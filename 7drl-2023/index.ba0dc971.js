function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function n(e){return e&&e.__esModule?e.default:e}var i={},r={},o=t.parcelRequire550f;null==o&&((o=function(e){if(e in i)return i[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},t.parcelRequire550f=o),o.register("27Lyk",(function(t,n){var i,r;e(t.exports,"register",(()=>i),(e=>i=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var o={};i=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)o[t[n]]=e[t[n]]},r=function(e){var t=o[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),o.register("cmoHh",(function(e,t){!function(e,t,n){function i(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new i(e),o=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&r(o,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n((function(){return o})):this.alea=o}(0,e,"function"==typeof define&&define)})),o.register("euRi5",(function(e,t){!function(e,t,n){function i(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new i(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&r(o,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n((function(){return o})):this.xor128=o}(0,e,"function"==typeof define&&define)})),o.register("hDsEw",(function(e,t){!function(e,t,n){function i(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),i==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new i(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&r(o,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n((function(){return o})):this.xorwow=o}(0,e,"function"==typeof define&&define)})),o.register("3J2Zm",(function(e,t){!function(e,t,n){function i(e){var t=this;t.next=function(){var e,n,i=t.x,r=t.i;return e=i[r],n=(e^=e>>>7)^e<<24,n^=(e=i[r+1&7])^e>>>10,n^=(e=i[r+3&7])^e>>>3,n^=(e=i[r+4&7])^e<<7,e=i[r+7&7],n^=(e^=e<<13)^e<<9,i[r]=n,t.i=r+1&7,n},function(e,t){var n,i=[];if(t===(0|t))i[0]=t;else for(t=""+t,n=0;n<t.length;++n)i[7&n]=i[7&n]<<15^t.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],e.x=i,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new i(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},s.int32=n.next,s.quick=s,o&&(o.x&&r(o,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n((function(){return o})):this.xorshift7=o}(0,e,"function"==typeof define&&define)})),o.register("6Px8M",(function(e,t){!function(e,t,n){function i(e){var t=this;t.next=function(){var e,n,i=t.w,r=t.X,o=t.i;return t.w=i=i+1640531527|0,n=r[o+34&127],e=r[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=r[o]=n^e,t.i=o,n+(i^i>>>16)|0},function(e,t){var n,i,r,o,s,a=[],l=128;for(t===(0|t)?(i=t,t=null):(t+="\0",i=0,l=Math.max(l,t.length)),r=0,o=-32;o<l;++o)t&&(i^=t.charCodeAt((o+32)%t.length)),0===o&&(s=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,o>=0&&(s=s+1640531527|0,r=0==(n=a[127&o]^=i+s)?r+1:0);for(r>=128&&(a[127&(t&&t.length||0)]=-1),r=127,o=512;o>0;--o)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;e.w=s,e.X=a,e.i=r}(t,e)}function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new i(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},s.int32=n.next,s.quick=s,o&&(o.X&&r(o,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n((function(){return o})):this.xor4096=o}(0,e,"function"==typeof define&&define)})),o.register("lDm0S",(function(e,t){!function(e,t,n){function i(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,i=t.d,r=t.a;return e=e<<25^e>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-i|0,t.d=i<<16^n>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var i=0;i<n.length+20;i++)t.b^=0|n.charCodeAt(i),t.next()}function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new i(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&r(o,n),s.state=function(){return r(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n((function(){return o})):this.tychei=o}(0,e,"function"==typeof define&&define)})),o.register("kjyEk",(function(e,t){})),o.register("iTab4",(function(e,t){e.exports=new URL(o("27Lyk").resolve("ad61r"),import.meta.url).toString()})),o.register("87bT4",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9uUvV"),import.meta.url).toString()})),o.register("eN2P4",(function(e,t){e.exports=new URL(o("27Lyk").resolve("3oZoP"),import.meta.url).toString()})),o.register("8A7kA",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2TVOL"),import.meta.url).toString()})),o.register("9bbmx",(function(e,t){e.exports=new URL(o("27Lyk").resolve("8yHq5"),import.meta.url).toString()})),o.register("V8ahV",(function(e,t){e.exports=new URL(o("27Lyk").resolve("dYyjZ"),import.meta.url).toString()})),o.register("hadbD",(function(e,t){e.exports=new URL(o("27Lyk").resolve("l8Gs4"),import.meta.url).toString()})),o.register("dH5ka",(function(e,t){e.exports=new URL(o("27Lyk").resolve("91j7m"),import.meta.url).toString()})),o.register("3twvr",(function(e,t){e.exports=new URL(o("27Lyk").resolve("dyBrj"),import.meta.url).toString()})),o.register("bBbdi",(function(e,t){e.exports=new URL(o("27Lyk").resolve("kO5BQ"),import.meta.url).toString()})),o.register("kBrAM",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9stv3"),import.meta.url).toString()})),o.register("k6Tdk",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iFwHo"),import.meta.url).toString()})),o.register("vDQ5G",(function(e,t){e.exports=new URL(o("27Lyk").resolve("cUkcS"),import.meta.url).toString()})),o.register("7DVvx",(function(e,t){e.exports=new URL(o("27Lyk").resolve("3WoZq"),import.meta.url).toString()})),o.register("al4v1",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4CRTl"),import.meta.url).toString()})),o.register("fO2Fk",(function(e,t){e.exports=new URL(o("27Lyk").resolve("byhsW"),import.meta.url).toString()})),o.register("kaxMC",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9W38z"),import.meta.url).toString()})),o.register("lsnFy",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4Xt2t"),import.meta.url).toString()})),o.register("iSQf2",(function(e,t){e.exports=new URL(o("27Lyk").resolve("7CMGD"),import.meta.url).toString()})),o.register("9W6vc",(function(e,t){e.exports=new URL(o("27Lyk").resolve("5OaqH"),import.meta.url).toString()})),o.register("h5cAV",(function(e,t){e.exports=new URL(o("27Lyk").resolve("eMbVa"),import.meta.url).toString()})),o.register("71dbC",(function(e,t){e.exports=new URL(o("27Lyk").resolve("3axOF"),import.meta.url).toString()})),o.register("iOIx8",(function(e,t){e.exports=new URL(o("27Lyk").resolve("e7FGC"),import.meta.url).toString()})),o.register("5HSVp",(function(e,t){e.exports=new URL(o("27Lyk").resolve("ePtUz"),import.meta.url).toString()})),o.register("gjhQR",(function(e,t){e.exports=new URL(o("27Lyk").resolve("54JTP"),import.meta.url).toString()})),o.register("9yWXC",(function(e,t){e.exports=new URL(o("27Lyk").resolve("f4kGs"),import.meta.url).toString()})),o.register("8wZYi",(function(e,t){e.exports=new URL(o("27Lyk").resolve("gIhaU"),import.meta.url).toString()})),o.register("lLaFn",(function(e,t){e.exports=new URL(o("27Lyk").resolve("lqqo8"),import.meta.url).toString()})),o.register("91Ssr",(function(e,t){e.exports=new URL(o("27Lyk").resolve("cLwSE"),import.meta.url).toString()})),o.register("iPqLJ",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2KH0C"),import.meta.url).toString()})),o.register("aYURT",(function(e,t){e.exports=new URL(o("27Lyk").resolve("cpKKf"),import.meta.url).toString()})),o.register("28SI0",(function(e,t){e.exports=new URL(o("27Lyk").resolve("5MeQP"),import.meta.url).toString()})),o.register("2v7tx",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2JDpK"),import.meta.url).toString()})),o.register("2ab9R",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2zYEJ"),import.meta.url).toString()})),o.register("5mxOT",(function(e,t){e.exports=new URL(o("27Lyk").resolve("cGSNL"),import.meta.url).toString()})),o.register("6zU4W",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iv3Fr"),import.meta.url).toString()})),o.register("c5gUn",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iTJrg"),import.meta.url).toString()})),o.register("pgODr",(function(e,t){e.exports=new URL(o("27Lyk").resolve("6QPv3"),import.meta.url).toString()})),o.register("2CXE7",(function(e,t){e.exports=new URL(o("27Lyk").resolve("l0nd4"),import.meta.url).toString()})),o.register("6IDgr",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2n0fD"),import.meta.url).toString()})),o.register("sYECX",(function(e,t){e.exports=new URL(o("27Lyk").resolve("fOp9V"),import.meta.url).toString()})),o.register("5SG7D",(function(e,t){e.exports=new URL(o("27Lyk").resolve("i4uwn"),import.meta.url).toString()})),o.register("b3a1B",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bFVB0"),import.meta.url).toString()})),o.register("hNZg3",(function(e,t){e.exports=new URL(o("27Lyk").resolve("auuxb"),import.meta.url).toString()})),o.register("f54Wu",(function(e,t){e.exports=new URL(o("27Lyk").resolve("ejcPD"),import.meta.url).toString()})),o.register("lLVHT",(function(e,t){e.exports=new URL(o("27Lyk").resolve("dGQlG"),import.meta.url).toString()})),o.register("4n1uh",(function(e,t){e.exports=new URL(o("27Lyk").resolve("c1reW"),import.meta.url).toString()})),o.register("9h7xU",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4kHlF"),import.meta.url).toString()})),o.register("jiU0R",(function(e,t){e.exports=new URL(o("27Lyk").resolve("UrS1Y"),import.meta.url).toString()})),o.register("alx6Z",(function(e,t){e.exports=new URL(o("27Lyk").resolve("la8N0"),import.meta.url).toString()})),o.register("ijwXJ",(function(e,t){e.exports=new URL(o("27Lyk").resolve("7cL8R"),import.meta.url).toString()})),o.register("a2kyU",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2wBmK"),import.meta.url).toString()})),o.register("5d0DW",(function(e,t){e.exports=new URL(o("27Lyk").resolve("jALpK"),import.meta.url).toString()})),o.register("dxMYB",(function(e,t){e.exports=new URL(o("27Lyk").resolve("b9dEt"),import.meta.url).toString()})),o.register("baOJW",(function(e,t){e.exports=new URL(o("27Lyk").resolve("fFe5r"),import.meta.url).toString()})),o.register("k2iei",(function(e,t){e.exports=new URL(o("27Lyk").resolve("lbRhG"),import.meta.url).toString()})),o.register("3x4yY",(function(e,t){e.exports=new URL(o("27Lyk").resolve("fpGvS"),import.meta.url).toString()})),o.register("egNqT",(function(e,t){e.exports=new URL(o("27Lyk").resolve("1sKsl"),import.meta.url).toString()})),o.register("QVkvm",(function(e,t){e.exports=new URL(o("27Lyk").resolve("gm0uu"),import.meta.url).toString()})),o.register("ggzCL",(function(e,t){e.exports=new URL(o("27Lyk").resolve("gYm3j"),import.meta.url).toString()})),o.register("h8bVj",(function(e,t){e.exports=new URL(o("27Lyk").resolve("binTT"),import.meta.url).toString()})),o.register("1NOTS",(function(e,t){e.exports=new URL(o("27Lyk").resolve("kOvrs"),import.meta.url).toString()})),o.register("6wdzE",(function(e,t){e.exports=new URL(o("27Lyk").resolve("f7gll"),import.meta.url).toString()})),o.register("7Bgvb",(function(e,t){e.exports=new URL(o("27Lyk").resolve("kxaoK"),import.meta.url).toString()})),o.register("cc8Co",(function(e,t){e.exports=new URL(o("27Lyk").resolve("1IHGt"),import.meta.url).toString()})),o.register("3Vwq5",(function(e,t){e.exports=new URL(o("27Lyk").resolve("d1AT3"),import.meta.url).toString()})),o.register("bk6h6",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iTS30"),import.meta.url).toString()})),o.register("7Du7Q",(function(e,t){e.exports=new URL(o("27Lyk").resolve("dgv1C"),import.meta.url).toString()})),o.register("aTKjT",(function(e,t){e.exports=new URL(o("27Lyk").resolve("3lODt"),import.meta.url).toString()})),o.register("8P0kg",(function(e,t){e.exports=new URL(o("27Lyk").resolve("nwoyO"),import.meta.url).toString()})),o.register("fyl73",(function(e,t){e.exports=new URL(o("27Lyk").resolve("hLJrX"),import.meta.url).toString()})),o.register("j5ffj",(function(e,t){e.exports=new URL(o("27Lyk").resolve("7NNoN"),import.meta.url).toString()})),o.register("40XLk",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iYi3V"),import.meta.url).toString()})),o.register("k4RLX",(function(e,t){e.exports=new URL(o("27Lyk").resolve("7xPeO"),import.meta.url).toString()})),o.register("34gKi",(function(e,t){e.exports=new URL(o("27Lyk").resolve("1cPlO"),import.meta.url).toString()})),o.register("9L8Sg",(function(e,t){e.exports=new URL(o("27Lyk").resolve("aGpum"),import.meta.url).toString()})),o.register("5Fjgc",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iOuyX"),import.meta.url).toString()})),o.register("7jABT",(function(e,t){e.exports=new URL(o("27Lyk").resolve("jjy9s"),import.meta.url).toString()})),o.register("fgE4t",(function(e,t){e.exports=new URL(o("27Lyk").resolve("8p5cP"),import.meta.url).toString()})),o.register("gGzmW",(function(e,t){e.exports=new URL(o("27Lyk").resolve("8Jj6R"),import.meta.url).toString()})),o.register("aUMGA",(function(e,t){e.exports=new URL(o("27Lyk").resolve("5u3ZN"),import.meta.url).toString()})),o.register("hAB2v",(function(e,t){e.exports=new URL(o("27Lyk").resolve("clDJP"),import.meta.url).toString()})),o.register("j1q3e",(function(e,t){e.exports=new URL(o("27Lyk").resolve("fnIha"),import.meta.url).toString()})),o.register("cp5Da",(function(e,t){e.exports=new URL(o("27Lyk").resolve("dxxv5"),import.meta.url).toString()})),o.register("k9vCo",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bGEJc"),import.meta.url).toString()})),o.register("fzAkK",(function(e,t){e.exports=new URL(o("27Lyk").resolve("goGEv"),import.meta.url).toString()})),o.register("2mcEF",(function(e,t){e.exports=new URL(o("27Lyk").resolve("5phrJ"),import.meta.url).toString()})),o.register("2lUVX",(function(e,t){e.exports=new URL(o("27Lyk").resolve("hZpxD"),import.meta.url).toString()})),o.register("bR2Qq",(function(e,t){e.exports=new URL(o("27Lyk").resolve("kSjuO"),import.meta.url).toString()})),o.register("4tABs",(function(e,t){e.exports=new URL(o("27Lyk").resolve("814wp"),import.meta.url).toString()})),o.register("4eWcK",(function(e,t){e.exports=new URL(o("27Lyk").resolve("6XNTC"),import.meta.url).toString()})),o.register("2IlHA",(function(e,t){e.exports=new URL(o("27Lyk").resolve("eSN3y"),import.meta.url).toString()})),o.register("b4oBR",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9fotz"),import.meta.url).toString()})),o.register("bEpX3",(function(e,t){e.exports=new URL(o("27Lyk").resolve("eseEk"),import.meta.url).toString()})),o.register("zO13n",(function(e,t){e.exports=new URL(o("27Lyk").resolve("fHEVh"),import.meta.url).toString()})),o.register("hPTSL",(function(e,t){e.exports=new URL(o("27Lyk").resolve("aR76A"),import.meta.url).toString()})),o.register("5TQSa",(function(e,t){e.exports=new URL(o("27Lyk").resolve("6SX6V"),import.meta.url).toString()})),o.register("h66m0",(function(e,t){e.exports=new URL(o("27Lyk").resolve("61mqx"),import.meta.url).toString()})),o.register("iXaO0",(function(e,t){e.exports=new URL(o("27Lyk").resolve("6vqpv"),import.meta.url).toString()})),o.register("kZ7gB",(function(e,t){e.exports=new URL(o("27Lyk").resolve("7YskR"),import.meta.url).toString()})),o.register("fBP7x",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4GKs5"),import.meta.url).toString()})),o.register("4iRwq",(function(e,t){e.exports=new URL(o("27Lyk").resolve("1i2I4"),import.meta.url).toString()})),o.register("aQaIJ",(function(e,t){e.exports=new URL(o("27Lyk").resolve("kOipz"),import.meta.url).toString()})),o.register("jI1w6",(function(e,t){e.exports=new URL(o("27Lyk").resolve("f3MqY"),import.meta.url).toString()})),o.register("7OaPU",(function(e,t){e.exports=new URL(o("27Lyk").resolve("8Eo8p"),import.meta.url).toString()})),o.register("eAAPp",(function(e,t){e.exports=new URL(o("27Lyk").resolve("6Z9FR"),import.meta.url).toString()})),o.register("Z94uH",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2BOzR"),import.meta.url).toString()})),o.register("2GAEF",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iFNVa"),import.meta.url).toString()})),o.register("bl9NP",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bb2lS"),import.meta.url).toString()})),o.register("avnp8",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bJNpV"),import.meta.url).toString()})),o.register("2mxOl",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bTEcp"),import.meta.url).toString()})),o.register("bvdYU",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4m6Oj"),import.meta.url).toString()})),o.register("f5YJN",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2keaG"),import.meta.url).toString()})),o.register("h733p",(function(e,t){e.exports=new URL(o("27Lyk").resolve("coxSt"),import.meta.url).toString()})),o.register("5iRGH",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9mWWx"),import.meta.url).toString()})),o.register("bodaa",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iS60i"),import.meta.url).toString()})),o.register("jnTTO",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bFY2K"),import.meta.url).toString()})),o.register("2uhoz",(function(e,t){e.exports=new URL(o("27Lyk").resolve("aRgI5"),import.meta.url).toString()})),o.register("4bkfm",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4VzTB"),import.meta.url).toString()})),o.register("cBYcL",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9gJPN"),import.meta.url).toString()})),o.register("1ZzuO",(function(e,t){e.exports=new URL(o("27Lyk").resolve("fH358"),import.meta.url).toString()})),o.register("iYF5j",(function(e,t){e.exports=new URL(o("27Lyk").resolve("76xZF"),import.meta.url).toString()})),o.register("hSkKy",(function(e,t){e.exports=new URL(o("27Lyk").resolve("jaDSM"),import.meta.url).toString()})),o.register("iCpSW",(function(e,t){e.exports=new URL(o("27Lyk").resolve("eVH90"),import.meta.url).toString()})),o.register("9upNV",(function(e,t){e.exports=new URL(o("27Lyk").resolve("j31GE"),import.meta.url).toString()})),o.register("yZG5v",(function(e,t){e.exports=new URL(o("27Lyk").resolve("g59Cn"),import.meta.url).toString()})),o.register("f1guA",(function(e,t){e.exports=new URL(o("27Lyk").resolve("3M7dG"),import.meta.url).toString()})),o.register("83TDO",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bodxv"),import.meta.url).toString()})),o.register("frVxF",(function(e,t){e.exports=new URL(o("27Lyk").resolve("aD9LH"),import.meta.url).toString()})),o.register("hCPR7",(function(e,t){e.exports=new URL(o("27Lyk").resolve("hiMs1"),import.meta.url).toString()})),o.register("4Za6U",(function(e,t){e.exports=new URL(o("27Lyk").resolve("5N2Ks"),import.meta.url).toString()})),o.register("3Xk6I",(function(e,t){e.exports=new URL(o("27Lyk").resolve("dxQIJ"),import.meta.url).toString()})),o.register("dosUm",(function(e,t){e.exports=new URL(o("27Lyk").resolve("35PQn"),import.meta.url).toString()})),o.register("4gdwQ",(function(e,t){e.exports=new URL(o("27Lyk").resolve("boWMm"),import.meta.url).toString()})),o.register("aLkfr",(function(e,t){e.exports=new URL(o("27Lyk").resolve("iI5Sk"),import.meta.url).toString()})),o.register("kSLiP",(function(e,t){e.exports=new URL(o("27Lyk").resolve("icWuP"),import.meta.url).toString()})),o.register("2IENo",(function(e,t){e.exports=new URL(o("27Lyk").resolve("8kRcq"),import.meta.url).toString()})),o.register("1CFiH",(function(e,t){e.exports=new URL(o("27Lyk").resolve("k6kBH"),import.meta.url).toString()})),o.register("llhgm",(function(e,t){e.exports=new URL(o("27Lyk").resolve("64BGF"),import.meta.url).toString()})),o.register("2eW7L",(function(e,t){e.exports=new URL(o("27Lyk").resolve("gdcwz"),import.meta.url).toString()})),o.register("kZcsz",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4q8Ah"),import.meta.url).toString()})),o.register("2qpAR",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9onoo"),import.meta.url).toString()})),o.register("cAyqi",(function(e,t){e.exports=new URL(o("27Lyk").resolve("93Pnl"),import.meta.url).toString()})),o.register("aEQTO",(function(e,t){e.exports=new URL(o("27Lyk").resolve("jpS1l"),import.meta.url).toString()})),o.register("ijfWN",(function(e,t){e.exports=new URL(o("27Lyk").resolve("8QomF"),import.meta.url).toString()})),o.register("7sWca",(function(e,t){e.exports=new URL(o("27Lyk").resolve("lqfpT"),import.meta.url).toString()})),o.register("fevkE",(function(e,t){e.exports=new URL(o("27Lyk").resolve("94dJT"),import.meta.url).toString()})),o.register("1B1JN",(function(e,t){e.exports=new URL(o("27Lyk").resolve("igW24"),import.meta.url).toString()})),o.register("jnuCJ",(function(e,t){e.exports=new URL(o("27Lyk").resolve("lqEqF"),import.meta.url).toString()})),o.register("cmvWY",(function(e,t){e.exports=new URL(o("27Lyk").resolve("8RJZ0"),import.meta.url).toString()})),o.register("hMHBo",(function(e,t){e.exports=new URL(o("27Lyk").resolve("dr5Sb"),import.meta.url).toString()})),o.register("9Nz7S",(function(e,t){e.exports=new URL(o("27Lyk").resolve("hrLmV"),import.meta.url).toString()})),o.register("9tCyg",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9wrD0"),import.meta.url).toString()})),o.register("7ryfo",(function(e,t){e.exports=new URL(o("27Lyk").resolve("lSD3i"),import.meta.url).toString()})),o.register("eLXb8",(function(e,t){e.exports=new URL(o("27Lyk").resolve("2z5r6"),import.meta.url).toString()})),o.register("8uLuu",(function(e,t){e.exports=new URL(o("27Lyk").resolve("6WfXi"),import.meta.url).toString()})),o.register("io7hj",(function(e,t){e.exports=new URL(o("27Lyk").resolve("lOXp5"),import.meta.url).toString()})),o.register("8Mr4t",(function(e,t){e.exports=new URL(o("27Lyk").resolve("9T16N"),import.meta.url).toString()})),o.register("3gcK8",(function(e,t){e.exports=new URL(o("27Lyk").resolve("k7LDh"),import.meta.url).toString()})),o.register("3N27a",(function(e,t){e.exports=new URL(o("27Lyk").resolve("gLbJJ"),import.meta.url).toString()})),o.register("i8RlJ",(function(e,t){e.exports=new URL(o("27Lyk").resolve("4qtqX"),import.meta.url).toString()})),o.register("4vw0X",(function(e,t){e.exports=new URL(o("27Lyk").resolve("z6pdh"),import.meta.url).toString()})),o.register("6aNdh",(function(e,t){e.exports=new URL(o("27Lyk").resolve("boWBX"),import.meta.url).toString()})),o.register("i6vQ5",(function(e,t){e.exports=new URL(o("27Lyk").resolve("jChss"),import.meta.url).toString()})),o.register("5PMpx",(function(e,t){e.exports=new URL(o("27Lyk").resolve("6WkPY"),import.meta.url).toString()})),o.register("2DFDi",(function(e,t){e.exports=new URL(o("27Lyk").resolve("idVW7"),import.meta.url).toString()})),o.register("527nu",(function(e,t){e.exports=new URL(o("27Lyk").resolve("jhJBF"),import.meta.url).toString()})),o.register("54HwM",(function(e,t){e.exports=new URL(o("27Lyk").resolve("1RMnM"),import.meta.url).toString()})),o.register("4e6QO",(function(e,t){e.exports=new URL(o("27Lyk").resolve("aawqd"),import.meta.url).toString()})),o.register("7k3tw",(function(e,t){e.exports=new URL(o("27Lyk").resolve("7Azq2"),import.meta.url).toString()})),o.register("fcDaw",(function(e,t){e.exports=new URL(o("27Lyk").resolve("bO5O6"),import.meta.url).toString()})),o.register("fty2x",(function(e,t){e.exports=new URL(o("27Lyk").resolve("cMgfB"),import.meta.url).toString()})),o.register("jFsow",(function(e,t){e.exports=new URL(o("27Lyk").resolve("i0tVX"),import.meta.url).toString()})),o.register("cMmoo",(function(e,t){e.exports=new URL(o("27Lyk").resolve("haQJd"),import.meta.url).toString()})),o("27Lyk").register(JSON.parse('{"17fSe":"index.ba0dc971.js","dwPvt":"tiles31color.140c045c.png","kDrfW":"font.84b63647.png","8Qic0":"Minstrel_Dance.84f0fe17.mp3","aSqJ5":"level-requirement-1.1c09d439.mp3","hMICc":"level-requirement-2.d04a051d.mp3","cFOzA":"lose-game-over.be572349.mp3","iP5rH":"Minstrel Dance Easter Egg.9bfc149a.mp3","4cgQm":"footstep-wood.61af6a80.mp3","5uP20":"footstep-tile.2079c58b.mp3","koWqL":"footstep-water.9134aef9.mp3","drQCs":"footstep-gravel.9bd43b2f.mp3","aKQuT":"footstep-grass.5ff03075.mp3","ad61r":"creak.dd25daba.mp3","9uUvV":"creak-2.17e2351c.mp3","3oZoP":"creak-3.15dd3369.mp3","2TVOL":"creak-4.44ae5b0e.mp3","8yHq5":"creak-5.76edc19f.mp3","dYyjZ":"creak-6.e3a72d6e.mp3","l8Gs4":"squeak1.463f9d1d.wav","91j7m":"squeak2.be5c76a8.wav","dyBrj":"squeak3.f084da55.wav","kO5BQ":"squeak4.f2ef2e0b.wav","9stv3":"hit16.mp3.12db2307.flac","iFwHo":"hit17.mp3.f1f9a130.flac","cUkcS":"hit18.mp3.9e7af88b.flac","3WoZq":"hit19.mp3.d775e463.flac","4CRTl":"hit20.mp3.3b3594b6.flac","byhsW":"hit26.mp3.ad2a87c8.flac","9W38z":"hit27.mp3.68a7736d.flac","4Xt2t":"coin.27887bdc.mp3","7CMGD":"coin-2.e8e82d5c.mp3","5OaqH":"coin-3.004f8541.mp3","eMbVa":"coin-4.6a51959e.mp3","3axOF":"coin-5.035907c7.mp3","e7FGC":"grunt.a8cde342.mp3","ePtUz":"grunt-2.30849a22.mp3","54JTP":"grunt-3.687bdfee.mp3","f4kGs":"grunt-4.4776cbdb.mp3","gIhaU":"grunt-5.7ebbc883.mp3","lqqo8":"grunt-6.b692d76a.mp3","cLwSE":"grunt-7.9923b5b3.mp3","2KH0C":"grunt-8.1912db98.mp3","cpKKf":"douse.5dfe688a.mp3","5MeQP":"douse-2.01d5e3d6.mp3","2JDpK":"douse-3.5dfe688a.mp3","2zYEJ":"douse-4.b84da553.mp3","cGSNL":"ignite.d3dd60a8.mp3","iv3Fr":"ignite-2.9dbae47a.mp3","iTJrg":"hide.b8c99711.mp3","6QPv3":"hide-2.0fe6cda6.mp3","l0nd4":"hide-3.302dff53.mp3","2n0fD":"hide-4.a97e1fc7.mp3","fOp9V":"hide-5.9bfbd476.mp3","i4uwn":"hide-6.1cd4f3d7.mp3","bFVB0":"gate.d5f8126d.mp3","auuxb":"gate-2.0044fff9.mp3","ejcPD":"gate-3.5b7711d0.mp3","dGQlG":"gate-4.1e6a5d1b.mp3","c1reW":"gate-5.72c10f72.mp3","4kHlF":"jump.e55ef093.mp3","UrS1Y":"jump-2.6fe19da4.mp3","la8N0":"too high.9cb62710.mp3","7cL8R":"too high-2.e4f836e5.mp3","2wBmK":"Hmm.ab4666bb.mp3","jALpK":"What.15d09f65.mp3","b9dEt":"hey.53e8bfa8.mp3","fFe5r":"hey-2.e5982d2d.mp3","lbRhG":"hey-3.d3e5ca0c.mp3","fpGvS":"what was that.77a752f9.mp3","1sKsl":"what was that-2.d2d3ac5e.mp3","gm0uu":"what was that-3.d5e6d3bc.mp3","gYm3j":"what was that-4.0ba90c81.mp3","binTT":"what was that-5.4cee52fb.mp3","kOvrs":"who goes there.e12006f8.mp3","f7gll":"huh.0b84b50b.mp3","kxaoK":"wha.fed9d6c8.mp3","1IHGt":"wait.00b947d9.mp3","d1AT3":"who there.af08ce5f.mp3","iTS30":"what moved.5eb219b5.mp3","dgv1C":"what in the shadows.e4c09c64.mp3","3lODt":"shadow move.f9411514.mp3","nwoyO":"see something.8ae2c900.mp3","hLJrX":"hello.5375bd54.mp3","7NNoN":"ugh.d8bf005c.mp3","iYi3V":"quiet out.e6c9a6bb.mp3","7xPeO":"jumpy.8728c25d.mp3","1cPlO":"jumpin shadows.2393e9a2.mp3","aGpum":"ahh.d5b34b8b.mp3","iOuyX":"aww.afe83640.mp3","jjy9s":"rest me bones.b8117961.mp3","8p5cP":"oh well.4c7e171f.mp3","8Jj6R":"case of the jitters.d7950824.mp3","5u3ZN":"must be seeing.1cf0d466.mp3","clDJP":"what in my coffee.66632fce.mp3","fnIha":"coffee too strong.b8d95a1c.mp3","dxxv5":"hmm nothing.5e78dbae.mp3","bGEJc":"well I though I saw.a502b75d.mp3","goGEv":"nothing.0afb94af.mp3","5phrJ":"hopefully nothing.38c5aeda.mp3","hZpxD":"seeing things.a6f06709.mp3","kSjuO":"what-2.66b0ac41.mp3","814wp":"hark.c23476ea.mp3","6XNTC":"noise.b4e76638.mp3","eSN3y":"heard something.e9e5f3ce.mp3","9fotz":"cant hear now.d26c58c2.mp3","eseEk":"hearing things.369b6c03.mp3","fHEVh":"noise again.9bf45be9.mp3","aR76A":"someone there.5c5c2581.mp3","6SX6V":"who could that be.676f39e4.mp3","61mqx":"there it is again.9322fa48.mp3","6vqpv":"better check it out.ebf046f4.mp3","7YskR":"what keeps making those noises.acd58821.mp3","4GKs5":"better be rats.ebf6a701.mp3","1i2I4":"again.e6429fce.mp3","kOipz":"who that.e84cef75.mp3","f3MqY":"come out come out.beb4d769.mp3","8Eo8p":"guess nothing.d8004f20.mp3","6Z9FR":"wonder it was.d88b20b1.mp3","2BOzR":"back to post.c9710e8a.mp3","iFNVa":"quiet now.14ad7770.mp3","bb2lS":"sure I heard something.92884ce2.mp3","bJNpV":"not there anymore.d9adab1a.mp3","bTEcp":"probably nothing.61c0f4ca.mp3","4m6Oj":"i dont know why i work here.9c74a165.mp3","2keaG":"waste of my time.01eb2214.mp3","coxSt":"why do I even try.c223ca7c.mp3","9mWWx":"at least Im not on cleaning duty.a322a828.mp3","iS60i":"at least my shift ends soon.508eba67.mp3","bFY2K":"what do you want me to do about it.b4058cf6.mp3","aRgI5":"where.5c5c6f23.mp3","4VzTB":"coming.2427458c.mp3","9gJPN":"here I come.88f25611.mp3","fH358":"to arms.6c7d0469.mp3","76xZF":"what is it.60c0a58c.mp3","jaDSM":"i dont know how to whistle.ba7df287.mp3","eVH90":"whistle.3a7291de.mp3","j31GE":"whistle-2.476ef42b.mp3","g59Cn":"whistle-3.6bcc64ea.mp3","3M7dG":"get em.e4bd8211.mp3","bodxv":"intruder.d29f8600.mp3","aD9LH":"oh no its a thief.95ded24b.mp3","hiMs1":"we coming for you.72c3b24e.mp3","5N2Ks":"coming for you.7bb9dc69.mp3","dxQIJ":"halt.12eee447.mp3","35PQn":"see you.859510ce.mp3","boWMm":"ill get you.dce0b107.mp3","iI5Sk":"a goner.50561a6a.mp3","icWuP":"just you wait.d2b91fc0.mp3","8kRcq":"you wont get away.800811e0.mp3","k6kBH":"no you dont.4ac92675.mp3","64BGF":"thief.2115f040.mp3","gdcwz":"thief-2.9040a582.mp3","4q8Ah":"thief-3.b8074467.mp3","9onoo":"after them.b8ebaf41.mp3","93Pnl":"what is thy business.a4047487.mp3","jpS1l":"no mercy for the wicked.5762a3e4.mp3","8QomF":"lost em.a34a1d09.mp3","lqfpT":"must have run.7a11d2a0.mp3","94dJT":"where they go.ca451290.mp3","igW24":"his holiness.4d336ce3.mp3","lqEqF":"the boss.cc03678e.mp3","8RJZ0":"huff puff give up.2bb20f55.mp3","dr5Sb":"where did he go.95b776f4.mp3","hrLmV":"drats lost him.1c6956c9.mp3","9wrD0":"gone.c866fdd9.mp3","lSD3i":"come back here.c30d95e2.mp3","2z5r6":"rotten scoundrel.aa0b2e4c.mp3","6WfXi":"aargh.09fd695b.mp3","lOXp5":"not coming back.c1590d1d.mp3","9T16N":"blast.14fafb40.mp3","k7LDh":"dont come back.5b7087c8.mp3","gLbJJ":"wont get away next time.565245ee.mp3","4qtqX":"for his holiness.674bd7fc.mp3","z6pdh":"lousy day at work.96f55006.mp3","boWBX":"i give up.14ffb14e.mp3","jChss":"what do i do help me.1938fc64.mp3","6WkPY":"oh no he got away.1ec7c74a.mp3","idVW7":"guard rant.a80c9b54.mp3","jhJBF":"take that.89a1c776.mp3","1RMnM":"oof.0fbc8e69.mp3","aawqd":"uh.0f80062b.mp3","7Azq2":"ah.f85c33dd.mp3","bO5O6":"ah-2.5f33dd73.mp3","cMgfB":"ha ya.86d45e64.mp3","i0tVX":"ha ya-2.fc4fbee2.mp3","haQJd":"ha ya-3.78dc4818.mp3"}'));class s extends Array{constructor(...e){super(...e)}static fromValues(e,t){return new s(e,t)}static create(){return new s(0,0)}static clone(e){return new s(e[0],e[1])}equals(e){return this[0]===e[0]&&this[1]===e[1]}equalsValues(e,t){return this[0]===e&&this[1]===t}copy(e){this[0]=e[0],this[1]=e[1]}set(e,t){this[0]=e,this[1]=t}add(e){return s.fromValues(this[0]+e[0],this[1]+e[1])}subtract(e){return s.fromValues(this[0]-e[0],this[1]-e[1])}multiply(e){return s.fromValues(this[0]*e[0],this[1]*e[1])}scale(e){return s.fromValues(this[0]*e,this[1]*e)}scaleAndAdd(e,t){return s.fromValues(this[0]+e[0]*t,this[1]+e[1]*t)}distance(e){const t=this[0]-e[0],n=this[1]-e[1];return Math.hypot(t,n)}squaredDistance(e){const t=this[0]-e[0],n=this[1]-e[1];return t*t+n*n}len(){return Math.hypot(this[0],this[1])}squaredLen(e){const t=this[0],n=this[1];return t*t+n*n}negate(){return s.fromValues(-this[0],-this[1])}dot(e){return this[0]*e[0]+this[1]*e[1]}lerp(e,t){return s.fromValues(this[0]+t*(e[0]-this[0]),this[1]+t*(e[1]-this[1]))}zero(){this[0]=0,this[1]=0}static copy(e,t){e[0]=t[0],e[1]=t[1]}static set(e,t,n){e[0]=t,e[1]=n}static add(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1]}static subtract(e,t,n){e[0]=t[0]-n[0],e[1]=t[1]-n[1]}static multiply(e,t,n){e[0]=t[0]*n[0],e[1]=t[1]*n[1]}static scale(e,t,n){e[0]=t[0]*n,e[1]=t[1]*n}static scaleAndAdd(e,t,n,i){e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i}static distance(e,t){const n=e[0]-t[0],i=e[1]-t[1];return Math.hypot(n,i)}static squaredDistance(e,t){const n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}static len(e){return Math.hypot(e[0],e[1])}static squaredLen(e){const t=e[0],n=e[1];return t*t+n*n}static negate(e,t){e[0]=-t[0],e[1]=-t[1]}static dot(e,t){return e[0]*t[0]+e[1]*t[1]}static lerp(e,t,n,i){e[0]=t[0]+i*(n[0]-t[0]),e[1]=t[1]+i*(n[1]-t[1])}static zero(e){e[0]=0,e[1]=0}}let a;var l;(l=a||(a={})).create=function(){return[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},l.copy=function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]},l.ortho=function(e,t,n,i,r,o,s){const a=1/(t-n),l=1/(i-r),u=1/(o-s);e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*a,e[13]=(r+i)*l,e[14]=(s+o)*u,e[15]=1};var u={},c=o("cmoHh"),h=o("euRi5"),d=o("hDsEw"),f=o("3J2Zm"),p=o("6Px8M"),m=o("lDm0S"),g={};!function(e,t,n){var i,r=256,s=6,a="random",l=n.pow(r,s),u=n.pow(2,52),c=2*u,h=r-1;function d(o,h,d){var g=[],b=v(m((h=1==h?{entropy:!0}:h||{}).entropy?[o,y(t)]:null==o?function(){try{var n;return i&&(n=i.randomBytes)?n=n(r):(n=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(n)),y(n)}catch(n){var o=e.navigator,s=o&&o.plugins;return[+new Date,e,s,e.screen,y(t)]}}():o,3),g),w=new f(g),_=function(){for(var e=w.g(s),t=l,n=0;e<u;)e=(e+n)*r,t*=r,n=w.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return _.int32=function(){return 0|w.g(4)},_.quick=function(){return w.g(4)/4294967296},_.double=_,v(y(w.S),t),(h.pass||d||function(e,t,i,r){return r&&(r.S&&p(r,w),e.state=function(){return p(w,{})}),i?(n[a]=e,t):e})(_,b,"global"in h?h.global:this==n,h.state)}function f(e){var t,n=e.length,i=this,o=0,s=i.i=i.j=0,a=i.S=[];for(n||(e=[n++]);o<r;)a[o]=o++;for(o=0;o<r;o++)a[o]=a[s=h&s+e[o%n]+(t=a[o])],a[s]=t;(i.g=function(e){for(var t,n=0,o=i.i,s=i.j,a=i.S;e--;)t=a[o=h&o+1],n=n*r+a[h&(a[o]=a[s=h&s+t])+(a[s]=t)];return i.i=o,i.j=s,n})(r)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,i=[],r=typeof e;if(t&&"object"==r)for(n in e)try{i.push(m(e[n],t-1))}catch(e){}return i.length?i:"string"==r?e:e+"\0"}function v(e,t){for(var n,i=e+"",r=0;r<i.length;)t[h&r]=h&(n^=19*t[h&r])+i.charCodeAt(r++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(v(n.random(),t),g){g=d;try{i=o("kjyEk")}catch(e){}}else"function"==typeof define&&define.amd?define((function(){return d})):n["seed"+a]=d}("undefined"!=typeof self?self:g,[],Math),g.alea=c,g.xor128=h,g.xorwow=d,g.xorshift7=f,g.xor4096=p,g.tychei=m,u=g;class v{constructor(e=""){""!==e?(this.seed=e,this.rng=u(e)):(this.seed="",this.rng=u())}random(){return this.rng()}randomInRange(e){return Math.floor(this.rng()*e)}shuffleArray(e){for(let t=e.length-1;t>0;--t){let n=this.randomInRange(t+1),i=e[t];e[t]=e[n],e[n]=i}}}function y(e){return Math.floor(Math.random()*e)}function b(e){for(let t=e.length-1;t>0;--t){let n=y(t+1),i=e[t];e[t]=e[n],e[n]=i}}let w;var _;(_=w||(w={}))[_.Damage=0]="Damage",_[_.GuardChase=1]="GuardChase",_[_.GuardSeeThief=2]="GuardSeeThief",_[_.GuardHearThief=3]="GuardHearThief",_[_.GuardHearGuard=4]="GuardHearGuard",_[_.GuardDownWarning=5]="GuardDownWarning",_[_.GuardAwakesWarning=6]="GuardAwakesWarning",_[_.GuardWarningResponse=7]="GuardWarningResponse",_[_.GuardInvestigate=8]="GuardInvestigate",_[_.GuardEndChase=9]="GuardEndChase",_[_.GuardFinishInvestigating=10]="GuardFinishInvestigating",_[_.GuardFinishLooking=11]="GuardFinishLooking",_[_.GuardFinishListening=12]="GuardFinishListening",_[_.GuardStirring=13]="GuardStirring";class S{constructor(){this.popups=[]}add(e,t){this.popups.push({popupType:e,posWorld:t})}clear(){this.popups.length=0}endOfUpdate(e){if(0===this.popups.length)return"";this.popups.sort(((e,t)=>e.popupType-t.popupType));return e[function(e){switch(e){case w.Damage:return"guardDamage";case w.GuardChase:return"guardChase";case w.GuardSeeThief:return"guardSeeThief";case w.GuardHearThief:return"guardHearThief";case w.GuardHearGuard:return"guardHearGuard";case w.GuardDownWarning:return"guardDownWarning";case w.GuardAwakesWarning:return"guardAwakesWarning";case w.GuardWarningResponse:return"guardWarningResponse";case w.GuardInvestigate:return"guardInvestigate";case w.GuardEndChase:return"guardEndChase";case w.GuardFinishInvestigating:return"guardFinishInvestigating";case w.GuardFinishLooking:return"guardFinishLooking";case w.GuardFinishListening:return"guardFinishListening";case w.GuardStirring:return"guardStirring"}}(this.popups[0].popupType)].play(.6).subtitle}}var T={},I={linear:function(e,t,n,i){return(n-t)*e/i+t},easeInQuad:function(e,t,n,i){return(n-t)*(e/=i)*e+t},easeOutQuad:function(e,t,n,i){return-(n-t)*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,n,i){var r=n-t;return(e/=i/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,i){return(n-t)*(e/=i)*e*e+t},easeOutCubic:function(e,t,n,i){return(n-t)*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,i){var r=n-t;return(e/=i/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,i){return(n-t)*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,n,i){return-(n-t)*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,i){var r=n-t;return(e/=i/2)<1?r/2*e*e*e*e+t:-r/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,i){return(n-t)*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,n,i){return(n-t)*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,i){var r=n-t;return(e/=i/2)<1?r/2*e*e*e*e*e+t:r/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,i){var r=n-t;return-r*Math.cos(e/i*(Math.PI/2))+r+t},easeOutSine:function(e,t,n,i){return(n-t)*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,n,i){return-(n-t)/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,n,i){return 0==e?t:(n-t)*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,n,i){var r=n-t;return e==i?t+r:r*(1-Math.pow(2,-10*e/i))+t},easeInOutExpo:function(e,t,n,i){var r=n-t;return 0===e?t:e===i?t+r:(e/=i/2)<1?r/2*Math.pow(2,10*(e-1))+t:r/2*(2-Math.pow(2,-10*--e))+t},easeInCirc:function(e,t,n,i){return-(n-t)*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,n,i){return(n-t)*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,n,i){var r=n-t;return(e/=i/2)<1?-r/2*(Math.sqrt(1-e*e)-1)+t:r/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,n,i){var r,o,s,a=n-t;return s=1.70158,0===e?t:1==(e/=i)?t+a:((o=0)||(o=.3*i),(r=a)<Math.abs(a)?(r=a,s=o/4):s=o/(2*Math.PI)*Math.asin(a/r),-r*Math.pow(2,10*(e-=1))*Math.sin((e*i-s)*(2*Math.PI)/o)+t)},easeOutElastic:function(e,t,n,i){var r,o,s,a=n-t;return s=1.70158,0===e?t:1==(e/=i)?t+a:((o=0)||(o=.3*i),(r=a)<Math.abs(a)?(r=a,s=o/4):s=o/(2*Math.PI)*Math.asin(a/r),r*Math.pow(2,-10*e)*Math.sin((e*i-s)*(2*Math.PI)/o)+a+t)},easeInOutElastic:function(e,t,n,i){var r,o,s,a=n-t;return s=1.70158,0===e?t:2==(e/=i/2)?t+a:((o=0)||(o=i*(.3*1.5)),(r=a)<Math.abs(a)?(r=a,s=o/4):s=o/(2*Math.PI)*Math.asin(a/r),e<1?r*Math.pow(2,10*(e-=1))*Math.sin((e*i-s)*(2*Math.PI)/o)*-.5+t:r*Math.pow(2,-10*(e-=1))*Math.sin((e*i-s)*(2*Math.PI)/o)*.5+a+t)},easeInBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),(n-t)*(e/=i)*e*((r+1)*e-r)+t},easeOutBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),(n-t)*((e=e/i-1)*e*((r+1)*e+r)+1)+t},easeInOutBack:function(e,t,n,i,r){var o=n-t;return void 0===r&&(r=1.70158),(e/=i/2)<1?o/2*(e*e*((1+(r*=1.525))*e-r))+t:o/2*((e-=2)*e*((1+(r*=1.525))*e+r)+2)+t},easeInBounce:function(e,t,n,i){var r=n-t;return r-I.easeOutBounce(i-e,0,r,i)+t},easeOutBounce:function(e,t,n,i){var r=n-t;return(e/=i)<1/2.75?r*(7.5625*e*e)+t:e<2/2.75?r*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?r*(7.5625*(e-=2.25/2.75)*e+.9375)+t:r*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(e,t,n,i){var r=n-t;return e<i/2?.5*I.easeInBounce(2*e,0,r,i)+t:.5*I.easeOutBounce(2*e-i,0,r,i)+.5*r+t}};T=I;class E{update(e){return!1}currentTile(){return{}}}class A extends E{constructor(e,t,n=0,i=0){super(),this.time=n,this.tileInfo=e,this.activeFrame=i,this.frameDuration=t}update(e){this.time+=e;const t=this.frameDuration instanceof Array?this.frameDuration[this.activeFrame]:this.frameDuration;return this.time>t&&(this.activeFrame++,this.activeFrame>=this.tileInfo.length&&(this.activeFrame=0),this.time=0),!1}currentTile(){return this.tileInfo[this.activeFrame]}}class k extends E{constructor(e,t){super(),this.time=0,this.offset=s.clone(e[0].pt0),this.tileInfo=t,this.activeFrame=0,this.frameStep=1,this.activePt=0,this.tweenSeq=e,this.removeOnFinish=!1}update(e){const t=this.tweenSeq[this.activePt].pt0,n=this.tweenSeq[this.activePt].pt1,i=this.tweenSeq[this.activePt].duration,r=this.tweenSeq[this.activePt].fn;return void 0===t||null==n||(this.time=Math.min(this.time+e,i),this.offset[0]=r(this.time,t[0],n[0],i),this.offset[1]=r(this.time,t[1],n[1],i),this.time==i&&(this.activePt++,this.time=0,this.activeFrame++),this.activeFrame>=this.tileInfo.length&&(this.activeFrame=0),this.activePt===this.tweenSeq.length)}currentTile(){return this.tileInfo[this.activeFrame]}}let C;var x;(x=C||(C={}))[x.idle=0]="idle",x[x.dimmed=1]="dimmed",x[x.off=2]="off";class R extends E{activeFrame=0;time=0;dimDuration=300;constructor(e,t,n,i,r,o,s){super(),this.idleTiles=r,this.dimTile=o,this.offTile=s,this.lightId=t,this.lightVector=n,this.state=e,this.item=i}update(e){if(null!==this.item&&(this.item.type===Z.TorchUnlit&&(this.state=C.off),this.item.type!==Z.TorchUnlit&&this.state===C.off&&(this.state=C.idle,this.lightVector[this.lightId]=0)),this.time+=e,this.state==C.off)return!1;let t=this.lightVector[this.lightId];if(0==t&&Math.random()>.995**(60*e)?(this.state=C.dimmed,t=3):t>0&&(t=Math.max(t-5*e,0)),0==t){this.state=C.idle;const e=this.idleTiles[this.activeFrame][1];this.time>=e&&(this.time=0,this.activeFrame++,this.activeFrame>=this.idleTiles.length&&(this.activeFrame=0))}return this.lightVector[this.lightId]=t,!1}currentTile(){return this.state==C.idle?this.idleTiles[this.activeFrame][0]:this.state==C.dimmed?this.dimTile:this.offTile}}let L;var M;let P;var D;(M=L||(L={}))[M.StoodStill=0]="StoodStill",M[M.Moved=1]="Moved",M[M.BumpedPlayer=2]="BumpedPlayer",(D=P||(P={}))[D.Patrol=0]="Patrol",D[D.Look=1]="Look",D[D.Listen=2]="Listen",D[D.ChaseVisibleTarget=3]="ChaseVisibleTarget",D[D.MoveToLastSighting=4]="MoveToLastSighting",D[D.MoveToLastSound=5]="MoveToLastSound",D[D.MoveToGuardShout=6]="MoveToGuardShout",D[D.MoveToDownedGuard=7]="MoveToDownedGuard",D[D.WakeGuard=8]="WakeGuard",D[D.MoveToTorch=9]="MoveToTorch",D[D.LightTorch=10]="LightTorch",D[D.Unconscious=11]="Unconscious";class N{dir=s.fromValues(1,0);mode=P.Patrol;angry=!1;hasTorch=!1;hasPurse=!1;hasVaultKey=!1;torchAnimation=null;speaking=!1;hasMoved=!1;heardThief=!1;heardThiefClosest=!1;hearingGuard=!1;heardGuard=!1;animation=null;modeTimeout=0;constructor(e,t){const n=e[t];this.pos=s.clone(n),this.heardGuardPos=s.clone(n),this.goal=s.clone(n),this.patrolPath=e,this.patrolPathIndex=t,this.updateDirInitial()}overheadIcon(){return this.mode===P.Unconscious?Q.Unconscious:this.mode===P.ChaseVisibleTarget?Q.Chasing:O(this.mode)?this.angry?Q.Angry:Q.Relaxed:Q.Alerted}movingWithPlayerPosition(e){switch(this.mode){case P.Patrol:const t=this.patrolPath[this.patrolPathIndex];if(t.equals(this.pos)){const n=(this.patrolPathIndex+1)%this.patrolPath.length,i=this.patrolPath[n];return!(i.equals(t)||i.equals(e))}return!0;case P.Look:case P.Listen:case P.ChaseVisibleTarget:case P.WakeGuard:case P.LightTorch:case P.Unconscious:return!1;case P.MoveToLastSighting:case P.MoveToLastSound:case P.MoveToGuardShout:return!this.pos.equals(this.goal);case P.MoveToDownedGuard:case P.MoveToTorch:return!this.cardinallyAdjacentTo(this.goal)}}moving(){switch(this.mode){case P.Patrol:const e=this.patrolPath[this.patrolPathIndex];if(e.equals(this.pos)){const t=(this.patrolPathIndex+1)%this.patrolPath.length;return!this.patrolPath[t].equals(e)}return!0;case P.Look:case P.Listen:case P.ChaseVisibleTarget:case P.WakeGuard:case P.LightTorch:case P.Unconscious:return!1;case P.MoveToLastSighting:case P.MoveToLastSound:case P.MoveToGuardShout:return!this.pos.equals(this.goal);case P.MoveToDownedGuard:case P.MoveToTorch:return!this.cardinallyAdjacentTo(this.goal)}}act(e,t,n,i){const r=this.mode,o=s.clone(this.pos);switch(this.mode!==P.Unconscious&&!O(this.mode)&&this.seesActor(e,n)&&(this.mode=P.ChaseVisibleTarget),this.mode){case P.Patrol:this.patrolStep(e,n);break;case P.Look:case P.Listen:this.modeTimeout-=1,0==this.modeTimeout&&this.enterPatrolMode(e);break;case P.ChaseVisibleTarget:if(s.copy(this.goal,n.pos),this.adjacentTo(n.pos)){if(H(this.dir,this.pos,this.goal),r==P.ChaseVisibleTarget){n.damagedLastTurn||t.add(w.Damage,this.pos);const e=s.create(),i=s.create();s.subtract(i,n.pos,this.pos),s.scale(i,i,.5),this.animation=new k([{pt0:e,pt1:i,duration:.1,fn:T.easeInQuad},{pt0:i,pt1:e,duration:.1,fn:T.easeOutQuad}],[]),n.applyDamage(1)}}else this.moveTowardPosition(this.goal,e,n);break;case P.MoveToLastSighting:case P.MoveToLastSound:case P.MoveToGuardShout:this.moveTowardPosition(this.goal,e,n)!==L.Moved&&(this.modeTimeout-=1),0==this.modeTimeout&&this.enterPatrolMode(e);break;case P.MoveToDownedGuard:this.cardinallyAdjacentTo(this.goal)?e.guards.find((e=>e.pos.equals(this.goal)&&e.mode===P.Unconscious))?(this.mode=P.WakeGuard,this.modeTimeout=3):(this.modeTimeout=0,this.enterPatrolMode(e)):this.moveTowardAdjacentToPosition(this.goal,e,n)!==L.Moved&&(this.modeTimeout-=1,0===this.modeTimeout&&this.enterPatrolMode(e));break;case P.WakeGuard:--this.modeTimeout,H(this.dir,this.pos,this.goal);const o=e.guards.find((e=>e.pos.equals(this.goal)&&e.mode===P.Unconscious));void 0!==o?this.modeTimeout<=0&&(o.modeTimeout=0,this.enterPatrolMode(e)):(this.modeTimeout=0,this.enterPatrolMode(e));break;case P.MoveToTorch:{const t=this.moveTowardAdjacentToPosition(this.goal,e,n);this.cardinallyAdjacentTo(this.goal)?(this.mode=P.LightTorch,this.modeTimeout=5):t===L.Moved?this.modeTimeout=3:(this.modeTimeout-=1,this.modeTimeout<=0&&this.enterPatrolMode(e))}break;case P.LightTorch:--this.modeTimeout,H(this.dir,this.pos,this.goal),this.modeTimeout<=0&&(!function(e,t,n){for(const n of e.items)n.type===Z.TorchUnlit&&n.pos.equals(t)&&(n.type=Z.TorchLit);e.computeLighting(e.cells.atVec(n.pos))}(e,this.goal,n),this.enterPatrolMode(e));break;case P.Unconscious:if(this.modeTimeout-=1,5===this.modeTimeout){const e=w.GuardStirring;t.add(e,this.pos)}else this.modeTimeout<=0&&(this.enterPatrolMode(e),this.modeTimeout=0,this.angry=!0,i.push({pos_shouter:this.pos,pos_target:this.pos,target:this}),t.add(w.GuardAwakesWarning,this.pos))}if(this.hasTorch&&!o.equals(this.pos)&&e.computeLighting(e.cells.at(n.pos[0],n.pos[1])),this.mode!==P.Unconscious){if(this.seesActor(e,n)?O(this.mode)&&!this.adjacentTo(n.pos)?(this.mode=P.Look,this.modeTimeout=2+y(4)):this.mode=P.ChaseVisibleTarget:this.mode===P.ChaseVisibleTarget&&(this.mode=P.MoveToLastSighting,this.modeTimeout=3),this.heardThief&&this.mode!==P.ChaseVisibleTarget&&(this.adjacentTo(n.pos)?this.mode=P.ChaseVisibleTarget:O(this.mode)&&!this.heardThiefClosest?(this.mode=P.Listen,this.modeTimeout=2+y(4)):this.mode!==P.MoveToDownedGuard&&(this.mode=P.MoveToLastSound,this.modeTimeout=2+y(4),s.copy(this.goal,n.pos))),this.heardGuard&&this.mode!==P.Look&&this.mode!==P.ChaseVisibleTarget&&this.mode!==P.MoveToLastSighting&&this.mode!==P.MoveToLastSound&&(this.mode=P.MoveToGuardShout,this.modeTimeout=2+y(4),s.copy(this.goal,this.heardGuardPos)),O(this.mode))for(let t of e.guards)if(t!==this&&t.mode===P.Unconscious&&this.seesActor(e,t)){s.copy(this.goal,t.pos),this.mode=P.MoveToDownedGuard,this.angry=!0,this.modeTimeout=3,i.push({pos_shouter:this.pos,pos_target:t.pos,target:t});break}if(this.mode===P.Patrol){const t=function(e,t){let n,i=65;for(const r of e.items)if(r.type===Z.TorchUnlit){const o=s.squaredDistance(r.pos,t);if(o>=i)continue;if(!G(e,t,r.pos))continue;i=o,n=r}return n}(e,this.pos);void 0!==t&&(s.copy(this.goal,t.pos),this.cardinallyAdjacentTo(this.goal)?(this.mode=P.LightTorch,this.modeTimeout=5):(this.mode=P.MoveToTorch,this.modeTimeout=3))}}this.heardThief=!1,this.heardThiefClosest=!1;const a=function(e,t){if(t==e)return;switch(t){case P.Patrol:switch(e){case P.Look:return w.GuardFinishLooking;case P.Listen:return w.GuardFinishListening;case P.MoveToLastSound:case P.MoveToGuardShout:return w.GuardFinishInvestigating;case P.MoveToLastSighting:return w.GuardEndChase;case P.Unconscious:return w.GuardAwakesWarning;default:return}case P.Look:return w.GuardSeeThief;case P.Listen:return w.GuardHearThief;case P.ChaseVisibleTarget:return e!=P.MoveToLastSighting?w.GuardChase:void 0;case P.MoveToLastSighting:return;case P.MoveToLastSound:return w.GuardInvestigate;case P.MoveToGuardShout:return w.GuardHearGuard;case P.MoveToDownedGuard:return w.GuardDownWarning}return}(r,this.mode);void 0!==a&&t.add(a,this.pos),this.mode===P.ChaseVisibleTarget&&r!==P.ChaseVisibleTarget&&i.push({pos_shouter:this.pos,pos_target:n.pos,target:n})}cardinallyAdjacentTo(e){const t=Math.abs(e[0]-this.pos[0]),n=Math.abs(e[1]-this.pos[1]);return 1==t&&0==n||0==t&&1==n}adjacentTo(e){const t=e[0]-this.pos[0],n=e[1]-this.pos[1];return Math.abs(t)<2&&Math.abs(n)<2}seesActor(e,t){const n=s.create();if(s.subtract(n,t.pos,this.pos),this.mode!==P.ChaseVisibleTarget&&s.dot(this.dir,n)<0)return!1;let i=e.cells.atVec(t.pos).lit>0;return!(s.squaredLen(n)>=this.sightCutoff(i))&&!((t.hidden(e)||!B(e,this.pos,t.pos))&&(O(this.mode)&&!this.angry||Math.abs(n[0])>=2||Math.abs(n[1])>=2))}hidden(){return!1}cutoffLit(){return O(this.mode)&&!this.angry?40:75}cutoffUnlit(){return O(this.mode)&&!this.angry?3:33}sightCutoff(e){return e?this.cutoffLit():this.cutoffUnlit()}enterPatrolMode(e){this.patrolPathIndex=e.patrolPathIndexForResume(this.patrolPath,this.patrolPathIndex,this.pos),this.mode=P.Patrol}patrolStep(e,t){this.patrolPath[this.patrolPathIndex].equals(this.pos)&&(this.patrolPathIndex=(this.patrolPathIndex+1)%this.patrolPath.length);const n=this.moveTowardPosition(this.patrolPath[this.patrolPathIndex],e,t);if(n===L.BumpedPlayer)this.mode=P.ChaseVisibleTarget,H(this.dir,this.pos,t.pos);else if(n===L.StoodStill){const t=this.tryGetPosLookAt(e);void 0!==t&&H(this.dir,this.pos,t)}}updateDirInitial(){const e=(this.patrolPathIndex+1)%this.patrolPath.length;H(this.dir,this.pos,this.patrolPath[e])}moveTowardPosition(e,t,n){const i=t.computeDistancesToPosition(e),r=t.posNextBest(i,this.pos);if(H(this.dir,this.pos,r),n.pos.equals(r))return L.BumpedPlayer;if(r.equals(this.pos))return L.StoodStill;const o=s.create();s.subtract(o,this.pos,r);const a=s.create();return this.animation=new k([{pt0:o,pt1:a,duration:.2,fn:T.linear}],[]),s.copy(this.pos,r),L.Moved}moveTowardAdjacentToPosition(e,t,n){const i=t.computeDistancesToAdjacentToPosition(e),r=t.posNextBest(i,this.pos);if(H(this.dir,this.pos,r),n.pos.equals(r))return L.BumpedPlayer;if(r.equals(this.pos))return L.StoodStill;const o=s.create();s.subtract(o,this.pos,r);const a=s.create();return this.animation=new k([{pt0:o,pt1:a,duration:.2,fn:T.linear}],[]),s.copy(this.pos,r),L.Moved}tryGetPosLookAt(e){const t=this.pos[0],n=this.pos[1];return t>0&&e.cells.at(t-1,n).type==$.OneWayWindowW?s.fromValues(t-1,n):t<e.cells.sizeX-1&&e.cells.at(t+1,n).type==$.OneWayWindowE?s.fromValues(t+1,n):n>0&&e.cells.at(t,n-1).type==$.OneWayWindowS?s.fromValues(t,n-1):n<e.cells.sizeY-1&&e.cells.at(t,n+1).type==$.OneWayWindowN?s.fromValues(t,n+1):void 0}}function O(e){return e===P.Patrol||e===P.MoveToTorch||e===P.LightTorch}function F(e,t){const n=t.items.find((e=>[Z.PortcullisEW,Z.PortcullisNS].includes(e.type)));return void 0!==n&&e.pos.equals(n.pos)}function U(e,t,n,i){for(const e of t.guards)e.heardGuard=e.hearingGuard,e.hearingGuard=!1,e.speaking=!1,e.hasMoved=!1;t.guards.sort(((e,t)=>{const n=e.moving(),r=t.moving();if(n&&!r)return 1;if(r&&!n)return-1;return Math.abs(e.pos[0]-i.pos[0])+Math.abs(e.pos[1]-i.pos[1])-(Math.abs(t.pos[0]-i.pos[0])+Math.abs(t.pos[1]-i.pos[1]))}));const r=[];let o=!1;for(const e of t.guards){const a=s.clone(e.pos);e.act(t,n,i,r),e.hasMoved=!0,o=o||F(e,t)&&!a.equals(e.pos)}for(const e of r)V(t,e);null===i.pickTarget||O(i.pickTarget.mode)&&i.pickTarget.cardinallyAdjacentTo(i.pos)||(i.pickTarget=null),o&&e.sounds.gate.play(.2)}function V(e,t){for(const n of e.guardsInEarshot(t.pos_shouter,25))n.pos[0]==t.pos_shouter[0]&&n.pos[1]==t.pos_shouter[1]||(n.hearingGuard=!0,t.target instanceof N&&(n.angry=!0),s.copy(n.heardGuardPos,t.pos_shouter))}function H(e,t,n){const i=s.create();s.subtract(i,n,t);const r=s.fromValues(-e[1],e[0]),o=s.dot(e,i),a=s.dot(r,i);o>=Math.abs(a)||(-o>Math.abs(a)?s.negate(e,e):a>=0?s.copy(e,r):s.negate(e,r))}function B(e,t,n){let i=t[0],r=t[1];const o=n[0]-i,s=n[1]-r;let a=Math.abs(o),l=Math.abs(s);const u=o>0?1:-1,c=s>0?1:-1;let h=l-a,d=a+l-1;for(a*=2,l*=2;d>0;){if(h>0)r+=c,h-=a;else{if(0===h&&e.cells.at(i,r+c).blocksSight)return!1;i+=u,h+=l}if(e.cells.at(i,r).blocksSight)return!1;--d}return!0}function j(e){return!!e.blocksSight||!!le(e.type)}function G(e,t,n){let i=t[0],r=t[1];const o=n[0]-i,s=n[1]-r;let a=Math.abs(o),l=Math.abs(s);const u=o>0?1:-1,c=s>0?1:-1;let h=l-a,d=a+l-1;for(a*=2,l*=2;d>0;){if(h>0)r+=c,h-=a;else{if(0===h&&j(e.cells.at(i,r+c)))return!1;i+=u,h+=l}const t=e.cells.at(i,r);if(t.blocksSight)return!1;if(le(t.type))return!1;--d}return!0}const W=[s.fromValues(-1,0),s.fromValues(1,0),s.fromValues(0,-1),s.fromValues(0,1)];class z{constructor(e,t,n){this.sizeX=e,this.sizeY=t,this.values=new Uint8Array(e*t),this.fill(n)}fill(e){this.values.fill(e?1:0)}get(e,t){return 0!==this.values[this.sizeX*t+e]}set(e,t,n){this.values[this.sizeX*t+e]=n?1:0}}class q{constructor(e,t,n){this.sizeX=e,this.sizeY=t,this.values=new Int32Array(e*t),this.fill(n)}fill(e){this.values.fill(e)}get(e,t){return this.values[this.sizeX*t+e]}set(e,t,n){this.values[this.sizeX*t+e]=n}}class K{constructor(e,t,n){this.sizeX=e,this.sizeY=t,this.values=new Float64Array(e*t),this.fill(n)}fill(e){this.values.fill(e)}get(e,t){return this.values[this.sizeX*t+e]}set(e,t,n){this.values[this.sizeX*t+e]=n}}let $;var Y;(Y=$||($={}))[Y.GroundNormal=0]="GroundNormal",Y[Y.GroundGrass=1]="GroundGrass",Y[Y.GroundWater=2]="GroundWater",Y[Y.GroundMarble=3]="GroundMarble",Y[Y.GroundWood=4]="GroundWood",Y[Y.GroundWoodCreaky=5]="GroundWoodCreaky",Y[Y.GroundVault=6]="GroundVault",Y[Y.Wall0000=7]="Wall0000",Y[Y.Wall0001=8]="Wall0001",Y[Y.Wall0010=9]="Wall0010",Y[Y.Wall0011=10]="Wall0011",Y[Y.Wall0100=11]="Wall0100",Y[Y.Wall0101=12]="Wall0101",Y[Y.Wall0110=13]="Wall0110",Y[Y.Wall0111=14]="Wall0111",Y[Y.Wall1000=15]="Wall1000",Y[Y.Wall1001=16]="Wall1001",Y[Y.Wall1010=17]="Wall1010",Y[Y.Wall1011=18]="Wall1011",Y[Y.Wall1100=19]="Wall1100",Y[Y.Wall1101=20]="Wall1101",Y[Y.Wall1110=21]="Wall1110",Y[Y.Wall1111=22]="Wall1111",Y[Y.OneWayWindowE=23]="OneWayWindowE",Y[Y.OneWayWindowW=24]="OneWayWindowW",Y[Y.OneWayWindowN=25]="OneWayWindowN",Y[Y.OneWayWindowS=26]="OneWayWindowS",Y[Y.PortcullisNS=27]="PortcullisNS",Y[Y.PortcullisEW=28]="PortcullisEW",Y[Y.DoorNS=29]="DoorNS",Y[Y.DoorEW=30]="DoorEW",Y[Y.GardenDoorNS=31]="GardenDoorNS",Y[Y.GardenDoorEW=32]="GardenDoorEW";class X{constructor(e,t){this.sizeX=e,this.sizeY=t;const n=e*t;this.values=new Array(n);for(let e=0;e<n;++e)this.values[e]=this.emptyCell()}at(e,t){if(e<0||e>=this.sizeX||t<0||t>=this.sizeY)return this.emptyCell();const n=this.sizeX*t+e;return this.values[n]}atVec(e){return this.at(e[0],e[1])}index(e,t){return this.sizeX*t+e}indexVec(e){return this.index(e[0],e[1])}emptyCell(){return{type:$.GroundNormal,moveCost:1/0,blocksPlayerMove:!1,blocksPlayerSight:!1,blocksSight:!1,blocksSound:!1,hidesPlayer:!1,lit:0,litSrc:new Set,seen:!1,identified:!1}}}let Q;var J;let Z;var ee;function te(e){switch(e){case Z.Chair:return 4;case Z.Table:case Z.Bush:return 10;case Z.Coin:case Z.DoorNS:case Z.DoorEW:case Z.LockedDoorNS:case Z.LockedDoorEW:case Z.PortcullisNS:case Z.PortcullisEW:return 0;case Z.TorchUnlit:case Z.TorchLit:return 1/0;case Z.TorchCarry:case Z.PurseCarry:case Z.Key:case Z.KeyCarry:return 0}}(J=Q||(Q={}))[J.Relaxed=0]="Relaxed",J[J.Angry=1]="Angry",J[J.Alerted=2]="Alerted",J[J.Chasing=3]="Chasing",J[J.Unconscious=4]="Unconscious",(ee=Z||(Z={}))[ee.Chair=0]="Chair",ee[ee.Table=1]="Table",ee[ee.Bush=2]="Bush",ee[ee.Coin=3]="Coin",ee[ee.DoorNS=4]="DoorNS",ee[ee.DoorEW=5]="DoorEW",ee[ee.LockedDoorNS=6]="LockedDoorNS",ee[ee.LockedDoorEW=7]="LockedDoorEW",ee[ee.PortcullisNS=8]="PortcullisNS",ee[ee.PortcullisEW=9]="PortcullisEW",ee[ee.TorchUnlit=10]="TorchUnlit",ee[ee.TorchLit=11]="TorchLit",ee[ee.TorchCarry=12]="TorchCarry",ee[ee.PurseCarry=13]="PurseCarry",ee[ee.Key=14]="Key",ee[ee.KeyCarry=15]="KeyCarry";const ne=5;class ie{animation=null;pickTarget=null;constructor(e){this.pos=s.clone(e),this.dir=s.fromValues(0,-1),this.health=ne,this.loot=0,this.noisy=!1,this.hasVaultKey=!1,this.damagedLastTurn=!1,this.turnsRemainingUnderwater=0}applyDamage(e){this.health-=Math.min(e,this.health),this.damagedLastTurn=!0}hidden(e){if(void 0!==e.guards.find((e=>e.mode==P.ChaseVisibleTarget)))return!1;if(e.cells.atVec(this.pos).hidesPlayer)return!0;return e.cells.atVec(this.pos).type==$.GroundWater&&this.turnsRemainingUnderwater>0}}const re=[{lx:-1,ly:-1,rx:-1,ry:1,nx:-1,ny:0},{lx:-1,ly:1,rx:1,ry:1,nx:0,ny:1},{lx:1,ly:1,rx:1,ry:-1,nx:1,ny:0},{lx:1,ly:-1,rx:-1,ry:-1,nx:0,ny:-1}];function oe(e,t,n,i){return e*i>t*n}const se=[{dx:1,dy:0,cost:2},{dx:-1,dy:0,cost:2},{dx:0,dy:1,cost:2},{dx:0,dy:-1,cost:2},{dx:-1,dy:-1,cost:3},{dx:1,dy:-1,cost:3},{dx:-1,dy:1,cost:3},{dx:1,dy:1,cost:3}];class ae{constructor(e){this.cells=e,this.patrolRegions=[],this.patrolRoutes=[],this.items=[],this.guards=[],this.playerStartPos=s.create(),this.lightCount=0}collectLootAt(e){let t=[];return this.items=this.items.filter((n=>n.type!=Z.Coin||!n.pos.equals(e)||(t.push(n),!1))),t}collectAllLoot(){let e=0;return this.items=this.items.filter((t=>t.type!=Z.Coin||(++e,!1))),e}identifyAdjacentCells(e){const t=Math.max(e[0]-1,0),n=Math.max(e[1]-1,0),i=Math.min(e[0]+2,this.cells.sizeX),r=Math.min(e[1]+2,this.cells.sizeY);for(let e=t;e<i;++e)for(let t=n;t<r;++t)this.cells.at(e,t).identified=!0}allSeen(){for(const e of this.cells.values)if(!e.seen)return!1;return!0}percentSeen(){let e=0;for(const t of this.cells.values)t.seen&&++e;return Math.floor(100*e/this.cells.values.length)}markAllSeen(){for(const e of this.cells.values)e.seen=!0,e.identified=!0}markAllUnseen(){for(const e of this.cells.values)e.seen=!1,e.identified=!1}recomputeVisibility(e){this.recomputeVisibilityFromPos(e);const t=s.create();for(const n of W)this.playerCanSeeInDirection(e,n)&&(s.add(t,e,n),this.recomputeVisibilityFromPos(t))}recomputeVisibilityFromPos(e){for(const t of re)this.computeVisibility(e[0],e[1],e[0],e[1],t.lx,t.ly,t.rx,t.ry)}playerCanSeeInDirection(e,t){const n=s.create();return s.add(n,e,t),n[0]<0||n[1]<0||n[0]>=this.cells.sizeX||n[1]>=this.cells.sizeY||!this.cells.at(n[0],n[1]).blocksPlayerSight}computeVisibility(e,t,n,i,r,o,s,a){if(n<0||i<0||n>=this.cells.sizeX||i>=this.cells.sizeY)return;const l=2*(n-e),u=2*(i-t);if(!(l*l+u*u>1600||(this.cells.at(n,i).seen=!0,this.cells.at(n,i).blocksPlayerSight))){for(let e=0;e<2;++e)for(let t=0;t<2;++t){let c=n+2*e-1,h=i+2*t-1,d=l+2*e-1,f=u+2*t-1;c>=0&&h>=0&&c<this.cells.sizeX&&h<this.cells.sizeY&&!oe(r,o,d,f)&&!oe(d,f,s,a)&&(this.cells.at(c,h).seen=!0)}for(const c of re){const h=l+c.lx,d=u+c.ly,f=l+c.rx,p=u+c.ry,[m,g]=oe(r,o,h,d)?[r,o]:[h,d],[v,y]=oe(s,a,f,p)?[f,p]:[s,a];oe(v,y,m,g)&&this.computeVisibility(e,t,n+c.nx,i+c.ny,m,g,v,y)}}}computeLighting(e=null){const t=new Set;null!==e&&t.add(e);for(let e of this.guards)t.add(this.cells.at(e.pos[0],e.pos[1]));for(const e of this.cells.values)e.lit=0,e.litSrc.clear();let n=0;for(const e of this.items)e.type==Z.TorchLit&&(this.castLight(e.pos,45,n,t),n++),e.type==Z.TorchUnlit&&n++;for(const e of this.guards)e.hasTorch&&(this.castLight(e.pos,15,n,t),n++);this.lightCount=n}castLight(e,t,n,i){this.cells.at(e[0],e[1]).lit=1;for(const r of re)this.castLightRecursive(e[0],e[1],e[0]+r.nx,e[1]+r.ny,r.lx,r.ly,r.rx,r.ry,t,n,i)}castLightRecursive(e,t,n,i,r,o,s,a,l,u,c){if(n<0||i<0||n>=this.cells.sizeX||i>=this.cells.sizeY)return;let h=n-e,d=i-t;if(h**2+d**2>l)return;h*=2,d*=2;const f=this.cells.at(n,i);if(!f.blocksSight||c.has(f)){if(!f.litSrc.has(u)){const r=(n-e)**2+(i-t)**2;f.lit+=1/(r+1),f.lit>1&&(f.lit=1),f.litSrc.add(u)}for(let l=0;l<2;++l)for(let c=0;c<2;++c){let f=n+2*l-1,p=i+2*c-1,m=h+2*l-1,g=d+2*c-1;if(f>=0&&p>=0&&f<this.cells.sizeX&&p<this.cells.sizeY&&!oe(r,o,m,g)&&!oe(m,g,s,a)){const n=this.cells.at(f,p);if(!n.blocksSight&&!n.litSrc.has(u)){const i=(f-e)**2+(p-t)**2;n.lit+=1/(i+1),n.lit>1&&(n.lit=1),n.litSrc.add(u)}}}for(const f of re){const p=h+f.lx,m=d+f.ly,g=h+f.rx,v=d+f.ry,[y,b]=oe(r,o,p,m)?[r,o]:[p,m],[w,_]=oe(s,a,g,v)?[g,v]:[s,a];oe(w,_,y,b)&&this.castLightRecursive(e,t,n+f.nx,i+f.ny,y,b,w,_,l,u,c)}}}allLootCollected(){return void 0===this.items.find((e=>e.type==Z.Coin))}isGuardAt(e,t){return null!=this.guards.find((n=>n.hasMoved&&n.pos.equalsValues(e,t)))}isGuardAtVec(e){return null!=this.guards.find((t=>t.hasMoved&&t.pos.equals(e)))}guardMoveCost(e,t){const n=this.cells.atVec(t).moveCost;return n===1/0||e[0]==t[0]||e[1]==t[1]||this.cells.at(e[0],t[1]).moveCost!==1/0&&this.cells.at(t[0],e[1]).moveCost!==1/0?n:1/0}posNextBest(e,t){let n=1/0,i=s.clone(t);const r=s.fromValues(Math.max(0,t[0]-1),Math.max(0,t[1]-1)),o=s.fromValues(Math.min(this.cells.sizeX,t[0]+2),Math.min(this.cells.sizeY,t[1]+2));for(let a=r[0];a<o[0];++a)for(let l=r[1];l<o[1];++l){const r=e.get(a,l);if(r==1/0)continue;let o=s.fromValues(a,l);this.guardMoveCost(t,o)!=1/0&&(this.isGuardAtVec(o)||r<n&&(n=r,i=o))}return i}patrolPathIndexForResume(e,t,n){const i=this.computeDistancesToPosition(n);let r=t;for(let t=0;t<e.length;++t){const t=e[r],n=this.posNextBest(i,t),o=e[(r+e.length-1)%e.length],a=s.create();s.subtract(a,t,n);const l=s.create();if(s.subtract(l,t,o),s.dot(a,l)>0)break;r=(r+1)%e.length}return r}computeDistancesToPosition(e){return console.assert(e[0]>=0),console.assert(e[1]>=0),console.assert(e[0]<this.cells.sizeX),console.assert(e[1]<this.cells.sizeY),this.computeDistanceField([{priority:0,pos:s.clone(e)}])}computeDistancesToAdjacentToPosition(e){const t=[];for(const n of W){const i=s.clone(e).add(n);if(i[0]<0||i[1]<0||i[0]>=this.cells.sizeX||i[1]>=this.cells.sizeY)continue;const r=this.cells.atVec(i);r.moveCost!==1/0&&t.push({priority:r.moveCost,pos:i})}return this.computeDistanceField(t)}computeDistanceField(e){let t=this.cells.sizeX,n=this.cells.sizeY;const i=[],r=new K(t,n,1/0);for(const t of e)he(i,t);for(;i.length>0;){const e=ce(i);if(!(e.priority>=r.get(e.pos[0],e.pos[1]))){r.set(e.pos[0],e.pos[1],e.priority);for(const o of se){const a=s.fromValues(e.pos[0]+o.dx,e.pos[1]+o.dy);if(a[0]<0||a[1]<0||a[0]>=t||a[1]>=n)continue;const l=this.guardMoveCost(e.pos,a);if(l==1/0)continue;const u=e.priority+l+o.cost;u<r.get(a[0],a[1])&&he(i,{priority:u,pos:a})}}}return r}guardsInEarshot(e,t){const n=this.coordsInEarshot(e,t);return this.guards.filter((e=>n.has(this.cells.sizeX*e.pos[1]+e.pos[0])))}coordsInEarshot(e,t){let n=this.cells.sizeX,i=this.cells.sizeY;const r=[],o=new K(n,i,1/0),a=new Set;for(he(r,{priority:0,pos:e});r.length>0;){const e=ce(r);if(!(e.priority>=o.get(e.pos[0],e.pos[1]))){o.set(e.pos[0],e.pos[1],e.priority),a.add(n*e.pos[1]+e.pos[0]);for(const a of se){const l=s.fromValues(e.pos[0]+a.dx,e.pos[1]+a.dy);if(l[0]<0||l[1]<0||l[0]>=n||l[1]>=i)continue;const u=e.priority+a.cost;u>t||(this.cells.at(l[0],l[1]).blocksSound||u>=o.get(l[0],l[1])||he(r,{priority:u,pos:l}))}}}return a}}function le(e){return e>=$.OneWayWindowE&&e<=$.OneWayWindowS}function ue(e){return e>=Z.DoorNS&&e<=Z.PortcullisEW}function ce(e){const t=e[0];e[0]=e[e.length-1],e.pop();let n=0;const i=e.length;for(;;){let t=n;const r=2*n+1;r<i&&e[r].priority<e[t].priority&&(t=r);const o=r+1;if(o<i&&e[o].priority<e[t].priority&&(t=o),t==n)break;[e[n],e[t]]=[e[t],e[n]],n=t}return t}function he(e,t){e.push(t);let n=e.length-1;for(;n>0;){const t=Math.floor((n-1)/2);if(e[n].priority>=e[t].priority)break;[e[n],e[t]]=[e[t],e[n]],n=t}}const de=5,fe=5,pe=3,me=[[3,3,2,2,6,6],[3,5,2,5,6,12],[3,5,2,6,9,15],[3,5,2,6,12,18],[3,7,3,6,15,21],[3,7,3,6,18,24],[3,7,3,6,21,30],[5,7,4,6,24,36],[5,9,4,6,30,42],[7,9,4,6,36,48]];let ge;var ve;function ye(e,t,n){const i=[];for(let t=0;t<e;++t){const e=be(t,n);i.push({numRoomsX:e[0],numRoomsY:e[1],totalLoot:0})}let r=0;for(const e of i){r+=e.numRoomsX*e.numRoomsY}let o=0;for(const e of i){const n=e.numRoomsX*e.numRoomsY,i=Math.floor(t*n/r);o+=i,e.totalLoot=i}return i[i.length-1].totalLoot+=t-o,i}function be(e,t){let n,i,r,o,s,a;[n,i,r,o,s,a]=me[e];const l=n+2*t.randomInRange(1+(i-n)/2);let u=r+t.randomInRange(1+o-r);return u=Math.min(Math.floor(a/l),u),u=Math.max(u,Math.ceil(s/l)),[l,u]}function we(e,t,n){const i=function(e,t,n){const i=new z(e,t,!0),r=Math.floor((e+1)/2);for(let e=Math.floor(t*r/4);e>0;--e){const e=n.randomInRange(r),o=n.randomInRange(t);i.set(e,o,!1)}for(let n=0;n<t;++n)for(let t=r;t<e;++t)i.set(t,n,i.get(e-1-t,n));return i}(t.numRoomsX,t.numRoomsY,n),[r,o]=function(e,t,n,i){const r=n.sizeX,o=n.sizeY,s=new q(r+1,o,0),a=new q(r,o+1,0);let l=i.randomInRange(3)-1;for(let e=0;e<o;++e)s.set(0,e,l);l=i.randomInRange(3)-1;for(let e=0;e<o;++e)s.set(r,e,l);l=i.randomInRange(3)-1;for(let e=0;e<r;++e)a.set(e,0,l);l=i.randomInRange(3)-1;for(let e=0;e<r;++e)a.set(e,o,l);for(let e=1;e<r;++e)for(let t=0;t<o;++t)s.set(e,t,i.randomInRange(3)-1);for(let e=0;e<r;++e)for(let t=1;t<o;++t)a.set(e,t,i.randomInRange(3)-1);for(let e=1;e<r;++e)for(let t=1;t<o;++t)0===i.randomInRange(2)?s.set(e,t,s.get(e,t-1)):a.set(e,t,a.get(e-1,t));if(e){if(0==(1&r)){const e=Math.floor(r/2);for(let t=0;t<o;++t)s.set(e,t,0)}for(let e=0;e<Math.floor((r+1)/2);++e)for(let t=0;t<o;++t)s.set(r-e,t,1-s.get(e,t));for(let e=0;e<Math.floor(r/2);++e)for(let t=0;t<o+1;++t)a.set(r-1-e,t,a.get(e,t))}if(t){if(0==(1&o)){const e=o/2;for(let t=0;t<r;++t)a.set(t,e,0)}for(let e=0;e<Math.floor((o+1)/2);++e)for(let t=0;t<r;++t)a.set(t,o-e,1-a.get(t,e));for(let e=0;e<Math.floor(o/2);++e)for(let t=0;t<r+1;++t)s.set(t,o-1-e,s.get(t,e))}let u=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;for(let e=0;e<o;++e)u=Math.max(u,-s.get(0,e));for(let e=0;e<r;++e)c=Math.max(c,-a.get(e,0));u+=pe,c+=pe;for(let e=0;e<r+1;++e)for(let t=0;t<o;++t){const n=s.get(e,t)+u+e*de;s.set(e,t,n)}for(let e=0;e<r;++e)for(let t=0;t<o+1;++t)a.set(e,t,a.get(e,t)+c+t*fe);return[s,a]}(true,false,i,n),[a,l]=function(e,t,n){const i=e.sizeX,r=e.sizeY,o=new q(i,r,0),a=[];a.push({roomType:ge.Exterior,group:0,depth:0,posMin:s.fromValues(0,0),posMax:s.fromValues(0,0),edges:[]});for(let l=0;l<i;++l)for(let i=0;i<r;++i){let r=a.length;o.set(l,i,r),a.push({roomType:e.get(l,i)?ge.PublicRoom:ge.PublicCourtyard,group:r,depth:0,posMin:s.fromValues(t.get(l,i)+1,n.get(l,i)+1),posMax:s.fromValues(t.get(l+1,i),n.get(l,i+1)),edges:[]})}return[a,o]}(i,r,o),u=function(e,t,n,i,r){let o=r.sizeX,a=r.sizeY;const l=[];{const u=[];{const e=[];let t=0;for(let a=0;a<o;++a){let o=n.get(a,t),u=n.get(a+1,t),c=i.get(a,t),h=l.length;e.push(h),l.push({origin:s.fromValues(o+1,c),dir:s.fromValues(1,0),length:u-(o+1),room_left:r.get(a,t),room_right:0,next_matching:h,door:!1,doorOffset:0})}u.push(e)}for(let e=1;e<a;++e){const t=[];for(let a=0;a<o;++a){let u=n.get(a,e),c=n.get(a,e-1),h=n.get(a+1,e),d=n.get(a+1,e-1),f=Math.max(c,u),p=Math.min(d,h),m=i.get(a,e);if(a>0&&c-u>1){let n=l.length;t.push(n),l.push({origin:s.fromValues(u+1,m),dir:s.fromValues(1,0),length:c-(u+1),room_left:r.get(a,e),room_right:r.get(a-1,e-1),next_matching:n,door:!1,doorOffset:0})}if(p-f>1){let n=l.length;t.push(n),l.push({origin:s.fromValues(f+1,m),dir:s.fromValues(1,0),length:p-(f+1),room_left:r.get(a,e),room_right:r.get(a,e-1),next_matching:n,door:!1,doorOffset:0})}if(a+1<o&&h-d>1){let n=l.length;t.push(n),l.push({origin:s.fromValues(d+1,m),dir:s.fromValues(1,0),length:h-(d+1),room_left:r.get(a,e),room_right:r.get(a+1,e-1),next_matching:n,door:!1,doorOffset:0})}}u.push(t)}{const e=[];let t=a;for(let a=0;a<o;++a){let o=n.get(a,t-1),u=n.get(a+1,t-1),c=i.get(a,t),h=l.length;e.push(h),l.push({origin:s.fromValues(o+1,c),dir:s.fromValues(1,0),length:u-(o+1),room_left:0,room_right:r.get(a,t-1),next_matching:h,door:!1,doorOffset:0})}u.push(e)}if(e)for(let e=0;e<u.length;++e){let t=u[e],n=0,i=t.length-1;for(;n<i;){let e=t[n],r=t[i];l[e].next_matching=r,l[r].next_matching=e;{let e=l[r];s.scaleAndAdd(e.origin,e.origin,e.dir,e.length-1),s.negate(e.dir,e.dir),[e.room_left,e.room_right]=[e.room_right,e.room_left]}n+=1,i-=1}}if(t){let e=0,t=u.length-1;for(;e<t;){let n=u[e],i=u[t];console.assert(n.length==i.length);for(let e=0;e<n.length;++e){let t=n[e],r=i[e];l[t].next_matching=r,l[r].next_matching=t}e+=1,t-=1}}}{let u=[];{const e=[];let t=0;for(let o=0;o<a;++o){let a=i.get(t,o),u=i.get(t,o+1),c=n.get(t,o),h=l.length;e.push(h),l.push({origin:s.fromValues(c,a+1),dir:s.fromValues(0,1),length:u-(a+1),room_left:0,room_right:r.get(t,o),next_matching:h,door:!1,doorOffset:0})}u.push(e)}for(let e=1;e<o;++e){const t=[];for(let o=0;o<a;++o){let u=i.get(e-1,o),c=i.get(e,o),h=i.get(e-1,o+1),d=i.get(e,o+1),f=Math.max(u,c),p=Math.min(h,d),m=n.get(e,o);if(o>0&&u-c>1){let n=l.length;t.push(n),l.push({origin:s.fromValues(m,c+1),dir:s.fromValues(0,1),length:u-(c+1),room_left:r.get(e-1,o-1),room_right:r.get(e,o),next_matching:n,door:!1,doorOffset:0})}if(p-f>1){let n=l.length;t.push(n),l.push({origin:s.fromValues(m,f+1),dir:s.fromValues(0,1),length:p-(f+1),room_left:r.get(e-1,o),room_right:r.get(e,o),next_matching:n,door:!1,doorOffset:0})}if(o+1<a&&d-h>1){let n=l.length;t.push(n),l.push({origin:s.fromValues(m,h+1),dir:s.fromValues(0,1),length:d-(h+1),room_left:r.get(e-1,o+1),room_right:r.get(e,o),next_matching:n,door:!1,doorOffset:0})}}u.push(t)}{const e=[];let t=o;for(let o=0;o<a;++o){let a=i.get(t-1,o),u=i.get(t-1,o+1),c=n.get(t,o),h=l.length;l.push({origin:s.fromValues(c,a+1),dir:s.fromValues(0,1),length:u-(a+1),room_left:r.get(t-1,o),room_right:0,next_matching:h,door:!1,doorOffset:0}),e.push(h)}u.push(e)}if(t)for(let e=0;e<u.length;++e){let t=u[e],n=Math.floor(t.length/2);for(let e=0;e<n;++e){let n=t[e],i=t[t.length-1-e];l[n].next_matching=i,l[i].next_matching=n;{let e=l[i];s.scaleAndAdd(e.origin,e.origin,e.dir,e.length-1),s.negate(e.dir,e.dir),[e.room_left,e.room_right]=[e.room_right,e.room_left]}}}if(e){let e=0,t=u.length-1;for(;e<t;){let n=u[e],i=u[t];for(let e=0;e<n.length;++e){let t=n[e],r=i[e];l[t].next_matching=r,l[r].next_matching=t}e+=1,t-=1}}}return l}(true,false,r,o,l);!function(e,t){for(let n=0;n<e.length;++n){const i=e[n];let r=i.room_left,o=i.room_right;t[r].edges.push(n),t[o].edges.push(n)}}(u,a);const c=function(e,t,n){let i=function(e,t){const n=[];for(let t=0;t<e.length;++t){let i=e[t].next_matching;i>=t&&(i>t?n.push([t,i]):n.push([t]))}return t.shuffleArray(n),n}(t,n);for(const n of t){let t=n.room_left,i=n.room_right;e[t].roomType==ge.PublicCourtyard&&e[i].roomType==ge.PublicCourtyard&&(n.door=!0,Te(e,e[t].group,e[i].group))}for(const r of i){let i=!1;{let o=t[r[0]],s=o.room_left,a=o.room_right;if(e[s].roomType!=ge.PublicRoom||e[a].roomType!=ge.PublicRoom)continue;let l=e[s].group,u=e[a].group;(l!=u||n.random()<.4)&&(o.door=!0,i=!0,Te(e,l,u))}if(i)for(let n=1;n<r.length;++n){let i=t[r[n]],o=i.room_left,s=i.room_right,a=e[o].group,l=e[s].group;i.door=!0,Te(e,a,l)}}for(const r of i){let i=!1;{let o=t[r[0]],s=o.room_left,a=o.room_right,l=e[s].roomType,u=e[a].roomType;if(l==u)continue;if(l==ge.Exterior||u==ge.Exterior)continue;let c=e[s].group,h=e[a].group;(c!=h||n.random()<.4)&&(o.door=!0,i=!0,Te(e,c,h))}if(i)for(let n=1;n<r.length;++n){let i=t[r[n]],o=i.room_left,s=i.room_right,a=e[o].group,l=e[s].group;i.door=!0,Te(e,a,l)}}let r=s.fromValues(0,0);{let n=function(e,t,n){for(const i of n)for(const n of i){let i=t[n];if(0!=i.dir[0]&&!(i.next_matching>n)){if(i.next_matching==n){if(e[i.room_right].roomType!=ge.Exterior)continue}else if(e[i.room_left].roomType!=ge.Exterior)continue;return n}}return 0}(e,t,i);r[0]=t[n].origin[0]+t[n].dir[0]*Math.floor(t[n].length/2),r[1]=pe-1,t[n].door=!0;let o=t[n].next_matching;o!=n&&(t[o].next_matching=o,t[n].next_matching=n)}return r}(a,u,n);!function(e,t,n,i,r){let o=n.length;n[0].depth=0;for(let e=1;e<n.length;++e)n[e].depth=o;const s=[];for(let t=0;t<e.sizeX;++t){let i=e.get(t,0);n[i].depth=1,s.push(i)}let a=0;for(;a<s.length;){let e=s[a];for(const i of n[e].edges){let r=t[i];if(!r.door)continue;const a=r.room_left==e?r.room_right:r.room_left;n[a].depth==o&&(n[a].depth=n[e].depth+1,s.push(a))}a+=1}let l=0;for(const e of n)l=Math.max(l,e.depth);const u=Math.floor(e.sizeX*e.sizeY/4);let c=0,h=l;for(;h>0;){for(const e of n)e.roomType!=ge.PublicRoom&&e.roomType!=ge.PublicCourtyard||e.depth==h&&(e.roomType=e.roomType==ge.PublicRoom?ge.PrivateRoom:ge.PrivateCourtyard,e.roomType==ge.PrivateRoom&&(c+=1));if(c>=u)break;h-=1}for(;;){let e=!1;for(let i=0;i<n.length;++i)if(n[i].roomType==ge.PublicCourtyard)for(const r of n[i].edges){const o=t[r];if(n[o.room_left!=i?o.room_left:o.room_right].roomType==ge.PrivateCourtyard){n[i].roomType=ge.PrivateCourtyard,e=!0;break}}if(!e)break}if(i>4){const e=[];for(const i of n){if(i.roomType===ge.Exterior)continue;if(i.roomType===ge.PrivateCourtyard||i.roomType===ge.PublicCourtyard)continue;let n=0;for(const e of i.edges){t[e].door&&++n}n<=1&&e.push(i)}e.length>0&&(e[r.randomInRange(e.length)].roomType=ge.Vault)}}(l,u,a,e,n);const h=function(e,t){const n=e.sizeX-1,i=t.sizeY-1;let r=0,o=0;for(let t=0;t<i;++t)r=Math.max(r,e.get(n,t));for(let e=0;e<n;++e)o=Math.max(o,t.get(e,i));r+=pe+1,o+=pe+1;const s=new X(r,o);return new ae(s)}(r,o);!function(e,t,n,i){const r=n.sizeX-1,o=i.sizeY-1;for(let t=0;t<r;++t)for(let r=0;r<o;++r){const o=n.get(t,r),s=n.get(t+1,r)+1,a=i.get(t,r),l=i.get(t,r+1)+1;for(let t=o;t<s;++t)for(let n=a;n<l;++n)e.at(t,n).type=$.GroundGrass}for(let s=0;s<r;++s)for(let a=0;a<o;++a){const l=t.get(s,a),u=n.get(s,a),c=n.get(s+1,a),h=i.get(s,a),d=i.get(s,a+1);(0==s||l)&&_e(e,u,h,d),(s==r-1||l)&&_e(e,c,h,d),(0==a||l)&&Se(e,u,h,c),(a==o-1||l)&&Se(e,u,d,c)}}(h.cells,i,r,o),function(e,t,n,i){for(const i of t){const t=e[i.room_left].roomType,r=e[i.room_right].roomType;if(ze(t)&&ze(r))for(let e=0;e<i.length;++e){const t=s.clone(i.origin).scaleAndAdd(i.dir,e);n.cells.atVec(t).type=$.GroundGrass}}for(let r=0;r<t.length;++r){const o=t[r],a=e[o.room_left].roomType,l=e[o.room_right].roomType,u=o.next_matching;if(u<r)continue;let c;c=u==r?Math.floor(o.length/2):o.length>2?1+i.randomInRange(o.length-2):i.randomInRange(o.length);let h=[];if(h.push(o),u!=r&&h.push(t[u]),!o.door&&a!==l)if(a==ge.Exterior||l==ge.Exterior){if(0!=(1&o.length)){let t=Math.floor(o.length/2);for(const i of h){if(e[i.room_left].roomType===ge.Vault||e[i.room_right].roomType===ge.Vault)continue;const r=s.clone(i.origin).scaleAndAdd(i.dir,t);let o=s.clone(i.dir);e[i.room_right].roomType==ge.Exterior&&s.negate(o,o),n.cells.atVec(r).type=Ue(o)}}}else if(ze(a)||ze(l)){let t=i.randomInRange(2);const r=Math.floor((o.length+1)/2);for(;t<r;){for(const i of h){if(e[i.room_left].roomType===ge.Vault||e[i.room_right].roomType===ge.Vault)continue;let r=s.clone(i.dir);ze(e[i.room_right].roomType)&&(r=r.negate());let o=Ue(r);const a=s.clone(i.origin).scaleAndAdd(i.dir,t),l=s.clone(i.origin).scaleAndAdd(i.dir,i.length-(t+1));n.cells.atVec(a).type=o,n.cells.atVec(l).type=o}t+=2}}let d=i.random()<.3333;for(const t of h){if(!t.door)continue;t.doorOffset=c;const i=s.clone(t.origin).scaleAndAdd(t.dir,c);let r=0==t.dir[0],o=e[t.room_left].roomType,a=e[t.room_right].roomType;o==ge.Exterior||a==ge.Exterior?(n.cells.atVec(i).type=r?$.PortcullisNS:$.PortcullisEW,je(n,i,r?Z.PortcullisNS:Z.PortcullisEW)):o===ge.Vault||a===ge.Vault?(n.cells.atVec(i).type=r?$.DoorNS:$.DoorEW,je(n,i,r?Z.LockedDoorNS:Z.LockedDoorEW)):ze(o)&&ze(a)?n.cells.atVec(i).type=r?$.GardenDoorNS:$.GardenDoorEW:o!=ge.PrivateRoom||a!=ge.PrivateRoom||d?(n.cells.atVec(i).type=r?$.DoorNS:$.DoorEW,je(n,i,r?Z.DoorNS:Z.DoorEW)):n.cells.atVec(i).type=r?$.DoorNS:$.DoorEW}}}(a,u,h,n),function(e,t,n,i){for(let r=1;r<t.length;++r){const o=t[r];let a;switch(o.roomType){case ge.Exterior:a=$.GroundNormal;break;case ge.PublicCourtyard:a=$.GroundGrass;break;case ge.PublicRoom:a=$.GroundWood;break;case ge.PrivateCourtyard:a=$.GroundGrass;break;case ge.PrivateRoom:a=$.GroundMarble;break;case ge.Vault:a=$.GroundVault}for(let e=o.posMin[0];e<o.posMax[0];++e)for(let t=o.posMin[1];t<o.posMax[1];++t)n.cells.at(e,t).type=a;let l=o.posMax[0]-o.posMin[0],u=o.posMax[1]-o.posMin[1];if(ze(o.roomType)){if(l>=5&&u>=5)for(let e=o.posMin[0]+1;e<o.posMax[0]-1;++e)for(let t=o.posMin[1]+1;t<o.posMax[1]-1;++t)n.cells.at(e,t).type=$.GroundWater;else if(l>=2&&u>=2){const t=[Z.Bush,Z.Bush,Z.Bush,Z.Bush];l>2&&u>2&&t.push(Ve(e,i)),i.shuffleArray(t);const r=[s.fromValues(o.posMin[0],o.posMin[1]),s.fromValues(o.posMax[0]-1,o.posMin[1]),s.fromValues(o.posMin[0],o.posMax[1]-1),s.fromValues(o.posMax[0]-1,o.posMax[1]-1)];for(let e=0;e<r.length;++e){const i=r[e];n.cells.atVec(i).type==$.GroundGrass&&He(n,i,t[e])}}}else if(o.roomType==ge.PublicRoom||o.roomType==ge.PrivateRoom){if(l>=5&&u>=5){if(o.roomType==ge.PrivateRoom)for(let e=2;e<l-2;++e)for(let t=2;t<u-2;++t)n.cells.at(o.posMin[0]+e,o.posMin[1]+t).type=$.GroundWater;n.cells.at(o.posMin[0]+1,o.posMin[1]+1).type=$.Wall0000,n.cells.at(o.posMax[0]-2,o.posMin[1]+1).type=$.Wall0000,n.cells.at(o.posMin[0]+1,o.posMax[1]-2).type=$.Wall0000,n.cells.at(o.posMax[0]-2,o.posMax[1]-2).type=$.Wall0000}else if(5==l&&u>=3&&(o.roomType==ge.PublicRoom||i.random()<.33333)){const t=new Array(u-2).fill(Z.Table);t.push(Ve(e,i)),i.shuffleArray(t);for(let e=1;e<u-1;++e)je(n,s.fromValues(o.posMin[0]+1,o.posMin[1]+e),Z.Chair),je(n,s.fromValues(o.posMin[0]+2,o.posMin[1]+e),t[e-1]),je(n,s.fromValues(o.posMin[0]+3,o.posMin[1]+e),Z.Chair)}else if(5==u&&l>=3&&(o.roomType==ge.PublicRoom||i.random()<.33333)){const t=new Array(l-2).fill(Z.Table);t.push(Ve(e,i)),i.shuffleArray(t);for(let e=1;e<l-1;++e)je(n,s.fromValues(o.posMin[0]+e,o.posMin[1]+1),Z.Chair),je(n,s.fromValues(o.posMin[0]+e,o.posMin[1]+2),t[e-1]),je(n,s.fromValues(o.posMin[0]+e,o.posMin[1]+3),Z.Chair)}else if(l>u&&1==(1&u)&&i.random()<.66667){let t=Math.floor(o.posMin[1]+u/2);const r=o.roomType==ge.PublicRoom?Z.Table:Z.Chair,a=[Ve(e,i),r];i.shuffleArray(a),He(n,s.fromValues(o.posMin[0]+1,t),a[0]),He(n,s.fromValues(o.posMax[0]-2,t),a[1])}else if(u>l&&1==(1&l)&&i.random()<.66667){let t=Math.floor(o.posMin[0]+l/2);const r=o.roomType==ge.PublicRoom?Z.Table:Z.Chair,a=[Ve(e,i),r];i.shuffleArray(a),He(n,s.fromValues(t,o.posMin[1]+1),a[0]),He(n,s.fromValues(t,o.posMax[1]-2),a[1])}else if(l>3&&u>3){const t=o.roomType==ge.PublicRoom?Z.Table:Z.Chair,r=[Ve(e,i),t,t,t];i.shuffleArray(r),He(n,s.fromValues(o.posMin[0],o.posMin[1]),r[0]),He(n,s.fromValues(o.posMax[0]-1,o.posMin[1]),r[1]),He(n,s.fromValues(o.posMin[0],o.posMax[1]-1),r[2]),He(n,s.fromValues(o.posMax[0]-1,o.posMax[1]-1),r[3])}}else o.roomType===ge.Vault&&l>=5&&u>=5&&(n.cells.at(o.posMin[0]+1,o.posMin[1]+1).type=$.Wall0000,n.cells.at(o.posMax[0]-2,o.posMin[1]+1).type=$.Wall0000,n.cells.at(o.posMin[0]+1,o.posMax[1]-2).type=$.Wall0000,n.cells.at(o.posMax[0]-2,o.posMax[1]-2).type=$.Wall0000);if(a==$.GroundWood&&e>3)for(let e=o.posMin[0];e<o.posMax[0];++e)for(let t=o.posMin[1];t<o.posMax[1];++t){if(n.cells.at(e,t).type!=$.GroundWood)continue;if(Be(n.cells,s.fromValues(e,t)))continue;if(i.random()>=.02)continue;const r=e>o.posMin[0]&&e<o.posMax[0]-1&&n.cells.at(e-1,t).type==$.GroundWood&&n.cells.at(e+1,t).type==$.GroundWood,a=t>o.posMin[1]&&t<o.posMax[1]-1&&n.cells.at(e,t-1).type==$.GroundWood&&n.cells.at(e,t+1).type==$.GroundWood;(r||a)&&(n.cells.at(e,t).type=$.GroundWoodCreaky)}}}(e,a,h,n),s.copy(h.playerStartPos,c),function(e,t){let n=e.cells.sizeX,i=e.cells.sizeY;for(let r=0;r<n;++r){for(let t=i-pe+1;t<i;++t){if(e.cells.at(r,t).type!=$.GroundNormal)continue;let n=e.cells.at(r,t);n.type=$.GroundGrass,n.seen=!0}0==(1&r)&&t.random()<.8&&je(e,s.fromValues(r,i-1),Z.Bush)}for(let r=pe;r<i-pe+1;++r){for(let t=0;t<pe-1;++t){if(e.cells.at(t,r).type!=$.GroundNormal)continue;let n=e.cells.at(t,r);n.type=$.GroundGrass,n.seen=!0}for(let t=n-pe+1;t<n;++t){if(e.cells.at(t,r).type!=$.GroundNormal)continue;let n=e.cells.at(t,r);n.type=$.GroundGrass,n.seen=!0}0!=(i-r&1)&&(t.random()<.8&&je(e,s.fromValues(0,r),Z.Bush),t.random()<.8&&je(e,s.fromValues(n-1,r),Z.Bush))}}(h,n),function(e){let t=e.cells.sizeX-1,n=Math.floor(e.cells.sizeX/2);for(let i=pe;i<n;i+=5)e.cells.at(i,1).type=$.Wall0000,e.cells.at(t-i,1).type=$.Wall0000}(h),function(e){for(let t=0;t<e.sizeX;++t)for(let n=0;n<e.sizeY;++n){e.at(t,n).type==$.Wall0000&&(e.at(t,n).type=qe($e(e,t,n)))}}(h.cells),function(e){let t=e.cells.sizeX,n=e.cells.sizeY;for(let i=0;i<t;++i)for(let t=0;t<n;++t){const n=e.cells.at(i,t),r=n.type,o=r>=$.Wall0000&&r<=$.Wall1111,s=le(r),a=r==$.GroundWater;n.moveCost=o||s||a?1/0:0,n.blocksPlayerMove=o,n.blocksPlayerSight=o,n.blocksSight=o,n.blocksSound=o,n.hidesPlayer=!1}for(const t of e.items){let n=e.cells.atVec(t.pos),i=t.type;n.moveCost=Math.max(n.moveCost,te(i)),i!==Z.DoorNS&&i!==Z.DoorEW&&i!==Z.LockedDoorNS&&i!==Z.LockedDoorEW||(n.blocksPlayerSight=!0),i!==Z.DoorNS&&i!==Z.DoorEW&&i!==Z.LockedDoorNS&&i!==Z.LockedDoorEW&&i!==Z.PortcullisNS&&i!==Z.PortcullisEW&&i!==Z.Bush||(n.blocksSight=!0),i!==Z.Table&&i!==Z.Bush||(n.hidesPlayer=!0)}}(h);const d=function(e,t,n,i,r){const o=i.filter((e=>e.door&&n[e.room_left].roomType!==ge.Exterior&&n[e.room_right].roomType!==ge.Exterior&&n[e.room_left].roomType!==ge.Vault&&n[e.room_right].roomType!==ge.Vault));r.shuffleArray(o);const a=[];for(let e=0;e<n.length;++e){const t={roomIndex:e,nodeNext:null,nodePrev:null,visited:!1};a.push(t)}for(const e of o){let t=a[e.room_left],n=a[e.room_right];null==t.nodeNext&&null==n.nodePrev?(t.nodeNext=n,n.nodePrev=t):null==n.nodeNext&&null==t.nodePrev?(n.nodeNext=t,t.nodePrev=n):null==t.nodeNext&&null==n.nodeNext?(Ee(n),t.nodeNext=n,n.nodePrev=t):null==t.nodePrev&&null==n.nodePrev&&(Ae(t),t.nodeNext=n,n.nodePrev=t)}for(const t of a){if(t.visited)continue;if(Re(t),Ce(t))continue;Le(t,Math.max(3,10-e))}!function(e){const t=[...e];for(const e of t)e.visited=!1;for(const n of t){if(n.visited)continue;if(Re(n),Ce(n))continue;const t=ke(n);let i=t.nodeNext,r=t;for(;null!==i&&null!==i.nodeNext;){const t={roomIndex:i.roomIndex,nodeNext:r,nodePrev:null,visited:!0};e.push(t),r.nodePrev=t,i=i.nodeNext,r=t}null!==i&&(r.nodePrev=i,i.nodeNext=r)}}(a);for(const e of o){const t=e.room_left,n=e.room_right,i=a[t],r=a[n];if(null==i.nodeNext&&null==i.nodePrev&&null!=r.nodeNext&&null!=r.nodePrev){const e=r.nodeNext,t={roomIndex:r.roomIndex,nodeNext:e,nodePrev:i,visited:!1};a.push(t),r.nodeNext=i,i.nodePrev=r,i.nodeNext=t,e.nodePrev=t}else if(null!=i.nodeNext&&null!=i.nodePrev&&null==r.nodeNext&&null==r.nodePrev){const e=i.nodeNext,t={roomIndex:i.roomIndex,nodeNext:e,nodePrev:r,visited:!1};a.push(t),i.nodeNext=r,r.nodeNext=t,r.nodePrev=i,e.nodePrev=t}}for(const e of a)e.visited=!1;const l=[];for(const e of a){if(e.visited)continue;if(null==e.nodeNext&&null==e.nodePrev){e.visited=!0;continue}const o=[];for(let a=ke(e);null!=a&&!a.visited;a=a.nodeNext){a.visited=!0;const e=a.nodeNext,l=a.nodePrev;if(null==e)continue;if(null==l)continue;const u=a.roomIndex,c=e.roomIndex,h=l.roomIndex,d=s.create(),f=s.create();if(c!==h)Me(d,n,i,u,h),Me(f,n,i,u,c);else{Me(d,n,i,u,h);const e=De(t,n[u]);e.length>0?s.copy(f,e[r.randomInRange(e.length)]):Pe(f,n,i,u,h,t);for(const e of Ne(t,d,f))o.push(e);o.push(s.clone(f)),o.push(s.clone(f)),o.push(s.clone(f)),s.copy(d,f),Me(f,n,i,u,c)}const p=Ne(t,d,f);for(const e of p)o.push(e)}l.push(Ie(o,r.randomInRange(o.length)))}if(r.shuffleArray(l),e>5){const e=[],n=2,i=2,r=t.cells.sizeX-3,o=t.cells.sizeY-3;for(let t=n;t<r;++t)e.push(s.fromValues(t,i));for(let t=i;t<o;++t)e.push(s.fromValues(r,t));for(let t=r;t>n;--t)e.push(s.fromValues(t,o));for(let t=o;t>i;--t)e.push(s.fromValues(n,t));l.push(e),l.push(Ie(e,Math.floor(e.length/2)))}return l}(e,h,a,u,n),f=void 0!==h.items.find((e=>e.type===Z.LockedDoorNS||e.type===Z.LockedDoorEW)),p=d.length-(f?1:0),m=Math.min(Math.floor(e/3),Math.min(p,t.totalLoot));return function(e,t,n,i,r){let o=0;for(const e of t)if(e.roomType===ge.Vault)for(let t=0;t<4;++t)Ge(e.posMin,e.posMax,i,r)&&++o;for(const s of t){if(o>=e)break;if(s.roomType!=ge.PublicRoom&&s.roomType!=ge.PrivateRoom)continue;let t=0;for(const e of s.edges)n[e].door&&(t+=1);t<2&&Ge(s.posMin,s.posMax,i,r)&&++o}for(const n of t){if(o>=e)break;n.roomType==ge.PrivateRoom&&(r.random()<.2||Ge(n.posMin,n.posMax,i,r)&&++o)}let a=s.fromValues(0,0),l=s.fromValues(i.cells.sizeX,i.cells.sizeY);for(let t=1e3;t>0&&o<e;--t)Ge(a,l,i,r)&&++o;console.assert(o===e)}(t.totalLoot-m,a,u,h,n),function(e,t,n,i,r,o){if(e<=0)return;for(const s of n){const n=new N(s,0);e>1&&o.randomInRange(5+e)<e&&(n.hasTorch=!0),r?(r=!1,n.hasVaultKey=!0):i>0&&(n.hasPurse=!0,i--),t.guards.push(n)}console.assert(0===i)}(e,h,d,m,f,n),function(e){let t=e.cells.sizeX,n=e.cells.sizeY;for(let i=0;i<t;++i)for(let r=0;r<n;++r)(e.cells.at(i,r).type==$.GroundNormal||i>0&&e.cells.at(i-1,r).type==$.GroundNormal||i>0&&r>0&&e.cells.at(i-1,r-1).type==$.GroundNormal||i>0&&r+1<n&&e.cells.at(i-1,r+1).type==$.GroundNormal||r>0&&e.cells.at(i,r-1).type==$.GroundNormal||r+1<n&&e.cells.at(i,r+1).type==$.GroundNormal||i+1<t&&e.cells.at(i+1,r).type==$.GroundNormal||i+1<t&&r>0&&e.cells.at(i+1,r-1).type==$.GroundNormal||i+1<t&&r+1<n&&e.cells.at(i+1,r+1).type==$.GroundNormal)&&(e.cells.at(i,r).seen=!0)}(h),h.computeLighting(),h.recomputeVisibility(h.playerStartPos),h}function _e(e,t,n,i){for(let r=n;r<=i;++r)e.at(t,r).type=$.Wall0000}function Se(e,t,n,i){for(let r=t;r<=i;++r)e.at(r,n).type=$.Wall0000}function Te(e,t,n){if(t!=n)for(const i of e)i.group==t&&(i.group=n)}function Ie(e,t){const n=[];for(let i=t;i<e.length;++i)n.push(e[i]);for(let i=0;i<t;++i)n.push(e[i]);return n}function Ee(e){let t=null;for(;null!=e;){const n=e.nodePrev;e.nodeNext=n,e.nodePrev=t,t=e,e=n}}function Ae(e){let t=null;for(;null!=e;){const n=e.nodeNext;e.nodePrev=n,e.nodeNext=t,t=e,e=n}}function ke(e){let t=e;for(;null!=t.nodePrev&&(t=t.nodePrev,t!=e););return t}function Ce(e){for(let t=e.nodeNext;null!=t;t=t.nodeNext)if(t==e)return!0;return!1}function xe(e){let t=0,n=ke(e);for(let e=n;null!=e&&(++t,e.nodeNext!=n);e=e.nodeNext);return t}function Re(e){let t=ke(e);for(let e=t;null!=e&&(e.visited=!0,e.nodeNext!=t);e=e.nodeNext);}function Le(e,t){const n=ke(e);let i=n,r=0;for(;;){const e=i.nodeNext;if(null==e)break;if(xe(i)<2*t)break;if(++r,r>=t&&(r=0,i.nodeNext=null,e.nodePrev=null),i=e,i==n)break}}function Me(e,t,n,i,r){for(const o of t[i].edges){const t=n[o];if(t.room_left===i&&t.room_right===r||t.room_left===r&&t.room_right===i)return void s.scaleAndAdd(e,t.origin,t.dir,t.doorOffset)}s.zero(e)}function Pe(e,t,n,i,r,o){for(const a of t[i].edges){const t=n[a];if(t.room_left===i&&t.room_right===r){s.scaleAndAdd(e,t.origin,t.dir,t.doorOffset);const n=s.fromValues(-t.dir[1],t.dir[0]);return s.scaleAndAdd(e,e,n,2),void(0!=o.cells.at(e[0],e[1]).moveCost&&s.scaleAndAdd(e,e,n,-1))}if(t.room_left===r&&t.room_right===i){s.scaleAndAdd(e,t.origin,t.dir,t.doorOffset);const n=s.fromValues(t.dir[1],-t.dir[0]);return s.scaleAndAdd(e,e,n,2),void(0!=o.cells.at(e[0],e[1]).moveCost&&s.scaleAndAdd(e,e,n,-1))}}s.zero(e)}function De(e,t){const n=[];for(let i=t.posMin[0];i<t.posMax[0];++i){if(t.posMin[1]>0){e.cells.at(i,t.posMin[1]-1).type==$.OneWayWindowS&&0===e.cells.at(i,t.posMin[1]).moveCost&&n.push(s.fromValues(i,t.posMin[1]))}if(t.posMax[1]<e.cells.sizeY){e.cells.at(i,t.posMax[1]).type==$.OneWayWindowN&&0===e.cells.at(i,t.posMax[1]-1).moveCost&&n.push(s.fromValues(i,t.posMax[1]-1))}}for(let i=t.posMin[1];i<t.posMax[1];++i){if(t.posMin[0]>0){e.cells.at(t.posMin[0]-1,i).type==$.OneWayWindowW&&0===e.cells.at(t.posMin[0],i).moveCost&&n.push(s.fromValues(t.posMin[0],i))}if(t.posMax[0]<e.cells.sizeX){e.cells.at(t.posMax[0],i).type==$.OneWayWindowE&&0===e.cells.at(t.posMax[0]-1,i).moveCost&&n.push(s.fromValues(t.posMax[0]-1,i))}}if(n.length>0)return n;for(const i of e.items)i.type==Z.Chair&&i.pos[0]>=t.posMin[0]&&i.pos[1]>=t.posMin[1]&&i.pos[0]<t.posMax[0]&&i.pos[1]<t.posMax[1]&&n.push(s.clone(i.pos));return n}function Ne(e,t,n){const i=e.computeDistancesToPosition(n),r=s.clone(t),o=[];for(;!r.equals(n);){o.push(s.clone(r));const t=Oe(e,i,r);if(t.equals(r))break;s.copy(r,t)}return o}function Oe(e,t,n){let i=1/0,r=s.clone(n);const o=s.fromValues(Math.max(0,n[0]-1),Math.max(0,n[1]-1)),a=s.fromValues(Math.min(e.cells.sizeX,n[0]+2),Math.min(e.cells.sizeY,n[1]+2));for(let l=o[0];l<a[0];++l)for(let u=o[1];u<a[1];++u){const o=t.get(l,u);if(o==1/0)continue;let a=s.fromValues(l,u);e.guardMoveCost(n,a)!=1/0&&(o<i&&(i=o,r=a))}if(r.equals(n)){console.log("failed to proceed");for(let e=o[0];e<a[0];++e)for(let n=o[1];n<a[1];++n){const i=t.get(e,n);console.log(e,n,i)}}return r}(ve=ge||(ge={}))[ve.Exterior=0]="Exterior",ve[ve.PublicCourtyard=1]="PublicCourtyard",ve[ve.PublicRoom=2]="PublicRoom",ve[ve.PrivateCourtyard=3]="PrivateCourtyard",ve[ve.PrivateRoom=4]="PrivateRoom",ve[ve.Vault=5]="Vault";const Fe=[$.OneWayWindowS,$.OneWayWindowE,$.OneWayWindowN,$.OneWayWindowW];function Ue(e){return Fe[e[0]+2*Math.max(0,e[1])+1]}function Ve(e,t){return 0===e||t.random()<.5?Z.TorchUnlit:Z.TorchLit}function He(e,t,n){Be(e.cells,t)||(n!=Z.TorchUnlit&&n!=Z.TorchLit||!function(e,t){let[n,i]=t;return!!le(e.at(n-1,i).type)||(!!le(e.at(n+1,i).type)||(!!le(e.at(n,i-1).type)||!!le(e.at(n,i+1).type)))}(e.cells,t))&&je(e,t,n)}function Be(e,t){let[n,i]=t;return e.at(n-1,i).type>=$.PortcullisNS||(e.at(n+1,i).type>=$.PortcullisNS||(e.at(n,i-1).type>=$.PortcullisNS||e.at(n,i+1).type>=$.PortcullisNS))}function je(e,t,n){e.items.push({pos:s.clone(t),type:n})}function Ge(e,t,n,i){let r=t[0]-e[0],o=t[1]-e[1];for(let t=1e3;t>0;--t){let t=s.fromValues(e[0]+i.randomInRange(r),e[1]+i.randomInRange(o)),a=n.cells.at(t[0],t[1]).type;if((a===$.GroundWood||a===$.GroundMarble||a===$.GroundVault)&&!We(n,t))return je(n,t,Z.Coin),!0}return!1}function We(e,t){for(const n of e.items)if(n.pos.equals(t))return!0;for(const n of e.guards)if(n.pos.equals(t))return!0;return!1}function ze(e){switch(e){case ge.Exterior:return!1;case ge.PublicCourtyard:return!0;case ge.PublicRoom:return!1;case ge.PrivateCourtyard:return!0;case ge.PrivateRoom:case ge.Vault:return!1}}function qe(e){return $.Wall0000+e}function Ke(e){return e>=$.Wall0000&&e<=$.DoorEW}function $e(e,t,n){const i=e.sizeX;let r=0;return n<e.sizeY-1&&Ke(e.at(t,n+1).type)&&(r|=8),n>0&&Ke(e.at(t,n-1).type)&&(r|=4),t<i-1&&Ke(e.at(t+1,n).type)&&(r|=2),t>0&&Ke(e.at(t-1,n).type)&&(r|=1),r}class Ye{getScreenSize(e){}beginFrame=e=>{};start(e,t){}addGlyph(e,t,n,i,r,o=1){}flush(){}constructor(e,t,n){this.tileSet=t,this.fontTileSet=n;const i=e.getContext("webgl2",{alpha:!1,depth:!1}),r=[n.image,t.image].map((e=>function(e,t){const n=16,i=16,r=n*i,o=t.naturalWidth/n,s=t.naturalHeight/i,a=1,l=o*a,u=s*a,c=document.createElement("canvas");c.width=l,c.height=u*r;const h=c.getContext("2d");h.imageSmoothingEnabled=!1;for(let e=0;e<i;++e)for(let i=0;i<n;++i){const r=i*o,a=e*s,c=0,d=(n*e+i)*u;h.drawImage(t,r,a,o,s,c,d,l,u)}const d=h.getImageData(0,0,c.width,c.height),f=new Uint8Array(d.data.buffer),p=e.createTexture();return e.bindTexture(e.TEXTURE_2D_ARRAY,p),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage3D(e.TEXTURE_2D_ARRAY,0,e.RGBA,l,u,r,0,e.RGBA,e.UNSIGNED_BYTE,f),p}(i,e))),o={vPosition:0,vTexcoord:1,vColor:2};function l(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function u(e){const[t,n,i,r]=e;return r<<24>>>0|i<<16>>>0|n<<8>>>0|t>>>0}const c=[t.tileSize[0]/t.cellSize[0],t.tileSize[1]/t.cellSize[1]],h=function(e,t,n,i){const r=Xe(e,e.VERTEX_SHADER,t),o=Xe(e,e.FRAGMENT_SHADER,n),s=e.createProgram();e.attachShader(s,r),e.attachShader(s,o);for(const t in i)e.bindAttribLocation(s,i[t],t);e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||alert("Unable to initialize the shader program: "+e.getProgramInfoLog(s));return s}(i,"#version 300 es\n            in vec2 vPosition;\n            in vec3 vTexcoord;\n            in vec4 vColor;\n\n            uniform mat4 uMatScreenFromWorld;\n\n            out highp vec3 fTexcoord;\n            out highp vec4 fColor;\n\n            void main() {\n                fTexcoord = vTexcoord;\n                fColor = vColor;\n                gl_Position = uMatScreenFromWorld * vec4(vPosition, 0, 1);\n            }\n        ","#version 300 es\n            in highp vec3 fTexcoord;\n            in highp vec4 fColor;\n\n            uniform highp sampler2DArray uOpacity;\n\n            out lowp vec4 fragColor;\n\n            void main() {\n                fragColor = fColor * texture(uOpacity, fTexcoord);\n            }\n        ",o),d=i.getUniformLocation(h,"uMatScreenFromWorld"),f=i.getUniformLocation(h,"uOpacity"),p=2*Float32Array.BYTES_PER_ELEMENT+2*Uint32Array.BYTES_PER_ELEMENT,m=p,g=new ArrayBuffer(256*p),v=new Float32Array(g),y=new Uint32Array(g),b=i.createBuffer();let w=0;const _=a.create(),S=i.createVertexArray();i.bindVertexArray(S),i.enableVertexAttribArray(o.vPosition),i.enableVertexAttribArray(o.vTexcoord),i.enableVertexAttribArray(o.vColor),i.bindBuffer(i.ARRAY_BUFFER,b),i.vertexAttribPointer(o.vPosition,2,i.FLOAT,!1,p,0),i.vertexAttribPointer(o.vTexcoord,3,i.UNSIGNED_BYTE,!1,p,8),i.vertexAttribPointer(o.vColor,4,i.UNSIGNED_BYTE,!0,p,12),i.bufferData(i.ARRAY_BUFFER,g,i.DYNAMIC_DRAW);!function(e,t){const n=new Uint16Array(6*t);for(let e=0;e<t;++e){let t=6*e,i=4*e;n[t+0]=i+0,n[t+1]=i+1,n[t+2]=i+2,n[t+3]=i+2,n[t+4]=i+1,n[t+5]=i+3}const i=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}(i,64);i.bindVertexArray(null),this.getScreenSize=e=>{const t=i.canvas;Qe(t);const n=t.clientWidth,r=t.clientHeight;s.set(e,n,r)},this.start=(e,t)=>{a.copy(_,e),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D_ARRAY,r[t])},this.addGlyph=(e,t,n,i,r,o=1)=>{if(void 0!==r.textureIndex)if(w>=64&&this.flush(),n=e+(n-e)*c[0],i=t+(i-t)*c[1],"number"==typeof o){const s=l(r.color?r.color:4294967295),a=l(r.unlitColor?r.unlitColor:4283453520),c=o**.25,h=u([a[0]+c*(s[0]-a[0]),a[1]+c*(s[1]-a[1]),a[2]+c*(s[2]-a[2]),a[3]+c*(s[3]-a[3])]),d=w*m,f=r.textureIndex<<16;v[d+0]=e,v[d+1]=t,y[d+2]=f+256,y[d+3]=h,v[d+4]=n,v[d+5]=t,y[d+6]=f+257,y[d+7]=h,v[d+8]=e,v[d+9]=i,y[d+10]=f,y[d+11]=h,v[d+12]=n,v[d+13]=i,y[d+14]=f+1,y[d+15]=h,++w}else{const s=[];for(const e of o){const t=l(r.color?r.color:4294967295),n=l(r.unlitColor?r.unlitColor:4283453520),i=e**.25,o=u([n[0]+i*(t[0]-n[0]),n[1]+i*(t[1]-n[1]),n[2]+i*(t[2]-n[2]),n[3]+i*(t[3]-n[3])]);s.push(o)}const a=w*m,c=r.textureIndex<<16;v[a+0]=e,v[a+1]=t,y[a+2]=c+256,y[a+3]=s[0],v[a+4]=n,v[a+5]=t,y[a+6]=c+257,y[a+7]=s[1],v[a+8]=e,v[a+9]=i,y[a+10]=c,y[a+11]=s[2],v[a+12]=n,v[a+13]=i,y[a+14]=c+1,y[a+15]=s[3],++w}},this.flush=()=>{w<=0||(i.useProgram(h),i.bindVertexArray(S),i.uniform1i(f,0),i.uniformMatrix4fv(d,!1,_),i.bindBuffer(i.ARRAY_BUFFER,b),i.bufferSubData(i.ARRAY_BUFFER,0,v,0),i.drawElements(i.TRIANGLES,6*w,i.UNSIGNED_SHORT,0),i.bindVertexArray(null),w=0)},this.beginFrame=e=>{const t=i.canvas;Qe(t);const n=t.clientWidth,r=t.clientHeight;i.viewport(0,0,n,r),i.clear(i.COLOR_BUFFER_BIT)},i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.BLEND),i.clearColor(0,0,0,1)}}function Xe(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||(alert("An error occurred compiling the shaders: "+e.getShaderInfoLog(i)),e.deleteShader(i)),i}function Qe(e){e.width===window.innerWidth&&e.height===window.innerHeight||(e.width=window.innerWidth,e.height=window.innerHeight)}const Je=4278190080,Ze=4278190248,et=4291875024,tt=4289243304,nt=4287660160,it=4285550672,rt=4283760212,ot=4294901332,st=4283760382,at=4291886846,lt=4290834158,ut=4294967295;var ct;ct=new URL(o("27Lyk").resolve("dwPvt"),import.meta.url).toString();function ht(){return mt}function dt(){return pt}function ft(e){return 16*e[1]+e[0]}const pt={name:"Basic Font",imageSrc:new URL(o("27Lyk").resolve("kDrfW"),import.meta.url).toString(),image:new Image,tileSize:[16,16],offset:[0,0],letterMap:[],background:{textureIndex:219,color:4027584528},heart:{textureIndex:3},air:{textureIndex:9}},mt={name:"31 Color Tileset",imageSrc:ct,image:new Image,tileSize:[16,16],cellSize:[16,16],offset:[0,0],flattenTexture:!0,unlitTile:{textureIndex:ft([0,0])},namedTiles:{pickTarget:{textureIndex:188,color:4294967295},noise:{textureIndex:187,color:2164260863},crossHatch:{textureIndex:3,color:4294967295},patrolRoute:{textureIndex:31,color:4286644096}},touchButtons:{menu:{textureIndex:ft([11,1]),color:2701131775,unlitColor:2164260863},up:{textureIndex:ft([2,1]),color:2701131775,unlitColor:2164260863},down:{textureIndex:ft([3,1]),color:2701131775,unlitColor:2164260863},left:{textureIndex:ft([0,1]),color:2701131775,unlitColor:2164260863},right:{textureIndex:ft([1,1]),color:2701131775,unlitColor:2164260863},wait:{textureIndex:ft([4,1]),color:2701131775,unlitColor:2164260863},exitLevel:{textureIndex:ft([9,1]),color:4278255615,unlitColor:4278255615},jump:{textureIndex:ft([5,1]),color:2701131775,unlitColor:2164260863},zoomIn:{textureIndex:ft([6,1]),color:2701131775,unlitColor:2164260863},zoomOut:{textureIndex:ft([7,1]),color:2701131775,unlitColor:2164260863},heal:{textureIndex:ft([8,1]),color:2701131775,unlitColor:2164260863},startLevel:{textureIndex:ft([9,1]),color:2701131775,unlitColor:2164260863},nextLevel:{textureIndex:ft([9,1]),color:2701131775,unlitColor:2164260863},restart:{textureIndex:ft([10,1]),color:2701131775,unlitColor:2164260863},forceRestart:{textureIndex:ft([10,1]),color:2701131775,unlitColor:2164260863},gamepadTouchOn:{textureIndex:ft([12,1]),color:2701131775,unlitColor:4294967295},gamepadTouchOff:{textureIndex:ft([12,1]),color:2701131775,unlitColor:2164260863},picker:{textureIndex:ft([13,1]),color:4278255615,unlitColor:4278255615},fullscreen:{textureIndex:ft([14,1]),color:2701131775,unlitColor:2164260863}},terrainTiles:[{textureIndex:ft([5,4]),color:at,unlitColor:it},{textureIndex:ft([8,4]),color:at,unlitColor:it},{textureIndex:ft([10,4]),color:at,unlitColor:it},{textureIndex:ft([0,4]),color:at,unlitColor:it},{textureIndex:ft([7,4]),color:lt,unlitColor:it},{textureIndex:ft([7,5]),color:lt,unlitColor:it},{textureIndex:ft([5,4]),color:at,unlitColor:it},{textureIndex:ft([0,2]),color:ut,unlitColor:nt},{textureIndex:ft([2,2]),color:ut,unlitColor:nt},{textureIndex:ft([4,2]),color:ut,unlitColor:nt},{textureIndex:ft([6,2]),color:ut,unlitColor:nt},{textureIndex:ft([1,2]),color:ut,unlitColor:nt},{textureIndex:ft([9,2]),color:ut,unlitColor:nt},{textureIndex:ft([8,2]),color:ut,unlitColor:nt},{textureIndex:ft([12,2]),color:ut,unlitColor:nt},{textureIndex:ft([3,2]),color:ut,unlitColor:nt},{textureIndex:ft([10,2]),color:ut,unlitColor:nt},{textureIndex:ft([7,2]),color:ut,unlitColor:nt},{textureIndex:ft([14,2]),color:ut,unlitColor:nt},{textureIndex:ft([5,2]),color:ut,unlitColor:nt},{textureIndex:ft([13,2]),color:ut,unlitColor:nt},{textureIndex:ft([11,2]),color:ut,unlitColor:nt},{textureIndex:ft([15,2]),color:ut,unlitColor:nt},{textureIndex:ft([0,3]),color:ut,unlitColor:nt},{textureIndex:ft([2,3]),color:ut,unlitColor:nt},{textureIndex:ft([3,3]),color:ut,unlitColor:nt},{textureIndex:ft([1,3]),color:ut,unlitColor:nt},{textureIndex:ft([12,3]),color:at,unlitColor:nt},{textureIndex:ft([11,3]),color:at,unlitColor:nt},{textureIndex:ft([8,3]),color:et,unlitColor:nt},{textureIndex:ft([5,3]),color:et,unlitColor:nt},{textureIndex:ft([8,4]),color:at,unlitColor:it},{textureIndex:ft([8,4]),color:at,unlitColor:it}],itemTiles:[{textureIndex:ft([3,13]),color:at,unlitColor:nt},{textureIndex:ft([4,13]),color:at,unlitColor:nt},{textureIndex:ft([2,13]),color:ut,unlitColor:nt},{textureIndex:ft([5,13]),color:ut,unlitColor:4294967295},{textureIndex:ft([7,3]),color:ut,unlitColor:nt},{textureIndex:ft([4,3]),color:ut,unlitColor:nt},{textureIndex:ft([9,3]),color:ut,unlitColor:nt},{textureIndex:ft([6,3]),color:ut,unlitColor:nt},{textureIndex:ft([12,3]),color:ut,unlitColor:nt},{textureIndex:ft([11,3]),color:ut,unlitColor:nt},{textureIndex:ft([0,13]),color:ut,unlitColor:4294967295},{textureIndex:ft([1,13]),color:ut,unlitColor:4294967295},{textureIndex:ft([12,13]),color:at,unlitColor:4288704624},{textureIndex:ft([0,15]),color:ut,unlitColor:4294967295},{textureIndex:ft([6,13]),color:ut,unlitColor:4294967295},{textureIndex:ft([1,15]),color:ut,unlitColor:4294967295}],npcTiles:[{textureIndex:ft([3,8]),color:ut,unlitColor:it},{textureIndex:ft([2,8]),color:ut,unlitColor:it},{textureIndex:ft([4,8]),color:ut,unlitColor:it},{textureIndex:ft([1,8]),color:ut,unlitColor:it},{textureIndex:ft([3,8]),color:it},{textureIndex:ft([2,8]),color:it},{textureIndex:ft([4,8]),color:it},{textureIndex:ft([1,8]),color:it},{textureIndex:ft([3,8]),color:ut,unlitColor:it},{textureIndex:ft([2,8]),color:ut,unlitColor:it},{textureIndex:ft([4,8]),color:ut,unlitColor:it},{textureIndex:ft([1,8]),color:ut,unlitColor:it},{textureIndex:ft([0,8]),color:ut,unlitColor:it},{textureIndex:ft([0,8]),color:ut,unlitColor:it},{textureIndex:ft([0,8]),color:ut,unlitColor:it},{textureIndex:ft([0,8]),color:ut,unlitColor:it}],playerTiles:{normal:{textureIndex:ft([1,9]),color:ut,unlitColor:tt},wounded:{textureIndex:ft([1,9]),color:4283716862,unlitColor:Ze},hidden:{textureIndex:ft([0,9]),color:it,unlitColor:4284497984},noisy:{textureIndex:ft([1,9]),color:tt,unlitColor:it},unlit:{textureIndex:ft([1,9]),color:ut,unlitColor:tt},right:{textureIndex:ft([2,9]),color:ut,unlitColor:tt},left:{textureIndex:ft([3,9]),color:ut,unlitColor:tt},down:{textureIndex:ft([1,9]),color:ut,unlitColor:tt},up:{textureIndex:ft([4,9]),color:ut,unlitColor:tt}},guardStateTiles:[{textureIndex:ft([0,11])},{textureIndex:ft([1,11])},{textureIndex:ft([2,11])},{textureIndex:ft([3,11])},{textureIndex:ft([4,11])}],ledgeTiles:[{textureIndex:ft([12,0]),color:4285753415,unlitColor:4282922024},{textureIndex:ft([13,0]),color:4285753415,unlitColor:4282922024},{textureIndex:ft([14,0]),color:4285753415,unlitColor:4282922024},{textureIndex:ft([15,0]),color:4285753415,unlitColor:4282922024}],waterAnimation:[{textureIndex:96,color:at,unlitColor:nt},{textureIndex:97,color:at,unlitColor:nt},{textureIndex:98,color:at,unlitColor:nt},{textureIndex:99,color:at,unlitColor:nt}],candleAnimation:[{textureIndex:224,color:at,unlitColor:nt},{textureIndex:225,color:at,unlitColor:nt},{textureIndex:226,color:at,unlitColor:nt},{textureIndex:227,color:at,unlitColor:nt},{textureIndex:208,color:at,unlitColor:nt}],torchAnimation:[{textureIndex:220},{textureIndex:221},{textureIndex:222},{textureIndex:223},{textureIndex:223}]};var gt,vt;
/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
!function(){var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||c(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var r=t._howls[i]._getSoundIds(),o=0;o<r.length;o++){var s=t._howls[i]._soundById(r[o]);s&&s._node&&(s._node.volume=s._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||c(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var r=t._howls[i]._getSoundIds(),o=0;o<r.length;o++){var s=t._howls[i]._soundById(r[o]);s&&s._node&&(s._node.muted=!!e||s._muted)}return t},stop:function(){for(var e=this||n,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,c()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator?e._navigator.userAgent:"",o=r.match(/OPR\/([0-6].)/g),s=o&&parseInt(o[0].split("/")[1],10)<33,a=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),l=r.match(/Version\/(.*?) /),u=a&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!(s||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||n;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch(n){e.noAudio=!0;break}for(var r=0;r<e._howls.length;r++)if(!e._howls[r]._webAudio)for(var o=e._howls[r]._getSoundIds(),s=0;s<o.length;s++){var a=e._howls[r]._soundById(o[s]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||n;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||n;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,i=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};i.prototype={init:function(e){var t=this;return n.ctx||c(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,void 0!==n.ctx&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(n.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var i=0;i<e._src.length;i++){var o,a;if(e._format&&e._format[i])o=e._format[i];else{if("string"!=typeof(a=e._src[i])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(o=/^data:audio\/([^;,]+);/i.exec(a))||(o=/\.([^.]+)$/.exec(a.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(o||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),o&&n.codecs(o)){t=e._src[i];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new r(e),e._webAudio&&s(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var o=0,s=0;s<i._sounds.length;s++)i._sounds[s]._paused&&!i._sounds[s]._ended&&(o++,r=i._sounds[s]._id);1===o?e=null:r=null}}var a=r?i._soundById(r):i._inactiveSound();if(!a)return null;if(r&&!e&&(e=a._sprite||"__default"),"loaded"!==i._state){a._sprite=e,a._ended=!1;var l=a._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(r&&!a._paused)return t||i._loadQueue("play"),a._id;i._webAudio&&n._autoResume();var u=Math.max(0,a._seek>0?a._seek:i._sprite[e][0]/1e3),c=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-u),h=1e3*c/Math.abs(a._rate),d=i._sprite[e][0]/1e3,f=(i._sprite[e][0]+i._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var p=function(){a._paused=!1,a._seek=u,a._start=d,a._stop=f,a._loop=!(!a._loop&&!i._sprite[e][2])};if(!(u>=f)){var m=a._node;if(i._webAudio){var g=function(){i._playLock=!1,p(),i._refreshBuffer(a);var e=a._muted||i._muted?0:a._volume;m.gain.setValueAtTime(e,n.ctx.currentTime),a._playStart=n.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,u,86400):m.bufferSource.noteGrainOn(0,u,c):a._loop?m.bufferSource.start(0,u,86400):m.bufferSource.start(0,u,c),h!==1/0&&(i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h)),t||setTimeout((function(){i._emit("play",a._id),i._loadQueue()}),0)};"running"===n.state&&"interrupted"!==n.ctx.state?g():(i._playLock=!0,i.once("resume",g),i._clearTimer(a._id))}else{var v=function(){m.currentTime=u,m.muted=a._muted||i._muted||n._muted||m.muted,m.volume=a._volume*n.volume(),m.playbackRate=a._rate;try{var r=m.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(i._playLock=!0,p(),r.then((function(){i._playLock=!1,m._unlocked=!0,t?i._loadQueue():i._emit("play",a._id)})).catch((function(){i._playLock=!1,i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):t||(i._playLock=!1,p(),i._emit("play",a._id)),m.playbackRate=a._rate,m.paused)return void i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h):(i._endTimers[a._id]=function(){i._ended(a),m.removeEventListener("ended",i._endTimers[a._id],!1)},m.addEventListener("ended",i._endTimers[a._id],!1))}catch(e){i._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=i._src,m.load());var y=window&&window.ejecta||!m.readyState&&n._navigator.isCocoonJS;if(m.readyState>=3||y)v();else{i._playLock=!0,i._state="loading";var b=function(){i._state="loaded",v(),m.removeEventListener(n._canPlayEvent,b,!1)};m.addEventListener(n._canPlayEvent,b,!1),i._clearTimer(a._id)}}return a._id}i._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var r=t._soundById(n[i]);if(r&&!r._paused&&(r._seek=t.seek(n[i]),r._rateSeek=0,r._paused=!0,t._stopFade(n[i]),r._node))if(t._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r?r._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),r=0;r<i.length;r++){n._clearTimer(i[r]);var o=n._soundById(i[r]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(i[r]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),t||n._emit("stop",o._id))}return n},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var r=i._getSoundIds(t),o=0;o<r.length;o++){var s=i._soundById(r[o]);s&&(s._muted=e,s._interval&&i._stopFade(s._id),i._webAudio&&s._node?s._node.gain.setValueAtTime(e?0:s._volume,n.ctx.currentTime):s._node&&(s._node.muted=!!n._muted||e),i._emit("mute",s._id))}return i},volume:function(){var e,t,i,r=this,o=arguments;if(0===o.length)return r._volume;if(1===o.length||2===o.length&&void 0===o[1]?r._getSoundIds().indexOf(o[0])>=0?t=parseInt(o[0],10):e=parseFloat(o[0]):o.length>=2&&(e=parseFloat(o[0]),t=parseInt(o[1],10)),!(void 0!==e&&e>=0&&e<=1))return(i=t?r._soundById(t):r._sounds[0])?i._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,o)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var s=0;s<t.length;s++)(i=r._soundById(t[s]))&&(i._volume=e,o[2]||r._stopFade(t[s]),r._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,n.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*n.volume()),r._emit("volume",i._id));return r},fade:function(e,t,i,r){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(e,t,i,r)}}),o;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),o.volume(e,r);for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var l=o._soundById(s[a]);if(l){if(r||o._stopFade(s[a]),o._webAudio&&!l._muted){var u=n.ctx.currentTime,c=u+i/1e3;l._volume=e,l._node.gain.setValueAtTime(e,u),l._node.gain.linearRampToValueAtTime(t,c)}o._startFadeInterval(l,e,t,i,s[a],void 0===r)}}return o},_startFadeInterval:function(e,t,n,i,r,o){var s=this,a=t,l=n-t,u=Math.abs(l/.01),c=Math.max(4,u>0?i/u:i),h=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var r=(Date.now()-h)/i;h=Date.now(),a+=l*r,a=Math.round(100*a)/100,a=l<0?Math.max(n,a):Math.min(n,a),s._webAudio?e._volume=a:s.volume(a,e._id,!0),o&&(s._volume=a),(n<t&&a<=n||n>t&&a>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,s.volume(n,e._id),s._emit("fade",e._id))}),c)},_stopFade:function(e){var t=this,i=t._soundById(e);return i&&i._interval&&(t._webAudio&&i._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(i._interval),i._interval=null,t.volume(i._fadeTo,e),i._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,n,i=this,r=arguments;if(0===r.length)return i._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(n=i._soundById(parseInt(r[0],10)))&&n._loop;e=r[0],i._loop=e}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var o=i._getSoundIds(t),s=0;s<o.length;s++)(n=i._soundById(o[s]))&&(n._loop=e,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,i.playing(o[s])&&(i.pause(o[s],!0),i.play(o[s],!0)))));return i},rate:function(){var e,t,i,r=this,o=arguments;if(0===o.length)t=r._sounds[0]._id;else if(1===o.length){r._getSoundIds().indexOf(o[0])>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if("number"!=typeof e)return(i=r._soundById(t))?i._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,o)}}),r;void 0===t&&(r._rate=e),t=r._getSoundIds(t);for(var s=0;s<t.length;s++)if(i=r._soundById(t[s])){r.playing(t[s])&&(i._rateSeek=r.seek(t[s]),i._playStart=r._webAudio?n.ctx.currentTime:i._playStart),i._rate=e,r._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,n.ctx.currentTime):i._node&&(i._node.playbackRate=e);var a=r.seek(t[s]),l=1e3*((r._sprite[i._sprite][0]+r._sprite[i._sprite][1])/1e3-a)/Math.abs(i._rate);!r._endTimers[t[s]]&&i._paused||(r._clearTimer(t[s]),r._endTimers[t[s]]=setTimeout(r._ended.bind(r,i),l)),r._emit("rate",i._id)}return r},seek:function(){var e,t,i=this,r=arguments;if(0===r.length)i._sounds.length&&(t=i._sounds[0]._id);else if(1===r.length){i._getSoundIds().indexOf(r[0])>=0?t=parseInt(r[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,r)}}),i;var o=i._soundById(t);if(o){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var s=i.playing(t)?n.ctx.currentTime-o._playStart:0,a=o._rateSeek?o._rateSeek-o._seek:0;return o._seek+(a+s*Math.abs(o._rate))}return o._node.currentTime}var l=i.playing(t);l&&i.pause(t,!0),o._seek=e,o._ended=!1,i._clearTimer(t),i._webAudio||!o._node||isNaN(o._node.duration)||(o._node.currentTime=e);var u=function(){l&&i.play(t,!0),i._emit("seek",t)};if(l&&!i._webAudio){var c=function(){i._playLock?setTimeout(c,0):u()};setTimeout(c,0)}else u()}return i},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,i=t._soundById(e);return i&&(n=t._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(n._canPlayEvent,t[i]._loadFn,!1),t[i]._node.removeEventListener("ended",t[i]._endFn,!1),n._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var r=n._howls.indexOf(e);r>=0&&n._howls.splice(r,1);var s=!0;for(i=0;i<n._howls.length;i++)if(n._howls[i]._src===e._src||e._src.indexOf(n._howls[i]._src)>=0){s=!1;break}return o&&s&&delete o[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var r=this["_on"+e];return"function"==typeof t&&r.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),this},off:function(e,t,n){var i=this,r=i["_on"+e],o=0;if("number"==typeof t&&(n=t,t=null),t||n)for(o=0;o<r.length;o++){var s=n===r[o].id;if(t===r[o].fn&&s||!t&&s){r.splice(o,1);break}}else if(e)i["_on"+e]=[];else{var a=Object.keys(i);for(o=0;o<a.length;o++)0===a[o].indexOf("_on")&&Array.isArray(i[a[o]])&&(i[a[o]]=[])}return i},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var i=this,r=i["_on"+e],o=r.length-1;o>=0;o--)r[o].id&&r[o].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(i,r[o].fn),0),r[o].once&&i.off(e,r[o].fn,r[o].id));return i._loadQueue(e),i},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,i=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[i][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),t._webAudio||r||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new r(e)},_drain:function(){var e=this,t=e._pool,n=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&n++;for(i=e._sounds.length-1;i>=0;i--){if(n<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=o[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),this},_cleanBuffer:function(e){var t=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(n._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(e){this._parent=e,this.init()};r.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,i=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(i,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):n.noAudio||(e._node=n._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=i*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var o={},s=function(e){var t=e._src;if(o[t])return e._duration=o[t].duration,void u(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);l(i.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){s.setRequestHeader(t,e._xhr.headers[t])})),s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?l(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete o[t],e.load())},a(s)}},a=function(e){try{e.send()}catch(t){e.onerror()}},l=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},r=function(e){e&&t._sounds.length>0?(o[t._src]=e,u(t,e)):i()};"undefined"!=typeof Promise&&1===n.ctx.decodeAudioData.length?n.ctx.decodeAudioData(e).then(r).catch(i):n.ctx.decodeAudioData(e,r,i)},u=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},c=function(){if(n.usingWebAudio){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!r&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:n,Howl:i}})),gt=n,vt=i,void 0!==t?(t.HowlerGlobal=e,t.Howler=n,t.Howl=i,t.Sound=r):"undefined"!=typeof window&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=i,window.Sound=r)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var i=this;return i.ctx&&i.ctx.listener?(t="number"!=typeof t?i._pos[1]:t,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof e?i._pos:(i._pos=[e,t,n],void 0!==i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(e,t,n,i,r,o){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,i="number"!=typeof i?a[3]:i,r="number"!=typeof r?a[4]:r,o="number"!=typeof o?a[5]:o,"number"!=typeof e?a:(s._orientation=[e,t,n,i,r,o],void 0!==s.ctx.listener.forwardX?(s.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),s.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),s.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),s.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),s.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),s.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):s.ctx.listener.setOrientation(e,t,n,i,r,o),s)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return i._stereo;i._stereo=e,i._pos=[e,0,0]}for(var o=i._getSoundIds(n),s=0;s<o.length;s++){var a=i._soundById(o[s]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,r),"spatial"===r?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",a._id)}}return i},Howl.prototype.pos=function(e,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(e,n,i,r)}}),o;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===r){if("number"!=typeof e)return o._pos;o._pos=[e,n,i]}for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var l=o._soundById(s[a]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,n,i],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setPosition(e,n,i)),o._emit("pos",l._id)}}return o},Howl.prototype.orientation=function(e,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(e,n,i,r)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,i="number"!=typeof i?o._orientation[2]:i,void 0===r){if("number"!=typeof e)return o._orientation;o._orientation=[e,n,i]}for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var l=o._soundById(s[a]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,n,i],l._node&&(l._panner||(l._pos||(l._pos=o._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setOrientation(e,n,i)),o._emit("orientation",l._id)}}return o},Howl.prototype.pannerAttr=function(){var e,n,i,r=this,o=arguments;if(!r._webAudio)return r;if(0===o.length)return r._pannerAttr;if(1===o.length){if("object"!=typeof o[0])return(i=r._soundById(parseInt(o[0],10)))?i._pannerAttr:r._pannerAttr;e=o[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:r._panningModel})}else 2===o.length&&(e=o[0],n=parseInt(o[1],10));for(var s=r._getSoundIds(n),a=0;a<s.length;a++)if(i=r._soundById(s[a])){var l=i._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var u=i._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(i._pos||(i._pos=r._pos||[0,0,-.5]),t(i,"spatial"))}return r},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}();var yt={};yt=new URL(o("27Lyk").resolve("8Qic0"),import.meta.url).toString();var bt={};bt=new URL(o("27Lyk").resolve("aSqJ5"),import.meta.url).toString();var wt={};wt=new URL(o("27Lyk").resolve("hMICc"),import.meta.url).toString();var _t={};_t=new URL(o("27Lyk").resolve("cFOzA"),import.meta.url).toString();var St={};St=new URL(o("27Lyk").resolve("iP5rH"),import.meta.url).toString();var Tt={};Tt=new URL(o("27Lyk").resolve("4cgQm"),import.meta.url).toString();var It={};It=new URL(o("27Lyk").resolve("5uP20"),import.meta.url).toString();var Et={};Et=new URL(o("27Lyk").resolve("koWqL"),import.meta.url).toString();var At={};At=new URL(o("27Lyk").resolve("drQCs"),import.meta.url).toString();var kt={};kt=new URL(o("27Lyk").resolve("aKQuT"),import.meta.url).toString();const Ct=[o("iTab4"),o("87bT4"),o("eN2P4"),o("8A7kA"),o("9bbmx"),o("V8ahV"),o("hadbD"),o("dH5ka"),o("3twvr"),o("bBbdi")],xt=[o("kBrAM"),o("k6Tdk"),o("vDQ5G"),o("7DVvx"),o("al4v1"),o("fO2Fk"),o("kaxMC")],Rt=[o("fO2Fk")],Lt=[o("lsnFy"),o("iSQf2"),o("9W6vc"),o("h5cAV"),o("71dbC")],Mt=[o("iOIx8"),o("5HSVp"),o("gjhQR"),o("9yWXC"),o("8wZYi"),o("lLaFn"),o("91Ssr"),o("iPqLJ")],Pt=[o("aYURT"),o("28SI0"),o("2v7tx"),o("2ab9R")],Dt=[o("5mxOT"),o("6zU4W")],Nt=[o("c5gUn"),o("pgODr"),o("2CXE7"),o("6IDgr"),o("sYECX"),o("5SG7D")],Ot=[o("b3a1B"),o("hNZg3"),o("f54Wu"),o("lLVHT"),o("4n1uh")],Ft=[o("9h7xU"),o("jiU0R")],Ut=[o("alx6Z"),o("ijwXJ")],Vt=[[o("a2kyU"),"Hmm..."],[o("5d0DW"),"What?"],[o("dxMYB"),"Hey!"],[o("baOJW"),"Hey!"],[o("k2iei"),"Hey!"],[o("3x4yY"),"What was that?"],[o("egNqT"),"What was that?"],[o("QVkvm"),"What was that?"],[o("ggzCL"),"What was that?"],[o("h8bVj"),"What was that?"],[o("1NOTS"),"Who goes there?"],[o("6wdzE"),"Huh?"],[o("5d0DW"),"What?"],[o("7Bgvb"),"Wha..."],[o("cc8Co"),"Wait!"],[o("3Vwq5"),"Who's out there?"],[o("bk6h6"),"What moved?"],[o("7Du7Q"),"What' in the shadows?"],[o("aTKjT"),"Did the shadows move?"],[o("8P0kg"),"Did I see something?"],[o("fyl73"),"Hello?"],[o("j5ffj"),"Ugh..."]],Ht=[[o("a2kyU"),"Hmm..."],[o("5d0DW"),"What?"],[o("3x4yY"),"What was that?"],[o("40XLk"),"Quiet out..."],[o("k4RLX"),"Jumpy tonight..."],[o("34gKi"),"I'm jumpin' at shadows..."],[o("9L8Sg"),"Ahh..."],[o("9L8Sg"),"Ahh..."],[o("a2kyU"),"Hmm..."],[o("5Fjgc"),"Aww..."],[o("7jABT"),"Rest me bones..."],[o("fgE4t"),"Oh well..."],[o("gGzmW"),"Case of the jitters..."],[o("aUMGA"),"Must be seeing..."],[o("hAB2v"),"What's in my coffee today?"],[o("j1q3e"),"Coffee must be too strong!"],[o("cp5Da"),"Hmm nothing..."],[o("k9vCo"),"Well I though I saw something."],[o("fzAkK"),"Nothing..."],[o("2mcEF"),"Hopefully nothing."],[o("2lUVX"),"Must be seeing things..."],[o("2lUVX"),"I must be seeing things."]],Bt=[[o("a2kyU"),"Hmm..."],[o("5d0DW"),"What?"],[o("bR2Qq"),"What?"],[o("dxMYB"),"Hey!"],[o("baOJW"),"Hey!"],[o("k2iei"),"Hey!"],[o("3x4yY"),"What was that?"],[o("egNqT"),"What was that?"],[o("QVkvm"),"What was that?"],[o("ggzCL"),"What was that?"],[o("h8bVj"),"What was that?"],[o("6wdzE"),"Huh?"],[o("5d0DW"),"What?"],[o("7Bgvb"),"Wha..."],[o("cc8Co"),"Wait!"],[o("3Vwq5"),"Who's out there?"],[o("fyl73"),"Hello?"],[o("j5ffj"),"Ugh..."],[o("4tABs"),"Hark?"],[o("4eWcK"),"What was that noise?"],[o("2IlHA"),"I heard something..."]],jt=[[o("a2kyU"),"Hmm..."],[o("3x4yY"),"What was that?"],[o("40XLk"),"Quiet out..."],[o("k4RLX"),"Jumpy tonight..."],[o("9L8Sg"),"Ahh..."],[o("9L8Sg"),"Ahh..."],[o("a2kyU"),"Hmm..."],[o("5Fjgc"),"Aww..."],[o("7jABT"),"Rest me bones..."],[o("fgE4t"),"Oh well..."],[o("gGzmW"),"Case of the jitters..."],[o("hAB2v"),"What's in my coffee today?"],[o("j1q3e"),"Coffee must be too strong!"],[o("cp5Da"),"Hmm nothing..."],[o("b4oBR"),"Can't hear it now."],[o("fzAkK"),"Nothing..."],[o("2mcEF"),"Hopefully nothing."],[o("bEpX3"),"I must be hearing things."]],Gt=[[o("a2kyU"),"Hmm..."],[o("dxMYB"),"Hey!"],[o("baOJW"),"Hey!"],[o("k2iei"),"Hey!"],[o("5d0DW"),"What?"],[o("zO13n"),"That noise again?"],[o("hPTSL"),"Someone there?"],[o("5TQSa"),"Who could that be?"],[o("h66m0"),"There it is again."],[o("iXaO0"),"Better check it out."],[o("kZ7gB"),"What keeps making those noises?"],[o("fBP7x"),"Better be rats!"],[o("4iRwq"),"Again!?"],[o("aQaIJ"),"Who is that?"],[o("jI1w6"),"Come out, Come out!"]],Wt=[[o("a2kyU"),"Hmm..."],[o("34gKi"),"Jumpin' at shadows!"],[o("k4RLX"),"Jumpy!"],[o("fgE4t"),"Oh, well."],[o("7OaPU"),"Guess it was nothing."],[o("eAAPp"),"Wonder what it was."],[o("Z94uH"),"Back to my post."],[o("2GAEF"),"All quiet now."],[o("bl9NP"),"I'm sure I heard something."],[o("avnp8"),"Not there anymore."],[o("2mxOl"),"Probably nothing."],[o("cp5Da"),"Hmm, nothing."],[o("bvdYU"),"I dont know why I work here."],[o("f5YJN"),"Waste of my time."],[o("h733p"),"Why do I even try."],[o("5iRGH"),"At least I'm not on cleaning duty."],[o("bodaa"),"At least my shift ends soon."],[o("jnTTO"),"What do you want me to do about it?"]],zt=[[o("k2iei"),"(To other guard) Hey!"],[o("5d0DW"),"(To other guard) What?"],[o("2uhoz"),"(To other guard) Where!?"],[o("4bkfm"),"(To other guard) Coming!"],[o("cBYcL"),"(To other guard) Here I come!"],[o("1ZzuO"),"(To other guard) To arms!"],[o("iYF5j"),"(To other guard) What is it!?"],[o("hSkKy"),"(To other guard) I dont know how to whistle."]],qt=[[o("iCpSW"),"(Whistles to other guards)"],[o("9upNV"),"(Whistles to other guards)"],[o("yZG5v"),"(Whistles to other guards)"],[o("f1guA"),"(Yells) Get 'em!"],[o("83TDO"),"(Yells) Intruder!"],[o("frVxF"),"(Yells) Oh no... it's a thief."],[o("hCPR7"),"(Yells) We're coming for you!"],[o("4Za6U"),"(Yells) Coming for you!"],[o("3Xk6I"),"(Yells) Halt!"],[o("dosUm"),"(Yells) We see you!"],[o("4gdwQ"),"(Yells) I'll get you!"],[o("aLkfr"),"(Yells) You're a goner!"],[o("kSLiP"),"(Yells) Just you wait!"],[o("2IENo"),"(Yells) You won't get away!"],[o("1CFiH"),"(Yells) No you dont!"],[o("llhgm"),"(Yells) Thief!"],[o("2eW7L"),"(Yells) Thief!"],[o("kZcsz"),"(Yells) Thief!"],[o("2qpAR"),"(Yells) After them!"],[o("cAyqi"),"(Yells) What is thy business with this gold?"],[o("aEQTO"),"(Yells) No mercy for the wicked!"]],Kt=[[o("ijfWN"),"Lost 'em!"],[o("7sWca"),"Must have run off..."],[o("fgE4t"),"Oh, well..."],[o("fevkE"),"Where did they go?"],[o("1B1JN"),"His Holiness would not be pleased!"],[o("jnuCJ"),"The boss will not be pleased!"],[o("cmvWY"),"(Huffing) I give up!"],[o("hMHBo"),"Where did he go!?"],[o("9Nz7S"),"Drats lost him!"],[o("9tCyg"),"Gone!"],[o("7ryfo"),"Come back here!"],[o("eLXb8"),"Rotten scoundrel!"],[o("8uLuu"),"Aargh!!"],[o("io7hj"),"He's not coming back!"],[o("8Mr4t"),"Blast!"],[o("3gcK8"),"Don't come back!"],[o("3N27a"),"You won't get away next time!"],[o("i8RlJ"),"His Holiness is a lord of mercy!"],[o("4vw0X"),"What a lousy day at work!"],[o("6aNdh"),"I give up..."],[o("i6vQ5"),"What do I do help me, help me..."],[o("5PMpx"),"Oh no, he got away!"],[o("2DFDi"),"(Guard rant)"]],$t=[[o("9L8Sg"),"(Yelling) Someone smacked me!"],[o("9L8Sg"),"(Yelling) Someone hit me!"],[o("9L8Sg"),"(Yelling) Who hit me!?"]],Yt=[[o("9L8Sg"),"(Yelling) We have a guard down"],[o("9L8Sg"),"(Yelling) Man down!"],[o("9L8Sg"),"(Yelling) Guard down!"]],Xt=[[o("9L8Sg"),"(Guard stirring) Ahh..."]],Qt=[[o("83TDO"),"We must have an intruder!"],[o("83TDO"),"I will keep an eye out!"]],Jt=[[o("527nu"),"Take that!!"],[o("54HwM"),"Oof!!"],[o("4e6QO"),"Ugg!!"],[o("7k3tw"),"Ahh!!"],[o("fcDaw"),"Ahh!!"],[o("fty2x"),"Hi-yah!"],[o("jFsow"),"Hi-yah!"],[o("cMmoo"),"Hi-yah!"]];class Zt{constructor(){this.activeHowls=[],this.activeLimit=2,this.fadeTime=1e3}setFadetime(e=1e3){return this.fadeTime=e,this}fade(e,t){return this.fadeTime>0?(e.fade(1,0,this.fadeTime,t),setTimeout((()=>e.stop(t)),this.fadeTime)):e.stop(t),this}empty(){for(let e of this.activeHowls)this.fade(...e);return this.activeHowls=[],this}queue(e,t){if(this.activeHowls.unshift([e,t]),this.activeHowls.length>this.activeLimit){const e=this.activeHowls.pop();this.fade(...e)}return this.activeHowls=this.activeHowls.slice(0,this.activeLimit),this}}class en{constructor(e,t=null){this.howls=e.map((e=>new vt({src:[e]}))),this.howlNum=0,this.soundPool=t,b(this.howls)}play(e){const t=this.next();t.volume(e);try{const e=t.play();return null!==this.soundPool&&this.soundPool.queue(t,e),e}catch(e){console.log(`Audio playback error ${t}`,e)}return-1}next(){return this.howlNum++,this.howlNum==this.howls.length&&(this.howlNum=0,b(this.howls)),this.howls[this.howlNum]}}class tn{constructor(e,t=null){this.sounds=e.map(nn),this.soundNum=0,this.soundPool=t,this.mute=!1,b(this.sounds)}play(e){const t=this.next();if(!this.mute){t.sound.volume(e);const n=t.sound.play();null!==this.soundPool&&this.soundPool.queue(t.sound,n)}return t}next(){const e=this.sounds[this.soundNum];return++this.soundNum,this.soundNum===this.sounds.length&&(this.soundNum=0,b(this.sounds)),e}}function nn(e){return{sound:new vt({src:[e[0]]}),subtitle:e[1]}}function rn(e,t,n){e.footstepWood=new en([Tt]),e.footstepTile=new en([It]),e.footstepWater=new en([Et]),e.footstepGravel=new en([At]),e.footstepGrass=new en([kt]),e.footstepCreaky=new en(Ct),e.victorySong=new en([yt]),e.levelRequirementJingle=new en([bt],n),e.levelCompleteJingle=new en([wt],n),e.gameOverJingle=new en([_t],n),e.easterEgg=new en([St],n),e.hitPlayer=new en(xt),e.hitGuard=new en(Rt),e.coin=new en(Lt),e.grunt=new en(Mt),e.douse=new en(Pt),e.ignite=new en(Dt),e.hide=new en(Nt),e.gate=new en(Ot),e.jump=new en(Ft),e.tooHigh=new en(Ut),t.guardInvestigate=new tn(Gt,n),t.guardFinishInvestigating=new tn(Wt,n),t.guardSeeThief=new tn(Vt),t.guardFinishLooking=new tn(Ht,n),t.guardChase=new tn(qt,n),t.guardEndChase=new tn(Kt,n),t.guardHearGuard=new tn(zt,n),t.guardHearThief=new tn(Bt,n),t.guardAwakesWarning=new tn($t,n),t.guardDownWarning=new tn(Yt,n),t.guardWarningResponse=new tn(Qt,n),t.guardFinishListening=new tn(jt,n),t.guardDamage=new tn(Jt,n),t.guardStirring=new tn(Xt,n)}const on={left:!1,right:!1,up:!1,down:!1,jumpLeft:!1,jumpRight:!1,jumpUp:!1,jumpDown:!1,los:!1,wait:!1,jump:!1,zoomIn:!1,zoomOut:!1,snapToPlayer:!1,panUp:!1,panDown:!1,panLeft:!1,panRight:!1,menu:!1,menuNext:!1,menuPrev:!1,menuClose:!1,home:!1,homePlay:!1,homeDaily:!1,homeStats:!1,homeOptions:!1,jumpToggle:!1,restart:!1,heal:!1,startLevel:!1,exitLevel:!1,guardMute:!1,volumeMute:!1,volumeDown:!1,volumeUp:!1,forceRestart:!1,resetState:!1,seeAll:!1,collectLoot:!1,markSeen:!1,guardSight:!1,guardPatrols:!1,nextLevel:!1,prevLevel:!1,gamepadStyleTouch:!1,fullscreen:!1,serverConfig:!1,today:!1,priorDay:!1,nextDay:!1,scrollUp:!1,scrollDown:!1},sn={...on};var an=null;const ln={BracketLeft:["zoomOut"],BracketRight:["zoomIn"],ArrowLeft:["left","menuPrev"],KeyA:["left","menuPrev"],Numpad4:["left","menuPrev"],ArrowRight:["right","menuNext"],KeyX:["home"],KeyP:["homePlay"],KeyO:["homeOptions"],KeyD:["right","homeDaily","menuNext"],Numpad6:["right","menuNext"],KeyL:["right","menuNext"],ArrowUp:["up"],KeyW:["up"],Numpad8:["up"],KeyK:["up"],ArrowDown:["down"],KeyS:["down","homeStats"],Numpad2:["down"],KeyJ:["down"],Period:["wait"],Space:["wait"],KeyZ:["wait"],Shift:["jump"],KeyF:["jumpToggle","fullscreen"],NumpadAdd:["jumpToggle","nextDay"],NumpadSubtract:["priorDay"],KeyT:["gamepadStyleTouch"],Escape:["menu","menuClose"],Slash:["menu","menuClose"],KeyR:["restart"],KeyC:["serverConfig"],KeyH:["heal"],KeyN:["startLevel"],Digit9:["guardMute"],Digit0:["volumeMute","today"],Minus:["volumeDown","priorDay"],Equal:["volumeUp","nextDay"],PageUp:["scrollUp"],PageDown:["scrollDown"],"Control+Space":["snapToPlayer"],"Control+Period":["snapToPlayer"],"Control+ArrowUp":["panUp"],"Control+KeyW":["panUp"],"Control+KeyJ":["panUp"],"Control+Numpad8":["panUp"],"Control+ArrowDown":["panDown"],"Control+KeyS":["panDown"],"Control+KeyK":["panDown"],"Control+Numpad2":["panDown"],"Control+ArrowLeft":["panLeft"],"Control+KeyA":["panLeft"],"Control+KeyH":["panLeft"],"Control+Numpad4":["panLeft"],"Control+ArrowRight":["panRight"],"Control+KeyD":["panRight"],"Control+KeyL":["panRight"],"Control+Numpad6":["panRight"],"Control+KeyR":["forceRestart"],"Alt+KeyR":["resetState"],"Alt+KeyA":["seeAll"],"Alt+KevC":["collectLoot"],"Alt+KeyS":["markSeen"],"Alt+KeyV":["guardSight"],"Alt+KeyP":["guardPatrols"],"Alt+Comma":["prevLevel"],"Alt+Period":["nextLevel"]};class un extends Array{constructor(e=0,t=0,n=0,i=0){super(e,t,n,i)}collide(e,t,n=0,i=0){return this[0]<e+n&&this[0]+this[2]>e&&this[1]<t+i&&this[1]+this[3]>t}}class cn{preventDefault=!0;currentFramePresses=new Set;currentFrameReleases=new Set;constructor(){this.controlStates={...sn},this.controlTimes={};for(const e in this.controlStates)this.controlTimes[e]=Date.now()}set(e,t=!0,n=!0){this.controlStates[e]=t,on[e]=t,this.controlTimes[e]=Date.now(),n&&(t?this.currentFramePresses.add(e):this.currentFrameReleases.add(e)),an=this}endFrame(){this.currentFramePresses.clear(),this.currentFrameReleases.clear()}vibrate(e,t,n){}}class hn extends cn{constructor(e=null){super(),null==e&&(e=ln),this.keyMap=e;let t=this;const n=document.querySelector("html");n&&(n.onkeydown=function(e){t.keyDownHandler(e)},n.onkeyup=function(e){t.keyUpHandler(e)})}getCode(e,t=!1){let n=e.code;return e.altKey&&"AltLeft"!==e.code&&"AltRight"!==e.code&&(n="Alt+"+n),e.shiftKey&&t&&"ShiftLeft"!==e.code&&"ShiftRight"!==e.code&&(n="Shift+"+n),e.ctrlKey&&"ControlLeft"!==e.code&&"ControlRight"!==e.code&&(n="Control+"+n),"AltLeft"!=e.code&&"AltRight"!=e.code||(n="Alt"),"ShiftLeft"!=e.code&&"ShiftRight"!=e.code||(n="Shift"),"ControlLeft"!=e.code&&"ControlRight"!=e.code||(n="Control"),n}updateModifierDown(e){for(let t in this.keyMap){const n=this.keyMap[t];for(let i of n)!t.includes(e)&&this.controlStates[i]&&(this.controlStates[i]=!1)}}updateModifierUp(e){for(let t in this.keyMap){const n=this.keyMap[t];for(let i of n)t.includes(e)&&this.controlStates[i]&&(this.controlStates[i]=!1)}}keyDownHandler(e){an=this;const t=this.getCode(e);if(["Alt","Control"].includes(t)&&this.updateModifierDown(t),t in this.keyMap){this.preventDefault&&e.preventDefault();const n=this.keyMap[t];for(let e of n)this.controlStates[e]||this.set(e,!0)}}keyUpHandler(e){const t=this.getCode(e);if(["Alt","Control"].includes(t)&&this.updateModifierUp(t),t in this.keyMap){this.preventDefault&&e.preventDefault();const n=this.keyMap[t];for(let e of n)this.set(e,!1)}}}class dn extends cn{constructor(e){super(),this.gamepad=e,this.thresh=.4,this.internalStates={...this.controlStates}}set(e,t=!0){this.internalStates[e]!=t&&(this.internalStates[e]=t,super.set(e,t))}vibrate(e,t,n){}}class fn{constructor(){let e=this;window.addEventListener("gamepadconnected",(function(t){e.connected(t)})),window.addEventListener("gamepaddisconnected",(function(t){e.disconnected(t)})),this.gamepads={}}connected(e){this.gamepads[e.gamepad.index]=new dn(e.gamepad)}disconnected(e){this.gamepads[e.gamepad.index];delete this.gamepads[e.gamepad.index]}updateGamepadStates(){let e=navigator.getGamepads();if(null!=e)for(let t of e){if(null==t)continue;let e=this.gamepads[t.index];e.gamepad=t,e.set("jump",this.buttonPressed(t.buttons[0])),e.set("wait",this.buttonPressed(t.buttons[2])),e.set("zoomIn",this.buttonPressed(t.buttons[6])),e.set("zoomOut",this.buttonPressed(t.buttons[7])),e.set("fullscreen",this.buttonPressed(t.buttons[8])),e.set("menu",this.buttonPressed(t.buttons[9])),e.set("left",this.buttonPressed(t.buttons[14])||t.axes[0]<-e.thresh&&t.axes[0]<-.5*Math.abs(t.axes[1])),e.set("right",this.buttonPressed(t.buttons[15])||t.axes[0]>e.thresh&&t.axes[0]>.5*Math.abs(t.axes[1])),e.set("up",this.buttonPressed(t.buttons[12])||t.axes[1]<-e.thresh&&t.axes[1]<-.5*Math.abs(t.axes[0])),e.set("down",this.buttonPressed(t.buttons[13])||t.axes[1]>e.thresh&&t.axes[1]>-.5*Math.abs(t.axes[0])),e.set("panLeft",t.axes[2]<-e.thresh&&t.axes[2]<-.5*Math.abs(t.axes[3])),e.set("panRight",t.axes[2]>e.thresh&&t.axes[2]>.5*Math.abs(t.axes[3])),e.set("panUp",t.axes[3]<-e.thresh&&t.axes[3]<-.5*Math.abs(t.axes[2])),e.set("panDown",t.axes[3]>e.thresh&&t.axes[3]>-.5*Math.abs(t.axes[2]))}}buttonPressed(e){return e.pressed}}class pn extends cn{mouseActive=!1;targetOnTouchDown=null;constructor(e,t){super(),this.canvas=e;let n=this;e.addEventListener("touchstart",(function(e){n.process_touchstart(e)}),!0),e.addEventListener("touchmove",(function(e){n.process_touchmove(e)}),!0),e.addEventListener("touchcancel",(function(e){n.process_touchend(e)}),!0),e.addEventListener("touchend",(function(e){n.process_touchend(e)}),!0),e.addEventListener("mousedown",(function(e){n.process_mousedown(e)}),!0),e.addEventListener("mouseup",(function(e){n.process_mouseup(e)}),!0),e.addEventListener("mousemove",(function(e){n.process_mousemove(e)}),!0);this.screenDimensions=[0,0],this.lastMotion={id:-1,active:!1,x0:0,y0:0,x:0,y:0},this.coreTouchTargets={up:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},down:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},left:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},right:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},jumpUp:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},jumpDown:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},jumpLeft:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},jumpRight:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},wait:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},exitLevel:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},jump:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},pan:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"press",tileInfo:null},zoomIn:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"always",tileInfo:null},zoomOut:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"always",tileInfo:null},restart:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"always",tileInfo:null},forceRestart:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"always",tileInfo:null},menu:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"always",tileInfo:null},fullscreen:{id:-1,active:!0,view:new un,game:new un,touchXY:[0,0],trigger:"release",show:"always",tileInfo:null}},this.touchTargets=this.coreTouchTargets,this.setTouchConfig(t)}setTouchConfig(e){if(e){for(let e of["up","down","left","right","wait","jump","pan"])this.coreTouchTargets[e].trigger="press",this.coreTouchTargets[e].show="always";for(let e of["jumpUp","jumpDown","jumpLeft","jumpRight"])this.coreTouchTargets[e].trigger="press",this.coreTouchTargets[e].show="press"}else{for(let e of["exitLevel"])this.coreTouchTargets[e].trigger="press",this.coreTouchTargets[e].show="always";for(let e of["up","down","left","right","pan","jumpUp","jumpDown","jumpLeft","jumpRight","wait","jump"])this.coreTouchTargets[e].trigger="release",this.coreTouchTargets[e].show="press"}}clearMotion(){this.lastMotion.active=!1,this.lastMotion.id=-1,this.lastMotion.x0=0,this.lastMotion.y0=0,this.lastMotion.x=0,this.lastMotion.y=0,this.targetOnTouchDown=null}updateCoreTouchTarget(e,t,n,i){const r=this.coreTouchTargets[e];r.view=n,r.game=t,r.tileInfo=i,r.view.collide(r.touchXY[0],this.canvas.clientHeight-r.touchXY[1])||this.controlStates[e]&&-1!=r.id&&(this.set(e,!1,!1),r.id=-1)}activateTouchTargets(e){this.touchTargets=void 0===e?this.coreTouchTargets:{...this.coreTouchTargets,...e}}process_mousedown(e){an=this,this.mouseActive=!0,this.lastMotion.id=-2,this.lastMotion.active=!1,this.lastMotion.x0=e.clientX,this.lastMotion.y0=this.canvas.clientHeight-e.clientY,this.lastMotion.x=e.clientX,this.lastMotion.y=this.canvas.clientHeight-e.clientY,this.targetOnTouchDown=null;for(let t in this.touchTargets){let n=this.touchTargets[t];n.view.collide(e.clientX,this.canvas.clientHeight-e.clientY)&&(n.touchXY=[e.clientX,e.clientY],n.id=-2,this.set(t,!0),this.targetOnTouchDown=t)}this.preventDefault&&e.preventDefault()}process_mousemove(e){an=this,this.mouseActive=!0,-2==this.lastMotion.id&&(this.lastMotion.active=!0,this.lastMotion.x=e.clientX,this.lastMotion.y=this.canvas.clientHeight-e.clientY);for(let t in this.touchTargets){let n=this.touchTargets[t];if(-2==n.id){n.view.collide(e.clientX,this.canvas.clientHeight-e.clientY)?n.touchXY=[e.clientX,e.clientY]:(this.set(t,!1,!1),n.id=-1)}else if("release"==n.trigger&&(null==this.targetOnTouchDown||this.targetOnTouchDown==t)){n.view.collide(e.clientX,this.canvas.clientHeight-e.clientY)&&(n.touchXY=[e.clientX,e.clientY],this.set(t,!0),n.id=-2)}}this.preventDefault&&e.preventDefault()}process_mouseup(e){for(const e in this.touchTargets){const t=this.touchTargets[e];this.controlStates[e]&&(t.id=-1,this.set(e,!1,"press"===t.trigger||e===this.targetOnTouchDown),this.controlTimes[e]=0)}this.clearMotion(),this.preventDefault&&e.preventDefault()}process_touchstart(e){an=this,this.mouseActive=!1,this.targetOnTouchDown=null;for(let t of e.changedTouches){this.lastMotion.id=t.identifier,this.lastMotion.active=!1,this.lastMotion.x0=t.clientX,this.lastMotion.y0=this.canvas.clientHeight-t.clientY,this.lastMotion.x=t.clientX,this.lastMotion.y=this.canvas.clientHeight-t.clientY;for(let e in this.touchTargets){let n=this.touchTargets[e];n.view.collide(t.clientX,this.canvas.clientHeight-t.clientY)&&(n.touchXY=[t.clientX,t.clientY],n.id=t.identifier,this.targetOnTouchDown=e,this.set(e,!0))}}this.preventDefault&&e.preventDefault()}process_touchmove(e){this.mouseActive=!1;for(let t of e.changedTouches){this.lastMotion.id==t.identifier&&(this.lastMotion.active=!0,this.lastMotion.x=t.clientX,this.lastMotion.y=this.canvas.clientHeight-t.clientY);for(let e in this.touchTargets){let n=this.touchTargets[e];if(n.id==t.identifier){n.view.collide(t.clientX,this.canvas.clientHeight-t.clientY)?n.touchXY=[t.clientX,t.clientY]:(n.id=-1,this.set(e,!1,!1))}else if(-1==n.id&&"release"==n.trigger&&(null==this.targetOnTouchDown||this.targetOnTouchDown==e)){n.view.collide(t.clientX,this.canvas.clientHeight-t.clientY)&&(n.touchXY=[t.clientX,t.clientY],n.id=t.identifier,this.set(e,!0))}}}this.preventDefault&&e.preventDefault()}process_touchend(e){this.mouseActive=!1;for(let t of e.changedTouches){for(const e in this.touchTargets){const n=this.touchTargets[e];n.id==t.identifier&&(n.id=-1,this.set(e,!1,"press"===n.trigger||e===this.targetOnTouchDown),this.controlTimes[e]=0)}this.lastMotion.id==t.identifier&&this.clearMotion()}this.preventDefault&&e.preventDefault()}vibrate(e,t,n){window.navigator.vibrate(n)}}let mn;var gn;(gn=mn||(mn={}))[gn.HomeScreen=0]="HomeScreen",gn[gn.StatsScreen=1]="StatsScreen",gn[gn.OptionsScreen=2]="OptionsScreen",gn[gn.Mansion=3]="Mansion",gn[gn.BetweenMansions=4]="BetweenMansions",gn[gn.Dead=5]="Dead",gn[gn.Win=6]="Win",gn[gn.DailyHub=7]="DailyHub",gn[gn.ServerConfig=8]="ServerConfig";class vn{pages=[];activePage=0;activePageData=[];highlightedAction=-1;actionSequence=[];cachedPageText="";touchTargetsDirty=!1;state={};glyphs=[];maxLineLength=0;scaleLargestX=0;scaleLargestY=0;scaleFactor=0;pixelsPerCharX=0;pixelsPerCharY=0;linesPixelSizeX=0;linesPixelSizeY=0;numCharsX=0;numCharsY=0;offsetX=0;offsetY=0;textW=8;textH=16;constructor(){this.mat=a.create(),this.screenSize=s.create(),this.touchTargets={}}initAction(e){this.touchTargets[e]={id:-1,active:!0,game:new un(0,0,0,0),view:new un(0,0,0,0),trigger:"release",tileInfo:{},show:"always",touchXY:[-1,-1]}}nextPage(){this.activePage=Math.min(this.pages.length-1,this.activePage+1),this.touchTargetsDirty=!0}prevPage(){this.activePage=Math.max(0,this.activePage-1),this.touchTargetsDirty=!0}parseImage(e,t,n,i){const r=e.slice(t+2).indexOf("#");if(r<0)return[e,t];const o=Number(e.slice(t+1,t+2+r));return Number.isNaN(o)?[e,t]:(this.glyphs.push([o,new un(t,i-n-.875,2,1)]),[e=e.slice(0,t)+"  "+e.slice(t+3+r),t+1])}parseButton(e,t,n,i){const r=t;let o,s;for(;;){if(o=e.slice(t).indexOf("|"),o<0)return[e,t];if(o+=t,s=e.slice(o+1).indexOf("]"),s<0)return[e,t];if(s+=o+1,t===o)break;"#"===e[t]&&([e,t]=this.parseImage(e,t,n,i)),t+=1}const a=e.slice(o+1,s);if(void 0!==a&&""!==a){a in this.touchTargets||this.initAction(a);const e=[r,t+1,n],[o,s]=[e[0],e[2]-1/8],[l,u]=[e[1],e[2]+1];this.touchTargets[a].game=new un(o,i-u,l-o,u-s),this.actionSequence.push(a)}return[e=e.slice(0,o)+e.slice(s),t=o]}parseUI(){let e=this.pages[this.activePage];const t=this.state;for(const n in t)e=e.replace("$"+n+"$",String(t[n]));if(e===this.cachedPageText)return;this.cachedPageText=e,this.activePageData=e.split("\n");const n=this.activePageData;this.glyphs.length=0,this.actionSequence=[],this.touchTargets={};for(let e=0;e<n.length;++e){let t=n[e],i=0;for(;i<t.length;){switch(t[i]){case"#":[t,i]=this.parseImage(t,i,e,n.length);break;case"[":[t,i]=this.parseButton(t,i,e,n.length)}i+=1}n[e]=t}}updateScreenSize(e){this.screenSize=e,this.maxLineLength=0;for(const e of this.activePageData)this.maxLineLength=Math.max(this.maxLineLength,e.length);this.scaleLargestX=Math.max(1,Math.floor(e[0]/(65*this.textW))),this.scaleLargestY=Math.max(1,Math.floor(e[1]/(22*this.textH))),this.scaleFactor=Math.min(this.scaleLargestX,this.scaleLargestY),this.pixelsPerCharX=8*this.scaleFactor,this.pixelsPerCharY=16*this.scaleFactor,this.linesPixelSizeX=this.maxLineLength*this.pixelsPerCharX,this.linesPixelSizeY=this.activePageData.length*this.pixelsPerCharY,this.numCharsX=e[0]/this.pixelsPerCharX,this.numCharsY=e[1]/this.pixelsPerCharY,this.offsetX=Math.floor((e[0]-this.linesPixelSizeX)/-2)/this.pixelsPerCharX,this.offsetY=Math.floor((e[1]-this.linesPixelSizeY)/-2)/this.pixelsPerCharY,this.mat=a.create(),a.ortho(this.mat,this.offsetX,this.offsetX+this.numCharsX,this.offsetY,this.offsetY+this.numCharsY,1,-1)}pixelCoords(e){return[(e[0]-this.offsetX)*this.pixelsPerCharX,(e[1]-this.offsetY)*this.pixelsPerCharY]}textCoords(e){return[e[0]/this.pixelsPerCharX+this.offsetX,e[1]/this.pixelsPerCharY+this.offsetY]}getTouchData(){for(let e in this.touchTargets){const t=this.touchTargets[e],n=t.game,[i,r]=this.pixelCoords([n[0],n[1]]),[o,s]=this.pixelCoords([n[2]+n[0],n[3]+n[1]]);t.view=new un(i,r,o-i,s-r)}return this.touchTargets}render(e){const t=this.activePageData,n=this.mat,i=this.maxLineLength,r=dt().background;e.start(n,0),e.addGlyph(-2,-1,i+2,t.length+1,r),e.flush(),e.start(n,0);for(let t in this.touchTargets){const n=this.touchTargets[t].game;if(an?.controlStates[t]&&(this.highlightedAction=this.actionSequence.indexOf(t)),this.touchTargets[t].active){const i=this.actionSequence[this.highlightedAction]===t?4291829936:4286586976;e.addGlyph(n[0],n[1],n[0]+n[2],n[1]+n[3],{textureIndex:r.textureIndex,color:i})}else this.actionSequence[this.highlightedAction]===t&&e.addGlyph(n[0],n[1],n[0]+n[2],n[1]+n[3],{textureIndex:r.textureIndex,color:4285558896})}e.flush(),e.start(n,1);for(const t of this.glyphs){const n=t[1];e.addGlyph(n[0],n[1],n[2]+n[0],n[3]+n[1],{textureIndex:t[0],color:ut})}e.flush(),e.start(n,0);for(let n=0;n<t.length;++n){const i=t.length-(1+n);for(let r=0;r<t[n].length;++r){const o=r;if(" "===t[n])continue;const s=t[n].charCodeAt(r);e.addGlyph(o,i,o+1,i+1,{textureIndex:s,color:4293849343})}}e.flush()}updateData(e){}update(e){}navigateUI(e){let t="";return e("up")?(this.highlightedAction--,this.highlightedAction<0&&(this.highlightedAction=this.actionSequence.length-1)):e("down")?(this.highlightedAction++,this.highlightedAction>=this.actionSequence.length&&(this.highlightedAction=0)):(this.highlightedAction>=0&&this.touchTargets[this.actionSequence[this.highlightedAction]]?.active&&e("wait")||e("jump"))&&(t=this.actionSequence[this.highlightedAction]),t}onControls(e,t){}}class yn extends vn{pages=["             Lurk Leap Loot\n     James McNeill and Damien Moore       \n\n            [P|homePlay]:        Play game\n            [D|homeDaily]:  Daily challenge\n            [S|homeStats]:       Statistics\n            [O|homeOptions]:          Options"];constructor(){super()}update(e){}onControls(e,t){const n=this.navigateUI(t);(t("homePlay")||"homePlay"==n)&&(e.rng=new v,e.dailyRun=null,_T(e)),t("homeDaily")||"homeDaily"==n?e.gameMode=mn.DailyHub:t("homeStats")||"homeStats"==n?e.gameMode=mn.StatsScreen:(t("homeOptions")||"homeOptions"==n)&&(e.gameMode=mn.OptionsScreen)}}class bn extends vn{pages=["                  Options\n\n[T|gamepadStyleTouch]      Touch controls as $touchMode$\n[Ctrl+R|forceRestart] Reset data\n\n[Esc|menu]    Back to menu"];update(e){let t=window.localStorage.getItem("touchMode");null===t&&(t=e.touchAsGamepad?"Gamepad":"Mouse",window.localStorage.setItem(t,t)),this.state.touchMode=t}onControls(e,t){const n=this.navigateUI(t);if(t("menu")||"menu"==n)e.gameMode=mn.HomeScreen;else if(t("gamepadStyleTouch")||"gamepadStyleTouch"==n){"Gamepad"==window.localStorage.getItem("touchMode")?(e.touchAsGamepad=!1,e.touchController.setTouchConfig(!1),window.localStorage.setItem("touchMode","Mouse")):(e.touchAsGamepad=!0,e.touchController.setTouchConfig(!0),window.localStorage.setItem("touchMode","Gamepad"))}else(t("forceRestart")||"forceRestart"==n)&&(window.localStorage.clear(),e.stats=yT(),e.gameMode=mn.HomeScreen)}}class wn extends vn{pages=[`                       Daily Challenge\n\n            $dailyStatus$\n\n            $dailyServerStatus$\n\n            Last played:        $lastPlayed$\n            Last score:         $lastScore$\n            Best winning score: $bestScore$\n\n            Total daily runs:   $dailyPlays$\n            Total daily wins:   $dailyWins$\n            Perfect runs:       $dailyPerfect$\n            Win streak:         $dailyWinStreak$\n\n\n1/2    [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Back to menu`,`                  Daily Challenge Results\n\n    Challenge ending $tableHeading$\n    Your rank: $dayRanking$\n    $playMode$\n\n$scoreTable$\n\n    [PgUp|scrollUp] Scroll up  [PgDn|scrollDown] Scroll down\n    [-|priorDay] Prior day     [+|nextDay] Next day   [0|today]  Current day\n\n2/2 [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Back to menu`];scoreTablePos=0;scoreTableCount=8;scoreTableDate=null;endTimeForDate(e){const t=new Date(e);return t.setUTCHours(24,0,0,0),t}prevDay(e){const t=new Date(e);return t.setDate(t.getDate()-1),t}nextDay(e){const t=new Date(e);t.setDate(t.getDate()+1);const n=new Date;return n.setUTCHours(24,0,0,0),t>n?e:t}timeToMidnightUTC(){const e=new Date,t=new Date(e);t.setUTCHours(24,0,0,0);const n=t.getTime()-e.getTime();Math.floor(n%1e3/100);var i=Math.floor(n/1e3%60),r=Math.floor(n/6e4%60);return Math.floor(n/36e5%24).toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")}update(e){const t=window.localStorage.getItem("lastDaily");if(null!==t&&t===xT()?(this.state.dailyStatus="Today's game completed\n            Time to next game: "+this.timeToMidnightUTC(),this.state.playMode=e.scoreServer.user?"[P|homePlay] Replay this game seed in non-challenge mode":""):(this.state.dailyStatus="[P|homePlay] Play daily game now\n            Time left to submit: "+this.timeToMidnightUTC(),this.state.playMode="[P|homePlay] Play daily game now"),0==this.activePage&&(null!==e.scoreServer.user?this.state.dailyServerStatus=`Signed in as ${e.scoreServer.user.displayName?.slice(0,20).replace("]",")").replace("[","(")}\n            [X|home] Signout [C|serverConfig] Configure`:this.state.dailyServerStatus="[R|restart] register or sign in\n            to track your scores online",this.state.lastPlayed=e.stats.lastDaily.date,this.state.lastScore=e.stats.lastDaily.score,this.state.bestScore=e.stats.bestDailyScore,this.state.dailyPlays=e.stats.dailyPlays,this.state.dailyWins=e.stats.dailyWins,this.state.dailyPerfect=e.stats.dailyPerfect,this.state.dailyWinStreak=e.stats.dailyWinStreak),1==this.activePage)if(null===e.scoreServer.user)this.state.scoreTable="    No score data available.",this.state.tableHeading="",this.state.dayRanking="N/A";else if(null===e.scoreServer.scoreData)this.state.scoreTable="    Loading...",this.state.tableHeading="",this.state.dayRanking="Loading...";else{const[t,n,i,r]=e.scoreServer.getFormattedScoreData(this.scoreTablePos,this.scoreTableCount,"");this.state.scoreTable=t,this.state.tableHeading=this.scoreTableDate?.toLocaleString(),this.state.dayRanking=e.scoreServer.userScoreRanking+" of "+e.scoreServer.scoreData.length}}onControls(e,t){const n=this.navigateUI(t);if(t("menu")||"menu"==n||t("menuClose")||"menuClose"==n)e.gameMode=mn.HomeScreen;else if(t("homePlay")||"homePlay"==n){let t;if(0==this.activePage)t=xT();else{if(null===e.scoreServer.scoreDate)return;t=xT(e.scoreServer.scoreDate,!1)}if(e.rng=new v("Daily "+t),"T"!==this.state.dailyStatus[0]){window.localStorage.setItem("lastDaily",t),e.dailyRun=t}else e.dailyRun=null;_T(e)}else if(t("left")||"left"==n||t("menuPrev")||"menuPrev"==n)this.prevPage();else if(t("right")||"right"==n||t("menuNext")||"menuNext"==n){const t=this.activePage;this.nextPage(),1===this.activePage&&0===t&&(this.scoreTableDate=this.endTimeForDate(new Date),e.scoreServer.getScoresForDate(this.scoreTableDate))}else if(t("today")||"today"==n){if(!this.scoreTableDate)return;this.scoreTablePos=0,this.scoreTableDate=this.endTimeForDate(new Date),e.scoreServer.getScoresForDate(this.scoreTableDate)}else if(t("nextDay")||"nextDay"==n){if(!this.scoreTableDate)return;this.scoreTablePos=0,this.scoreTableDate=this.nextDay(this.scoreTableDate),e.scoreServer.getScoresForDate(this.scoreTableDate)}else if(t("priorDay")||"priorDay"==n){if(!this.scoreTableDate)return;this.scoreTablePos=0,this.scoreTableDate=this.prevDay(this.scoreTableDate),e.scoreServer.getScoresForDate(this.scoreTableDate)}else if(t("scrollUp")||"scrollUp"==n){if(null===e.scoreServer.scoreData)return;this.scoreTablePos=Math.max(this.scoreTablePos-this.scoreTableCount,0)}else if(t("scrollDown")||"scrollDown"==n){if(null===e.scoreServer.scoreData)return;this.scoreTablePos=Math.min(this.scoreTablePos+this.scoreTableCount,e.scoreServer.scoreData.length-this.scoreTableCount)}else t("home")||"home"==n?e.scoreServer.signOut():t("restart")||"restart"==n?(e.keyboardController.preventDefault=!1,e.touchController.preventDefault=!1,e.gameMode=mn.ServerConfig,e.scoreServer.openSignInPopup((()=>{e.gameMode=mn.DailyHub,e.keyboardController.preventDefault=!0,e.touchController.preventDefault=!0}))):(t("serverConfig")||"serverConfig"==n)&&(console.log("Server config",n),e.keyboardController.preventDefault=!1,e.touchController.preventDefault=!1,e.gameMode=mn.ServerConfig,e.scoreServer.openConfigPopup((()=>{e.gameMode=mn.DailyHub,e.keyboardController.preventDefault=!0,e.touchController.preventDefault=!0})))}}class _n extends vn{pages=[`                   Play Statistics\n\n            Total plays:             $totalPlays$\n            Total wins:              $totalWins$\n            Total loot:              $totalGold$\n            Total mansions ghosted:  $totalGhosts$\n            Total mansions looted:   $totalLootSweeps$\n            Best winning score:      $bestScore$\n\n1/2    [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Back to menu`,`                     Achievements\n\n$achievements$\n\n2/2    [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Back to menu`];update(e){0==this.activePage?(this.state.totalPlays=e.stats.totalPlays,this.state.totalWins=e.stats.totalWins,this.state.totalGold=e.stats.totalGold,this.state.totalGhosts=e.stats.totalGhosts,this.state.totalLootSweeps=e.stats.totalLootSweeps,this.state.bestScore=e.stats.bestScore):1==this.activePage&&(this.state.achievements="")}onControls(e,t){const n=this.navigateUI(t);t("menu")||"menu"==n||t("menuClose")||"menuClose"==n?e.gameMode=mn.HomeScreen:t("left")||"left"==n||t("menuPrev")||"menuPrev"==n?this.prevPage():(t("right")||"right"==n||t("menuNext")||"menuNext"==n)&&this.nextPage()}}class Sn extends vn{pages=["   Mansion $level$ Complete!\n\nMansion Statistics\nLoot stolen:     $lootStolen$ / $lootAvailable$\nGhost bonus:     $ghostBonus$\nTimely delivery: $timeBonus$\nMansion total:   $totalScore$\n\nCurrent loot:    $loot$\n[H|heal]: Heal one heart for $$healCost$\n[N|startLevel]: Next mansion"];update(e){this.state.level=e.level+1,this.state.lootStolen=e.lootStolen,this.state.lootAvailable=e.lootAvailable,this.state.ghostBonus=e.ghostBonus,this.state.timeBonus=YS(e),this.state.totalScore=this.state.lootStolen+this.state.timeBonus+this.state.ghostBonus,this.state.loot=e.player.loot,this.state.healCost=e.healCost}onControls(e,t){const n=this.navigateUI(t);t("zoomIn")||"zoomIn"==n?(e.zoomLevel=Math.max(1,e.zoomLevel-1),e.camera.snapped=!1):t("zoomOut")||"zoomOut"==n?(e.zoomLevel=Math.min(10,e.zoomLevel+1),e.camera.snapped=!1):t("restart")||"restart"==n?(e.rng=new v,e.dailyRun=null,_T(e)):t("heal")||"heal"==n?function(e){if(e.player.health>=ne)return;if(e.player.loot<e.healCost)return;e.player.loot-=e.healCost,e.gameStats.lootSpent+=e.healCost,e.player.health+=1,e.healCost*=2}(e):t("startLevel")||"startLevel"==n?function(e){if(e.level+=1,e.level>=OS.numGameMaps)return void _T(e);e.activeSoundPool.empty(),e.gameMap=we(e.level,e.gameMapRoughPlans[e.level],e.rng),e.lightStates=new Array(e.gameMap.lightCount).fill(0),wT(e.gameMap,e),bT(e.gameMap,e),e.topStatusMessage=qS,e.topStatusMessageSticky=!0,e.finishedLevel=!1,e.healCost+=1;const t=e.gameStats;t.lootStolen+=e.lootStolen,t.maxLootStolen+=e.lootAvailable,t.ghostBonuses+=e.ghostBonus,t.maxGhostBonuses+=5,t.timeBonuses+=YS(e),t.maxTimeBonuses+=e.maxTimeBonus,t.lootSpent+=e.lootSpent,e.turns=0,e.lootStolen=0,e.lootSpent=0,e.lootAvailable=e.gameMapRoughPlans[e.level].totalLoot,e.ghostBonus=5,e.maxTimeBonus=5,e.player.pos=e.gameMap.playerStartPos,e.player.dir=s.fromValues(0,-1),e.player.noisy=!1,e.player.hasVaultKey=!1,e.player.damagedLastTurn=!1,e.player.turnsRemainingUnderwater=0,e.popups.clear(),e.camera=mT(e.gameMap.playerStartPos),e.gameMode=mn.Mansion}(e):(t("menu")||"menu"==n)&&(e.helpActive=!0)}}class Tn extends vn{pages=["         You are dead!\n\nStatistics\nLoot stolen:   $lootStolen$ / $maxLootStolen$\nGhost bonuses: $ghostBonuses$ / $maxGhostBonuses$\nTime bonuses:  $timeBonuses$ / $maxTimeBonuses$\nLoot spent:    $lootSpent$\n\nFinal loot:    $loot$\n\n[R|restart]: Start new game\n[Esc|menu]: Exit to home screen"];update(e){this.state.lootStolen=e.gameStats.lootStolen,this.state.maxLootStolen=e.gameStats.maxLootStolen,this.state.ghostBonuses=e.gameStats.ghostBonuses,this.state.maxGhostBonuses=e.gameStats.maxGhostBonuses,this.state.timeBonuses=e.gameStats.timeBonuses,this.state.maxTimeBonuses=e.gameStats.maxTimeBonuses,this.state.lootSpent=e.gameStats.lootSpent,this.state.loot=e.player.loot}onControls(e,t){const n=this.navigateUI(t);t("zoomIn")||"zoomIn"==n?(e.zoomLevel=Math.max(1,e.zoomLevel-1),e.camera.snapped=!1):t("zoomOut")||"zoomOut"==n?(e.zoomLevel=Math.min(10,e.zoomLevel+1),e.camera.snapped=!1):t("restart")||"restart"==n?(e.rng=new v,e.dailyRun=null,_T(e)):(t("menu")||"menu"==n)&&(e.gameMode=mn.HomeScreen)}}class In extends vn{pages=["   Mission Complete!\n\nStatistics\nLoot stolen:   $lootStolen$ / $maxLootStolen$\nGhost bonuses: $ghostBonuses$ / $maxGhostBonuses$\nTime bonuses:  $timeBonuses$ / $maxTimeBonuses$\nLoot spent:    $lootSpent$\n\nScore:         $loot$\n\n[R|restartGame]: Start new game\n[Esc|menu]: Exit to home screen"];update(e){this.state.lootStolen=e.gameStats.lootStolen,this.state.maxLootStolen=e.gameStats.maxLootStolen,this.state.ghostBonuses=e.gameStats.ghostBonuses,this.state.maxGhostBonuses=e.gameStats.maxGhostBonuses,this.state.timeBonuses=e.gameStats.timeBonuses,this.state.maxTimeBonuses=e.gameStats.maxTimeBonuses,this.state.lootSpent=e.gameStats.lootSpent,this.state.loot=e.player.loot}onControls(e,t){const n=this.navigateUI(t);t("zoomIn")||"zoomIn"==n?(e.zoomLevel=Math.max(1,e.zoomLevel-1),e.camera.snapped=!1):t("zoomOut")||"zoomOut"==n?(e.zoomLevel=Math.min(10,e.zoomLevel+1),e.camera.snapped=!1):t("restart")||"restart"==n?(e.rng=new v,e.dailyRun=null,_T(e)):(t("menu")||"menu"==n)&&(e.gameMode=mn.HomeScreen)}}const En=ht().touchButtons.left.textureIndex,An=ht().touchButtons.right.textureIndex;class kn extends vn{pages=[`Lurk Leap Loot\n\nYour mission from the thieves' guild is to\nmap $numGameMaps$ mansions. You can keep any loot you\nfind ($totalGameLoot$ total).\n\nMansion bonuses:\n- Up to 5 gold for a timely map delivery.\n- 5 gold if you avoid alerting guards.\n\n[X|home] Exit to menu (abort game)\n\n1/4    [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Close`,`Keyboard controls\n\n  Move: Arrows / WASD / HJKL\n  Wait: Space / Z / Period / Numpad5\n  Leap: Shift + move\n  Leap (Toggle): F / Numpad+\n  Zoom View: [ / ]\n  Volume: (Mute/Down/Up) 0 / - / =\n  Guard Mute (Toggle): 9\n\nDisable NumLock if using numpad\nMouse, touch and gamepad also supported\n\n2/4    [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Close`,`Key \n\n#${ht().playerTiles.normal.textureIndex}# Thief: You!\n#${ht().npcTiles[3].textureIndex}# Guard: Avoid them!\n#${ht().itemTiles[Z.Coin].textureIndex}# Loot: Collect for score, or spend to heal\n#${ht().itemTiles[Z.Bush].textureIndex}# Tree: Hiding place\n#${ht().itemTiles[Z.Table].textureIndex}# Table: Hiding place\n#${ht().itemTiles[Z.Chair].textureIndex}# Stool: Not a hiding place\n#${ht().itemTiles[Z.TorchLit].textureIndex}# Torch: Guards want them lit\n#${ht().terrainTiles[$.OneWayWindowN].textureIndex}# Window: One-way escape route\n#${ht().terrainTiles[$.GroundWoodCreaky].textureIndex}# Creaky floorboard: Alerts guards if stepped on\n\n\n3/4    [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Close`,`Made for 2023 Seven-Day Roguelike Challenge\n\nby James McNeill and Damien Moore\n\nAdditional voices by Evan Moore\nAdditional assistance by Mike Gaffney\nTesting by Tom Elmer\nSpecial thanks to Mendi Carroll\n\n\n\n\n\n4/4    [#${En}#|menuPrev] Prev     [#${An}#|menuNext] Next     [Esc|menuClose] Close`];update(e){this.state.numGameMaps=OS.numGameMaps,this.state.totalGameLoot=OS.totalGameLoot}onControls(e,t){const n=this.navigateUI(t);(t("home")||"home"==n)&&(this.activePage=0,e.helpActive=!1,e.gameMode=mn.HomeScreen),t("menu")||"menu"==n||t("menuClose")||"menuClose"==n?(this.activePage=0,e.helpActive=!1):t("zoomIn")||"zoomIn"==n?(e.zoomLevel=Math.max(1,e.zoomLevel-1),e.camera.snapped=!1):t("zoomOut")||"zoomOut"==n?(e.zoomLevel=Math.min(10,e.zoomLevel+1),e.camera.snapped=!1):t("fullscreen")||"fullscreen"==n?document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen():t("forceRestart")||"forceRestart"==n?(e.rng=new v,e.dailyRun=null,_T(e)):t("gamepadStyleTouch")||"gamepadStyleTouch"==n?(e.touchAsGamepad=!e.touchAsGamepad,e.touchController.setTouchConfig(e.touchAsGamepad),e.topStatusMessage=e.touchAsGamepad?"Touch gamepad enabled":"Touch gamepad disabled (touch map to move)"):t("left")||"left"==n||t("menuPrev")||"menuPrev"==n?this.prevPage():(t("right")||"right"==n||t("menuNext")||"menuNext"==n)&&this.nextPage()}}var Cn={};e(Cn,"_DEFAULT_ENTRY_NAME",(()=>or)),e(Cn,"_apps",(()=>ar)),e(Cn,"_components",(()=>lr)),e(Cn,"_addComponent",(()=>ur)),e(Cn,"_addOrOverwriteComponent",(()=>cr)),e(Cn,"_registerComponent",(()=>hr)),e(Cn,"_getProvider",(()=>dr)),e(Cn,"_removeServiceInstance",(()=>fr)),e(Cn,"_clearComponents",(()=>pr)),e(Cn,"SDK_VERSION",(()=>vr)),e(Cn,"initializeApp",(()=>yr)),e(Cn,"getApp",(()=>br)),e(Cn,"getApps",(()=>wr)),e(Cn,"deleteApp",(()=>_r)),e(Cn,"registerVersion",(()=>Sr)),e(Cn,"onLog",(()=>Tr)),e(Cn,"setLogLevel",(()=>Ir)),e(Cn,"FirebaseError",(()=>ci));
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var xn,Rn,Ln,Mn=xn={};function Pn(){throw new Error("setTimeout has not been defined")}function Dn(){throw new Error("clearTimeout has not been defined")}function Nn(e){if(Rn===setTimeout)return setTimeout(e,0);if((Rn===Pn||!Rn)&&setTimeout)return Rn=setTimeout,setTimeout(e,0);try{return Rn(e,0)}catch(t){try{return Rn.call(null,e,0)}catch(t){return Rn.call(this,e,0)}}}!function(){try{Rn="function"==typeof setTimeout?setTimeout:Pn}catch(e){Rn=Pn}try{Ln="function"==typeof clearTimeout?clearTimeout:Dn}catch(e){Ln=Dn}}();var On,Fn=[],Un=!1,Vn=-1;function Hn(){Un&&On&&(Un=!1,On.length?Fn=On.concat(Fn):Vn=-1,Fn.length&&Bn())}function Bn(){if(!Un){var e=Nn(Hn);Un=!0;for(var t=Fn.length;t;){for(On=Fn,Fn=[];++Vn<t;)On&&On[Vn].run();Vn=-1,t=Fn.length}On=null,Un=!1,function(e){if(Ln===clearTimeout)return clearTimeout(e);if((Ln===Dn||!Ln)&&clearTimeout)return Ln=clearTimeout,clearTimeout(e);try{return Ln(e)}catch(t){try{return Ln.call(null,e)}catch(t){return Ln.call(this,e)}}}(e)}}function jn(e,t){this.fun=e,this.array=t}function Gn(){}Mn.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Fn.push(new jn(e,t)),1!==Fn.length||Un||Nn(Bn)},jn.prototype.run=function(){this.fun.apply(null,this.array)},Mn.title="browser",Mn.browser=!0,Mn.env={},Mn.argv=[],Mn.version="",Mn.versions={},Mn.on=Gn,Mn.addListener=Gn,Mn.once=Gn,Mn.off=Gn,Mn.removeListener=Gn,Mn.removeAllListeners=Gn,Mn.emit=Gn,Mn.prependListener=Gn,Mn.prependOnceListener=Gn,Mn.listeners=function(e){return[]},Mn.binding=function(e){throw new Error("process.binding is not supported")},Mn.cwd=function(){return"/"},Mn.chdir=function(e){throw new Error("process.chdir is not supported")},Mn.umask=function(){return 0};const Wn=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},zn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,u=r>>2,c=(3&r)<<4|s>>4;let h=(15&s)<<2|l>>6,d=63&l;a||(d=64,o||(h=64)),i.push(n[u],n[c],n[h],n[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Wn(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&o)}else if(r>239&&r<365){const o=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(o>>10)),t[i++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const r=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const s=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==r||null==o||null==s||null==a)throw new qn;const l=r<<2|o>>4;if(i.push(l),64!==s){const e=o<<4&240|s>>2;if(i.push(e),64!==a){const e=s<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kn=function(e){return function(e){const t=Wn(e);return zn.encodeByteArray(t,!0)}(e).replace(/\./g,"")},$n=function(e){try{return zn.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Yn(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Yn(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Xn=()=>
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Qn=()=>{try{return Xn()||(()=>{if(void 0===xn||void 0===xn.env)return})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&$n(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},Jn=e=>{var t,n;return null===(n=null===(t=Qn())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Zn=e=>{const t=Jn(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},ei=()=>{var e;return null===(e=Qn())||void 0===e?void 0:e.config},ti=e=>{var t;return null===(t=Qn())||void 0===t?void 0:t[`_${e}`]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ni{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Kn(JSON.stringify({alg:"none",type:"JWT"})),Kn(JSON.stringify(o)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function oi(){var e;const n=null===(e=Qn())||void 0===e?void 0:e.forceEnvironment;if("node"===n)return!0;if("browser"===n)return!1;try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function si(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function ai(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function li(){const e=ri();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function ui(){try{return"object"==typeof indexedDB}catch(e){return!1}}class ci extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,ci.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hi.prototype.create)}}class hi{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?function(e,t){return e.replace(di,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",s=`${this.serviceName}: ${o} (${i}).`;return new ci(i,s,n)}}const di=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function fi(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function pi(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function mi(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],o=t[r];if(gi(n)&&gi(o)){if(!mi(n,o))return!1}else if(n!==o)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function gi(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function vi(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function yi(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function bi(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(e,t){const n=new _i(e,t);return n.subscribe.bind(n)}class _i{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=Si),void 0===i.error&&(i.error=Si),void 0===i.complete&&(i.complete=Si);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Si(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ti(e){return e&&e._delegate?e._delegate:e}class Ii{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new ni;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:Ei})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=Ei){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=Ei){return this.instances.has(e)}getOptions(e=Ei){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===Ei?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e=Ei){return this.component?this.component.multipleInstances?e:Ei:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ki{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ai(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci=[];var xi,Ri;(Ri=xi||(xi={}))[Ri.DEBUG=0]="DEBUG",Ri[Ri.VERBOSE=1]="VERBOSE",Ri[Ri.INFO=2]="INFO",Ri[Ri.WARN=3]="WARN",Ri[Ri.ERROR=4]="ERROR",Ri[Ri.SILENT=5]="SILENT";const Li={debug:xi.DEBUG,verbose:xi.VERBOSE,info:xi.INFO,warn:xi.WARN,error:xi.ERROR,silent:xi.SILENT},Mi=xi.INFO,Pi={[xi.DEBUG]:"log",[xi.VERBOSE]:"log",[xi.INFO]:"info",[xi.WARN]:"warn",[xi.ERROR]:"error"},Di=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=Pi[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class Ni{constructor(e){this.name=e,this._logLevel=Mi,this._logHandler=Di,this._userLogHandler=null,Ci.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Li[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xi.DEBUG,...e),this._logHandler(this,xi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xi.VERBOSE,...e),this._logHandler(this,xi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xi.INFO,...e),this._logHandler(this,xi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xi.WARN,...e),this._logHandler(this,xi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xi.ERROR,...e),this._logHandler(this,xi.ERROR,...e)}}function Oi(e,t){for(const n of Ci){let i=null;t&&t.level&&(i=Li[t.level]),n.userLogHandler=null===e?null:(t,n,...r)=>{const o=r.map((e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((e=>e)).join(" ");n>=(null!=i?i:t.logLevel)&&e({level:xi[n].toLowerCase(),message:o,args:r,type:t.name})}}}const Fi=(e,t)=>t.some((t=>e instanceof t));let Ui,Vi;const Hi=new WeakMap,Bi=new WeakMap,ji=new WeakMap,Gi=new WeakMap,Wi=new WeakMap;let zi={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Bi.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ji.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $i(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function qi(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Vi||(Vi=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Yi(this),t),$i(Hi.get(this))}:function(...t){return $i(e.apply(Yi(this),t))}:function(t,...n){const i=e.call(Yi(this),t,...n);return ji.set(i,t.sort?t.sort():[t]),$i(i)}}function Ki(e){return"function"==typeof e?qi(e):(e instanceof IDBTransaction&&function(e){if(Bi.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{t(),i()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)}));Bi.set(e,t)}(e),Fi(e,Ui||(Ui=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,zi):e)}function $i(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{t($i(e.result)),i()},o=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&Hi.set(t,e)})).catch((()=>{})),Wi.set(t,e),t}(e);if(Gi.has(e))return Gi.get(e);const t=Ki(e);return t!==e&&(Gi.set(e,t),Wi.set(t,e)),t}const Yi=e=>Wi.get(e);function Xi(e,t,{blocked:n,upgrade:i,blocking:r,terminated:o}={}){const s=indexedDB.open(e,t),a=$i(s);return i&&s.addEventListener("upgradeneeded",(e=>{i($i(s.result),e.oldVersion,e.newVersion,$i(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}const Qi=["get","getKey","getAll","getAllKeys","count"],Ji=["put","add","delete","clear"],Zi=new Map;function er(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Zi.get(t))return Zi.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=Ji.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Qi.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,r?"readwrite":"readonly");let s=o.store;return i&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),r&&o.done]))[0]};return Zi.set(t,o),o}zi=(e=>({...e,get:(t,n,i)=>er(t,n)||e.get(t,n,i),has:(t,n)=>!!er(t,n)||e.has(t,n)}))(zi);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class tr{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const nr="@firebase/app",ir="0.9.11",rr=new Ni("@firebase/app"),or="[DEFAULT]",sr={[nr]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ar=new Map,lr=new Map;function ur(e,t){try{e.container.addComponent(t)}catch(n){rr.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function cr(e,t){e.container.addOrOverwriteComponent(t)}function hr(e){const t=e.name;if(lr.has(t))return rr.debug(`There were multiple attempts to register component ${t}.`),!1;lr.set(t,e);for(const t of ar.values())ur(t,e);return!0}function dr(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function fr(e,t,n=or){dr(e,t).clearInstance(n)}function pr(){lr.clear()}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr=new hi("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class gr{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ii("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw mr.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr="9.22.1";function yr(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const i=Object.assign({name:or,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw mr.create("bad-app-name",{appName:String(r)});if(n||(n=ei()),!n)throw mr.create("no-options");const o=ar.get(r);if(o){if(mi(n,o.options)&&mi(i,o.config))return o;throw mr.create("duplicate-app",{appName:r})}const s=new ki(r);for(const e of lr.values())s.addComponent(e);const a=new gr(n,i,s);return ar.set(r,a),a}function br(e=or){const t=ar.get(e);if(!t&&e===or&&ei())return yr();if(!t)throw mr.create("no-app",{appName:e});return t}function wr(){return Array.from(ar.values())}async function _r(e){const t=e.name;ar.has(t)&&(ar.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function Sr(e,t,n){var i;let r=null!==(i=sr[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const o=r.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${r}" with version "${t}":`];return o&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void rr.warn(e.join(" "))}hr(new Ii(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}function Tr(e,t){if(null!==e&&"function"!=typeof e)throw mr.create("invalid-log-argument");Oi(e,t)}function Ir(e){var t;t=e,Ci.forEach((e=>{e.setLogLevel(t)}))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Er="firebase-heartbeat-database",Ar=1,kr="firebase-heartbeat-store";let Cr=null;function xr(){return Cr||(Cr=Xi(Er,Ar,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(kr)}}).catch((e=>{throw mr.create("idb-open",{originalErrorMessage:e.message})}))),Cr}async function Rr(e,t){try{const n=(await xr()).transaction(kr,"readwrite"),i=n.objectStore(kr);await i.put(t,Lr(e)),await n.done}catch(e){if(e instanceof ci)rr.warn(e.message);else{const t=mr.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});rr.warn(t.message)}}}function Lr(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr=1024;class Pr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Nr(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Dr();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Dr(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=Mr){const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Or(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Or(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=Kn(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Dr(){return(new Date).toISOString().substring(0,10)}class Nr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ui()&&new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{const t=await xr();return await t.transaction(kr).objectStore(kr).get(Lr(e))}catch(e){if(e instanceof ci)rr.warn(e.message);else{const t=mr.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});rr.warn(t.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Rr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Rr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Or(e){return Kn(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fr;Fr="",hr(new Ii("platform-logger",(e=>new tr(e)),"PRIVATE")),hr(new Ii("heartbeat",(e=>new Pr(e)),"PRIVATE")),Sr(nr,ir,Fr),Sr(nr,ir,"esm2017"),Sr("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Sr("firebase","9.22.1","app");function Ur(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Vr={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Hr={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function Br(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jr=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},Gr=Br,Wr=new hi("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),zr=new Ni("@firebase/auth");function qr(e,...t){zr.logLevel<=xi.ERROR&&zr.error(`Auth (${vr}): ${e}`,...t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(e,...t){throw Qr(e,...t)}function $r(e,...t){return Qr(e,...t)}function Yr(e,t,n){const i=Object.assign(Object.assign({},Gr()),{[t]:n});return new hi("auth","Firebase",i).create(t,{appName:e.name})}function Xr(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Kr(e,"argument-error"),Yr(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Qr(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return Wr.create(e,...t)}function Jr(e,t,...n){if(!e)throw Qr(t,...n)}function Zr(e){const t="INTERNAL ASSERTION FAILED: "+e;throw qr(t),new Error(t)}function eo(e,t){e||Zr(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function no(){return"http:"===io()||"https:"===io()}function io(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ro{constructor(e,t){this.shortDelay=e,this.longDelay=t,eo(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ri())||ai()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(no()||si()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(e,t){eo(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},lo=new ro(3e4,6e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function co(e,t,n,i,r={}){return ho(e,r,(async()=>{let r={},o={};i&&("GET"===t?o=i:r={body:JSON.stringify(i)});const s=vi(Object.assign({key:e.config.apiKey},o)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),so.fetch()(po(e,e.config.apiHost,n,s),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function ho(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},ao),t);try{const t=new mo(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw go(e,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const t=r.ok?o.errorMessage:o.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw go(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw go(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw go(e,"user-disabled",o);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw Yr(e,a,s);Kr(e,a)}}catch(t){if(t instanceof ci)throw t;Kr(e,"network-request-failed",{message:String(t)})}}async function fo(e,t,n,i,r={}){const o=await co(e,t,n,i,r);return"mfaPendingCredential"in o&&Kr(e,"multi-factor-auth-required",{_serverResponse:o}),o}function po(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?oo(e.config,r):`${e.config.apiScheme}://${r}`}class mo{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t($r(this.auth,"network-request-failed"))),lo.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function go(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=$r(e,t,i);return r.customData._tokenResponse=n,r}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function vo(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(e){return 1e3*Number(e)}function bo(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return qr("JWT malformed, contained fewer than 3 sections"),null;try{const e=$n(n);return e?JSON.parse(e):(qr("Failed to decode base64 JWT payload"),null)}catch(e){return qr("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function wo(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof ci&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class _o{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vo(this.lastLoginAt),this.creationTime=vo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function To(e){var t;const n=e.auth,i=await e.getIdToken(),r=await wo(e,async function(e,t){return co(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));Jr(null==r?void 0:r.users.length,n,"internal-error");const o=r.users[0];e._notifyReloadListener(o);const s=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?o.providerUserInfo.map((e=>{var{providerId:t}=e,n=Ur(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(l=e.providerData,u=s,[...l.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var l,u;const c=e.isAnonymous,h=!(e.email&&o.passwordHash||(null==a?void 0:a.length)),d=!!c&&h,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new So(o.createdAt,o.lastLoginAt),isAnonymous:d};Object.assign(e,f)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Jr(e.idToken,"internal-error"),Jr(void 0!==e.idToken,"internal-error"),Jr(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=bo(e);return Jr(t,"internal-error"),Jr(void 0!==t.exp,"internal-error"),Jr(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Jr(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(e,t){const n=await ho(e,{},(async()=>{const n=vi({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,o=po(e,i,"/v1/token",`key=${r}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",so.fetch()(o,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,o=new Io;return n&&(Jr("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),i&&(Jr("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),r&&(Jr("number"==typeof r,"internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Io,this.toJSON())}_performRefresh(){return Zr("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eo(e,t){Jr("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Ao{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Ur(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _o(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new So(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await wo(this,this.stsTokenManager.getToken(this.auth,e));return Jr(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Ti(e),i=await n.getIdToken(t),r=bo(i);Jr(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const o="object"==typeof r.firebase?r.firebase:void 0,s=null==o?void 0:o.sign_in_provider;return{claims:r,token:i,authTime:vo(yo(r.auth_time)),issuedAtTime:vo(yo(r.iat)),expirationTime:vo(yo(r.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Ti(e);await To(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Jr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ao(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Jr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await To(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await wo(this,async function(e,t){return co(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,o,s,a,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(o=t.photoURL)&&void 0!==o?o:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:_,stsTokenManager:S}=t;Jr(y&&S,e,"internal-error");const T=Io.fromJSON(this.name,S);Jr("string"==typeof y,e,"internal-error"),Eo(c,e.name),Eo(h,e.name),Jr("boolean"==typeof b,e,"internal-error"),Jr("boolean"==typeof w,e,"internal-error"),Eo(d,e.name),Eo(f,e.name),Eo(p,e.name),Eo(m,e.name),Eo(g,e.name),Eo(v,e.name);const I=new Ao({uid:y,auth:e,email:h,emailVerified:b,displayName:c,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:g,lastLoginAt:v});return _&&Array.isArray(_)&&(I.providerData=_.map((e=>Object.assign({},e)))),m&&(I._redirectEventId=m),I}static async _fromIdTokenResponse(e,t,n=!1){const i=new Io;i.updateFromServerResponse(t);const r=new Ao({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await To(r),r}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko=new Map;function Co(e){eo(e instanceof Function,"Expected a class definition");let t=ko.get(e);return t?(eo(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ko.set(e,t),t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}xo.type="NONE";const Ro=xo;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(e,t,n){return`firebase:${e}:${t}:${n}`}class Mo{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Lo(this.userKey,i.apiKey,r),this.fullPersistenceKey=Lo("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ao._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Mo(Co(Ro),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||Co(Ro);const o=Lo(n,e.config.apiKey,e.name);let s=null;for(const n of t)try{const t=await n._get(o);if(t){const i=Ao._fromJSON(e,t);n!==r&&(s=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],s&&await r._set(o,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(o)}catch(e){}}))),new Mo(r,e,n)):new Mo(r,e,n)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Fo(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Do(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Vo(t))return"Blackberry";if(Ho(t))return"Webos";if(No(t))return"Safari";if((t.includes("chrome/")||Oo(t))&&!t.includes("edge/"))return"Chrome";if(Uo(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Do(e=ri()){return/firefox\//i.test(e)}function No(e=ri()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Oo(e=ri()){return/crios\//i.test(e)}function Fo(e=ri()){return/iemobile/i.test(e)}function Uo(e=ri()){return/android/i.test(e)}function Vo(e=ri()){return/blackberry/i.test(e)}function Ho(e=ri()){return/webos/i.test(e)}function Bo(e=ri()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function jo(e=ri()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}function Go(e=ri()){return Bo(e)||Uo(e)||Ho(e)||Vo(e)||/windows phone/i.test(e)||Fo(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Wo(e,t=[]){let n;switch(e){case"Browser":n=Po(ri());break;case"Worker":n=`${Po(ri())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${vr}/${i}`}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zo(e,t){return co(e,"GET","/v2/recaptchaConfig",uo(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(e){return void 0!==e&&void 0!==e.getResponse}function Ko(e){return void 0!==e&&void 0!==e.enterprise}class $o{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yo(e){return new Promise(((t,n)=>{const i=document.createElement("script");var r,o;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=$r("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(o=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==o?o:document).appendChild(i)}))}function Xo(e){return`__${e}${Math.floor(1e6*Math.random())}`}const Qo="NO_RECAPTCHA";class Jo{constructor(e){this.type="recaptcha-enterprise",this.auth=ns(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;Ko(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(Qo)}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{zo(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new $o(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&Ko(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));Yo("https://www.google.com/recaptcha/enterprise.js?render="+r).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function Zo(e,t,n,i=!1){const r=new Jo(e);let o;try{o=await r.verify(n)}catch(e){o=await r.verify(n,!0)}const s=Object.assign({},t);return i?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new is(this),this.idTokenSubscription=new is(this),this.beforeStateQueue=new es(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wr,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Co(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Mo.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,o=null==i?void 0:i._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==o||!(null==s?void 0:s.user)||(i=s.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Jr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await To(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Ti(e):null;return t&&Jr(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Jr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Co(e))}))}async initializeRecaptchaConfig(){const e=await zo(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new $o(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new Jo(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new hi("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Co(e)||this._popupRedirectResolver;Jr(t,this,"argument-error"),this.redirectPersistenceManager=await Mo.create(this,[Co(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Jr(o,this,"internal-error"),o.then((()=>r(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Jr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wo(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){zr.logLevel<=xi.WARN&&zr.warn(`Auth (${vr}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function ns(e){return Ti(e)}class is{constructor(e){this.auth=e,this.observer=null,this.addObserver=wi((e=>this.observer=e))}get next(){return Jr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(e,t,n){const i=ns(e);Jr(i._canInitEmulator,i,"emulator-config-failed"),Jr(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),o=os(t),{host:s,port:a}=function(e){const t=os(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:ss(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:ss(t)}}}(t),l=null===a?"":`:${a}`;i.config.emulator={url:`${o}//${s}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function os(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ss(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class as{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Zr("not implemented")}_getIdTokenResponse(e){return Zr("not implemented")}_linkToIdToken(e,t){return Zr("not implemented")}_getReauthenticationResolver(e){return Zr("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ls(e,t){return co(e,"POST","/v1/accounts:resetPassword",uo(e,t))}async function us(e,t){return co(e,"POST","/v1/accounts:update",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function cs(e,t){return fo(e,"POST","/v1/accounts:signInWithPassword",uo(e,t))}async function hs(e,t){return co(e,"POST","/v1/accounts:sendOobCode",uo(e,t))}async function ds(e,t){return hs(e,t)}async function fs(e,t){return hs(e,t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ps extends as{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new ps(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new ps(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await Zo(e,n,"signInWithPassword");return cs(e,t)}return cs(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await Zo(e,n,"signInWithPassword");return cs(e,t)}return Promise.reject(t)}));case"emailLink":
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(e,t){return fo(e,"POST","/v1/accounts:signInWithEmailLink",uo(e,t))}(e,{email:this._email,oobCode:this._password});default:Kr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return us(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return fo(e,"POST","/v1/accounts:signInWithEmailLink",uo(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Kr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ms(e,t){return fo(e,"POST","/v1/accounts:signInWithIdp",uo(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs extends as{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Kr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Ur(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new gs(n,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){return ms(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ms(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ms(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=vi(t)}return e}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs={USER_NOT_FOUND:"user-not-found"};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ys extends as{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ys({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ys({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return fo(e,"POST","/v1/accounts:signInWithPhoneNumber",uo(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await fo(e,"POST","/v1/accounts:signInWithPhoneNumber",uo(e,t));if(n.temporaryProof)throw go(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return fo(e,"POST","/v1/accounts:signInWithPhoneNumber",uo(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),vs)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new ys({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){var t,n,i,r,o,s;const a=yi(bi(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Jr(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(o=a.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=a.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=yi(bi(e)).link,n=t?yi(bi(t)).deep_link_id:null,i=yi(bi(e)).deep_link_id;return(i?yi(bi(i)).link:null)||i||n||t||e}(e);try{return new bs(t)}catch(e){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ws{constructor(){this.providerId=ws.PROVIDER_ID}static credential(e,t){return ps._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=bs.parseLink(t);return Jr(n,"argument-error"),ps._fromEmailAndCode(e,n.code,n.tenantId)}}ws.PROVIDER_ID="password",ws.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ws.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class _s{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends _s{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ts extends Ss{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return Jr("providerId"in t&&"signInMethod"in t,"argument-error"),gs._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Jr(e.idToken||e.accessToken,"argument-error"),gs._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ts.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ts.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:o,providerId:s}=e;if(!(n||i||t||r))return null;if(!s)return null;try{return new Ts(s)._credential({idToken:t,accessToken:n,nonce:o,pendingToken:r})}catch(e){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Ss{constructor(){super("facebook.com")}static credential(e){return gs._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Is.credential(e.oauthAccessToken)}catch(e){return null}}}Is.FACEBOOK_SIGN_IN_METHOD="facebook.com",Is.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Es extends Ss{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gs._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Es.credential(t,n)}catch(e){return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com",Es.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class As extends Ss{constructor(){super("github.com")}static credential(e){return gs._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch(e){return null}}}As.GITHUB_SIGN_IN_METHOD="github.com",As.PROVIDER_ID="github.com";class ks extends as{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return ms(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ms(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ms(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,pendingToken:r}=t;return n&&i&&r&&n===i?new ks(n,r):null}static _create(e,t){return new ks(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends _s{constructor(e){Jr(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return Cs.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Cs.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=ks.fromJSON(e);return Jr(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return ks._create(n,t)}catch(e){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends Ss{constructor(){super("twitter.com")}static credential(e,t){return gs._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return xs.credential(t,n)}catch(e){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Rs(e,t){return fo(e,"POST","/v1/accounts:signUp",uo(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xs.TWITTER_SIGN_IN_METHOD="twitter.com",xs.PROVIDER_ID="twitter.com";class Ls{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await Ao._fromIdTokenResponse(e,n,i),o=Ms(n);return new Ls({user:r,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Ms(n);return new Ls({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Ms(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ps extends ci{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Ps.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Ps(e,t,n,i)}}function Ds(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Ps._fromErrorAndOperation(e,n,t,i);throw n}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Os(e,t){const n=Ti(e);await Us(!0,n,t);const{providerUserInfo:i}=await async function(e,t){return co(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),r=Ns(i||[]);return n.providerData=n.providerData.filter((e=>r.has(e.providerId))),r.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Fs(e,t,n=!1){const i=await wo(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ls._forOperation(e,"link",i)}async function Us(e,t,n){await To(t);const i=!1===e?"provider-already-linked":"no-such-provider";Jr(Ns(t.providerData).has(n)===e,t.auth,i)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(e,t,n=!1){const{auth:i}=e,r="reauthenticate";try{const o=await wo(e,Ds(i,r,t,e),n);Jr(o.idToken,i,"internal-error");const s=bo(o.idToken);Jr(s,i,"internal-error");const{sub:a}=s;return Jr(e.uid===a,i,"user-mismatch"),Ls._forOperation(e,r,o)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Kr(i,"user-mismatch"),e}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hs(e,t,n=!1){const i="signIn",r=await Ds(e,i,t),o=await Ls._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(o.user),o}async function Bs(e,t){return Hs(ns(e),t)}async function js(e,t){const n=Ti(e);return await Us(!1,n,t.providerId),Fs(n,t)}async function Gs(e,t){return Vs(Ti(e),t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Ws(e,t){const n=ns(e),i=await async function(e,t){return fo(e,"POST","/v1/accounts:signInWithCustomToken",uo(e,t))}(n,{token:t,returnSecureToken:!0}),r=await Ls._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(r.user),r}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?qs._fromServerResponse(e,t):"totpInfo"in t?Ks._fromServerResponse(e,t):Kr(e,"internal-error")}}class qs extends zs{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new qs(t)}}class Ks extends zs{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Ks(t)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(e,t,n){var i;Jr((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),Jr(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Jr(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Jr(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ys(e,t){await async function(e,t){return co(e,"POST","/v1/accounts:update",uo(e,t))}(Ti(e),{oobCode:t})}async function Xs(e,t){const n=Ti(e),i=await ls(n,{oobCode:t}),r=i.requestType;switch(Jr(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Jr(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Jr(i.mfaInfo,n,"internal-error");default:Jr(i.email,n,"internal-error")}let o=null;return i.mfaInfo&&(o=zs._fromServerResponse(ns(n),i.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:r}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Qs(e,t){const n={identifier:t,continueUri:no()?to():"http://localhost"},{signinMethods:i}=await
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(e,t){return co(e,"POST","/v1/accounts:createAuthUri",uo(e,t))}(Ti(e),n);return i||[]}async function Js(e,t){const n=Ti(e),i={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&$s(n.auth,i,t);const{email:r}=await async function(e,t){return hs(e,t)}(n.auth,i);r!==e.email&&await e.reload()}async function Zs(e,t,n){const i=Ti(e),r={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&$s(i.auth,r,n);const{email:o}=await async function(e,t){return hs(e,t)}(i.auth,r);o!==e.email&&await e.reload()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function ea(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const i=Ti(e),r={idToken:await i.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},o=await wo(i,async function(e,t){return co(e,"POST","/v1/accounts:update",t)}(i.auth,r));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const s=i.providerData.find((({providerId:e})=>"password"===e));s&&(s.displayName=i.displayName,s.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}async function ta(e,t,n){const{auth:i}=e,r={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(r.email=t),n&&(r.password=n);const o=await wo(e,us(i,r));await e._updateTokensIfNecessary(o,!0)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class ia extends na{constructor(e,t,n,i){super(e,t,n),this.username=i}}class ra extends na{constructor(e,t){super(e,"facebook.com",t)}}class oa extends ia{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class sa extends na{constructor(e,t){super(e,"google.com",t)}}class aa extends ia{constructor(e,t,n){super(e,"twitter.com",t,n)}}function la(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:i}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},o=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!i&&(null==e?void 0:e.idToken)){const i=null===(n=null===(t=bo(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(i)return new na(o,"anonymous"!==i&&"custom"!==i?i:null)}if(!i)return null;switch(i){case"facebook.com":return new ra(o,r);case"github.com":return new oa(o,r);case"google.com":return new sa(o,r);case"twitter.com":return new aa(o,r,e.screenName||null);case"custom":case"anonymous":return new na(o,null);default:return new na(o,i,r)}}(n)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(e,t,n,i){return Ti(e).onAuthStateChanged(t,n,i)}function ca(e){return Ti(e).signOut()}class ha{constructor(e,t,n){this.type=e,this.credential=t,this.auth=n}static _fromIdtoken(e,t){return new ha("enroll",e,t)}static _fromMfaPendingCredential(e){return new ha("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return ha._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return ha._fromIdtoken(e.multiFactorSession.idToken)}return null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=ns(e),i=t.customData._serverResponse,r=(i.mfaInfo||[]).map((e=>zs._fromServerResponse(n,e)));Jr(i.mfaPendingCredential,n,"internal-error");const o=ha._fromMfaPendingCredential(i.mfaPendingCredential);return new da(o,r,(async e=>{const r=await e._process(n,o);delete i.mfaInfo,delete i.mfaPendingCredential;const s=Object.assign(Object.assign({},i),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Ls._fromIdTokenResponse(n,t.operationType,s);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return Jr(t.user,n,"internal-error"),Ls._forOperation(t.user,t.operationType,s);default:Kr(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class fa{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>zs._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new fa(e)}async getSession(){return ha._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,t){const n=e,i=await this.getSession(),r=await wo(this.user,n._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await wo(this.user,(i=this.user.auth,r={idToken:n,mfaEnrollmentId:t},co(i,"POST","/v2/accounts/mfaEnrollment:withdraw",uo(i,r))));this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}var i,r}}const pa=new WeakMap;const ma="__sak";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ma,"1"),this.storage.removeItem(ma),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends ga{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=ri();return No(e)||Bo(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Go(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);li()&&10===document.documentMode&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}va.type="LOCAL";const ya=va;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba extends ga{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ba.type="SESSION";const wa=ba;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class _a{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new _a(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,o=this.handlersMap[i];if(!(null==o?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const s=Array.from(o).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Sa(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_a.receivers=[];class Ta{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise(((s,a)=>{const l=Sa("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);o={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),s(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])})).finally((()=>{o&&this.removeMessageHandler(o)}))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ea(){return void 0!==Ia().WorkerGlobalScope&&"function"==typeof Ia().importScripts}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Aa="firebaseLocalStorageDb",ka=1,Ca="firebaseLocalStorage",xa="fbase_key";class Ra{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function La(e,t){return e.transaction([Ca],t?"readwrite":"readonly").objectStore(Ca)}function Ma(){const e=indexedDB.open(Aa,ka);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ca,{keyPath:xa})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ca)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Aa);return new Ra(e).toPromise()}(),t(await Ma()))}))}))}async function Pa(e,t,n){const i=La(e,!0).put({[xa]:t,value:n});return new Ra(i).toPromise()}function Da(e,t){const n=La(e,!0).delete(t);return new Ra(n).toPromise()}class Na{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Ma()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ea()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_a._getInstance(Ea()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ta(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ma();return await Pa(e,ma,"1"),await Da(e,ma),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Pa(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=La(e,!1).get(t),i=await new Ra(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Da(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=La(e,!1).getAll();return new Ra(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Na.type="LOCAL";const Oa=Na;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Fa=1e12;class Ua{constructor(e){this.auth=e,this.counter=Fa,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Va(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Fa;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Fa;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Fa;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Va{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i="string"==typeof e?document.getElementById(e):e;Jr(i,"argument-error",{appName:t}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ha=Xo("rcb"),Ba=new ro(3e4,6e4);class ja{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=Ia().grecaptcha)||void 0===e?void 0:e.render)}load(e,t=""){return Jr(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&qo(Ia().grecaptcha)?Promise.resolve(Ia().grecaptcha):new Promise(((n,i)=>{const r=Ia().setTimeout((()=>{i($r(e,"network-request-failed"))}),Ba.get());Ia()[Ha]=()=>{Ia().clearTimeout(r),delete Ia()[Ha];const o=Ia().grecaptcha;if(!o||!qo(o))return void i($r(e,"internal-error"));const s=o.render;o.render=(e,t)=>{const n=s(e,t);return this.counter++,n},this.hostLanguage=t,n(o)};Yo(`https://www.google.com/recaptcha/api.js??${vi({onload:Ha,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(r),i($r(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=Ia().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Ga{async load(e){return new Ua(e)}clearedOneInstance(){}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa="recaptcha",za={theme:"light",type:"image"};class qa{constructor(e,t=Object.assign({},za),n){this.parameters=t,this.type=Wa,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ns(n),this.isInvisible="invisible"===this.parameters.size,Jr("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof e?document.getElementById(e):e;Jr(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ga:new ja,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const i=e=>{e&&(this.tokenChangeListeners.delete(i),n(e))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){Jr(!this.parameters.sitekey,this.auth,"argument-error"),Jr(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Jr("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=Ia()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){Jr(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Jr(no()&&!Ea(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await co(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);Jr(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Jr(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Ka{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ys._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function $a(e,t,n){var i;const r=await n.verify();try{let o;if(Jr("string"==typeof r,e,"argument-error"),Jr(n.type===Wa,e,"argument-error"),o="string"==typeof t?{phoneNumber:t}:t,"session"in o){const t=o.session;if("phoneNumber"in o){Jr("enroll"===t.type,e,"internal-error");const n=await
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){return co(e,"POST","/v2/accounts/mfaEnrollment:start",uo(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Jr("signin"===t.type,e,"internal-error");const n=(null===(i=o.multiFactorHint)||void 0===i?void 0:i.uid)||o.multiFactorUid;Jr(n,e,"missing-multi-factor-info");const s=await function(e,t){return co(e,"POST","/v2/accounts/mfaSignIn:start",uo(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return co(e,"POST","/v1/accounts:sendVerificationCode",uo(e,t))}(e,{phoneNumber:o.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ya{constructor(e){this.providerId=Ya.PROVIDER_ID,this.auth=ns(e)}verifyPhoneNumber(e,t){return $a(this.auth,e,Ti(t))}static credential(e,t){return ys._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ya.credentialFromTaggedObject(t)}static credentialFromError(e){return Ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?ys._fromTokenResponse(t,n):null}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Xa(e,t){return t?Co(t):(Jr(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ya.PROVIDER_ID="phone",Ya.PHONE_SIGN_IN_METHOD="phone";class Qa extends as{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ms(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ms(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ms(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ja(e){return Hs(e.auth,new Qa(e),e.bypassAuthState)}function Za(e){const{auth:t,user:n}=e;return Jr(n,t,"internal-error"),Vs(n,new Qa(e),e.bypassAuthState)}async function el(e){const{auth:t,user:n}=e;return Jr(n,t,"internal-error"),Fs(n,new Qa(e),e.bypassAuthState)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:o,type:s}=e;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ja;case"linkViaPopup":case"linkViaRedirect":return el;case"reauthViaPopup":case"reauthViaRedirect":return Za;default:Kr(this.auth,"internal-error")}}resolve(e){eo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){eo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=new ro(2e3,1e4);class il extends tl{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,il.currentPopupAction&&il.currentPopupAction.cancel(),il.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Jr(e,this.auth,"internal-error"),e}async onExecution(){eo(1===this.filter.length,"Popup operations only handle one event");const e=Sa();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject($r(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject($r(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,il.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject($r(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,nl.get())};e()}}il.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const rl="pendingRedirect",ol=new Map;class sl extends tl{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ol.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=cl(t),i=ul(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}ol.set(this.auth._key(),e)}return this.bypassAuthState||ol.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function al(e,t){return ul(e)._set(cl(t),"true")}function ll(e,t){ol.set(e._key(),t)}function ul(e){return Co(e._redirectPersistence)}function cl(e){return Lo(rl,e.config.apiKey,e.name)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(e,t,n){return async function(e,t,n){const i=ns(e);Xr(e,t,_s),await i._initializationPromise;const r=Xa(i,n);return await al(r,i),r._openRedirect(i,t,"signInViaRedirect")}(e,t,n)}function dl(e,t,n){return async function(e,t,n){const i=Ti(e);Xr(i.auth,t,_s),await i.auth._initializationPromise;const r=Xa(i.auth,n);await al(r,i.auth);const o=await ml(i);return r._openRedirect(i.auth,t,"reauthViaRedirect",o)}(e,t,n)}function fl(e,t,n){return async function(e,t,n){const i=Ti(e);Xr(i.auth,t,_s),await i.auth._initializationPromise;const r=Xa(i.auth,n);await Us(!1,i,t.providerId),await al(r,i.auth);const o=await ml(i);return r._openRedirect(i.auth,t,"linkViaRedirect",o)}(e,t,n)}async function pl(e,t,n=!1){const i=ns(e),r=Xa(i,t),o=new sl(i,r,n),s=await o.execute();return s&&!n&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,t)),s}async function ml(e){const t=Sa(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yl(e);default:return!1}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!yl(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError($r(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(vl(e))}saveEventToCache(e){this.cachedEventUids.add(vl(e)),this.lastProcessedEventTime=Date.now()}}function vl(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function yl({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function bl(e,t={}){return co(e,"GET","/v1/projects",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_l=/^https?/;function Sl(e){const t=to(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!_l.test(n))return!1;if(wl.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl=new ro(3e4,6e4);function Il(){const e=Ia().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let El=null;function Al(e){return El=El||function(e){return new Promise(((t,n)=>{var i,r,o;function s(){Il(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Il(),n($r(e,"network-request-failed"))},timeout:Tl.get()})}if(null===(r=null===(i=Ia().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(o=Ia().gapi)||void 0===o?void 0:o.load)){const t=Xo("iframefcb");return Ia()[t]=()=>{gapi.load?s():n($r(e,"network-request-failed"))},Yo(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw El=null,e}))}(e),El}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=new ro(5e3,15e3),Cl="__/auth/iframe",xl="emulator/auth/iframe",Rl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ll=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ml(e){const t=e.config;Jr(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?oo(t,xl):`https://${e.config.authDomain}/${Cl}`,i={apiKey:t.apiKey,appName:e.name,v:vr},r=Ll.get(e.config.apiHost);r&&(i.eid=r);const o=e._getFrameworks();return o.length&&(i.fw=o.join(",")),`${n}?${vi(i).slice(1)}`}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Pl={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Dl=500,Nl=600,Ol="_blank",Fl="http://localhost";class Ul{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Vl(e,t,n,i=Dl,r=Nl){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Pl),{width:i.toString(),height:r.toString(),top:o,left:s}),u=ri().toLowerCase();n&&(a=Oo(u)?Ol:n),Do(u)&&(t=t||Fl,l.scrollbars="yes");const c=Object.entries(l).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=ri()){var t;return Bo(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t||"",a),new Ul(null);const h=window.open(t||"",a,c);Jr(h,e,"popup-blocked");try{h.focus()}catch(e){}return new Ul(h)}const Hl="__/auth/handler",Bl="emulator/auth/handler",jl=encodeURIComponent("fac");async function Gl(e,t,n,i,r,o){Jr(e.config.authDomain,e,"auth-domain-config-required"),Jr(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:vr,eventId:r};if(t instanceof _s){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",pi(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))s[e]=t}if(t instanceof Ss){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const a=s;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const l=await e._getAppCheckToken(),u=l?`#${jl}=${encodeURIComponent(l)}`:"";return`${function({config:e}){return e.emulator?oo(e,Bl):`https://${e.authDomain}/${Hl}`}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)}?${vi(a).slice(1)}${u}`}const Wl="webStorageSupport";const zl=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wa,this._completeRedirectFn=pl,this._overrideRedirectResult=ll}async _openPopup(e,t,n,i){var r;eo(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return Vl(e,await Gl(e,t,n,to(),i),Sa())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){Ia().location.href=e}(await Gl(e,t,n,to(),i)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(eo(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Al(e),n=Ia().gapi;return Jr(n,e,"internal-error"),t.open({where:document.body,url:Ml(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Rl,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=$r(e,"network-request-failed"),o=Ia().setTimeout((()=>{i(r)}),kl.get());function s(){Ia().clearTimeout(o),n(t)}t.ping(s).then(s,(()=>{i(r)}))}))))}(e),n=new gl(e);return t.register("authEvent",(t=>{Jr(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Wl,{type:Wl},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Wl];void 0!==r&&t(!!r),Kr(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await bl(e);for(const e of t)try{if(Sl(e))return}catch(e){}Kr(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Go()||No()||Bo()}};class ql{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Zr("unexpected MultiFactorSessionType")}}}class Kl extends ql{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Kl(e)}_finalizeEnroll(e,t,n){return function(e,t){return co(e,"POST","/v2/accounts/mfaEnrollment:finalize",uo(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return co(e,"POST","/v2/accounts/mfaSignIn:finalize",uo(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class $l{constructor(){}static assertion(e){return Kl._fromCredential(e)}}$l.FACTOR_ID="phone";var Yl="@firebase/auth",Xl="0.23.2";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ql{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Jr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Jl=ti("authIdTokenMaxAge")||300;let Zl=null;const eu=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>Jl)return;const r=null==n?void 0:n.token;Zl!==r&&(Zl=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function tu(e=br()){const t=dr(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=dr(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(mi(n.getOptions(),null!=t?t:{}))return e;Kr(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:zl,persistence:[Oa,ya,wa]}),i=ti("authTokenSyncURL");if(i){const e=eu(i);!function(e,t,n){Ti(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(e,t,n,i){Ti(e).onIdTokenChanged(t,n,i)}(n,(t=>e(t)))}const r=Jn("auth");return r&&rs(n,`http://${r}`),n}var nu;nu="Browser",hr(new Ii("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=n.options;Jr(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:o,authDomain:s,clientPlatform:nu,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wo(nu)},l=new ts(n,i,r,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Co);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(l,t),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),hr(new Ii("auth-internal",(e=>(e=>new Ql(e))(ns(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Sr(Yl,Xl,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(nu)),Sr(Yl,Xl,"esm2017");var iu,ru="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},ou={},su=su||{},au=ru||self;function lu(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function uu(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var cu="closure_uid_"+(1e9*Math.random()>>>0),hu=0;function du(e,t,n){return e.call.apply(e.bind,arguments)}function fu(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function pu(e,t,n){return(pu=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?du:fu).apply(null,arguments)}function mu(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function gu(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return t.prototype[n].apply(e,r)}}function vu(){this.s=this.s,this.o=this.o}vu.prototype.s=!1,vu.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,cu)&&e[cu]||(e[cu]=++hu))},vu.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const yu=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function bu(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function wu(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(lu(n)){const t=e.length||0,i=n.length||0;e.length=t+i;for(let r=0;r<i;r++)e[t+r]=n[r]}else e.push(n)}}function _u(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}_u.prototype.h=function(){this.defaultPrevented=!0};var Su=function(){if(!au.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{au.addEventListener("test",(()=>{}),t),au.removeEventListener("test",(()=>{}),t)}catch(e){}return e}();function Tu(e){return/^[\s\xa0]*$/.test(e)}function Iu(){var e=au.navigator;return e&&(e=e.userAgent)?e:""}function Eu(e){return-1!=Iu().indexOf(e)}function Au(e){return Au[" "](e),e}Au[" "]=function(){};var ku,Cu,xu,Ru=Eu("Opera"),Lu=Eu("Trident")||Eu("MSIE"),Mu=Eu("Edge"),Pu=Mu||Lu,Du=Eu("Gecko")&&!(-1!=Iu().toLowerCase().indexOf("webkit")&&!Eu("Edge"))&&!(Eu("Trident")||Eu("MSIE"))&&!Eu("Edge"),Nu=-1!=Iu().toLowerCase().indexOf("webkit")&&!Eu("Edge");function Ou(){var e=au.document;return e?e.documentMode:void 0}e:{var Fu="",Uu=(Cu=Iu(),Du?/rv:([^\);]+)(\)|;)/.exec(Cu):Mu?/Edge\/([\d\.]+)/.exec(Cu):Lu?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Cu):Nu?/WebKit\/(\S+)/.exec(Cu):Ru?/(?:Version)[ \/]?(\S+)/.exec(Cu):void 0);if(Uu&&(Fu=Uu?Uu[1]:""),Lu){var Vu=Ou();if(null!=Vu&&Vu>parseFloat(Fu)){ku=String(Vu);break e}}ku=Fu}if(au.document&&Lu){var Hu=Ou();xu=Hu||(parseInt(ku,10)||void 0)}else xu=void 0;var Bu=xu;function ju(e,t){if(_u.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Du){e:{try{Au(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Gu[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ju.$.h.call(this)}}gu(ju,_u);var Gu={2:"touch",3:"pen",4:"mouse"};ju.prototype.h=function(){ju.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Wu="closure_listenable_"+(1e6*Math.random()|0),zu=0;function qu(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.la=r,this.key=++zu,this.fa=this.ia=!1}function Ku(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function $u(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function Yu(e){const t={};for(const n in e)t[n]=e[n];return t}const Xu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Qu(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<Xu.length;t++)n=Xu[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function Ju(e){this.src=e,this.g={},this.h=0}function Zu(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],o=yu(r,t);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Ku(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function ec(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r];if(!o.fa&&o.listener==t&&o.capture==!!n&&o.la==i)return r}return-1}Ju.prototype.add=function(e,t,n,i,r){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var s=ec(e,t,i,r);return-1<s?(t=e[s],n||(t.ia=!1)):((t=new qu(t,this.src,o,!!i,r)).ia=n,e.push(t)),t};var tc="closure_lm_"+(1e6*Math.random()|0),nc={};function ic(e,t,n,i,r){if(i&&i.once)return oc(e,t,n,i,r);if(Array.isArray(t)){for(var o=0;o<t.length;o++)ic(e,t[o],n,i,r);return null}return n=dc(n),e&&e[Wu]?e.O(t,n,uu(i)?!!i.capture:!!i,r):rc(e,t,n,!1,i,r)}function rc(e,t,n,i,r,o){if(!t)throw Error("Invalid event type");var s=uu(r)?!!r.capture:!!r,a=cc(e);if(a||(e[tc]=a=new Ju(e)),(n=a.add(t,n,i,s,o)).proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=uc;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)Su||(r=s),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(lc(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function oc(e,t,n,i,r){if(Array.isArray(t)){for(var o=0;o<t.length;o++)oc(e,t[o],n,i,r);return null}return n=dc(n),e&&e[Wu]?e.P(t,n,uu(i)?!!i.capture:!!i,r):rc(e,t,n,!0,i,r)}function sc(e,t,n,i,r){if(Array.isArray(t))for(var o=0;o<t.length;o++)sc(e,t[o],n,i,r);else i=uu(i)?!!i.capture:!!i,n=dc(n),e&&e[Wu]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=ec(o=e.g[t],n,i,r))&&(Ku(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--)))):e&&(e=cc(e))&&(t=e.g[t.toString()],e=-1,t&&(e=ec(t,n,i,r)),(n=-1<e?t[e]:null)&&ac(n))}function ac(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Wu])Zu(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(lc(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=cc(t))?(Zu(n,e),0==n.h&&(n.src=null,t[tc]=null)):Ku(e)}}}function lc(e){return e in nc?nc[e]:nc[e]="on"+e}function uc(e,t){if(e.fa)e=!0;else{t=new ju(t,this);var n=e.listener,i=e.la||e.src;e.ia&&ac(e),e=n.call(i,t)}return e}function cc(e){return(e=e[tc])instanceof Ju?e:null}var hc="__closure_events_fn_"+(1e9*Math.random()>>>0);function dc(e){return"function"==typeof e?e:(e[hc]||(e[hc]=function(t){return e.handleEvent(t)}),e[hc])}function fc(){vu.call(this),this.i=new Ju(this),this.S=this,this.J=null}function pc(e,t){var n,i=e.J;if(i)for(n=[];i;i=i.J)n.push(i);if(e=e.S,i=t.type||t,"string"==typeof t)t=new _u(t,e);else if(t instanceof _u)t.target=t.target||e;else{var r=t;Qu(t=new _u(i,e),r)}if(r=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];r=mc(s,i,!0,t)&&r}if(r=mc(s=t.g=e,i,!0,t)&&r,r=mc(s,i,!1,t)&&r,n)for(o=0;o<n.length;o++)r=mc(s=t.g=n[o],i,!1,t)&&r}function mc(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.fa&&s.capture==n){var a=s.listener,l=s.la||s.src;s.ia&&Zu(e.i,s),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}gu(fc,vu),fc.prototype[Wu]=!0,fc.prototype.removeEventListener=function(e,t,n,i){sc(this,e,t,n,i)},fc.prototype.N=function(){if(fc.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)Ku(n[i]);delete t.g[e],t.h--}}this.J=null},fc.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},fc.prototype.P=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var gc=au.JSON.stringify;function vc(){var e=Ic;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var yc=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new bc),(e=>e.reset()));class bc{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function wc(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function _c(e){au.setTimeout((()=>{throw e}),0)}let Sc,Tc=!1,Ic=new class{constructor(){this.h=this.g=null}add(e,t){const n=yc.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Ec=()=>{const e=au.Promise.resolve(void 0);Sc=()=>{e.then(Ac)}};var Ac=()=>{for(var e;e=vc();){try{e.h.call(e.g)}catch(e){_c(e)}var t=yc;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Tc=!1};function kc(e,t){fc.call(this),this.h=e||1,this.g=t||au,this.j=pu(this.qb,this),this.l=Date.now()}function Cc(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function xc(e,t,n){if("function"==typeof e)n&&(e=pu(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=pu(e.handleEvent,e)}return 2147483647<Number(t)?-1:au.setTimeout(e,t||0)}function Rc(e){e.g=xc((()=>{e.g=null,e.i&&(e.i=!1,Rc(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}gu(kc,fc),(iu=kc.prototype).ga=!1,iu.T=null,iu.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),pc(this,"tick"),this.ga&&(Cc(this),this.start()))}},iu.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},iu.N=function(){kc.$.N.call(this),Cc(this),delete this.g};class Lc extends vu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Rc(this)}N(){super.N(),this.g&&(au.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mc(e){vu.call(this),this.h=e,this.g={}}gu(Mc,vu);var Pc=[];function Dc(e,t,n,i){Array.isArray(n)||(n&&(Pc[0]=n.toString()),n=Pc);for(var r=0;r<n.length;r++){var o=ic(t,n[r],i||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}}function Nc(e){$u(e.g,(function(e,t){this.g.hasOwnProperty(t)&&ac(e)}),e),e.g={}}function Oc(){this.g=!0}function Fc(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return gc(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}Mc.prototype.N=function(){Mc.$.N.call(this),Nc(this)},Mc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Oc.prototype.Ea=function(){this.g=!1},Oc.prototype.info=function(){};var Uc={},Vc=null;function Hc(){return Vc=Vc||new fc}function Bc(e){_u.call(this,Uc.Ta,e)}function jc(e){const t=Hc();pc(t,new Bc(t))}function Gc(e,t){_u.call(this,Uc.STAT_EVENT,e),this.stat=t}function Wc(e){const t=Hc();pc(t,new Gc(t,e))}function zc(e,t){_u.call(this,Uc.Ua,e),this.size=t}function qc(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return au.setTimeout((function(){e()}),t)}Uc.Ta="serverreachability",gu(Bc,_u),Uc.STAT_EVENT="statevent",gu(Gc,_u),Uc.Ua="timingevent",gu(zc,_u);var Kc={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},$c={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Yc(){}function Xc(e){return e.h||(e.h=e.i())}function Qc(){}Yc.prototype.h=null;var Jc,Zc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function eh(){_u.call(this,"d")}function th(){_u.call(this,"c")}function nh(){}function ih(e,t,n,i){this.l=e,this.j=t,this.m=n,this.W=i||1,this.U=new Mc(this),this.P=oh,e=Pu?125:void 0,this.V=new kc(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new rh}function rh(){this.i=null,this.g="",this.h=!1}gu(eh,_u),gu(th,_u),gu(nh,Yc),nh.prototype.g=function(){return new XMLHttpRequest},nh.prototype.i=function(){return{}},Jc=new nh;var oh=45e3,sh={},ah={};function lh(e,t,n){e.L=1,e.v=kh(Sh(t)),e.s=n,e.S=!0,uh(e,null)}function uh(e,t){e.G=Date.now(),fh(e),e.A=Sh(e.v);var n=e.A,i=e.W;Array.isArray(i)||(i=[String(i)]),Hh(n.i,"t",i),e.C=0,n=e.l.J,e.h=new rh,e.g=Vd(e.l,n?t:null,!e.s),0<e.O&&(e.M=new Lc(pu(e.Pa,e,e.g),e.O)),Dc(e.U,e.g,"readystatechange",e.nb),t=e.I?Yu(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),jc(),function(e,t,n,i,r,o){e.info((function(){if(e.g)if(o)for(var s="",a=o.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");s=2<=h.length&&"type"==h[1]?s+(c+"=")+u+"&":s+(c+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+s}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function ch(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function hh(e,t,n){let i,r=!0;for(;!e.J&&e.C<n.length;){if(i=dh(e,n),i==ah){4==t&&(e.o=4,Wc(14),r=!1),Fc(e.j,e.m,null,"[Incomplete Response]");break}if(i==sh){e.o=4,Wc(15),Fc(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}Fc(e.j,e.m,i,null),yh(e,i)}ch(e)&&i!=ah&&i!=sh&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Wc(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ld(t),t.M=!0,Wc(11))):(Fc(e.j,e.m,n,"[Invalid Chunked Response]"),vh(e),gh(e))}function dh(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?ah:(n=Number(t.substring(n,i)),isNaN(n)?sh:(i+=1)+n>t.length?ah:(t=t.slice(i,i+n),e.C=i+n,t))}function fh(e){e.Y=Date.now()+e.P,ph(e,e.P)}function ph(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=qc(pu(e.lb,e),t)}function mh(e){e.B&&(au.clearTimeout(e.B),e.B=null)}function gh(e){0==e.l.H||e.J||Dd(e.l,e)}function vh(e){mh(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Cc(e.V),Nc(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function yh(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||qh(n.i,e)))if(!e.K&&qh(n.i,e)&&3==n.H){try{var i=n.Ja.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Pd(n),Td(n)}Rd(n),Wc(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=qc(pu(n.ib,n),6e3));if(1>=zh(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else Od(n,11)}else if((e.K||n.g==e)&&Pd(n),!Tu(t))for(r=n.Ja.g.parse(t),t=0;t<r.length;t++){let u=r[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const r=u[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const c=u[5];null!=c&&"number"==typeof c&&0<c&&(i=1.5*c,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var o=i.i;o.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(Kh(o,o.h),o.h=null))}if(i.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.Da=e,Ah(i.I,i.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var s=e;if((i=n).wa=Ud(i,i.J?i.pa:null,i.Y),s.K){$h(i.i,s);var a=s,l=i.L;l&&a.setTimeout(l),a.B&&(mh(a),fh(a)),i.g=s}else xd(i);0<n.j.length&&Ed(n)}else"stop"!=u[0]&&"close"!=u[0]||Od(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Od(n,7):Sd(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}jc()}catch(e){}}function bh(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(lu(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(lu(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(lu(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,o=0;o<r;o++)t.call(void 0,i[o],n&&n[o],e)}(iu=ih.prototype).setTimeout=function(e){this.P=e},iu.nb=function(e){e=e.target;const t=this.M;t&&3==gd(e)?t.l():this.Pa(e)},iu.Pa=function(e){try{if(e==this.g)e:{const c=gd(this.g);var t=this.g.Ia();this.g.da();if(!(3>c)&&(3!=c||Pu||this.g&&(this.h.h||this.g.ja()||vd(this.g)))){this.J||4!=c||7==t||jc(),mh(this);var n=this.g.da();this.ca=n;t:if(ch(this)){var i=vd(this.g);e="";var r=i.length,o=4==gd(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){vh(this),gh(this);var s="";break t}this.h.i=new au.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:o&&t==r-1});i.splice(0,r),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==n,function(e,t,n,i,r,o,s){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Tu(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Wc(12),vh(this),gh(this);break e}Fc(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,yh(this,n)}this.S?(hh(this,c,s),Pu&&this.i&&3==c&&(Dc(this.U,this.V,"tick",this.mb),this.V.start())):(Fc(this.j,this.m,s,null),yh(this,s)),4==c&&vh(this),this.i&&!this.J&&(4==c?Dd(this.l,this):(this.i=!1,fh(this)))}else(function(e){const t={};e=(e.g&&2<=gd(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(Tu(e[i]))continue;var n=wc(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const o=t[r]||[];t[r]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.o=3,Wc(12)):(this.o=0,Wc(13)),vh(this),gh(this)}}}catch(e){}},iu.mb=function(){if(this.g){var e=gd(this.g),t=this.g.ja();this.C<t.length&&(mh(this),hh(this,e,t),this.i&&4!=e&&fh(this))}},iu.cancel=function(){this.J=!0,vh(this)},iu.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(jc(),Wc(17)),vh(this),this.o=2,gh(this)):ph(this,this.Y-e)};var wh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _h(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof _h){this.h=e.h,Th(this,e.j),this.s=e.s,this.g=e.g,Ih(this,e.m),this.l=e.l;var t=e.i,n=new Oh;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Eh(this,n),this.o=e.o}else e&&(t=String(e).match(wh))?(this.h=!1,Th(this,t[1]||"",!0),this.s=Ch(t[2]||""),this.g=Ch(t[3]||"",!0),Ih(this,t[4]),this.l=Ch(t[5]||"",!0),Eh(this,t[6]||"",!0),this.o=Ch(t[7]||"")):(this.h=!1,this.i=new Oh(null,this.h))}function Sh(e){return new _h(e)}function Th(e,t,n){e.j=n?Ch(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ih(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Eh(e,t,n){t instanceof Oh?(e.i=t,function(e,t){t&&!e.j&&(Fh(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Uh(this,t),Hh(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=xh(t,Dh)),e.i=new Oh(t,e.h))}function Ah(e,t,n){e.i.set(t,n)}function kh(e){return Ah(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Ch(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function xh(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Rh),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Rh(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}_h.prototype.toString=function(){var e=[],t=this.j;t&&e.push(xh(t,Lh,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(xh(t,Lh,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(xh(n,"/"==n.charAt(0)?Ph:Mh,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",xh(n,Nh)),e.join("")};var Lh=/[#\/\?@]/g,Mh=/[#\?:]/g,Ph=/[#\?]/g,Dh=/[#\?@]/g,Nh=/#/g;function Oh(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Fh(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var o=e[n].substring(0,i);r=e[n].substring(i+1)}else o=e[n];t(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Uh(e,t){Fh(e),t=Bh(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Vh(e,t){return Fh(e),t=Bh(e,t),e.g.has(t)}function Hh(e,t,n){Uh(e,t),0<n.length&&(e.i=null,e.g.set(Bh(e,t),bu(n)),e.h+=n.length)}function Bh(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(iu=Oh.prototype).add=function(e,t){Fh(this),this.i=null,e=Bh(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},iu.forEach=function(e,t){Fh(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},iu.ta=function(){Fh(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},iu.Z=function(e){Fh(this);let t=[];if("string"==typeof e)Vh(this,e)&&(t=t.concat(this.g.get(Bh(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},iu.set=function(e,t){return Fh(this),this.i=null,Vh(this,e=Bh(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},iu.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},iu.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const o=encodeURIComponent(String(i)),s=this.Z(i);for(i=0;i<s.length;i++){var r=o;""!==s[i]&&(r+="="+encodeURIComponent(String(s[i]))),e.push(r)}}return this.i=e.join("&")};function jh(e){this.l=e||Gh,au.PerformanceNavigationTiming?e=0<(e=au.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(au.g&&au.g.Ka&&au.g.Ka()&&au.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Gh=10;function Wh(e){return!!e.h||!!e.g&&e.g.size>=e.j}function zh(e){return e.h?1:e.g?e.g.size:0}function qh(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Kh(e,t){e.g?e.g.add(t):e.h=t}function $h(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Yh(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return bu(e.i)}jh.prototype.cancel=function(){if(this.i=Yh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Xh=class{stringify(e){return au.JSON.stringify(e,void 0)}parse(e){return au.JSON.parse(e,void 0)}};function Qh(){this.g=new Xh}function Jh(e,t,n){const i=n||"";try{bh(e,(function(e,n){let r=e;uu(e)&&(r=gc(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function Zh(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch(e){}}function ed(e){this.l=e.fc||null,this.j=e.ob||!1}function td(e,t){fc.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=nd,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gu(ed,Yc),ed.prototype.g=function(){return new td(this.l,this.j)},ed.prototype.i=function(e){return function(){return e}}({}),gu(td,fc);var nd=0;function id(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function rd(e){e.readyState=4,e.l=null,e.j=null,e.A=null,od(e)}function od(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(iu=td.prototype).open=function(e,t){if(this.readyState!=nd)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,od(this)},iu.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||au).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},iu.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,rd(this)),this.readyState=nd},iu.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,od(this)),this.g&&(this.readyState=3,od(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==au.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;id(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},iu.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?rd(this):od(this),3==this.readyState&&id(this)}},iu.Za=function(e){this.g&&(this.response=this.responseText=e,rd(this))},iu.Ya=function(e){this.g&&(this.response=e,rd(this))},iu.ka=function(){this.g&&rd(this)},iu.setRequestHeader=function(e,t){this.v.append(e,t)},iu.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},iu.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(td.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var sd=au.JSON.parse;function ad(e){fc.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ld,this.L=this.M=!1}gu(ad,fc);var ld="",ud=/^https?$/i,cd=["POST","PUT"];function hd(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,dd(e),pd(e)}function dd(e){e.F||(e.F=!0,pc(e,"complete"),pc(e,"error"))}function fd(e){if(e.h&&void 0!==su&&(!e.C[1]||4!=gd(e)||2!=e.da()))if(e.v&&4==gd(e))xc(e.La,0,e);else if(pc(e,"readystatechange"),4==gd(e)){e.h=!1;try{const s=e.da();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===s){var r=String(e.I).match(wh)[1]||null;!r&&au.self&&au.self.location&&(r=au.self.location.protocol.slice(0,-1)),i=!ud.test(r?r.toLowerCase():"")}n=i}if(n)pc(e,"complete"),pc(e,"success");else{e.m=6;try{var o=2<gd(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.da()+"]",dd(e)}}finally{pd(e)}}}function pd(e,t){if(e.g){md(e);const n=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||pc(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function md(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(au.clearTimeout(e.A),e.A=null)}function gd(e){return e.g?e.g.readyState:0}function vd(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case ld:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function yd(e){let t="";return $u(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function bd(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=yd(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Ah(e,t,n))}function wd(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function _d(e){this.Ga=0,this.j=[],this.l=new Oc,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=wd("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=wd("baseRetryDelayMs",5e3,e),this.hb=wd("retryDelaySeedMs",1e4,e),this.eb=wd("forwardChannelMaxRetries",2,e),this.xa=wd("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new jh(e&&e.concurrentRequestLimit),this.Ja=new Qh,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Sd(e){if(Id(e),3==e.H){var t=e.W++,n=Sh(e.I);if(Ah(n,"SID",e.K),Ah(n,"RID",t),Ah(n,"TYPE","terminate"),kd(e,n),(t=new ih(e,e.l,t)).L=2,t.v=kh(Sh(n)),n=!1,au.navigator&&au.navigator.sendBeacon)try{n=au.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&au.Image&&((new Image).src=t.v,n=!0),n||(t.g=Vd(t.l,null),t.g.ha(t.v)),t.G=Date.now(),fh(t)}Fd(e)}function Td(e){e.g&&(Ld(e),e.g.cancel(),e.g=null)}function Id(e){Td(e),e.u&&(au.clearTimeout(e.u),e.u=null),Pd(e),e.i.cancel(),e.m&&("number"==typeof e.m&&au.clearTimeout(e.m),e.m=null)}function Ed(e){if(!Wh(e.i)&&!e.m){e.m=!0;var t=e.Na;Sc||Ec(),Tc||(Sc(),Tc=!0),Ic.add(t,e),e.C=0}}function Ad(e,t){var n;n=t?t.m:e.W++;const i=Sh(e.I);Ah(i,"SID",e.K),Ah(i,"RID",n),Ah(i,"AID",e.V),kd(e,i),e.o&&e.s&&bd(i,e.o,e.s),n=new ih(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Cd(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Kh(e.i,n),lh(n,i,t)}function kd(e,t){e.na&&$u(e.na,(function(e,n){Ah(t,n,e)})),e.h&&bh({},(function(e,n){Ah(t,n,e)}))}function Cd(e,t,n){n=Math.min(e.j.length,n);var i=e.h?pu(e.h.Va,e.h,e):null;e:{var r=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let s=0;s<n;s++){let n=r[s].g;const a=r[s].map;if(n-=t,0>n)t=Math.max(0,r[s].g-100),o=!1;else try{Jh(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(o){i=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,i}function xd(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Sc||Ec(),Tc||(Sc(),Tc=!0),Ic.add(t,e),e.A=0}}function Rd(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=qc(pu(e.Ma,e),Nd(e,e.A)),e.A++,!0)}function Ld(e){null!=e.B&&(au.clearTimeout(e.B),e.B=null)}function Md(e){e.g=new ih(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Sh(e.wa);Ah(t,"RID","rpc"),Ah(t,"SID",e.K),Ah(t,"AID",e.V),Ah(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Ah(t,"TO",e.qa),Ah(t,"TYPE","xmlhttp"),kd(e,t),e.o&&e.s&&bd(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=kh(Sh(t)),n.s=null,n.S=!0,uh(n,e)}function Pd(e){null!=e.v&&(au.clearTimeout(e.v),e.v=null)}function Dd(e,t){var n=null;if(e.g==t){Pd(e),Ld(e),e.g=null;var i=2}else{if(!qh(e.i,t))return;n=t.F,$h(e.i,t),i=1}if(0!=e.H)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.G;var r=e.C;pc(i=Hc(),new zc(i,n)),Ed(e)}else xd(e);else if(3==(r=t.o)||0==r&&0<t.ca||!(1==i&&function(e,t){return!(zh(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=qc(pu(e.Na,e,t),Nd(e,e.C)),e.C++,0)))}(e,t)||2==i&&Rd(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:Od(e,5);break;case 4:Od(e,10);break;case 3:Od(e,6);break;default:Od(e,2)}}function Nd(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Od(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var i=pu(e.pb,e);n||(n=new _h("//www.google.com/images/cleardot.gif"),au.location&&"http"==au.location.protocol||Th(n,"https"),kh(n)),function(e,t){const n=new Oc;if(au.Image){const i=new Image;i.onload=mu(Zh,n,i,"TestLoadImage: loaded",!0,t),i.onerror=mu(Zh,n,i,"TestLoadImage: error",!1,t),i.onabort=mu(Zh,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=mu(Zh,n,i,"TestLoadImage: timeout",!1,t),au.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else Wc(2);e.H=0,e.h&&e.h.za(t),Fd(e),Id(e)}function Fd(e){if(e.H=0,e.ma=[],e.h){const t=Yh(e.i);0==t.length&&0==e.j.length||(wu(e.ma,t),wu(e.ma,e.j),e.i.i.length=0,bu(e.j),e.j.length=0),e.h.ya()}}function Ud(e,t,n){var i=n instanceof _h?Sh(n):new _h(n);if(""!=i.g)t&&(i.g=t+"."+i.g),Ih(i,i.m);else{var r=au.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var o=new _h(null);i&&Th(o,i),t&&(o.g=t),r&&Ih(o,r),n&&(o.l=n),i=o}return n=e.F,t=e.Da,n&&t&&Ah(i,n,t),Ah(i,"VER",e.ra),kd(e,i),i}function Vd(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new ad(new ed({ob:!0})):new ad(e.va)).Oa(e.J),t}function Hd(){}function Bd(){if(Lu&&!(10<=Number(Bu)))throw Error("Environmental error: no available transport.")}function jd(e,t){fc.call(this),this.g=new _d(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Tu(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Tu(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new zd(this)}function Gd(e){eh.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Wd(){th.call(this),this.status=1}function zd(e){this.g=e}function qd(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Kd(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var o=e.g[3],s=t+(o^n&(r^o))+i[0]+3614090360&4294967295;s=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=n+(s<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(r^o))+i[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(r^o))+i[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(r^o))+i[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^o&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^o&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^o&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^o&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^r^o)+i[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^o)+i[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^o)+i[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^o)+i[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(r^(n|~o))+i[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(o|~n))+i[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(r^(n|~o))+i[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(o|~n))+i[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(r^(n|~o))+i[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(o|~n))+i[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(t=n+((s=t+(r^(n|~o))+i[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((r=o+((s=r+(t^(o|~n))+i[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+o&4294967295}function $d(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var o=0|e[r];i&&o==t||(n[r]=o,i=!1)}this.g=n}(iu=ad.prototype).Oa=function(e){this.M=e},iu.ha=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Jc.g(),this.C=this.u?Xc(this.u):Xc(Jc),this.g.onreadystatechange=pu(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void hd(this,e)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),r=au.FormData&&e instanceof au.FormData,!(0<=yu(cd,t))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{md(this),0<this.B&&((this.L=function(e){return Lu&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=pu(this.ua,this)):this.A=xc(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){hd(this,e)}},iu.ua=function(){void 0!==su&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,pc(this,"timeout"),this.abort(8))},iu.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,pc(this,"complete"),pc(this,"abort"),pd(this))},iu.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),pd(this,!0)),ad.$.N.call(this)},iu.La=function(){this.s||(this.G||this.v||this.l?fd(this):this.kb())},iu.kb=function(){fd(this)},iu.isActive=function(){return!!this.g},iu.da=function(){try{return 2<gd(this)?this.g.status:-1}catch(e){return-1}},iu.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},iu.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),sd(t)}},iu.Ia=function(){return this.m},iu.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(iu=_d.prototype).ra=8,iu.H=1,iu.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const r=new ih(this,this.l,e);let o=this.s;if(this.U&&(o?(o=Yu(o),Qu(o,this.U)):o=this.U),null!==this.o||this.O||(r.I=o,o=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Cd(this,r,t),Ah(n=Sh(this.I),"RID",e),Ah(n,"CVER",22),this.F&&Ah(n,"X-HTTP-Session-Id",this.F),kd(this,n),o&&(this.O?t="headers="+encodeURIComponent(String(yd(o)))+"&"+t:this.o&&bd(n,this.o,o)),Kh(this.i,r),this.bb&&Ah(n,"TYPE","init"),this.P?(Ah(n,"$req",t),Ah(n,"SID","null"),r.aa=!0,lh(r,n,null)):lh(r,n,t),this.H=2}}else 3==this.H&&(e?Ad(this,e):0==this.j.length||Wh(this.i)||Ad(this))},iu.Ma=function(){if(this.u=null,Md(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=qc(pu(this.jb,this),e)}},iu.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Wc(10),Td(this),Md(this))},iu.ib=function(){null!=this.v&&(this.v=null,Td(this),Rd(this),Wc(19))},iu.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Wc(2)):(this.l.info("Failed to ping google.com"),Wc(1))},iu.isActive=function(){return!!this.h&&this.h.isActive(this)},(iu=Hd.prototype).Ba=function(){},iu.Aa=function(){},iu.za=function(){},iu.ya=function(){},iu.isActive=function(){return!0},iu.Va=function(){},Bd.prototype.g=function(e,t){return new jd(e,t)},gu(jd,fc),jd.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Wc(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Ud(e,null,e.Y),Ed(e)},jd.prototype.close=function(){Sd(this.g)},jd.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=gc(e),e=n);t.j.push(new class{constructor(e,t){this.g=e,this.map=t}}(t.fb++,e)),3==t.H&&Ed(t)},jd.prototype.N=function(){this.g.h=null,delete this.j,Sd(this.g),delete this.g,jd.$.N.call(this)},gu(Gd,eh),gu(Wd,th),gu(zd,Hd),zd.prototype.Ba=function(){pc(this.g,"a")},zd.prototype.Aa=function(e){pc(this.g,new Gd(e))},zd.prototype.za=function(e){pc(this.g,new Wd)},zd.prototype.ya=function(){pc(this.g,"b")},gu(qd,(function(){this.blockSize=-1})),qd.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},qd.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.m,r=this.h,o=0;o<t;){if(0==r)for(;o<=n;)Kd(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(i[r++]=e.charCodeAt(o++),r==this.blockSize){Kd(this,i),r=0;break}}else for(;o<t;)if(i[r++]=e[o++],r==this.blockSize){Kd(this,i),r=0;break}}this.h=r,this.i+=t},qd.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var Yd={};function Xd(e){return-128<=e&&128>e?function(e,t){var n=Yd;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new $d([0|e],0>e?-1:0)})):new $d([0|e],0>e?-1:0)}function Qd(e){if(isNaN(e)||!isFinite(e))return Zd;if(0>e)return of(Qd(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=Jd;return new $d(t,0)}var Jd=4294967296,Zd=Xd(0),ef=Xd(1),tf=Xd(16777216);function nf(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function rf(e){return-1==e.h}function of(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new $d(n,~e.h).add(ef)}function sf(e,t){return e.add(of(t))}function af(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function lf(e,t){this.g=e,this.h=t}function uf(e,t){if(nf(t))throw Error("division by zero");if(nf(e))return new lf(Zd,Zd);if(rf(e))return t=uf(of(e),t),new lf(of(t.g),of(t.h));if(rf(t))return t=uf(e,of(t)),new lf(of(t.g),t.h);if(30<e.g.length){if(rf(e)||rf(t))throw Error("slowDivide_ only works with positive integers.");for(var n=ef,i=t;0>=i.X(e);)n=cf(n),i=cf(i);var r=hf(n,1),o=hf(i,1);for(i=hf(i,2),n=hf(n,2);!nf(i);){var s=o.add(i);0>=s.X(e)&&(r=r.add(n),o=s),i=hf(i,1),n=hf(n,1)}return t=sf(e,r.R(t)),new lf(r,t)}for(r=Zd;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),s=(o=Qd(n)).R(t);rf(s)||0<s.X(e);)s=(o=Qd(n-=i)).R(t);nf(o)&&(o=ef),r=r.add(o),e=sf(e,s)}return new lf(r,e)}function cf(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.D(i)<<1|e.D(i-1)>>>31;return new $d(n,e.h)}function hf(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,r=[],o=0;o<i;o++)r[o]=0<t?e.D(o+n)>>>t|e.D(o+n+1)<<32-t:e.D(o+n);return new $d(r,e.h)}(iu=$d.prototype).ea=function(){if(rf(this))return-of(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.D(n);e+=(0<=i?i:Jd+i)*t,t*=Jd}return e},iu.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(nf(this))return"0";if(rf(this))return"-"+of(this).toString(e);for(var t=Qd(Math.pow(e,6)),n=this,i="";;){var r=uf(n,t).g,o=((0<(n=sf(n,r.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(nf(n=r))return o+i;for(;6>o.length;)o="0"+o;i=o+i}},iu.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},iu.X=function(e){return rf(e=sf(this,e))?-1:nf(e)?0:1},iu.abs=function(){return rf(this)?of(this):this},iu.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,r=0;r<=t;r++){var o=i+(65535&this.D(r))+(65535&e.D(r)),s=(o>>>16)+(this.D(r)>>>16)+(e.D(r)>>>16);i=s>>>16,o&=65535,s&=65535,n[r]=s<<16|o}return new $d(n,-2147483648&n[n.length-1]?-1:0)},iu.R=function(e){if(nf(this)||nf(e))return Zd;if(rf(this))return rf(e)?of(this).R(of(e)):of(of(this).R(e));if(rf(e))return of(this.R(of(e)));if(0>this.X(tf)&&0>e.X(tf))return Qd(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<e.g.length;r++){var o=this.D(i)>>>16,s=65535&this.D(i),a=e.D(r)>>>16,l=65535&e.D(r);n[2*i+2*r]+=s*l,af(n,2*i+2*r),n[2*i+2*r+1]+=o*l,af(n,2*i+2*r+1),n[2*i+2*r+1]+=s*a,af(n,2*i+2*r+1),n[2*i+2*r+2]+=o*a,af(n,2*i+2*r+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new $d(n,0)},iu.gb=function(e){return uf(this,e).h},iu.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)&e.D(i);return new $d(n,this.h&e.h)},iu.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)|e.D(i);return new $d(n,this.h|e.h)},iu.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)^e.D(i);return new $d(n,this.h^e.h)},Bd.prototype.createWebChannel=Bd.prototype.g,jd.prototype.send=jd.prototype.u,jd.prototype.open=jd.prototype.m,jd.prototype.close=jd.prototype.close,Kc.NO_ERROR=0,Kc.TIMEOUT=8,Kc.HTTP_ERROR=6,$c.COMPLETE="complete",Qc.EventType=Zc,Zc.OPEN="a",Zc.CLOSE="b",Zc.ERROR="c",Zc.MESSAGE="d",fc.prototype.listen=fc.prototype.O,ad.prototype.listenOnce=ad.prototype.P,ad.prototype.getLastError=ad.prototype.Sa,ad.prototype.getLastErrorCode=ad.prototype.Ia,ad.prototype.getStatus=ad.prototype.da,ad.prototype.getResponseJson=ad.prototype.Wa,ad.prototype.getResponseText=ad.prototype.ja,ad.prototype.send=ad.prototype.ha,ad.prototype.setWithCredentials=ad.prototype.Oa,qd.prototype.digest=qd.prototype.l,qd.prototype.reset=qd.prototype.reset,qd.prototype.update=qd.prototype.j,$d.prototype.add=$d.prototype.add,$d.prototype.multiply=$d.prototype.R,$d.prototype.modulo=$d.prototype.gb,$d.prototype.compare=$d.prototype.X,$d.prototype.toNumber=$d.prototype.ea,$d.prototype.toString=$d.prototype.toString,$d.prototype.getBits=$d.prototype.D,$d.fromNumber=Qd,$d.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return of(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Qd(Math.pow(n,8)),r=Zd,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),a=parseInt(t.substring(o,o+s),n);8>s?(s=Qd(Math.pow(n,s)),r=r.R(s).add(Qd(a))):r=(r=r.R(i)).add(Qd(a))}return r};var df=ou.createWebChannelTransport=function(){return new Bd},ff=ou.getStatEventTarget=function(){return Hc()},pf=ou.ErrorCode=Kc,mf=ou.EventType=$c,gf=ou.Event=Uc,vf=ou.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},yf=ou.FetchXmlHttpFactory=ed,bf=ou.WebChannel=Qc,wf=ou.XhrIo=ad,_f=ou.Md5=qd,Sf=ou.Integer=$d;const Tf="@firebase/firestore";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}If.UNAUTHENTICATED=new If(null),If.GOOGLE_CREDENTIALS=new If("google-credentials-uid"),If.FIRST_PARTY=new If("first-party-uid"),If.MOCK_USER=new If("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Ef="9.22.1";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Af=new Ni("@firebase/firestore");function kf(){return Af.logLevel}function Cf(e,...t){if(Af.logLevel<=xi.DEBUG){const n=t.map(Lf);Af.debug(`Firestore (${Ef}): ${e}`,...n)}}function xf(e,...t){if(Af.logLevel<=xi.ERROR){const n=t.map(Lf);Af.error(`Firestore (${Ef}): ${e}`,...n)}}function Rf(e,...t){if(Af.logLevel<=xi.WARN){const n=t.map(Lf);Af.warn(`Firestore (${Ef}): ${e}`,...n)}}function Lf(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mf(e="Unexpected state"){const t=`FIRESTORE (${Ef}) INTERNAL ASSERTION FAILED: `+e;throw xf(t),new Error(t)}function Pf(e,t){e||Mf()}function Df(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Of extends ci{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Vf{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(If.UNAUTHENTICATED)))}shutdown(){}}class Hf{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Bf{constructor(e){this.t=e,this.currentUser=If.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new Ff;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ff,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},s=e=>{Cf("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(Cf("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ff)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Cf("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Pf("string"==typeof t.accessToken),new Uf(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Pf(null===e||"string"==typeof e),new If(e)}}class jf{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=If.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Gf{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new jf(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(If.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Wf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class zf{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&Cf("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,Cf("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{Cf("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?i(e):Cf("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Pf("string"==typeof e.token),this.T=e.token,new Wf(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function qf(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=qf(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<t&&(n+=e.charAt(i[r]%e.length))}return n}}function $f(e,t){return e<t?-1:e>t?1:0}function Yf(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Xf{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Of(Nf.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Of(Nf.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Of(Nf.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Of(Nf.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Xf.fromMillis(Date.now())}static fromDate(e){return Xf.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Xf(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$f(this.nanoseconds,e.nanoseconds):$f(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Qf(e)}static min(){return new Qf(new Xf(0,0))}static max(){return new Qf(new Xf(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,t,n){void 0===t?t=0:t>e.length&&Mf(),void 0===n?n=e.length-t:n>e.length-t&&Mf(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Jf.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Jf?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Zf extends Jf{construct(e,t,n){return new Zf(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Of(Nf.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Zf(t)}static emptyPath(){return new Zf([])}}const ep=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tp extends Jf{construct(e,t,n){return new tp(e,t,n)}static isValidIdentifier(e){return ep.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tp.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new tp(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Of(Nf.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Of(Nf.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Of(Nf.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(o=!o,i++):"."!==t||o?(n+=t,i++):(r(),i++)}if(r(),o)throw new Of(Nf.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tp(t)}static emptyPath(){return new tp([])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e){this.path=e}static fromPath(e){return new np(Zf.fromString(e))}static fromName(e){return new np(Zf.fromString(e).popFirst(5))}static empty(){return new np(Zf.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Zf.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Zf.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new np(new Zf(e.slice()))}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}ip.UNKNOWN_ID=-1;function rp(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Qf.fromTimestamp(1e9===i?new Xf(n+1,0):new Xf(n,i));return new sp(r,np.empty(),t)}function op(e){return new sp(e.readTime,e.key,-1)}class sp{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new sp(Qf.min(),np.empty(),-1)}static max(){return new sp(Qf.max(),np.empty(),-1)}}function ap(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=np.comparator(e.documentKey,t.documentKey),0!==n?n:$f(e.largestBatchId,t.largestBatchId))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class up{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cp(e){if(e.code!==Nf.FAILED_PRECONDITION||e.message!==lp)throw e;Cf("LocalStore","Unexpectedly lost primary lease")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Mf(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new hp(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof hp?t:hp.resolve(t)}catch(e){return hp.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):hp.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):hp.reject(t)}static resolve(e){return new hp(((t,n)=>{t(e)}))}static reject(e){return new hp(((t,n)=>{n(e)}))}static waitFor(e){return new hp(((t,n)=>{let i=0,r=0,o=!1;e.forEach((e=>{++i,e.next((()=>{++r,o&&r===i&&t()}),(e=>n(e)))})),o=!0,r===i&&t()}))}static or(e){let t=hp.resolve(!1);for(const n of e)t=t.next((e=>e?hp.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new hp(((n,i)=>{const r=e.length,o=new Array(r);let s=0;for(let a=0;a<r;a++){const l=a;t(e[l]).next((e=>{o[l]=e,++s,s===r&&n(o)}),(e=>i(e)))}}))}static doWhile(e,t){return new hp(((n,i)=>{const r=()=>{!0===e()?t().next((()=>{r()}),i):n()};r()}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(e){return"IndexedDbTransactionError"===e.name}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class fp{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function pp(e){return null==e}function mp(e){return 0===e&&1/e==-1/0}function gp(e){return"number"==typeof e&&Number.isInteger(e)&&!mp(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fp.ct=-1;const vp=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],yp=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],bp=yp;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function wp(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function _p(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Sp(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,t){this.comparator=e,this.root=t||Ep.EMPTY}insert(e,t){return new Tp(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ep.BLACK,null,null))}remove(e){return new Tp(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ep.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ip(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ip(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ip(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ip(this.root,e,this.comparator,!0)}}class Ip{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ep{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Ep.RED,this.left=null!=i?i:Ep.EMPTY,this.right=null!=r?r:Ep.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new Ep(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ep.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ep.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ep.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ep.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Mf();if(this.right.isRed())throw Mf();const e=this.left.check();if(e!==this.right.check())throw Mf();return e+(this.isRed()?0:1)}}Ep.EMPTY=null,Ep.RED=!0,Ep.BLACK=!1,Ep.EMPTY=new class{constructor(){this.size=0}get key(){throw Mf()}get value(){throw Mf()}get color(){throw Mf()}get left(){throw Mf()}get right(){throw Mf()}copy(e,t,n,i,r){return this}insert(e,t,n){return new Ep(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ap{constructor(e){this.comparator=e,this.data=new Tp(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kp(this.data.getIterator())}getIteratorFrom(e){return new kp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Ap))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ap(this.comparator);return t.data=e,t}}class kp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Cp{constructor(e){this.fields=e,e.sort(tp.comparator)}static empty(){return new Cp([])}unionWith(e){let t=new Ap(tp.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Cp(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Yf(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Rp{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new xp("Invalid base64 string: "+e):e}}(e);return new Rp(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Rp(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){var e;return e=this.binaryString,btoa(e)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $f(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rp.EMPTY_BYTE_STRING=new Rp("");const Lp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mp(e){if(Pf(!!e),"string"==typeof e){let t=0;const n=Lp.exec(e);if(Pf(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Pp(e.seconds),nanos:Pp(e.nanos)}}function Pp(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Dp(e){return"string"==typeof e?Rp.fromBase64String(e):Rp.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Op(e){const t=e.mapValue.fields.__previous_value__;return Np(t)?Op(t):t}function Fp(e){const t=Mp(e.mapValue.fields.__local_write_time__.timestampValue);return new Xf(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,t,n,i,r,o,s,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=l}}class Vp{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Vp("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Vp&&e.projectId===this.projectId&&e.database===this.database}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Bp(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Np(e)?4:tm(e)?9007199254740991:10:Mf()}function jp(e,t){if(e===t)return!0;const n=Bp(e);if(n!==Bp(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Fp(e).isEqual(Fp(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Mp(e.timestampValue),i=Mp(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Dp(e.bytesValue).isEqual(Dp(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Pp(e.geoPointValue.latitude)===Pp(t.geoPointValue.latitude)&&Pp(e.geoPointValue.longitude)===Pp(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Pp(e.integerValue)===Pp(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Pp(e.doubleValue),i=Pp(t.doubleValue);return n===i?mp(n)===mp(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return Yf(e.arrayValue.values||[],t.arrayValue.values||[],jp);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(wp(n)!==wp(i))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===i[e]||!jp(n[e],i[e])))return!1;return!0}(e,t);default:return Mf()}}function Gp(e,t){return void 0!==(e.values||[]).find((e=>jp(e,t)))}function Wp(e,t){if(e===t)return 0;const n=Bp(e),i=Bp(t);if(n!==i)return $f(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return $f(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Pp(e.integerValue||e.doubleValue),i=Pp(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return zp(e.timestampValue,t.timestampValue);case 4:return zp(Fp(e),Fp(t));case 5:return $f(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Dp(e),i=Dp(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let e=0;e<n.length&&e<i.length;e++){const t=$f(n[e],i[e]);if(0!==t)return t}return $f(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=$f(Pp(e.latitude),Pp(t.latitude));return 0!==n?n:$f(Pp(e.longitude),Pp(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let e=0;e<n.length&&e<i.length;++e){const t=Wp(n[e],i[e]);if(t)return t}return $f(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Hp.mapValue&&t===Hp.mapValue)return 0;if(e===Hp.mapValue)return 1;if(t===Hp.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},o=Object.keys(r);i.sort(),o.sort();for(let e=0;e<i.length&&e<o.length;++e){const t=$f(i[e],o[e]);if(0!==t)return t;const s=Wp(n[i[e]],r[o[e]]);if(0!==s)return s}return $f(i.length,o.length)}(e.mapValue,t.mapValue);default:throw Mf()}}function zp(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return $f(e,t);const n=Mp(e),i=Mp(t),r=$f(n.seconds,i.seconds);return 0!==r?r:$f(n.nanos,i.nanos)}function qp(e){return Kp(e)}function Kp(e){var t,n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Mp(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Dp(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,np.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Kp(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${Kp(e.fields[r])}`;return n+"}"}(e.mapValue):Mf()}function $p(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Yp(e){return!!e&&"integerValue"in e}function Xp(e){return!!e&&"arrayValue"in e}function Qp(e){return!!e&&"nullValue"in e}function Jp(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Zp(e){return!!e&&"mapValue"in e}function em(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return _p(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=em(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=em(e.arrayValue.values[n]);return t}return Object.assign({},e)}function tm(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class nm{constructor(e){this.value=e}static empty(){return new nm({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Zp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=em(t)}setAll(e){let t=tp.emptyPath(),n={},i=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=em(e):i.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());Zp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jp(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Zp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){_p(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new nm(em(this.value))}}function im(e){const t=[];return _p(e.fields,((e,n)=>{const i=new tp([e]);if(Zp(n)){const e=im(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new Cp(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class rm{constructor(e,t,n,i,r,o,s){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=o,this.documentState=s}static newInvalidDocument(e){return new rm(e,0,Qf.min(),Qf.min(),Qf.min(),nm.empty(),0)}static newFoundDocument(e,t,n,i){return new rm(e,1,t,Qf.min(),n,i,0)}static newNoDocument(e,t){return new rm(e,2,t,Qf.min(),Qf.min(),nm.empty(),0)}static newUnknownDocument(e,t){return new rm(e,3,t,Qf.min(),Qf.min(),nm.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qf.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nm.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nm.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qf.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof rm&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rm(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,t){this.position=e,this.inclusive=t}}function sm(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const o=t[r],s=e.position[r];if(i=o.field.isKeyField()?np.comparator(np.fromName(s.referenceValue),n.key):Wp(s,n.data.field(o.field)),"desc"===o.dir&&(i*=-1),0!==i)break}return i}function am(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!jp(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,t="asc"){this.field=e,this.dir=t}}function um(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{}class hm extends cm{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new bm(e,t,n):"array-contains"===t?new Tm(e,n):"in"===t?new Im(e,n):"not-in"===t?new Em(e,n):"array-contains-any"===t?new Am(e,n):new hm(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new wm(e,n):new _m(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Wp(t,this.value)):null!==t&&Bp(this.value)===Bp(t)&&this.matchesComparison(Wp(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Mf()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class dm extends cm{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new dm(e,t)}matches(e){return fm(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft((e=>e.isInequality()));return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function fm(e){return"and"===e.op}function pm(e){return mm(e)&&fm(e)}function mm(e){for(const t of e.filters)if(t instanceof dm)return!1;return!0}function gm(e){if(e instanceof hm)return e.field.canonicalString()+e.op.toString()+qp(e.value);if(pm(e))return e.filters.map((e=>gm(e))).join(",");{const t=e.filters.map((e=>gm(e))).join(",");return`${e.op}(${t})`}}function vm(e,t){return e instanceof hm?function(e,t){return t instanceof hm&&e.op===t.op&&e.field.isEqual(t.field)&&jp(e.value,t.value)}(e,t):e instanceof dm?function(e,t){return t instanceof dm&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&vm(n,t.filters[i])),!0)}(e,t):void Mf()}function ym(e){return e instanceof hm?function(e){return`${e.field.canonicalString()} ${e.op} ${qp(e.value)}`}(e):e instanceof dm?function(e){return e.op.toString()+" {"+e.getFilters().map(ym).join(" ,")+"}"}(e):"Filter"}class bm extends hm{constructor(e,t,n){super(e,t,n),this.key=np.fromName(n.referenceValue)}matches(e){const t=np.comparator(e.key,this.key);return this.matchesComparison(t)}}class wm extends hm{constructor(e,t){super(e,"in",t),this.keys=Sm("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class _m extends hm{constructor(e,t){super(e,"not-in",t),this.keys=Sm("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Sm(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>np.fromName(e.referenceValue)))}class Tm extends hm{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xp(t)&&Gp(t.arrayValue,this.value)}}class Im extends hm{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Gp(this.value.arrayValue,t)}}class Em extends hm{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Gp(this.value.arrayValue,t)}}class Am extends hm{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Gp(this.value.arrayValue,e)))}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,t=null,n=[],i=[],r=null,o=null,s=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.dt=null}}function Cm(e,t=null,n=[],i=[],r=null,o=null,s=null){return new km(e,t,n,i,r,o,s)}function xm(e){const t=Df(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>gm(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),pp(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>qp(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>qp(e))).join(",")),t.dt=e}return t.dt}function Rm(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!um(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!vm(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!am(e.startAt,t.startAt)&&am(e.endAt,t.endAt)}function Lm(e){return np.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Mm{constructor(e,t=null,n=[],i=[],r=null,o="F",s=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=o,this.startAt=s,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function Pm(e,t,n,i,r,o,s,a){return new Mm(e,t,n,i,r,o,s,a)}function Dm(e){return new Mm(e)}function Nm(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Om(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Fm(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function Um(e){return null!==e.collectionGroup}function Vm(e){const t=Df(e);if(null===t.wt){t.wt=[];const e=Fm(t),n=Om(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new lm(e)),t.wt.push(new lm(tp.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new lm(tp.keyField(),e))}}}return t.wt}function Hm(e){const t=Df(e);if(!t._t)if("F"===t.limitType)t._t=Cm(t.path,t.collectionGroup,Vm(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of Vm(t)){const t="desc"===n.dir?"asc":"desc";e.push(new lm(n.field,t))}const n=t.endAt?new om(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new om(t.startAt.position,t.startAt.inclusive):null;t._t=Cm(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}return t._t}function Bm(e,t){t.getFirstInequalityField(),Fm(e);const n=e.filters.concat([t]);return new Mm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function jm(e,t,n){return new Mm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Gm(e,t){return Rm(Hm(e),Hm(t))&&e.limitType===t.limitType}function Wm(e){return`${xm(Hm(e))}|lt:${e.limitType}`}function zm(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>ym(e))).join(", ")}]`),pp(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>qp(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>qp(e))).join(",")),`Target(${t})`}(Hm(e))}; limitType=${e.limitType})`}function qm(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):np.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Vm(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=sm(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,Vm(e),t))&&!(e.endAt&&!function(e,t,n){const i=sm(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,Vm(e),t))}(e,t)}function Km(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function $m(e){return(t,n)=>{let i=!1;for(const r of Vm(e)){const e=Ym(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function Ym(e,t,n){const i=e.field.isKeyField()?np.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?Wp(i,r):Mf()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Mf()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,i]of n)if(this.equalsFn(t,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_p(this.inner,((t,n)=>{for(const[t,i]of n)e(t,i)}))}isEmpty(){return Sp(this.inner)}size(){return this.innerSize}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qm=new Tp(np.comparator);function Jm(){return Qm}const Zm=new Tp(np.comparator);function eg(...e){let t=Zm;for(const n of e)t=t.insert(n.key,n);return t}function tg(e){let t=Zm;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function ng(){return rg()}function ig(){return rg()}function rg(){return new Xm((e=>e.toString()),((e,t)=>e.isEqual(t)))}const og=new Tp(np.comparator),sg=new Ap(np.comparator);function ag(...e){let t=sg;for(const n of e)t=t.add(n);return t}const lg=new Ap($f);function ug(){return lg}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mp(t)?"-0":t}}function hg(e){return{integerValue:""+e}}function dg(e,t){return gp(t)?hg(t):cg(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(){this._=void 0}}function pg(e,t,n){return e instanceof vg?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Np(t)&&(t=Op(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof yg?bg(e,t):e instanceof wg?_g(e,t):function(e,t){const n=gg(e,t),i=Tg(n)+Tg(e.gt);return Yp(n)&&Yp(e.gt)?hg(i):cg(e.serializer,i)}(e,t)}function mg(e,t,n){return e instanceof yg?bg(e,t):e instanceof wg?_g(e,t):n}function gg(e,t){var n;return e instanceof Sg?Yp(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null}class vg extends fg{}class yg extends fg{constructor(e){super(),this.elements=e}}function bg(e,t){const n=Ig(t);for(const t of e.elements)n.some((e=>jp(e,t)))||n.push(t);return{arrayValue:{values:n}}}class wg extends fg{constructor(e){super(),this.elements=e}}function _g(e,t){let n=Ig(t);for(const t of e.elements)n=n.filter((e=>!jp(e,t)));return{arrayValue:{values:n}}}class Sg extends fg{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Tg(e){return Pp(e.integerValue||e.doubleValue)}function Ig(e){return Xp(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,t){this.version=e,this.transformResults=t}}class Ag{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ag}static exists(e){return new Ag(void 0,e)}static updateTime(e){return new Ag(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kg(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Cg{}function xg(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Vg(e.key,Ag.none()):new Dg(e.key,e.data,Ag.none());{const n=e.data,i=nm.empty();let r=new Ap(tp.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new Ng(e.key,i,new Cp(r.toArray()),Ag.none())}}function Rg(e,t,n){e instanceof Dg?function(e,t,n){const i=e.value.clone(),r=Fg(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof Ng?function(e,t,n){if(!kg(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Fg(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(Og(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Lg(e,t,n,i){return e instanceof Dg?function(e,t,n,i){if(!kg(e.precondition,t))return n;const r=e.value.clone(),o=Ug(e.fieldTransforms,i,t);return r.setAll(o),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof Ng?function(e,t,n,i){if(!kg(e.precondition,t))return n;const r=Ug(e.fieldTransforms,i,t),o=t.data;return o.setAll(Og(e)),o.setAll(r),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return kg(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Mg(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=gg(i.transform,e||null);null!=r&&(null===n&&(n=nm.empty()),n.set(i.field,r))}return n||null}function Pg(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Yf(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof yg&&t instanceof yg||e instanceof wg&&t instanceof wg?Yf(e.elements,t.elements,jp):e instanceof Sg&&t instanceof Sg?jp(e.gt,t.gt):e instanceof vg&&t instanceof vg}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Dg extends Cg{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ng extends Cg{constructor(e,t,n,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Og(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function Fg(e,t,n){const i=new Map;Pf(e.length===n.length);for(let r=0;r<n.length;r++){const o=e[r],s=o.transform,a=t.data.field(o.field);i.set(o.field,mg(s,a,n[r]))}return i}function Ug(e,t,n){const i=new Map;for(const r of e){const e=r.transform,o=n.data.field(r.field);i.set(r.field,pg(e,o,t))}return i}class Vg extends Cg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Hg extends Cg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const i=this.mutations[t];i.key.isEqual(e.key)&&Rg(i,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Lg(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Lg(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=ig();return this.mutations.forEach((i=>{const r=e.get(i.key),o=r.overlayedDocument;let s=this.applyToLocalView(o,r.mutatedFields);s=t.has(i.key)?null:s;const a=xg(o,s);null!==a&&n.set(i.key,a),o.isValidDocument()||o.convertToNoDocument(Qf.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ag())}isEqual(e){return this.batchId===e.batchId&&Yf(this.mutations,e.mutations,((e,t)=>Pg(e,t)))&&Yf(this.baseMutations,e.baseMutations,((e,t)=>Pg(e,t)))}}class jg{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Pf(e.mutations.length===n.length);let i=og;const r=e.mutations;for(let e=0;e<r.length;e++)i=i.insert(r[e].key,n[e].version);return new jg(e,t,n,i)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Wg{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zg,qg;function Kg(e){switch(e){default:return Mf();case Nf.CANCELLED:case Nf.UNKNOWN:case Nf.DEADLINE_EXCEEDED:case Nf.RESOURCE_EXHAUSTED:case Nf.INTERNAL:case Nf.UNAVAILABLE:case Nf.UNAUTHENTICATED:return!1;case Nf.INVALID_ARGUMENT:case Nf.NOT_FOUND:case Nf.ALREADY_EXISTS:case Nf.PERMISSION_DENIED:case Nf.FAILED_PRECONDITION:case Nf.ABORTED:case Nf.OUT_OF_RANGE:case Nf.UNIMPLEMENTED:case Nf.DATA_LOSS:return!0}}function $g(e){if(void 0===e)return xf("GRPC error has no .code"),Nf.UNKNOWN;switch(e){case zg.OK:return Nf.OK;case zg.CANCELLED:return Nf.CANCELLED;case zg.UNKNOWN:return Nf.UNKNOWN;case zg.DEADLINE_EXCEEDED:return Nf.DEADLINE_EXCEEDED;case zg.RESOURCE_EXHAUSTED:return Nf.RESOURCE_EXHAUSTED;case zg.INTERNAL:return Nf.INTERNAL;case zg.UNAVAILABLE:return Nf.UNAVAILABLE;case zg.UNAUTHENTICATED:return Nf.UNAUTHENTICATED;case zg.INVALID_ARGUMENT:return Nf.INVALID_ARGUMENT;case zg.NOT_FOUND:return Nf.NOT_FOUND;case zg.ALREADY_EXISTS:return Nf.ALREADY_EXISTS;case zg.PERMISSION_DENIED:return Nf.PERMISSION_DENIED;case zg.FAILED_PRECONDITION:return Nf.FAILED_PRECONDITION;case zg.ABORTED:return Nf.ABORTED;case zg.OUT_OF_RANGE:return Nf.OUT_OF_RANGE;case zg.UNIMPLEMENTED:return Nf.UNIMPLEMENTED;case zg.DATA_LOSS:return Nf.DATA_LOSS;default:return Mf()}}(qg=zg||(zg={}))[qg.OK=0]="OK",qg[qg.CANCELLED=1]="CANCELLED",qg[qg.UNKNOWN=2]="UNKNOWN",qg[qg.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qg[qg.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qg[qg.NOT_FOUND=5]="NOT_FOUND",qg[qg.ALREADY_EXISTS=6]="ALREADY_EXISTS",qg[qg.PERMISSION_DENIED=7]="PERMISSION_DENIED",qg[qg.UNAUTHENTICATED=16]="UNAUTHENTICATED",qg[qg.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qg[qg.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qg[qg.ABORTED=10]="ABORTED",qg[qg.OUT_OF_RANGE=11]="OUT_OF_RANGE",qg[qg.UNIMPLEMENTED=12]="UNIMPLEMENTED",qg[qg.INTERNAL=13]="INTERNAL",qg[qg.UNAVAILABLE=14]="UNAVAILABLE",qg[qg.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Yg{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Xg}static getOrCreateInstance(){return null===Xg&&(Xg=new Yg),Xg}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach((t=>t(e)))}}let Xg=null;
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(){return new TextEncoder}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg=new Sf([4294967295,4294967295],0);function Zg(e){const t=Qg().encode(e),n=new _f;return n.update(t),new Uint8Array(n.digest())}function ev(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new Sf([n,i],0),new Sf([r,o],0)]}class tv{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new nv(`Invalid padding: ${t}`);if(n<0)throw new nv(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new nv(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new nv(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Sf.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(Sf.fromNumber(n)));return 1===i.compare(Jg)&&(i=new Sf([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=Zg(e),[n,i]=ev(t);for(let e=0;e<this.hashCount;e++){const t=this.Et(n,i,e);if(!this.At(t))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new tv(r,i,t);return n.forEach((e=>o.insert(e))),o}insert(e){if(0===this.It)return;const t=Zg(e),[n,i]=ev(t);for(let e=0;e<this.hashCount;e++){const t=this.Et(n,i,e);this.Rt(t)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class nv extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,rv.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new iv(Qf.min(),i,new Tp($f),Jm(),ag())}}class rv{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new rv(n,t,ag(),ag(),ag())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class sv{constructor(e,t){this.targetId=e,this.Vt=t}}class av{constructor(e,t,n=Rp.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class lv{constructor(){this.St=0,this.Dt=hv(),this.Ct=Rp.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=ag(),t=ag(),n=ag();return this.Dt.forEach(((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Mf()}})),new rv(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=hv()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class uv{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Jm(),this.zt=cv(),this.Wt=new Tp($f)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,(t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:Mf()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach(((e,n)=>{this.te(n)&&t(n)}))}ne(e){var t;const n=e.targetId,i=e.Vt.count,r=this.se(n);if(r){const o=r.target;if(Lm(o))if(0===i){const e=new np(o.path);this.Yt(n,e,rm.newNoDocument(e,Qf.min()))}else Pf(1===i);else{const r=this.ie(n);if(r!==i){const i=this.re(e,r);if(0!==i){this.ee(n);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=Yg.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var i,r,o,s,a,l;const u={localCacheCount:t,existenceFilterCount:n.count},c=n.unchangedNames;return c&&(u.bloomFilter={applied:0===e,hashCount:null!==(i=null==c?void 0:c.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(s=null===(o=null===(r=null==c?void 0:c.bits)||void 0===r?void 0:r.bitmap)||void 0===o?void 0:o.length)&&void 0!==s?s:0,padding:null!==(l=null===(a=null==c?void 0:c.bits)||void 0===a?void 0:a.padding)&&void 0!==l?l:0}),u}(i,r,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:r="",padding:o=0},hashCount:s=0}=n;let a,l;try{a=Dp(r).toUint8Array()}catch(e){if(e instanceof xp)return Rf("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{l=new tv(a,o,s)}catch(e){return Rf(e instanceof nv?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Gt.ue(),o=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.vt(o)||(this.Yt(e,n,null),i++)})),i}ce(e){const t=new Map;this.Qt.forEach(((n,i)=>{const r=this.se(i);if(r){if(n.current&&Lm(r.target)){const t=new np(r.target.path);null!==this.jt.get(t)||this.ae(i,t)||this.Yt(i,t,rm.newNoDocument(t,e))}n.Mt&&(t.set(i,n.Ot()),n.Ft())}}));let n=ag();this.zt.forEach(((e,t)=>{let i=!0;t.forEachWhile((e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)})),i&&(n=n.add(e))})),this.jt.forEach(((t,n)=>n.setReadTime(e)));const i=new iv(e,t,this.Wt,this.jt,n);return this.jt=Jm(),this.zt=cv(),this.Wt=new Tp($f),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new lv,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Ap($f),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Cf("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new lv),this.Gt.getRemoteKeysForTarget(e).forEach((t=>{this.Yt(e,t,null)}))}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function cv(){return new Tp(np.comparator)}function hv(){return new Tp(np.comparator)}const dv={asc:"ASCENDING",desc:"DESCENDING"},fv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pv={and:"AND",or:"OR"};class mv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function gv(e,t){return e.useProto3Json||pp(t)?t:{value:t}}function vv(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function yv(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function bv(e,t){return vv(e,t.toTimestamp())}function wv(e){return Pf(!!e),Qf.fromTimestamp(function(e){const t=Mp(e);return new Xf(t.seconds,t.nanos)}(e))}function _v(e,t){return function(e){return new Zf(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Sv(e){const t=Zf.fromString(e);return Pf(jv(t)),t}function Tv(e,t){return _v(e.databaseId,t.path)}function Iv(e,t){const n=Sv(t);if(n.get(1)!==e.databaseId.projectId)throw new Of(Nf.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Of(Nf.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new np(Cv(n))}function Ev(e,t){return _v(e.databaseId,t)}function Av(e){const t=Sv(e);return 4===t.length?Zf.emptyPath():Cv(t)}function kv(e){return new Zf(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Cv(e){return Pf(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function xv(e,t,n){return{name:Tv(e,t),fields:n.value.mapValue.fields}}function Rv(e,t){let n;if(t instanceof Dg)n={update:xv(e,t.key,t.value)};else if(t instanceof Vg)n={delete:Tv(e,t.key)};else if(t instanceof Ng)n={update:xv(e,t.key,t.data),updateMask:Bv(t.fieldMask)};else{if(!(t instanceof Hg))return Mf();n={verify:Tv(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof vg)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof yg)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof wg)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Sg)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Mf()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:bv(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Mf()}(e,t.precondition)),n}function Lv(e,t){return{documents:[Ev(e,t.path)]}}function Mv(e,t){const n={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n.parent=Ev(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Ev(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(e){if(0!==e.length)return Hv(dm.create(e,"and"))}(t.filters);r&&(n.structuredQuery.where=r);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Uv(e.field),direction:Nv(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const s=gv(e,t.limit);var a;return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Pv(e){let t=Av(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Pf(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=Dv(e);return t instanceof dm&&pm(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=n.orderBy.map((e=>function(e){return new lm(Vv(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,pp(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new om(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new om(n,t)}(n.endAt)),Pm(t,r,s,o,a,"F",l,u)}function Dv(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Vv(e.unaryFilter.field);return hm.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Vv(e.unaryFilter.field);return hm.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Vv(e.unaryFilter.field);return hm.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Vv(e.unaryFilter.field);return hm.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Mf()}}(e):void 0!==e.fieldFilter?function(e){return hm.create(Vv(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Mf()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return dm.create(e.compositeFilter.filters.map((e=>Dv(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Mf()}}(e.compositeFilter.op))}(e):Mf()}function Nv(e){return dv[e]}function Ov(e){return fv[e]}function Fv(e){return pv[e]}function Uv(e){return{fieldPath:e.canonicalString()}}function Vv(e){return tp.fromServerFormat(e.fieldPath)}function Hv(e){return e instanceof hm?function(e){if("=="===e.op){if(Jp(e.value))return{unaryFilter:{field:Uv(e.field),op:"IS_NAN"}};if(Qp(e.value))return{unaryFilter:{field:Uv(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Jp(e.value))return{unaryFilter:{field:Uv(e.field),op:"IS_NOT_NAN"}};if(Qp(e.value))return{unaryFilter:{field:Uv(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uv(e.field),op:Ov(e.op),value:e.value}}}(e):e instanceof dm?function(e){const t=e.getFilters().map((e=>Hv(e)));return 1===t.length?t[0]:{compositeFilter:{op:Fv(e.op),filters:t}}}(e):Mf()}function Bv(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function jv(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e,t,n,i,r=Qf.min(),o=Qf.min(),s=Rp.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=a}withSequenceNumber(e){return new Gv(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Gv(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gv(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gv(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e){this.fe=e}}function zv(e){const t=Pv({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?jm(t,t.limit,"L"):t}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Pp(e.integerValue));else if("doubleValue"in e){const n=Pp(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),mp(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Dp(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?tm(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Mf()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const e of Object.keys(n))this.Te(e,t),this.me(n[e],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const e of n)this.me(e,t)}ve(e,t){this.ye(t,37),np.fromName(e).path.forEach((e=>{this.ye(t,60),this.be(e,t)}))}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}qv.Ve=new qv;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Kv{constructor(){this.rn=new $v}addToCollectionParentIndex(e,t){return this.rn.add(t),hp.resolve()}getCollectionParents(e,t){return hp.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return hp.resolve()}deleteFieldIndex(e,t){return hp.resolve()}getDocumentsMatchingTarget(e,t){return hp.resolve(null)}getIndexType(e,t){return hp.resolve(0)}getFieldIndexes(e,t){return hp.resolve([])}getNextCollectionGroupToUpdate(e){return hp.resolve(null)}getMinOffset(e,t){return hp.resolve(sp.min())}getMinOffsetFromCollectionGroup(e,t){return hp.resolve(sp.min())}updateCollectionGroup(e,t,n){return hp.resolve()}updateIndexEntries(e,t){return hp.resolve()}}class $v{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Ap(Zf.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ap(Zf.comparator)).toArray()}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Uint8Array(0);class Yv{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Yv(e,Yv.DEFAULT_COLLECTION_PERCENTILE,Yv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yv.DEFAULT_COLLECTION_PERCENTILE=10,Yv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yv.DEFAULT=new Yv(41943040,Yv.DEFAULT_COLLECTION_PERCENTILE,Yv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yv.DISABLED=new Yv(-1,0,0);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Xv{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Xv(0)}static Mn(){return new Xv(-1)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Qv{constructor(){this.changes=new Xm((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rm.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?hp.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Jv{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Lg(n.mutation,e,Cp.empty(),Xf.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ag()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=ag()){const i=ng();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=eg();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=ng();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ag())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let r=Jm();const o=rg(),s=rg();return t.forEach(((e,t)=>{const s=n.get(t.key);i.has(t.key)&&(void 0===s||s.mutation instanceof Ng)?r=r.insert(t.key,t):void 0!==s?(o.set(t.key,s.mutation.getFieldMask()),Lg(s.mutation,t,s.mutation.getFieldMask(),Xf.now())):o.set(t.key,Cp.empty())})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>o.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new Jv(t,null!==(n=o.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=rg();let i=new Tp(((e,t)=>e-t)),r=ag();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const o=t.get(e);if(null===o)return;let s=n.get(e)||Cp.empty();s=r.applyToLocalView(o,s),n.set(e,s);const a=(i.get(r.batchId)||ag()).add(e);i=i.insert(r.batchId,a)}))})).next((()=>{const o=[],s=i.getReverseIterator();for(;s.hasNext();){const i=s.getNext(),a=i.key,l=i.value,u=ig();l.forEach((e=>{if(!r.has(e)){const i=xg(t.get(e),n.get(e));null!==i&&u.set(e,i),r=r.add(e)}})),o.push(this.documentOverlayCache.saveOverlays(e,a,u))}return hp.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return np.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Um(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):hp.resolve(ng());let s=-1,a=r;return o.next((t=>hp.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),r.get(t)?hp.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,a,t,ag()))).next((e=>({batchId:s,changes:tg(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new np(t)).next((e=>{let t=eg();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let r=eg();return this.indexManager.getCollectionParents(e,i).next((o=>hp.forEach(o,(o=>{const s=function(e,t){return new Mm(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,s,n).next((e=>{e.forEach(((e,t)=>{r=r.insert(e,t)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((r=>(i=r,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i)))).next((e=>{i.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,rm.newInvalidDocument(i)))}));let n=eg();return e.forEach(((e,r)=>{const o=i.get(e);void 0!==o&&Lg(o.mutation,r,Cp.empty(),Xf.now()),qm(t,r)&&(n=n.insert(e,r))})),n}))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return hp.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:wv(n.createTime)}),hp.resolve()}getNamedQuery(e,t){return hp.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:zv(e.bundledQuery),readTime:wv(e.readTime)}}(t)),hp.resolve()}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(){this.overlays=new Tp(np.comparator),this.ls=new Map}getOverlay(e,t){return hp.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ng();return hp.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.we(e,t,i)})),hp.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.ls.delete(n)),hp.resolve()}getOverlaysForCollection(e,t,n){const i=ng(),r=t.length+1,o=new np(t.child("")),s=this.overlays.getIteratorFrom(o);for(;s.hasNext();){const e=s.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return hp.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new Tp(((e,t)=>e-t));const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=ng(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=ng(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=i)););return hp.resolve(s)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Gg(t,n));let r=this.ls.get(t);void 0===r&&(r=ag(),this.ls.set(t,r)),this.ls.set(t,r.add(n.key))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(){this.fs=new Ap(iy.ds),this.ws=new Ap(iy._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new iy(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.ys(new iy(e,t))}ps(e,t){e.forEach((e=>this.removeReference(e,t)))}Is(e){const t=new np(new Zf([])),n=new iy(t,e),i=new iy(t,e+1),r=[];return this.ws.forEachInRange([n,i],(e=>{this.ys(e),r.push(e.key)})),r}Ts(){this.fs.forEach((e=>this.ys(e)))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new np(new Zf([])),n=new iy(t,e),i=new iy(t,e+1);let r=ag();return this.ws.forEachInRange([n,i],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new iy(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class iy{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return np.comparator(e.key,t.key)||$f(e.As,t.As)}static _s(e,t){return $f(e.As,t.As)||np.comparator(e.key,t.key)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Ap(iy.ds)}checkEmpty(e){return hp.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Bg(r,t,n,i);this.mutationQueue.push(o);for(const t of i)this.Rs=this.Rs.add(new iy(t.key,r)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return hp.resolve(o)}lookupMutationBatch(e,t){return hp.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.bs(n),r=i<0?0:i;return hp.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return hp.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return hp.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new iy(t,0),i=new iy(t,Number.POSITIVE_INFINITY),r=[];return this.Rs.forEachInRange([n,i],(e=>{const t=this.Ps(e.As);r.push(t)})),hp.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ap($f);return t.forEach((e=>{const t=new iy(e,0),i=new iy(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,i],(e=>{n=n.add(e.As)}))})),hp.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;np.isDocumentKey(r)||(r=r.child(""));const o=new iy(new np(r),0);let s=new Ap($f);return this.Rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(s=s.add(e.As)),!0)}),o),hp.resolve(this.Vs(s))}Vs(e){const t=[];return e.forEach((e=>{const n=this.Ps(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Pf(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return hp.forEach(t.mutations,(i=>{const r=new iy(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Rs=n}))}Cn(e){}containsKey(e,t){const n=new iy(t,0),i=this.Rs.firstAfterOrEqual(n);return hp.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,hp.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e){this.Ds=e,this.docs=new Tp(np.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,o=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return hp.resolve(n?n.document.mutableCopy():rm.newInvalidDocument(t))}getEntries(e,t){let n=Jm();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():rm.newInvalidDocument(e))})),hp.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=Jm();const o=t.path,s=new np(o.child("")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:e,value:{document:s}}=a.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||ap(op(s),n)<=0||(i.has(s.key)||qm(t,s))&&(r=r.insert(s.key,s.mutableCopy()))}return hp.resolve(r)}getAllFromCollectionGroup(e,t,n,i){Mf()}Cs(e,t){return hp.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new sy(this)}getSize(e){return hp.resolve(this.size)}}class sy extends Qv{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)})),hp.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e){this.persistence=e,this.xs=new Xm((e=>xm(e)),Rm),this.lastRemoteSnapshotVersion=Qf.min(),this.highestTargetId=0,this.Ns=0,this.ks=new ny,this.targetCount=0,this.Ms=Xv.kn()}forEachTarget(e,t){return this.xs.forEach(((e,n)=>t(n))),hp.resolve()}getLastRemoteSnapshotVersion(e){return hp.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return hp.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),hp.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),hp.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Xv(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,hp.resolve()}updateTargetData(e,t){return this.Fn(t),hp.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,hp.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.xs.forEach(((o,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.xs.delete(o),r.push(this.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),hp.waitFor(r).next((()=>i))}getTargetCount(e){return hp.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return hp.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),hp.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((t=>{r.push(i.markPotentiallyOrphaned(e,t))})),hp.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),hp.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return hp.resolve(n)}containsKey(e,t){return hp.resolve(this.ks.containsKey(t))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e,t){this.$s={},this.overlays={},this.Os=new fp(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new ay(this),this.indexManager=new Kv,this.remoteDocumentCache=function(e){return new oy(e)}((e=>this.referenceDelegate.Ls(e))),this.serializer=new Wv(t),this.qs=new ey(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ty,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new ry(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Cf("MemoryPersistence","Starting transaction:",e);const i=new uy(this.Os.next());return this.referenceDelegate.Us(),n(i).next((e=>this.referenceDelegate.Ks(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Gs(e,t){return hp.or(Object.values(this.$s).map((n=>()=>n.containsKey(e,t))))}}class uy extends up{constructor(e){super(),this.currentSequenceNumber=e}}class cy{constructor(e){this.persistence=e,this.Qs=new ny,this.js=null}static zs(e){return new cy(e)}get Ws(){if(this.js)return this.js;throw Mf()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),hp.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),hp.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),hp.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach((e=>this.Ws.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ws.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return hp.forEach(this.Ws,(n=>{const i=np.fromPath(n);return this.Hs(e,i).next((e=>{e||t.removeEntry(i,Qf.min())}))})).next((()=>(this.js=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hs(e,t).next((e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())}))}Ls(e){return 0}Hs(e,t){return hp.or([()=>hp.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class hy{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=ag(),i=ag();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new hy(e,t.fromCache,n,i)}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next((r=>r||this.Gi(e,t,i,n))).next((n=>n||this.Qi(e,t)))}Ki(e,t){if(Nm(t))return hp.resolve(null);let n=Hm(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=jm(t,null,"F"),n=Hm(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const r=ag(...i);return this.Ui.getDocuments(e,r).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const o=this.ji(t,i);return this.zi(t,o,r,n.readTime)?this.Ki(e,jm(t,null,"F")):this.Wi(e,o,t,n)}))))})))))}Gi(e,t,n,i){return Nm(t)||i.isEqual(Qf.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((r=>{const o=this.ji(t,r);return this.zi(t,o,n,i)?this.Qi(e,t):(kf()<=xi.DEBUG&&Cf("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),zm(t)),this.Wi(e,o,t,rp(i,-1)))}))}ji(e,t){let n=new Ap($m(e));return t.forEach(((t,i)=>{qm(e,i)&&(n=n.add(i))})),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Qi(e,t){return kf()<=xi.DEBUG&&Cf("QueryEngine","Using full collection scan to execute query:",zm(t)),this.Ui.getDocumentsMatchingQuery(e,t,sp.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new Tp($f),this.Yi=new Xm((e=>xm(e)),Rm),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Zv(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}function py(e,t,n,i){return new fy(e,t,n,i)}async function my(e,t){const n=Df(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((r=>(i=r,n.tr(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],o=[];let s=ag();for(const e of i){r.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({er:e,removedBatchIds:r,addedBatchIds:o})))}))}))}function gy(e){const t=Df(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Bs.getLastRemoteSnapshotVersion(e)))}function vy(e,t,n){let i=ag(),r=ag();return n.forEach((e=>i=i.add(e))),t.getEntries(e,i).next((e=>{let i=Jm();return n.forEach(((n,o)=>{const s=e.get(n);o.isFoundDocument()!==s.isFoundDocument()&&(r=r.add(n)),o.isNoDocument()&&o.version.isEqual(Qf.min())?(t.removeEntry(n,o.readTime),i=i.insert(n,o)):!s.isValidDocument()||o.version.compareTo(s.version)>0||0===o.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(o),i=i.insert(n,o)):Cf("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),{nr:i,sr:r}}))}function yy(e,t){const n=Df(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function by(e,t){const n=Df(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let i;return n.Bs.getTargetData(e,t).next((r=>r?(i=r,hp.resolve(i)):n.Bs.allocateTargetId(e).next((r=>(i=new Gv(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,i).next((()=>i)))))))})).then((e=>{const i=n.Ji.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}async function wy(e,t,n){const i=Df(e),r=i.Ji.get(t),o=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",o,(e=>i.persistence.referenceDelegate.removeTarget(e,r)))}catch(e){if(!dp(e))throw e;Cf("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}i.Ji=i.Ji.remove(t),i.Yi.delete(r.target)}function _y(e,t,n){const i=Df(e);let r=Qf.min(),o=ag();return i.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const i=Df(e),r=i.Yi.get(n);return void 0!==r?hp.resolve(i.Ji.get(r)):i.Bs.getTargetData(t,n)}(i,e,Hm(t)).next((t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.Bs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{o=e}))})).next((()=>i.Hi.getDocumentsMatchingQuery(e,t,n?r:Qf.min(),n?o:ag()))).next((e=>(Sy(i,Km(t),e),{documents:e,ir:o})))))}function Sy(e,t,n){let i=e.Xi.get(t)||Qf.min();n.forEach(((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)})),e.Xi.set(t,i)}class Ty{constructor(){this.activeTargetIds=ug()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Iy{constructor(){this.Hr=new Ty,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Ty,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{Yr(e){}shutdown(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Cf("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Cf("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ky=null;function Cy(){return null===ky?ky=268435456+Math.round(2147483648*Math.random()):ky++,"0x"+ky.toString(16)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const xy={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly="WebChannelConnection";class My extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,r){const o=Cy(),s=this.To(e,t);Cf("RestConnection",`Sending RPC '${e}' ${o}:`,s,n);const a={};return this.Eo(a,i,r),this.Ao(e,s,a,n).then((t=>(Cf("RestConnection",`Received RPC '${e}' ${o}: `,t),t)),(t=>{throw Rf("RestConnection",`RPC '${e}' ${o} failed with error: `,t,"url: ",s,"request:",n),t}))}vo(e,t,n,i,r,o){return this.Io(e,t,n,i,r)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ef,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}To(e,t){const n=xy[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const r=Cy();return new Promise(((o,s)=>{const a=new wf;a.setWithCredentials(!0),a.listenOnce(mf.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case pf.NO_ERROR:const t=a.getResponseJson();Cf(Ly,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(t)),o(t);break;case pf.TIMEOUT:Cf(Ly,`RPC '${e}' ${r} timed out`),s(new Of(Nf.DEADLINE_EXCEEDED,"Request time out"));break;case pf.HTTP_ERROR:const n=a.getStatus();if(Cf(Ly,`RPC '${e}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Nf).indexOf(t)>=0?t:Nf.UNKNOWN}(t.status);s(new Of(e,t.message))}else s(new Of(Nf.UNKNOWN,"Server responded with status "+a.getStatus()))}else s(new Of(Nf.UNAVAILABLE,"Connection failed."));break;default:Mf()}}finally{Cf(Ly,`RPC '${e}' ${r} completed.`)}}));const l=JSON.stringify(i);Cf(Ly,`RPC '${e}' ${r} sending request:`,i),a.send(t,"POST",l,n,15)}))}Ro(e,t,n){const i=Cy(),r=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=df(),s=ff(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.xmlHttpFactory=new yf({})),this.Eo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=r.join("");Cf(Ly,`Creating RPC '${e}' stream ${i}: ${u}`,a);const c=o.createWebChannel(u,a);let h=!1,d=!1;const f=new Ry({ro:t=>{d?Cf(Ly,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(h||(Cf(Ly,`Opening RPC '${e}' stream ${i} transport.`),c.open(),h=!0),Cf(Ly,`RPC '${e}' stream ${i} sending:`,t),c.send(t))},oo:()=>c.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(c,bf.EventType.OPEN,(()=>{d||Cf(Ly,`RPC '${e}' stream ${i} transport opened.`)})),p(c,bf.EventType.CLOSE,(()=>{d||(d=!0,Cf(Ly,`RPC '${e}' stream ${i} transport closed`),f.wo())})),p(c,bf.EventType.ERROR,(t=>{d||(d=!0,Rf(Ly,`RPC '${e}' stream ${i} transport errored:`,t),f.wo(new Of(Nf.UNAVAILABLE,"The operation could not be completed")))})),p(c,bf.EventType.MESSAGE,(t=>{var n;if(!d){const r=t.data[0];Pf(!!r);const o=r,s=o.error||(null===(n=o[0])||void 0===n?void 0:n.error);if(s){Cf(Ly,`RPC '${e}' stream ${i} received error:`,s);const t=s.status;let n=function(e){const t=zg[e];if(void 0!==t)return $g(t)}(t),r=s.message;void 0===n&&(n=Nf.INTERNAL,r="Unknown error status: "+t+" with message "+s.message),d=!0,f.wo(new Of(n,r)),c.close()}else Cf(Ly,`RPC '${e}' stream ${i} received:`,r),f._o(r)}})),p(s,gf.STAT_EVENT,(t=>{t.stat===vf.PROXY?Cf(Ly,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===vf.NOPROXY&&Cf(Ly,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.fo()}),0),f}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(e){return new mv(e,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,t,n=1e3,i=1.5,r=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=r,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&Cf("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,(()=>(this.Co=Date.now(),e()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,t,n,i,r,o,s,a){this.ii=e,this.$o=n,this.Oo=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Ny(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===Nf.RESOURCE_EXHAUSTED?(xf(t.toString()),xf("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===Nf.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Fo===t&&this.Zo(e,n)}),(t=>{e((()=>{const e=new Of(Nf.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)}))}))}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((e=>{n((()=>this.tu(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(e){return Cf("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.Fo===e?t():(Cf("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Fy extends Oy{constructor(e,t,n,i,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=r}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Mf()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(Pf(void 0===t||"string"==typeof t),Rp.fromBase64String(t||"")):(Pf(void 0===t||t instanceof Uint8Array),Rp.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(e){const t=void 0===e.code?Nf.UNKNOWN:$g(e.code);return new Of(t,e.message||"")}(s);n=new av(i,r,o,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=Iv(e,i.document.name),o=wv(i.document.updateTime),s=i.document.createTime?wv(i.document.createTime):Qf.min(),a=new nm({mapValue:{fields:i.document.fields}}),l=rm.newFoundDocument(r,o,s,a),u=i.targetIds||[],c=i.removedTargetIds||[];n=new ov(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=Iv(e,i.document),o=i.readTime?wv(i.readTime):Qf.min(),s=rm.newNoDocument(r,o),a=i.removedTargetIds||[];n=new ov([],a,s.key,s)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=Iv(e,i.document),o=i.removedTargetIds||[];n=new ov([],o,r,null)}else{if(!("filter"in t))return Mf();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:r}=e,o=new Wg(i,r),s=e.targetId;n=new sv(s,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Qf.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Qf.min():t.readTime?wv(t.readTime):Qf.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=kv(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=Lm(i)?{documents:Lv(e,i)}:{query:Mv(e,i)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=yv(e,t.resumeToken);const i=gv(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(Qf.min())>0){n.readTime=vv(e,t.snapshotVersion.toTimestamp());const i=gv(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Mf()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=kv(this.serializer),t.removeTarget=e,this.Wo(t)}}class Uy extends Oy{constructor(e,t,n,i,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=r,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(Pf(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(Pf(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?wv(e.updateTime):wv(t);return n.isEqual(Qf.min())&&(n=wv(t)),new Eg(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=wv(e.commitTime);return this.listener.cu(n,t)}return Pf(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=kv(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Rv(this.serializer,e)))};this.Wo(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Of(Nf.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.Io(e,t,n,i,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Nf.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Of(Nf.UNKNOWN,e.toString())}))}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.vo(e,t,n,r,o,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Nf.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Of(Nf.UNKNOWN,e.toString())}))}terminate(){this.lu=!0}}class Hy{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(xf(t),this.mu=!1):Cf("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=r,this.Pu.Yr((e=>{n.enqueueAndForget((async()=>{Xy(this)&&(Cf("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Df(e);t.vu.add(4),await Gy(t),t.bu.set("Unknown"),t.vu.delete(4),await jy(t)}(this))}))})),this.bu=new Hy(n,i)}}async function jy(e){if(Xy(e))for(const t of e.Ru)await t(!0)}async function Gy(e){for(const t of e.Ru)await t(!1)}function Wy(e,t){const n=Df(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),Yy(n)?$y(n):pb(n).Ko()&&qy(n,t))}function zy(e,t){const n=Df(e),i=pb(n);n.Au.delete(t),i.Ko()&&Ky(n,t),0===n.Au.size&&(i.Ko()?i.jo():Xy(n)&&n.bu.set("Unknown"))}function qy(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Qf.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}pb(e).su(t)}function Ky(e,t){e.Vu.qt(t),pb(e).iu(t)}function $y(e){e.Vu=new uv({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),pb(e).start(),e.bu.gu()}function Yy(e){return Xy(e)&&!pb(e).Uo()&&e.Au.size>0}function Xy(e){return 0===Df(e).vu.size}function Qy(e){e.Vu=void 0}async function Jy(e){e.Au.forEach(((t,n)=>{qy(e,t)}))}async function Zy(e,t){Qy(e),Yy(e)?(e.bu.Iu(t),$y(e)):e.bu.set("Unknown")}async function eb(e,t,n){if(e.bu.set("Online"),t instanceof av&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.Au.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.Au.delete(i),e.Vu.removeTarget(i))}(e,t)}catch(n){Cf("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await tb(e,n)}else if(t instanceof ov?e.Vu.Ht(t):t instanceof sv?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(Qf.min()))try{const t=await gy(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.Au.get(i);r&&e.Au.set(i,r.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const i=e.Au.get(t);if(!i)return;e.Au.set(t,i.withResumeToken(Rp.EMPTY_BYTE_STRING,i.snapshotVersion)),Ky(e,t);const r=new Gv(i.target,t,n,i.sequenceNumber);qy(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Cf("RemoteStore","Failed to raise snapshot:",t),await tb(e,t)}}async function tb(e,t,n){if(!dp(t))throw t;e.vu.add(1),await Gy(e),e.bu.set("Offline"),n||(n=()=>gy(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Cf("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await jy(e)}))}function nb(e,t){return t().catch((n=>tb(e,n,t)))}async function ib(e){const t=Df(e),n=mb(t);let i=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;rb(t);)try{const e=await yy(t.localStore,i);if(null===e){0===t.Eu.length&&n.jo();break}i=e.batchId,ob(t,e)}catch(e){await tb(t,e)}sb(t)&&ab(t)}function rb(e){return Xy(e)&&e.Eu.length<10}function ob(e,t){e.Eu.push(t);const n=mb(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function sb(e){return Xy(e)&&!mb(e).Uo()&&e.Eu.length>0}function ab(e){mb(e).start()}async function lb(e){mb(e).hu()}async function ub(e){const t=mb(e);for(const n of e.Eu)t.uu(n.mutations)}async function cb(e,t,n){const i=e.Eu.shift(),r=jg.from(i,t,n);await nb(e,(()=>e.remoteSyncer.applySuccessfulWrite(r))),await ib(e)}async function hb(e,t){t&&mb(e).ou&&await async function(e,t){if(Kg(n=t.code)&&n!==Nf.ABORTED){const n=e.Eu.shift();mb(e).Qo(),await nb(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ib(e)}var n}(e,t),sb(e)&&ab(e)}async function db(e,t){const n=Df(e);n.asyncQueue.verifyOperationInProgress(),Cf("RemoteStore","RemoteStore received new credentials");const i=Xy(n);n.vu.add(3),await Gy(n),i&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await jy(n)}async function fb(e,t){const n=Df(e);t?(n.vu.delete(2),await jy(n)):t||(n.vu.add(2),await Gy(n),n.bu.set("Unknown"))}function pb(e){return e.Su||(e.Su=function(e,t,n){const i=Df(e);return i.fu(),new Fy(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{uo:Jy.bind(null,e),ao:Zy.bind(null,e),nu:eb.bind(null,e)}),e.Ru.push((async t=>{t?(e.Su.Qo(),Yy(e)?$y(e):e.bu.set("Unknown")):(await e.Su.stop(),Qy(e))}))),e.Su}function mb(e){return e.Du||(e.Du=function(e,t,n){const i=Df(e);return i.fu(),new Uy(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{uo:lb.bind(null,e),ao:hb.bind(null,e),au:ub.bind(null,e),cu:cb.bind(null,e)}),e.Ru.push((async t=>{t?(e.Du.Qo(),await ib(e)):(await e.Du.stop(),e.Eu.length>0&&(Cf("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))}))),e.Du
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class gb{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Ff,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,i,r){const o=Date.now()+n,s=new gb(e,t,o,i,r);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Of(Nf.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vb(e,t){if(xf("AsyncQueue",`${t}: ${e}`),dp(e))return new Of(Nf.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e){this.comparator=e?(t,n)=>e(t,n)||np.comparator(t.key,n.key):(e,t)=>np.comparator(e.key,t.key),this.keyedMap=eg(),this.sortedSet=new Tp(this.comparator)}static emptySet(e){return new yb(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof yb))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new yb;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(){this.Cu=new Tp(np.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Mf():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class wb{constructor(e,t,n,i,r,o,s,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,r){const o=[];return t.forEach((e=>{o.push({type:0,doc:e})})),new wb(e,t,yb.emptySet(t),o,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(){this.Nu=void 0,this.listeners=[]}}class Sb{constructor(){this.queries=new Xm((e=>Wm(e)),Gm),this.onlineState="Unknown",this.ku=new Set}}async function Tb(e,t){const n=Df(e),i=t.query;let r=!1,o=n.queries.get(i);if(o||(r=!0,o=new _b),r)try{o.Nu=await n.onListen(i)}catch(e){const n=vb(e,`Initialization of query '${zm(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,o),o.listeners.push(t),t.Mu(n.onlineState),o.Nu&&t.$u(o.Nu)&&kb(n)}async function Ib(e,t){const n=Df(e),i=t.query;let r=!1;const o=n.queries.get(i);if(o){const e=o.listeners.indexOf(t);e>=0&&(o.listeners.splice(e,1),r=0===o.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function Eb(e,t){const n=Df(e);let i=!1;for(const e of t){const t=e.query,r=n.queries.get(t);if(r){for(const t of r.listeners)t.$u(e)&&(i=!0);r.Nu=e}}i&&kb(n)}function Ab(e,t,n){const i=Df(e),r=i.queries.get(t);if(r)for(const e of r.listeners)e.onError(n);i.queries.delete(t)}function kb(e){e.ku.forEach((e=>{e.next()}))}class Cb{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new wb(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=wb.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class xb{constructor(e){this.key=e}}class Rb{constructor(e){this.key=e}}class Lb{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=ag(),this.mutatedKeys=ag(),this.tc=$m(e),this.ec=new yb(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new bb,i=t?t.ec:this.ec;let r=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((e,t)=>{const u=i.get(e),c=qm(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),f=!0):this.rc(u,c)||(n.track({type:2,doc:c}),f=!0,(a&&this.tc(c,a)>0||l&&this.tc(c,l)<0)&&(s=!0)):!u&&c?(n.track({type:0,doc:c}),f=!0):u&&!c&&(n.track({type:1,doc:u}),f=!0,(a||l)&&(s=!0)),f&&(c?(o=o.add(c),r=d?r.add(e):r.delete(e)):(o=o.delete(e),r=r.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{ec:o,ic:n,zi:s,mutatedKeys:r}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const r=e.ic.xu();r.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mf()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc))),this.oc(n);const o=t?this.uc():[],s=0===this.Zu.size&&this.current?1:0,a=s!==this.Xu;return this.Xu=s,0!==r.length||a?{snapshot:new wb(this.query,e.ec,i,r,e.mutatedKeys,0===s,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new bb,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach((e=>this.Yu=this.Yu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Yu=this.Yu.delete(e))),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=ag(),this.ec.forEach((e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))}));const t=[];return e.forEach((e=>{this.Zu.has(e)||t.push(new Rb(e))})),this.Zu.forEach((n=>{e.has(n)||t.push(new xb(n))})),t}hc(e){this.Yu=e.ir,this.Zu=ag();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return wb.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Mb{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Pb{constructor(e){this.key=e,this.fc=!1}}class Db{constructor(e,t,n,i,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Xm((e=>Wm(e)),Gm),this._c=new Map,this.mc=new Set,this.gc=new Tp(np.comparator),this.yc=new Map,this.Ic=new ny,this.Tc={},this.Ec=new Map,this.Ac=Xv.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function Nb(e,t){const n=Zb(e);let i,r;const o=n.wc.get(t);if(o)i=o.targetId,n.sharedClientState.addLocalQueryTarget(i),r=o.view.lc();else{const e=await by(n.localStore,Hm(t)),o=n.sharedClientState.addLocalQueryTarget(e.targetId);i=e.targetId,r=await Ob(n,t,i,"current"===o,e.resumeToken),n.isPrimaryClient&&Wy(n.remoteStore,e)}return r}async function Ob(e,t,n,i,r){e.Rc=(t,n,i)=>async function(e,t,n,i){let r=t.view.sc(n);r.zi&&(r=await _y(e.localStore,t.query,!1).then((({documents:e})=>t.view.sc(e,r))));const o=i&&i.targetChanges.get(t.targetId),s=t.view.applyChanges(r,e.isPrimaryClient,o);return Kb(e,t.targetId,s.cc),s.snapshot}(e,t,n,i);const o=await _y(e.localStore,t,!0),s=new Lb(t,o.ir),a=s.sc(o.documents),l=rv.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,r),u=s.applyChanges(a,e.isPrimaryClient,l);Kb(e,n,u.cc);const c=new Mb(t,n,s);return e.wc.set(t,c),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}async function Fb(e,t){const n=Df(e),i=n.wc.get(t),r=n._c.get(i.targetId);if(r.length>1)return n._c.set(i.targetId,r.filter((e=>!Gm(e,t)))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await wy(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),zy(n.remoteStore,i.targetId),zb(n,i.targetId)})).catch(cp)):(zb(n,i.targetId),await wy(n.localStore,i.targetId,!0))}async function Ub(e,t){const n=Df(e);try{const e=await function(e,t){const n=Df(e),i=t.snapshotVersion;let r=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const o=n.Zi.newChangeBuffer({trackRemovals:!0});r=n.Ji;const s=[];t.targetChanges.forEach(((o,a)=>{const l=r.get(a);if(!l)return;s.push(n.Bs.removeMatchingKeys(e,o.removedDocuments,a).next((()=>n.Bs.addMatchingKeys(e,o.addedDocuments,a))));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(Rp.EMPTY_BYTE_STRING,Qf.min()).withLastLimboFreeSnapshotVersion(Qf.min()):o.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(o.resumeToken,i)),r=r.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,u,o)&&s.push(n.Bs.updateTargetData(e,u))}));let a=Jm(),l=ag();if(t.documentUpdates.forEach((i=>{t.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))})),s.push(vy(e,o,t.documentUpdates).next((e=>{a=e.nr,l=e.sr}))),!i.isEqual(Qf.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next((t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,i)));s.push(t)}return hp.waitFor(s).next((()=>o.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.Ji=r,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const i=n.yc.get(t);i&&(Pf(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.fc=!0:e.modifiedDocuments.size>0?Pf(i.fc):e.removedDocuments.size>0&&(Pf(i.fc),i.fc=!1))})),await Xb(n,e,t)}catch(e){await cp(e)}}function Vb(e,t,n){const i=Df(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.wc.forEach(((n,i)=>{const r=i.view.Mu(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=Df(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.Mu(t)&&(i=!0)})),i&&kb(n)}(i.eventManager,t),e.length&&i.dc.nu(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Hb(e,t,n){const i=Df(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.yc.get(t),o=r&&r.key;if(o){let e=new Tp(np.comparator);e=e.insert(o,rm.newNoDocument(o,Qf.min()));const n=ag().add(o),r=new iv(Qf.min(),new Map,new Tp($f),e,n);await Ub(i,r),i.gc=i.gc.remove(o),i.yc.delete(t),Yb(i)}else await wy(i.localStore,t,!1).then((()=>zb(i,t,n))).catch(cp)}async function Bb(e,t){const n=Df(e),i=t.batch.batchId;try{const e=await function(e,t){const n=Df(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),r=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,o=r.keys();let s=hp.resolve();return o.forEach((e=>{s=s.next((()=>i.getEntry(t,e))).next((t=>{const o=n.docVersions.get(e);Pf(null!==o),t.version.compareTo(o)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,r)))}(n,e,t,r).next((()=>r.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ag();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);Wb(n,i,null),Gb(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Xb(n,e)}catch(e){await cp(e)}}async function jb(e,t,n){const i=Df(e);try{const e=await function(e,t){const n=Df(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Pf(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);Wb(i,t,n),Gb(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await Xb(i,e)}catch(n){await cp(n)}}function Gb(e,t){(e.Ec.get(t)||[]).forEach((e=>{e.resolve()})),e.Ec.delete(t)}function Wb(e,t,n){const i=Df(e);let r=i.Tc[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Tc[i.currentUser.toKey()]=r}}function zb(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e._c.get(t))e.wc.delete(i),n&&e.dc.Pc(i,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((t=>{e.Ic.containsKey(t)||qb(e,t)}))}function qb(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(zy(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),Yb(e))}function Kb(e,t,n){for(const i of n)i instanceof xb?(e.Ic.addReference(i.key,t),$b(e,i)):i instanceof Rb?(Cf("SyncEngine","Document no longer in limbo: "+i.key),e.Ic.removeReference(i.key,t),e.Ic.containsKey(i.key)||qb(e,i.key)):Mf()}function $b(e,t){const n=t.key,i=n.path.canonicalString();e.gc.get(n)||e.mc.has(i)||(Cf("SyncEngine","New document in limbo: "+n),e.mc.add(i),Yb(e))}function Yb(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new np(Zf.fromString(t)),i=e.Ac.next();e.yc.set(i,new Pb(n)),e.gc=e.gc.insert(n,i),Wy(e.remoteStore,new Gv(Hm(Dm(n.path)),i,"TargetPurposeLimboResolution",fp.ct))}}async function Xb(e,t,n){const i=Df(e),r=[],o=[],s=[];i.wc.isEmpty()||(i.wc.forEach(((e,a)=>{s.push(i.Rc(a,t,n).then((e=>{if((e||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){r.push(e);const t=hy.Li(a.targetId,e);o.push(t)}})))})),await Promise.all(s),i.dc.nu(r),await async function(e,t){const n=Df(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>hp.forEach(t,(t=>hp.forEach(t.Fi,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>hp.forEach(t.Bi,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!dp(e))throw e;Cf("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ji.get(t),i=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(i);n.Ji=n.Ji.insert(t,r)}}}(i.localStore,o))}async function Qb(e,t){const n=Df(e);if(!n.currentUser.isEqual(t)){Cf("SyncEngine","User change. New user:",t.toKey());const e=await my(n.localStore,t);n.currentUser=t,function(e,t){e.Ec.forEach((e=>{e.forEach((e=>{e.reject(new Of(Nf.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Xb(n,e.er)}}function Jb(e,t){const n=Df(e),i=n.yc.get(t);if(i&&i.fc)return ag().add(i.key);{let e=ag();const i=n._c.get(t);if(!i)return e;for(const t of i){const i=n.wc.get(t);e=e.unionWith(i.view.nc)}return e}}function Zb(e){const t=Df(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ub.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jb.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Hb.bind(null,t),t.dc.nu=Eb.bind(null,t.eventManager),t.dc.Pc=Ab.bind(null,t.eventManager),t}function ew(e){const t=Df(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Bb.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=jb.bind(null,t),t}class tw{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Dy(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return py(this.persistence,new dy,e.initialUser,this.serializer)}createPersistence(e){return new ly(cy.zs,this.serializer)}createSharedClientState(e){return new Iy}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class nw{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Vb(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Qb.bind(null,this.syncEngine),await fb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Sb}createDatastore(e){const t=Dy(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new My(i));var i;return function(e,t,n,i){return new Vy(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){var t,n,i,r,o;return t=this.localStore,n=this.datastore,i=e.asyncQueue,r=e=>Vb(this.syncEngine,e,0),o=Ay.D()?new Ay:new Ey,new By(t,n,i,r,o)}createSyncEngine(e,t){return function(e,t,n,i,r,o,s){const a=new Db(e,t,n,i,r,o);return s&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Df(e);Cf("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await Gy(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class iw{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):xf("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class rw{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=If.UNAUTHENTICATED,this.clientId=Kf.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Cf("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Cf("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Of(Nf.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ff;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=vb(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function ow(e,t){e.asyncQueue.verifyOperationInProgress(),Cf("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await my(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function sw(e,t){e.asyncQueue.verifyOperationInProgress();const n=await lw(e);Cf("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener((e=>db(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>db(t.remoteStore,n))),e._onlineComponents=t}function aw(e){return"FirebaseError"===e.name?e.code===Nf.FAILED_PRECONDITION||e.code===Nf.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function lw(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Cf("FirestoreClient","Using user provided OfflineComponentProvider");try{await ow(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!aw(n))throw n;Rf("Error using user provided cache. Falling back to memory cache: "+n),await ow(e,new tw)}}else Cf("FirestoreClient","Using default OfflineComponentProvider"),await ow(e,new tw);return e._offlineComponents}async function uw(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Cf("FirestoreClient","Using user provided OnlineComponentProvider"),await sw(e,e._uninitializedComponentsProvider._online)):(Cf("FirestoreClient","Using default OnlineComponentProvider"),await sw(e,new nw))),e._onlineComponents}function cw(e){return uw(e).then((e=>e.syncEngine))}async function hw(e){const t=await uw(e),n=t.eventManager;return n.onListen=Nb.bind(null,t.syncEngine),n.onUnlisten=Fb.bind(null,t.syncEngine),n}function dw(e,t,n={}){const i=new Ff;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,r){const o=new iw({next:o=>{t.enqueueAndForget((()=>Ib(e,s)));const a=o.docs.has(n);!a&&o.fromCache?r.reject(new Of(Nf.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&i&&"server"===i.source?r.reject(new Of(Nf.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(o)},error:e=>r.reject(e)}),s=new Cb(Dm(n.path),o,{includeMetadataChanges:!0,Ku:!0});return Tb(e,s)}(await hw(e),e.asyncQueue,t,n,i))),i.promise}function fw(e,t,n={}){const i=new Ff;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,r){const o=new iw({next:n=>{t.enqueueAndForget((()=>Ib(e,s))),n.fromCache&&"server"===i.source?r.reject(new Of(Nf.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),s=new Cb(n,o,{includeMetadataChanges:!0,Ku:!0});return Tb(e,s)}(await hw(e),e.asyncQueue,t,n,i))),i.promise}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function pw(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const mw=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(e,t,n){if(!n)throw new Of(Nf.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function vw(e){if(!np.isDocumentKey(e))throw new Of(Nf.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function yw(e){if(np.isDocumentKey(e))throw new Of(Nf.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function bw(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Mf()}function ww(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Of(Nf.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bw(e);throw new Of(Nf.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class _w{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Of(Nf.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Of(Nf.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Of(Nf.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pw(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Of(Nf.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Of(Nf.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Of(Nf.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,n;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sw{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _w({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Of(Nf.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Of(Nf.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _w(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Vf;switch(e.type){case"firstParty":return new Gf(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Of(Nf.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=mw.get(e);t&&(Cf("ComponentProvider","Removing Datastore"),mw.delete(e),t.terminate())}(this),Promise.resolve()}}function Tw(e,t,n,i={}){var r;const o=(e=ww(e,Sw))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==t&&Rf("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},o),{host:`${t}:${n}`,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=If.MOCK_USER;else{t=ii(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new Of(Nf.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new If(o)}e._authCredentials=new Hf(new Uf(t,n))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Aw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Iw(this.firestore,e,this._key)}}class Ew{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ew(this.firestore,e,this._query)}}class Aw extends Ew{constructor(e,t,n){super(e,t,Dm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Iw(this.firestore,null,new np(e))}withConverter(e){return new Aw(this.firestore,e,this._path)}}function kw(e,t,...n){if(e=Ti(e),gw("collection","path",t),e instanceof Sw){const i=Zf.fromString(t,...n);return yw(i),new Aw(e,null,i)}{if(!(e instanceof Iw||e instanceof Aw))throw new Of(Nf.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(Zf.fromString(t,...n));return yw(i),new Aw(e.firestore,null,i)}}function Cw(e,t,...n){if(e=Ti(e),1===arguments.length&&(t=Kf.A()),gw("doc","path",t),e instanceof Sw){const i=Zf.fromString(t,...n);return vw(i),new Iw(e,null,new np(i))}{if(!(e instanceof Iw||e instanceof Aw))throw new Of(Nf.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(Zf.fromString(t,...n));return vw(i),new Iw(e.firestore,e instanceof Aw?e.converter:null,new np(i))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class xw{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Ny(this,"async_queue_retry"),this.Xc=()=>{const e=Py();e&&Cf("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=Py();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=Py();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise((()=>{}));const t=new Ff;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qc.push(e),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!dp(e))throw e;Cf("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(e){const t=this.Gc.then((()=>(this.Hc=!0,e().catch((e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw xf("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Hc=!1,e))))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=gb.createAndSchedule(this,e,t,n,(e=>this.na(e)));return this.zc.push(i),i}Zc(){this.Wc&&Mf()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then((()=>{this.zc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()}))}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}class Rw extends Sw{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new xw,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Pw(this),this._firestoreClient.terminate()}}function Lw(e,t){const n="string"==typeof e?e:t||"(default)",i=dr("object"==typeof e?e:br(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=Zn("firestore");e&&Tw(i,...e)}return i}function Mw(e){return e._firestoreClient||Pw(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Pw(e){var t,n,i;const r=e._freezeSettings(),o=function(e,t,n,i){return new Up(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,pw(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._firestoreClient=new rw(e._authCredentials,e._appCheckCredentials,e._queue,o),(null===(n=r.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.cache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Dw{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dw(Rp.fromBase64String(e))}catch(e){throw new Of(Nf.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Dw(Rp.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Of(Nf.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tp(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ow{constructor(e){this._methodName=e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Of(Nf.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Of(Nf.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $f(this._lat,e._lat)||$f(this._long,e._long)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw=/^__.*__$/;class Vw{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ng(e,this.data,this.fieldMask,t,this.fieldTransforms):new Dg(e,this.data,t,this.fieldTransforms)}}function Hw(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Mf()}}class Bw{constructor(e,t,n,i,r,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.ua(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Bw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Zw(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Hw(this.ca)&&Uw.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class jw{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Dy(e)}ya(e,t,n,i=!1){return new Bw({ca:e,methodName:t,ga:n,path:tp.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gw(e){const t=e._freezeSettings(),n=Dy(e._databaseId);return new jw(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ww(e,t,n,i,r,o={}){const s=e.ya(o.merge||o.mergeFields?2:0,t,n,r);Yw("Data must be an object, but it was:",s,i);const a=Kw(i,s);let l,u;if(o.merge)l=new Cp(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){const e=[];for(const i of o.mergeFields){const r=Xw(t,i,n);if(!s.contains(r))throw new Of(Nf.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);e_(e,r)||e.push(r)}l=new Cp(e),u=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,u=s.fieldTransforms;return new Vw(new nm(a),l,u)}function zw(e,t,n,i=!1){return qw(n,e.ya(i?4:3,t))}function qw(e,t){if($w(e=Ti(e)))return Yw("Unsupported field value:",t,e),Kw(e,t);if(e instanceof Ow)return function(e,t){if(!Hw(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=qw(r,t.wa(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Ti(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return dg(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Xf.fromDate(e);return{timestampValue:vv(t.serializer,n)}}if(e instanceof Xf){const n=new Xf(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:vv(t.serializer,n)}}if(e instanceof Fw)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Dw)return{bytesValue:yv(t.serializer,e._byteString)};if(e instanceof Iw){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:_v(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${bw(e)}`)}(e,t)}function Kw(e,t){const n={};return Sp(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):_p(e,((e,i)=>{const r=qw(i,t.ha(e));null!=r&&(n[e]=r)})),{mapValue:{fields:n}}}function $w(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Xf||e instanceof Fw||e instanceof Dw||e instanceof Iw||e instanceof Ow)}function Yw(e,t,n){if(!$w(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=bw(n);throw"an object"===i?t._a(e+" a custom object"):t._a(e+" "+i)}}function Xw(e,t,n){if((t=Ti(t))instanceof Nw)return t._internalPath;if("string"==typeof t)return Jw(e,t);throw Zw("Field path arguments must be of type string or ",e,!1,void 0,n)}const Qw=new RegExp("[~\\*/\\[\\]]");function Jw(e,t,n){if(t.search(Qw)>=0)throw Zw(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Nw(...t.split("."))._internalPath}catch(i){throw Zw(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Zw(e,t,n,i,r){const o=i&&!i.isEmpty(),s=void 0!==r;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new Of(Nf.INVALID_ARGUMENT,a+e+l)}function e_(e,t){return e.some((e=>e.isEqual(t)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Iw(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new n_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(i_("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class n_ extends t_{data(){return super.data()}}function i_(e,t){return"string"==typeof t?Jw(e,t):t instanceof Nw?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Of(Nf.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class o_{}class s_ extends o_{}function a_(e,t,...n){let i=[];t instanceof o_&&i.push(t),i=i.concat(n),function(e){const t=e.filter((e=>e instanceof c_)).length,n=e.filter((e=>e instanceof l_)).length;if(t>1||t>0&&n>0)throw new Of(Nf.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const t of i)e=t._apply(e);return e}class l_ extends s_{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new l_(e,t,n)}_apply(e){const t=this._parse(e);return f_(e._query,t),new Ew(e.firestore,e.converter,Bm(e._query,t))}_parse(e){const t=Gw(e.firestore),n=function(e,t,n,i,r,o,s){let a;if(r.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Of(Nf.INVALID_ARGUMENT,`Invalid Query. You can't perform '${o}' queries on documentId().`);if("in"===o||"not-in"===o){d_(s,o);const t=[];for(const n of s)t.push(h_(i,e,n));a={arrayValue:{values:t}}}else a=h_(i,e,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||d_(s,o),a=zw(n,"where",s,"in"===o||"not-in"===o);return hm.create(r,o,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function u_(e,t,n){const i=t,r=i_("where",e);return l_._create(r,i,n)}class c_ extends o_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new c_(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:dm.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const e of i)f_(n,e),n=Bm(n,e)}(e._query,t),new Ew(e.firestore,e.converter,Bm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function h_(e,t,n){if("string"==typeof(n=Ti(n))){if(""===n)throw new Of(Nf.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Um(t)&&-1!==n.indexOf("/"))throw new Of(Nf.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(Zf.fromString(n));if(!np.isDocumentKey(i))throw new Of(Nf.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return $p(e,new np(i))}if(n instanceof Iw)return $p(e,n._key);throw new Of(Nf.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bw(n)}.`)}function d_(e,t){if(!Array.isArray(e)||0===e.length)throw new Of(Nf.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function f_(e,t){if(t.isInequality()){const n=Fm(e),i=t.field;if(null!==n&&!n.isEqual(i))throw new Of(Nf.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const r=Om(e);null!==r&&p_(e,i,r)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Of(Nf.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Of(Nf.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function p_(e,t,n){if(!n.isEqual(t))throw new Of(Nf.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class m_{convertValue(e,t="none"){switch(Bp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pp(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Dp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Mf()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return _p(e,((e,i)=>{n[e]=this.convertValue(i,t)})),n}convertGeoPoint(e){return new Fw(Pp(e.latitude),Pp(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Op(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Fp(e));default:return null}}convertTimestamp(e){const t=Mp(e);return new Xf(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Zf.fromString(e);Pf(jv(n));const i=new Vp(n.get(1),n.get(3)),r=new np(n.popFirst(5));return i.isEqual(t)||xf(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class v_{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class y_ extends t_{constructor(e,t,n,i,r,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new b_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(i_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class b_ extends y_{data(e={}){return super.data(e)}}class w_{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new v_(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new b_(this._firestore,this._userDataWriter,n.key,n,new v_(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Of(Nf.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const i=new b_(e._firestore,e._userDataWriter,n.doc.key,n.doc,new v_(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const i=new b_(e._firestore,e._userDataWriter,t.doc.key,t.doc,new v_(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,o=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:__(t.type),doc:i,oldIndex:r,newIndex:o}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function __(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mf()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function S_(e){e=ww(e,Iw);const t=ww(e.firestore,Rw);return dw(Mw(t),e._key).then((n=>k_(t,e,n)))}class T_ extends m_{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dw(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Iw(this.firestore,null,t)}}function I_(e){e=ww(e,Ew);const t=ww(e.firestore,Rw),n=Mw(t),i=new T_(t);return r_(e._query),fw(n,e._query).then((n=>new w_(t,i,e,n)))}function E_(e,t,n){e=ww(e,Iw);const i=ww(e.firestore,Rw),r=g_(e.converter,t,n);return A_(i,[Ww(Gw(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,Ag.none())])}function A_(e,t){return function(e,t){const n=new Ff;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=ew(e);try{const e=await function(e,t){const n=Df(e),i=Xf.now(),r=t.reduce(((e,t)=>e.add(t.key)),ag());let o,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Jm(),l=ag();return n.Zi.getEntries(e,r).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((r=>{o=r;const s=[];for(const e of t){const t=Mg(e,o.get(e.key).overlayedDocument);null!=t&&s.push(new Ng(e.key,t,im(t.value.mapValue),Ag.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,s,t)})).next((t=>{s=t;const i=t.applyToLocalDocumentSet(o,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:s.batchId,changes:tg(o)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Tc[e.currentUser.toKey()];i||(i=new Tp($f)),i=i.insert(t,n),e.Tc[e.currentUser.toKey()]=i}(i,e.batchId,n),await Xb(i,e.changes),await ib(i.remoteStore)}catch(e){const t=vb(e,"Failed to persist write");n.reject(t)}}(await cw(e),t,n))),n.promise}(Mw(e),t)}function k_(e,t,n){const i=n.docs.get(t._key),r=new T_(e);return new y_(e,r,t._key,i,new v_(n.hasPendingWrites,n.fromCache),t.converter)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(e,t=!0){Ef=vr,hr(new Ii("firestore",((e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),o=new Rw(new Bf(e.getProvider("auth-internal")),new zf(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Of(Nf.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vp(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),Sr(Tf,"3.12.1",e),Sr(Tf,"3.12.1","esm2017")}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class C_{constructor(e,t){this._delegate=e,this.firebase=t,ur(e,new Ii("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),_r(this._delegate))))}_getService(e,t=or){var n;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return i.isInitialized()||"EXPLICIT"!==(null===(n=i.getComponent())||void 0===n?void 0:n.instantiationMode)||i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=or){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){ur(this._delegate,e)}_addOrOverwriteComponent(e){cr(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_=new hi("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const R_=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function e(){const t=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){const t={},n={__esModule:!0,initializeApp:function(i,r={}){const o=yr(i,r);if(fi(t,o.name))return t[o.name];const s=new e(o,n);return t[o.name]=s,s},app:i,registerVersion:Sr,setLogLevel:Ir,onLog:Tr,apps:null,SDK_VERSION:vr,INTERNAL:{registerComponent:function(t){const r=t.name,o=r.replace("-compat","");if(hr(t)&&"PUBLIC"===t.type){const s=(e=i())=>{if("function"!=typeof e[o])throw x_.create("invalid-app-argument",{appName:r});return e[o]()};void 0!==t.serviceProps&&Yn(s,t.serviceProps),n[o]=s,e.prototype[o]=function(...e){return this._getService.bind(this,r).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[o]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:Cn}};function i(e){if(!fi(t,e=e||or))throw x_.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),i.App=e,n}(C_);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Yn(t,e)},createSubscribe:wi,ErrorFactory:hi,deepExtend:Yn}),t}(),L_=new Ni("@firebase/app-compat"),M_="@firebase/app-compat",P_="0.2.11";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){L_.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&L_.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const D_=R_;!
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){Sr(M_,P_,e)}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function N_(){return window}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
D_.registerVersion("firebase","9.22.1","app-compat");const O_=2e3;async function F_(e,t,n){var i;const{BuildInfo:r}=N_();eo(t.sessionId,"AuthEvent did not contain a session ID");const o=await async function(e){const t=function(e){if(eo(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),s={};return Bo()?s.ibi=r.packageName:Uo()?s.apn=r.packageName:Kr(e,"operation-not-supported-in-this-environment"),r.displayName&&(s.appDisplayName=r.displayName),s.sessionId=o,Gl(e,n,t.type,void 0,null!==(i=t.eventId)&&void 0!==i?i:void 0,s)}function U_(e){const{cordova:t}=N_();return new Promise((n=>{t.plugins.browsertab.isAvailable((i=>{let r=null;i?t.plugins.browsertab.openUrl(e):r=t.InAppBrowser.open(e,jo()?"_blank":"_system","location=yes"),n(r)}))}))}const V_=20;class H_ extends gl{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function B_(e){const t=await W_()._get(z_(e));return t&&await W_()._remove(z_(e)),t}function j_(e,t){var n,i;const r=function(e){const t=q_(e),n=t.link?decodeURIComponent(t.link):void 0,i=q_(n).link,r=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return q_(r).link||r||i||n||e}(t);if(r.includes("/__/auth/callback")){const t=q_(r),o=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,s=null===(i=null===(n=null==o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===i?void 0:i[1],a=s?$r(s):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:r,postBody:null}}return null}function G_(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<V_;n++){const n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}function W_(){return Co(ya)}function z_(e){return Lo("authEvent",e.config.apiKey,e.name)}function q_(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return yi(n.join("?"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_=class{constructor(){this._redirectPersistence=wa,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=pl,this._overrideRedirectResult=ll}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new H_(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){Kr(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,i){!function(e){var t,n,i,r,o,s,a,l,u,c;const h=N_();Jr("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Jr(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Jr("function"==typeof(null===(o=null===(r=null===(i=null==h?void 0:h.cordova)||void 0===i?void 0:i.plugins)||void 0===r?void 0:r.browsertab)||void 0===o?void 0:o.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Jr("function"==typeof(null===(l=null===(a=null===(s=null==h?void 0:h.cordova)||void 0===s?void 0:s.plugins)||void 0===a?void 0:a.browsertab)||void 0===l?void 0:l.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Jr("function"==typeof(null===(c=null===(u=null==h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===c?void 0:c.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const r=await this._initialize(e);await r.initialized(),r.resetRedirect(),ol.clear(),await this._originValidation(e);const o=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:G_(),postBody:null,tenantId:e.tenantId,error:$r(e,"no-auth-event")}}(e,n,i);await function(e,t){return W_()._set(z_(e),t)}(e,o);const s=await F_(e,o,t);return async function(e,t,n){const{cordova:i}=N_();let r=()=>{};try{await new Promise(((o,s)=>{let a=null;function l(){var e;o();const t=null===(e=i.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout((()=>{s($r(e,"redirect-cancelled-by-user"))}),O_))}function c(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(l),document.addEventListener("resume",u,!1),Uo()&&document.addEventListener("visibilitychange",c,!1),r=()=>{t.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),a&&window.clearTimeout(a)}}))}finally{r()}}(e,r,await U_(s))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=N_(),n={};Bo()?n.iosBundleId=t.packageName:Uo()?n.androidPackageName=t.packageName:Kr(e,"operation-not-supported-in-this-environment"),await bl(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:i,BuildInfo:r}=N_(),o=setTimeout((async()=>{await B_(e),t.onEvent($_())}),500),s=async n=>{clearTimeout(o);const i=await B_(e);let r=null;i&&(null==n?void 0:n.url)&&(r=j_(i,n.url)),t.onEvent(r||$_())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,s);const a=i,l=`${r.packageName.toLowerCase()}://`;N_().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(l)&&s({url:e}),"function"==typeof a)try{a(e)}catch(e){console.error(e)}}}};function $_(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:$r("no-auth-event")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Y_="@firebase/auth-compat",X_="0.4.2";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Q_=1e3;function J_(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Z_(e=ri()){return!("file:"!==J_()&&"ionic:"!==J_()&&"capacitor:"!==J_()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function eS(e=ri()){return li()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=ri()){return/Edge\/\d+/.test(e)}(e)}function tS(){try{const e=self.localStorage,t=Sa();if(e)return e.setItem(t,"1"),e.removeItem(t),!eS()||ui()}catch(e){return nS()&&ui()}return!1}function nS(){return void 0!==t&&"WorkerGlobalScope"in t&&"importScripts"in t}function iS(){return("http:"===J_()||"https:"===J_()||si()||Z_())&&!(ai()||oi())&&tS()&&!nS()}function rS(){return Z_()&&"undefined"!=typeof document}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const oS={LOCAL:"local",NONE:"none",SESSION:"session"},sS=Jr,aS="persistence";async function lS(e){await e._initializationPromise;const t=uS(),n=Lo(aS,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function uS(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(e){return null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS=Jr;class hS{constructor(){this.browserResolver=Co(zl),this.cordovaResolver=Co(K_),this.underlyingResolver=null,this._redirectPersistence=wa,this._completeRedirectFn=pl,this._overrideRedirectResult=ll}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,i)}async _openRedirect(e,t,n,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return rS()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return cS(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!rS()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),Q_);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(e){return e.unwrap()}function fS(e,t){var n;const i=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null==t?void 0:t.code)){t.resolver=new vS(e,function(e,t){var n;const i=Ti(e),r=t;return Jr(t.customData.operationType,i,"argument-error"),Jr(null===(n=r.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,i,"argument-error"),da._fromError(i,r)}(e,t))}else if(i){const e=pS(t),n=t;e&&(n.credential=e,n.tenantId=i.tenantId||void 0,n.email=i.email||void 0,n.phoneNumber=i.phoneNumber||void 0)}}function pS(e){const{_tokenResponse:t}=e instanceof ci?e.customData:e;if(!t)return null;if(!(e instanceof ci)&&"temporaryProof"in t&&"phoneNumber"in t)return Ya.credentialFromResult(e);const n=t.providerId;if(!n||n===Vr.PASSWORD)return null;let i;switch(n){case Vr.GOOGLE:i=Es;break;case Vr.FACEBOOK:i=Is;break;case Vr.GITHUB:i=As;break;case Vr.TWITTER:i=xs;break;default:const{oauthIdToken:e,oauthAccessToken:r,oauthTokenSecret:o,pendingToken:s,nonce:a}=t;return r||o||e||s?s?n.startsWith("saml.")?ks._create(n,s):gs._fromParams({providerId:n,signInMethod:n,pendingToken:s,idToken:e,accessToken:r}):new Ts(n).credential({idToken:e,accessToken:r,rawNonce:a}):null}return e instanceof ci?i.credentialFromError(e):i.credentialFromResult(e)}function mS(e,t){return t.catch((t=>{throw t instanceof ci&&fS(e,t),t})).then((e=>{const t=e.operationType,n=e.user;return{operationType:t,credential:(i=e,pS(i)),additionalUserInfo:la(e),user:yS.getOrCreate(n)};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var i}))}async function gS(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>mS(e,n.confirm(t))}}class vS{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return mS(dS(this.auth),this.resolver.resolveSignIn(e))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=Ti(e);return pa.has(t)||pa.set(t,fa._fromUser(t)),pa.get(t)}(e)}static getOrCreate(e){return yS.USER_MAP.has(e)||yS.USER_MAP.set(e,new yS(e)),yS.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return mS(this.auth,js(this._delegate,e))}async linkWithPhoneNumber(e,t){return gS(this.auth,async function(e,t,n){const i=Ti(e);await Us(!1,i,"phone");const r=await $a(i.auth,t,Ti(n));return new Ka(r,(e=>js(i,e)))}(this._delegate,e,t))}async linkWithPopup(e){return mS(this.auth,async function(e,t,n){const i=Ti(e);Xr(i.auth,t,_s);const r=Xa(i.auth,n);return new il(i.auth,"linkViaPopup",t,r,i).executeNotNull()}(this._delegate,e,hS))}async linkWithRedirect(e){return await lS(ns(this.auth)),fl(this._delegate,e,hS)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return mS(this.auth,Gs(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return gS(this.auth,async function(e,t,n){const i=Ti(e),r=await $a(i.auth,t,Ti(n));return new Ka(r,(e=>Gs(i,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return mS(this.auth,async function(e,t,n){const i=Ti(e);Xr(i.auth,t,_s);const r=Xa(i.auth,n);return new il(i.auth,"reauthViaPopup",t,r,i).executeNotNull()}(this._delegate,e,hS))}async reauthenticateWithRedirect(e){return await lS(ns(this.auth)),dl(this._delegate,e,hS)}sendEmailVerification(e){return Js(this._delegate,e)}async unlink(e){return await Os(this._delegate,e),this}updateEmail(e){return function(e,t){return ta(Ti(e),t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return ta(Ti(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){await Fs(Ti(e),t)}(this._delegate,e)}updateProfile(e){return ea(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Zs(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}yS.USER_MAP=new WeakMap;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const bS=Jr;class wS{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;bS(n,"invalid-api-key",{appName:e.name}),bS(n,"invalid-api-key",{appName:e.name});const i="undefined"!=typeof window?hS:void 0;this._delegate=t.initialize({options:{persistence:SS(n,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(jr),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?yS.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){rs(this._delegate,e,t)}applyActionCode(e){return Ys(this._delegate,e)}checkActionCode(e){return Xs(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await ls(Ti(e),{oobCode:t,newPassword:n})}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return mS(this._delegate,async function(e,t,n){var i;const r=ns(e),o={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};let s;if(null===(i=r._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled){const e=await Zo(r,o,"signUpPassword");s=Rs(r,e)}else s=Rs(r,o).catch((async e=>{if("auth/missing-recaptcha-token"===e.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const e=await Zo(r,o,"signUpPassword");return Rs(r,e)}return Promise.reject(e)}));const a=await s.catch((e=>Promise.reject(e))),l=await Ls._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Qs(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=bs.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){bS(iS(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await ns(e)._initializationPromise,pl(e,t,!1)}(this._delegate,hS);return e?mS(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){ns(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:i,error:r,complete:o}=_S(e,t,n);return this._delegate.onAuthStateChanged(i,r,o)}onIdTokenChanged(e,t,n){const{next:i,error:r,complete:o}=_S(e,t,n);return this._delegate.onIdTokenChanged(i,r,o)}sendSignInLinkToEmail(e,t){
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(e,t,n){var i;const r=ns(e),o={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};function s(e,t){Jr(t.handleCodeInApp,r,"argument-error"),t&&$s(r,e,t)}if(null===(i=r._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled){const e=await Zo(r,o,"getOobCode",!0);s(e,n),await fs(r,e)}else s(o,n),await fs(r,o).catch((async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const e=await Zo(r,o,"getOobCode",!0);s(e,n),await fs(r,e)}}))}(this._delegate,e,t)}sendPasswordResetEmail(e,t){return async function(e,t,n){var i;const r=ns(e),o={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};if(null===(i=r._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled){const e=await Zo(r,o,"getOobCode",!0);n&&$s(r,e,n),await ds(r,e)}else n&&$s(r,o,n),await ds(r,o).catch((async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const e=await Zo(r,o,"getOobCode",!0);n&&$s(r,e,n),await ds(r,e)}}))}(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){sS(Object.values(oS).includes(t),e,"invalid-persistence-type"),ai()?sS(t!==oS.SESSION,e,"unsupported-persistence-type"):oi()?sS(t===oS.NONE,e,"unsupported-persistence-type"):nS()?sS(t===oS.NONE||t===oS.LOCAL&&ui(),e,"unsupported-persistence-type"):sS(t===oS.NONE||tS(),e,"unsupported-persistence-type")}(this._delegate,e),e){case oS.SESSION:t=wa;break;case oS.LOCAL:t=await Co(Oa)._isAvailable()?Oa:ya;break;case oS.NONE:t=Ro;break;default:return Kr("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return mS(this._delegate,async function(e){var t;const n=ns(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Ls({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await Rs(n,{returnSecureToken:!0}),r=await Ls._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(r.user),r}(this._delegate))}signInWithCredential(e){return mS(this._delegate,Bs(this._delegate,e))}signInWithCustomToken(e){return mS(this._delegate,Ws(this._delegate,e))}signInWithEmailAndPassword(e,t){return mS(this._delegate,function(e,t,n){return Bs(Ti(e),ws.credential(t,n))}(this._delegate,e,t))}signInWithEmailLink(e,t){return mS(this._delegate,async function(e,t,n){const i=Ti(e),r=ws.credentialWithLink(t,n||to());return Jr(r._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),Bs(i,r)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return gS(this._delegate,async function(e,t,n){const i=ns(e),r=await $a(i,t,Ti(n));return new Ka(r,(e=>Bs(i,e)))}(this._delegate,e,t))}async signInWithPopup(e){return bS(iS(),this._delegate,"operation-not-supported-in-this-environment"),mS(this._delegate,async function(e,t,n){const i=ns(e);Xr(e,t,_s);const r=Xa(i,n);return new il(i,"signInViaPopup",t,r).executeNotNull()}(this._delegate,e,hS))}async signInWithRedirect(e){return bS(iS(),this._delegate,"operation-not-supported-in-this-environment"),await lS(this._delegate),hl(this._delegate,e,hS)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await Xs(Ti(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function _S(e,t,n){let i=e;"function"!=typeof e&&({next:i,error:t,complete:n}=e);const r=i;return{next:e=>r(e&&yS.getOrCreate(e)),error:t,complete:n}}function SS(e,t){const n=function(e,t){const n=uS();if(!n)return[];const i=Lo(aS,e,t);switch(n.getItem(i)){case oS.NONE:return[Ro];case oS.LOCAL:return[Oa,wa];case oS.SESSION:return[wa];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(Oa)||n.push(Oa),"undefined"!=typeof window)for(const e of[ya,wa])n.includes(e)||n.push(e);return n.includes(Ro)||n.push(Ro),n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wS.Persistence=oS;class TS{constructor(){this.providerId="phone",this._delegate=new Ya(dS(D_.auth()))}static credential(e,t){return Ya.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}TS.PHONE_SIGN_IN_METHOD=Ya.PHONE_SIGN_IN_METHOD,TS.PROVIDER_ID=Ya.PROVIDER_ID;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const IS=Jr;class ES{constructor(e,t,n=D_.app()){var i;IS(null===(i=n.options)||void 0===i?void 0:i.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new qa(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="auth-compat";var kS;(kS=D_).INTERNAL.registerComponent(new Ii(AS,(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new wS(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Hr.EMAIL_SIGNIN,PASSWORD_RESET:Hr.PASSWORD_RESET,RECOVER_EMAIL:Hr.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Hr.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Hr.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Hr.VERIFY_EMAIL}},EmailAuthProvider:ws,FacebookAuthProvider:Is,GithubAuthProvider:As,GoogleAuthProvider:Es,OAuthProvider:Ts,SAMLAuthProvider:Cs,PhoneAuthProvider:TS,PhoneMultiFactorGenerator:$l,RecaptchaVerifier:ES,TwitterAuthProvider:xs,Auth:wS,AuthCredential:as,Error:ci}).setInstantiationMode("LAZY").setMultipleInstances(!1)),kS.registerVersion(Y_,X_);var CS={};!function(){var e=window.CustomEvent;function t(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement}return null}function n(e){e&&e.blur&&e!==document.body&&e.blur()}function i(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1}function r(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function o(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window){new MutationObserver(this.maybeHideModal.bind(this)).observe(e,{attributes:!0,attributeFilter:["open"]})}else{var t,n=!1,i=function(){n?this.downgradeModal():this.maybeHideModal(),n=!1}.bind(this),r=function(r){if(r.target===e){var o="DOMNodeRemoved";n|=r.type.substr(0,o.length)===o,window.clearTimeout(t),t=window.setTimeout(i,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(t){e.addEventListener(t,r)}))}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("click",this.backdropClick_.bind(this))}e&&"object"!=typeof e||((e=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),n}).prototype=window.Event.prototype),o.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&document.body.contains(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),s.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropClick_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var n=document.createEvent("MouseEvents");n.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(n),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");if(!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),!e){var t=["button","input","keygen","select","textarea"].map((function(e){return e+":not([disabled])"}));t.push('[tabindex]:not([disabled]):not([tabindex=""])'),e=this.dialog_.querySelector(t.join(", "))}n(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!document.body.contains(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!s.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),n=function(e,n){return!(void 0===t[e]||t[e]===n)};if(t.opacity<1||n("zIndex","auto")||n("transform","none")||n("mixBlendMode","normal")||n("filter","none")||n("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,s.needsCentering(this.dialog_)?(s.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(t){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==t&&(this.dialog_.returnValue=t);var n=new e("close",{bubbles:!1,cancelable:!1});this.dialog_.dispatchEvent(n)}};var s={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,n=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,n)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var n=document.styleSheets[t],r=null;try{r=n.cssRules}catch(e){}if(r)for(var o=0;o<r.length;++o){var s=r[o],a=null;try{a=document.querySelectorAll(s.selectorText)}catch(e){}if(a&&i(a,e)){var l=s.style.getPropertyValue("top"),u=s.style.getPropertyValue("bottom");if(l&&"auto"!==l||u&&"auto"!==u)return!0}}}return!1},needsCentering:function(e){return"absolute"===window.getComputedStyle(e).position&&(!("auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom)&&!s.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new o(e)},registerDialog:function(e){e.showModal||s.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(t){var n=[];t.forEach((function(e){for(var t,i=0;t=e.removedNodes[i];++i)t instanceof Element&&("dialog"===t.localName&&n.push(t),n=n.concat(t.querySelectorAll("dialog")))})),n.length&&e(n)})))}};if(s.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},s.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},s.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,n=0;e=this.pendingDialogStack[n];++n)e.updateZIndex(--t,--t),0===n&&(this.overlay.style.zIndex=--t);var i=this.pendingDialogStack[0];i?(i.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},s.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=t(e);){for(var n,i=0;n=this.pendingDialogStack[i];++i)if(n.dialog===e)return 0===i;e=e.parentElement}return!1},s.DialogManager.prototype.handleFocus_=function(e){if(!this.containedByTopDialog_(e.target)&&(e.preventDefault(),e.stopPropagation(),n(e.target),void 0!==this.forwardTab_)){var t=this.pendingDialogStack[0];return t.dialog.compareDocumentPosition(e.target)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?t.focus_():document.documentElement.focus()),!1}},s.DialogManager.prototype.handleKey_=function(t){if(this.forwardTab_=void 0,27===t.keyCode){t.preventDefault(),t.stopPropagation();var n=new e("cancel",{bubbles:!1,cancelable:!0}),i=this.pendingDialogStack[0];i&&i.dialog.dispatchEvent(n)&&i.dialog.close()}else 9===t.keyCode&&(this.forwardTab_=!t.shiftKey)},s.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach((function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()}))},s.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t)&&(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),!0)},s.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},s.dm=new s.DialogManager,s.formSubmitter=null,s.useValue=null,void 0===window.HTMLDialogElement){var a=document.createElement("form");if(a.setAttribute("method","dialog"),"dialog"!==a.method){var l=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(l){var u=l.get;l.get=function(){return r(this)?"dialog":u.call(this)};var c=l.set;l.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):c.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",l)}}document.addEventListener("click",(function(e){if(s.formSubmitter=null,s.useValue=null,!e.defaultPrevented){var n=e.target;if(n&&r(n.form)){if(!("submit"===n.type&&["button","input"].indexOf(n.localName)>-1)){if("input"!==n.localName||"image"!==n.type)return;s.useValue=e.offsetX+","+e.offsetY}t(n)&&(s.formSubmitter=n)}}}),!1);var h=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!r(this))return h.call(this);var e=t(this);e&&e.close()},document.addEventListener("submit",(function(e){var n=e.target;if(r(n)){e.preventDefault();var i=t(n);if(i){var o=s.formSubmitter;o&&o.form===n?i.close(s.useValue||o.value):i.close(),s.formSubmitter=null}}}),!0)}s.forceRegisterDialog=s.forceRegisterDialog,s.registerDialog=s.registerDialog,"function"==typeof define&&"amd"in define?define((function(){return s})):"object"==typeof CS?CS=s:window.dialogPolyfill=s}();
/**
 * @license
 * Copyright 2015 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var xS,RS,LS,MS,PS={upgradeDom:function(e,t){},upgradeElement:function(e,t){},upgradeElements:function(e){},upgradeAllRegistered:function(){},registerUpgradedCallback:function(e,t){},register:function(e){},downgradeElements:function(e){}};PS=function(){var e=[],t=[],n="mdlComponentConfigInternal_";function i(t,n){for(var i=0;i<e.length;i++)if(e[i].className===t)return void 0!==n&&(e[i]=n),e[i];return!1}function r(e){var t=e.getAttribute("data-upgraded");return null===t?[""]:t.split(",")}function o(e,t){return-1!==r(e).indexOf(t)}function s(e,t,n){if("CustomEvent"in window&&"function"==typeof window.CustomEvent)return new CustomEvent(e,{bubbles:t,cancelable:n});var i=document.createEvent("Events");return i.initEvent(e,t,n),i}function a(t,n){if(void 0===t&&void 0===n)for(var r=0;r<e.length;r++)a(e[r].className,e[r].cssClass);else{var o=t;if(void 0===n){var s=i(o);s&&(n=s.cssClass)}for(var u=document.querySelectorAll("."+n),c=0;c<u.length;c++)l(u[c],o)}}function l(a,l){if(!("object"==typeof a&&a instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var u=s("mdl-componentupgrading",!0,!0);if(a.dispatchEvent(u),!u.defaultPrevented){var c=r(a),h=[];if(l)o(a,l)||h.push(i(l));else{var d=a.classList;e.forEach((function(e){d.contains(e.cssClass)&&-1===h.indexOf(e)&&!o(a,e.className)&&h.push(e)}))}for(var f,p=0,m=h.length;p<m;p++){if(!(f=h[p]))throw new Error("Unable to find a registered component for the given class.");c.push(f.className),a.setAttribute("data-upgraded",c.join(","));var g=new f.classConstructor(a);g[n]=f,t.push(g);for(var v=0,y=f.callbacks.length;v<y;v++)f.callbacks[v](a);f.widget&&(a[f.className]=g);var b=s("mdl-componentupgraded",!0,!1);a.dispatchEvent(b)}}}function u(e){if(e){var i=t.indexOf(e);t.splice(i,1);var r=e.element_.getAttribute("data-upgraded").split(","),o=r.indexOf(e[n].classAsString);r.splice(o,1),e.element_.setAttribute("data-upgraded",r.join(","));var a=s("mdl-componentdowngraded",!0,!1);e.element_.dispatchEvent(a)}}return{upgradeDom:a,upgradeElement:l,upgradeElements:function e(t){Array.isArray(t)||(t=t instanceof Element?[t]:Array.prototype.slice.call(t));for(var n,i=0,r=t.length;i<r;i++)(n=t[i])instanceof HTMLElement&&(l(n),n.children.length>0&&e(n.children))},upgradeAllRegistered:function(){for(var t=0;t<e.length;t++)a(e[t].className)},registerUpgradedCallback:function(e,t){var n=i(e);n&&n.callbacks.push(t)},register:function(t){var r=!0;void 0===t.widget&&void 0===t.widget||(r=t.widget||t.widget);var o={classConstructor:t.constructor||t.constructor,className:t.classAsString||t.classAsString,cssClass:t.cssClass||t.cssClass,widget:r,callbacks:[]};if(e.forEach((function(e){if(e.cssClass===o.cssClass)throw new Error("The provided cssClass has already been registered: "+e.cssClass);if(e.className===o.className)throw new Error("The provided className has already been registered")})),t.constructor.prototype.hasOwnProperty(n))throw new Error("MDL component classes must not have "+n+" defined as a property.");i(t.classAsString,o)||e.push(o)},downgradeElements:function(e){var n=function(e){t.filter((function(t){return t.element_===e})).forEach(u)};if(e instanceof Array||e instanceof NodeList)for(var i=0;i<e.length;i++)n(e[i]);else{if(!(e instanceof Node))throw new Error("Invalid argument provided to downgrade MDL nodes.");n(e)}}}}(),PS.ComponentConfigPublic,PS.ComponentConfig,PS.Component,PS.upgradeDom=PS.upgradeDom,PS.upgradeElement=PS.upgradeElement,PS.upgradeElements=PS.upgradeElements,PS.upgradeAllRegistered=PS.upgradeAllRegistered,PS.registerUpgradedCallback=PS.registerUpgradedCallback,PS.register=PS.register,PS.downgradeElements=PS.downgradeElements,window.componentHandler=PS,window.componentHandler=PS,window.addEventListener("load",(function(){"classList"in document.createElement("div")&&"querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach?(document.documentElement.classList.add("mdl-js"),PS.upgradeAllRegistered()):(PS.upgradeElement=function(){},PS.register=function(){})})),
/**
 * @license
 * Copyright 2015 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
xS=function(e){this.element_=e,this.init()},window.MaterialButton=xS,xS.prototype.Constant_={},xS.prototype.CssClasses_={RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-button__ripple-container",RIPPLE:"mdl-ripple"},xS.prototype.blurHandler_=function(e){e&&this.element_.blur()},xS.prototype.disable=function(){this.element_.disabled=!0},xS.prototype.disable=xS.prototype.disable,xS.prototype.enable=function(){this.element_.disabled=!1},xS.prototype.enable=xS.prototype.enable,xS.prototype.init=function(){if(this.element_){if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){var e=document.createElement("span");e.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleElement_=document.createElement("span"),this.rippleElement_.classList.add(this.CssClasses_.RIPPLE),e.appendChild(this.rippleElement_),this.boundRippleBlurHandler=this.blurHandler_.bind(this),this.rippleElement_.addEventListener("mouseup",this.boundRippleBlurHandler),this.element_.appendChild(e)}this.boundButtonBlurHandler=this.blurHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundButtonBlurHandler),this.element_.addEventListener("mouseleave",this.boundButtonBlurHandler)}},componentHandler.register({constructor:xS,classAsString:"MaterialButton",cssClass:"mdl-js-button",widget:!0}),
/**
 * @license
 * Copyright 2015 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
RS=function(e){this.element_=e,this.init()},window.MaterialProgress=RS,RS.prototype.Constant_={},RS.prototype.CssClasses_={INDETERMINATE_CLASS:"mdl-progress__indeterminate"},RS.prototype.setProgress=function(e){this.element_.classList.contains(this.CssClasses_.INDETERMINATE_CLASS)||(this.progressbar_.style.width=e+"%")},RS.prototype.setProgress=RS.prototype.setProgress,RS.prototype.setBuffer=function(e){this.bufferbar_.style.width=e+"%",this.auxbar_.style.width=100-e+"%"},RS.prototype.setBuffer=RS.prototype.setBuffer,RS.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.className="progressbar bar bar1",this.element_.appendChild(e),this.progressbar_=e,(e=document.createElement("div")).className="bufferbar bar bar2",this.element_.appendChild(e),this.bufferbar_=e,(e=document.createElement("div")).className="auxbar bar bar3",this.element_.appendChild(e),this.auxbar_=e,this.progressbar_.style.width="0%",this.bufferbar_.style.width="100%",this.auxbar_.style.width="0%",this.element_.classList.add("is-upgraded")}},componentHandler.register({constructor:RS,classAsString:"MaterialProgress",cssClass:"mdl-js-progress",widget:!0}),
/**
 * @license
 * Copyright 2015 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
LS=function(e){this.element_=e,this.init()},window.MaterialSpinner=LS,LS.prototype.Constant_={MDL_SPINNER_LAYER_COUNT:4},LS.prototype.CssClasses_={MDL_SPINNER_LAYER:"mdl-spinner__layer",MDL_SPINNER_CIRCLE_CLIPPER:"mdl-spinner__circle-clipper",MDL_SPINNER_CIRCLE:"mdl-spinner__circle",MDL_SPINNER_GAP_PATCH:"mdl-spinner__gap-patch",MDL_SPINNER_LEFT:"mdl-spinner__left",MDL_SPINNER_RIGHT:"mdl-spinner__right"},LS.prototype.createLayer=function(e){var t=document.createElement("div");t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER),t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER+"-"+e);var n=document.createElement("div");n.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),n.classList.add(this.CssClasses_.MDL_SPINNER_LEFT);var i=document.createElement("div");i.classList.add(this.CssClasses_.MDL_SPINNER_GAP_PATCH);var r=document.createElement("div");r.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),r.classList.add(this.CssClasses_.MDL_SPINNER_RIGHT);for(var o=[n,i,r],s=0;s<o.length;s++){var a=document.createElement("div");a.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE),o[s].appendChild(a)}t.appendChild(n),t.appendChild(i),t.appendChild(r),this.element_.appendChild(t)},LS.prototype.createLayer=LS.prototype.createLayer,LS.prototype.stop=function(){this.element_.classList.remove("is-active")},LS.prototype.stop=LS.prototype.stop,LS.prototype.start=function(){this.element_.classList.add("is-active")},LS.prototype.start=LS.prototype.start,LS.prototype.init=function(){if(this.element_){for(var e=1;e<=this.Constant_.MDL_SPINNER_LAYER_COUNT;e++)this.createLayer(e);this.element_.classList.add("is-upgraded")}},componentHandler.register({constructor:LS,classAsString:"MaterialSpinner",cssClass:"mdl-js-spinner",widget:!0}),
/**
 * @license
 * Copyright 2015 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
MS=function(e){this.element_=e,this.maxRows=this.Constant_.NO_MAX_ROWS,this.init()},window.MaterialTextfield=MS,MS.prototype.Constant_={NO_MAX_ROWS:-1,MAX_ROWS_ATTRIBUTE:"maxrows"},MS.prototype.CssClasses_={LABEL:"mdl-textfield__label",INPUT:"mdl-textfield__input",IS_DIRTY:"is-dirty",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_INVALID:"is-invalid",IS_UPGRADED:"is-upgraded",HAS_PLACEHOLDER:"has-placeholder"},MS.prototype.onKeyDown_=function(e){var t=e.target.value.split("\n").length;13===e.keyCode&&t>=this.maxRows&&e.preventDefault()},MS.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},MS.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},MS.prototype.onReset_=function(e){this.updateClasses_()},MS.prototype.updateClasses_=function(){this.checkDisabled(),this.checkValidity(),this.checkDirty(),this.checkFocus()},MS.prototype.checkDisabled=function(){this.input_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},MS.prototype.checkDisabled=MS.prototype.checkDisabled,MS.prototype.checkFocus=function(){Boolean(this.element_.querySelector(":focus"))?this.element_.classList.add(this.CssClasses_.IS_FOCUSED):this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},MS.prototype.checkFocus=MS.prototype.checkFocus,MS.prototype.checkValidity=function(){this.input_.validity&&(this.input_.validity.valid?this.element_.classList.remove(this.CssClasses_.IS_INVALID):this.element_.classList.add(this.CssClasses_.IS_INVALID))},MS.prototype.checkValidity=MS.prototype.checkValidity,MS.prototype.checkDirty=function(){this.input_.value&&this.input_.value.length>0?this.element_.classList.add(this.CssClasses_.IS_DIRTY):this.element_.classList.remove(this.CssClasses_.IS_DIRTY)},MS.prototype.checkDirty=MS.prototype.checkDirty,MS.prototype.disable=function(){this.input_.disabled=!0,this.updateClasses_()},MS.prototype.disable=MS.prototype.disable,MS.prototype.enable=function(){this.input_.disabled=!1,this.updateClasses_()},MS.prototype.enable=MS.prototype.enable,MS.prototype.change=function(e){this.input_.value=e||"",this.updateClasses_()},MS.prototype.change=MS.prototype.change,MS.prototype.init=function(){if(this.element_&&(this.label_=this.element_.querySelector("."+this.CssClasses_.LABEL),this.input_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.input_)){this.input_.hasAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE)&&(this.maxRows=parseInt(this.input_.getAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE),10),isNaN(this.maxRows)&&(this.maxRows=this.Constant_.NO_MAX_ROWS)),this.input_.hasAttribute("placeholder")&&this.element_.classList.add(this.CssClasses_.HAS_PLACEHOLDER),this.boundUpdateClassesHandler=this.updateClasses_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.boundResetHandler=this.onReset_.bind(this),this.input_.addEventListener("input",this.boundUpdateClassesHandler),this.input_.addEventListener("focus",this.boundFocusHandler),this.input_.addEventListener("blur",this.boundBlurHandler),this.input_.addEventListener("reset",this.boundResetHandler),this.maxRows!==this.Constant_.NO_MAX_ROWS&&(this.boundKeyDownHandler=this.onKeyDown_.bind(this),this.input_.addEventListener("keydown",this.boundKeyDownHandler));var e=this.element_.classList.contains(this.CssClasses_.IS_INVALID);this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED),e&&this.element_.classList.add(this.CssClasses_.IS_INVALID),this.input_.hasAttribute("autofocus")&&(this.element_.focus(),this.checkFocus())}},componentHandler.register({constructor:MS,classAsString:"MaterialTextfield",cssClass:"mdl-js-textfield",widget:!0}),function(){(function(){var e,n,i="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)n=Object.setPrototypeOf;else{var r;e:{var o={};try{o.__proto__={xb:!0},r=o.xb;break e}catch(e){}r=!1}n=r?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var s=n;function a(e,t){if(e.prototype=i(t.prototype),e.prototype.constructor=e,s)s(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.K=t.prototype}var l="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},u="undefined"!=typeof window&&window===this?this:void 0!==t&&null!=t?t:this;function c(e,t){if(t){var n=u;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];r in n||(n[r]={}),n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&l(n,e,{configurable:!0,writable:!0,value:t})}}c("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),c("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(0>(t=t||0)&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}}));var h=this;function d(e){return void 0!==e}function f(e){return"string"==typeof e}var p=/^[\w+/_-]+[=]{0,2}$/,m=null;function g(){}function v(e){e.W=void 0,e.Xa=function(){return e.W?e.W:e.W=new e}}function y(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function b(e){return"array"==y(e)}function w(e){var t=y(e);return"array"==t||"object"==t&&"number"==typeof e.length}function _(e){return"function"==y(e)}function S(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var T="closure_uid_"+(1e9*Math.random()>>>0),I=0;function E(e,t,n){return e.call.apply(e.bind,arguments)}function A(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function k(e,t,n){return(k=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:A).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function x(e,t){for(var n in t)e[n]=t[n]}var R,L=Date.now||function(){return+new Date};function M(e,t){e=e.split(".");var n,i=h;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)!e.length&&d(t)?i[n]=t:i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}}function P(e,t){function n(){}n.prototype=t.prototype,e.K=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.vc=function(e,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return t.prototype[n].apply(e,r)}}function D(e){if(Error.captureStackTrace)Error.captureStackTrace(this,D);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function N(e,t){for(var n="",i=(e=e.split("%s")).length-1,r=0;r<i;r++)n+=e[r]+(r<t.length?t[r]:"%s");D.call(this,n+e[i])}function O(e,t){throw new N("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}P(D,Error),D.prototype.name="CustomError",P(N,D),N.prototype.name="AssertionError";var F=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(f(e))return f(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},U=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var i=e.length,r=f(e)?e.split(""):e,o=0;o<i;o++)o in r&&t.call(n,r[o],o,e)};var V=Array.prototype.filter?function(e,t){return Array.prototype.filter.call(e,t,void 0)}:function(e,t){for(var n=e.length,i=[],r=0,o=f(e)?e.split(""):e,s=0;s<n;s++)if(s in o){var a=o[s];t.call(void 0,a,s,e)&&(i[r++]=a)}return i},H=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,i=Array(n),r=f(e)?e.split(""):e,o=0;o<n;o++)o in r&&(i[o]=t.call(void 0,r[o],o,e));return i},B=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,i=f(e)?e.split(""):e,r=0;r<n;r++)if(r in i&&t.call(void 0,i[r],r,e))return!0;return!1};function j(e,t){return 0<=F(e,t)}function G(e,t){var n;return(n=0<=(t=F(e,t)))&&W(e,t),n}function W(e,t){return 1==Array.prototype.splice.call(e,t,1).length}function z(e,t){!function(e,t){for(var n=f(e)?e.split(""):e,i=e.length-1;0<=i;--i)i in n&&t.call(void 0,n[i],i,e)}(e,(function(n,i){t.call(void 0,n,i,e)&&W(e,i)&&0}))}function q(e){return Array.prototype.concat.apply([],arguments)}function K(e){var t=e.length;if(0<t){for(var n=Array(t),i=0;i<t;i++)n[i]=e[i];return n}return[]}function $(e,t,n){return 2>=arguments.length?Array.prototype.slice.call(e,t):Array.prototype.slice.call(e,t,n)}var Y=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},X=/&/g,Q=/</g,J=/>/g,Z=/"/g,ee=/'/g,te=/\x00/g,ne=/[\x00&<>"']/;function ie(e,t){return e<t?-1:e>t?1:0}function re(e){return ne.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(X,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(Q,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(J,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(Z,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(ee,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(te,"&#0;"))),e}function oe(e,t,n){for(var i in e)t.call(n,e[i],i,e)}function se(e){var t,n={};for(t in e)n[t]=e[t];return n}var ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(e,t){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])e[n]=i[n];for(var o=0;o<ae.length;o++)n=ae[o],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}var ue="StopIteration"in h?h.StopIteration:{message:"StopIteration",stack:""};function ce(){}function he(e){if(e instanceof ce)return e;if("function"==typeof e.ha)return e.ha(!1);if(w(e)){var t=0,n=new ce;return n.next=function(){for(;;){if(t>=e.length)throw ue;if(t in e)return e[t++];t++}},n}throw Error("Not implemented")}function de(e){if(w(e))return K(e);e=he(e);var t=[];return function(e,t){if(w(e))try{U(e,t,void 0)}catch(e){if(e!==ue)throw e}else{e=he(e);try{for(;;)t.call(void 0,e.next(),void 0,e)}catch(e){if(e!==ue)throw e}}}(e,(function(e){t.push(e)})),t}function fe(e,t){this.g={},this.a=[],this.j=this.h=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(e)if(e instanceof fe)for(n=e.ja(),i=0;i<n.length;i++)this.set(n[i],e.get(n[i]));else for(i in e)this.set(i,e[i])}function pe(e){if(e.h!=e.a.length){for(var t=0,n=0;t<e.a.length;){var i=e.a[t];me(e.g,i)&&(e.a[n++]=i),t++}e.a.length=n}if(e.h!=e.a.length){var r={};for(n=t=0;t<e.a.length;)me(r,i=e.a[t])||(e.a[n++]=i,r[i]=1),t++;e.a.length=n}}function me(e,t){return Object.prototype.hasOwnProperty.call(e,t)}ce.prototype.next=function(){throw ue},ce.prototype.ha=function(){return this},(e=fe.prototype).la=function(){pe(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.g[this.a[t]]);return e},e.ja=function(){return pe(this),this.a.concat()},e.clear=function(){this.g={},this.j=this.h=this.a.length=0},e.get=function(e,t){return me(this.g,e)?this.g[e]:t},e.set=function(e,t){me(this.g,e)||(this.h++,this.a.push(e),this.j++),this.g[e]=t},e.forEach=function(e,t){for(var n=this.ja(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);e.call(t,o,r,this)}},e.ha=function(e){pe(this);var t=0,n=this.j,i=this,r=new ce;return r.next=function(){if(n!=i.j)throw Error("The map has changed since the iterator was created");if(t>=i.a.length)throw ue;var r=i.a[t++];return e?r:i.g[r]},r};var ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ve(e,t,n,i){for(var r=n.length;0<=(t=e.indexOf(n,t))&&t<i;){var o=e.charCodeAt(t-1);if(!(38!=o&&63!=o||(o=e.charCodeAt(t+r))&&61!=o&&38!=o&&35!=o))return t;t+=r+1}return-1}var ye=/#|$/;function be(e,t){var n=e.search(ye),i=ve(e,0,t,n);if(0>i)return null;var r=e.indexOf("&",i);return(0>r||r>n)&&(r=n),i+=t.length+1,decodeURIComponent(e.substr(i,r-i).replace(/\+/g," "))}var we=/[?&]($|#)/;function _e(e,t){var n;this.h=this.A=this.j="",this.C=null,this.s=this.g="",this.i=!1,e instanceof _e?(this.i=d(t)?t:e.i,Se(this,e.j),this.A=e.A,this.h=e.h,Te(this,e.C),this.g=e.g,Ie(this,Ue(e.a)),this.s=e.s):e&&(n=String(e).match(ge))?(this.i=!!t,Se(this,n[1]||"",!0),this.A=Ae(n[2]||""),this.h=Ae(n[3]||"",!0),Te(this,n[4]),this.g=Ae(n[5]||"",!0),Ie(this,n[6]||"",!0),this.s=Ae(n[7]||"")):(this.i=!!t,this.a=new De(null,this.i))}function Se(e,t,n){e.j=n?Ae(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Te(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.C=t}else e.C=null}function Ie(e,t,n){t instanceof De?(e.a=t,function(e,t){t&&!e.j&&(Ne(e),e.h=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Oe(this,t),Oe(this,n),0<e.length&&(this.h=null,this.a.set(Ve(this,n),K(e)),this.g+=e.length))}),e)),e.j=t}(e.a,e.i)):(n||(t=ke(t,Me)),e.a=new De(t,e.i))}function Ee(e){return e instanceof _e?new _e(e):new _e(e,void 0)}function Ae(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ke(e,t,n){return f(e)?(e=encodeURI(e).replace(t,Ce),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ce(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}_e.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ke(t,xe,!0),":");var n=this.h;return(n||"file"==t)&&(e.push("//"),(t=this.A)&&e.push(ke(t,xe,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.C)&&e.push(":",String(n))),(n=this.g)&&(this.h&&"/"!=n.charAt(0)&&e.push("/"),e.push(ke(n,"/"==n.charAt(0)?Le:Re,!0))),(n=this.a.toString())&&e.push("?",n),(n=this.s)&&e.push("#",ke(n,Pe)),e.join("")};var xe=/[#\/\?@]/g,Re=/[#\?:]/g,Le=/[#\?]/g,Me=/[#\?@]/g,Pe=/#/g;function De(e,t){this.g=this.a=null,this.h=e||null,this.j=!!t}function Ne(e){e.a||(e.a=new fe,e.g=0,e.h&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var o=e[n].substring(0,i);r=e[n].substring(i+1)}else o=e[n];t(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.h,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Oe(e,t){Ne(e),t=Ve(e,t),me(e.a.g,t)&&(e.h=null,e.g-=e.a.get(t).length,me((e=e.a).g,t)&&(delete e.g[t],e.h--,e.j++,e.a.length>2*e.h&&pe(e)))}function Fe(e,t){return Ne(e),t=Ve(e,t),me(e.a.g,t)}function Ue(e){var t=new De;return t.h=e.h,e.a&&(t.a=new fe(e.a),t.g=e.g),t}function Ve(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function He(e){this.a=Ee(e)}function Be(e){return e.a.a.get(We.Pa)||null}function je(e,t){t?e.a.a.set(We.PROVIDER_ID,t):Oe(e.a.a,We.PROVIDER_ID)}(e=De.prototype).add=function(e,t){Ne(this),this.h=null,e=Ve(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.g+=1,this},e.clear=function(){this.a=this.h=null,this.g=0},e.forEach=function(e,t){Ne(this),this.a.forEach((function(n,i){U(n,(function(n){e.call(t,n,i,this)}),this)}),this)},e.ja=function(){Ne(this);for(var e=this.a.la(),t=this.a.ja(),n=[],i=0;i<t.length;i++)for(var r=e[i],o=0;o<r.length;o++)n.push(t[i]);return n},e.la=function(e){Ne(this);var t=[];if(f(e))Fe(this,e)&&(t=q(t,this.a.get(Ve(this,e))));else{e=this.a.la();for(var n=0;n<e.length;n++)t=q(t,e[n])}return t},e.set=function(e,t){return Ne(this),this.h=null,Fe(this,e=Ve(this,e))&&(this.g-=this.a.get(e).length),this.a.set(e,[t]),this.g+=1,this},e.get=function(e,t){return e&&0<(e=this.la(e)).length?String(e[0]):t},e.toString=function(){if(this.h)return this.h;if(!this.a)return"";for(var e=[],t=this.a.ja(),n=0;n<t.length;n++){var i=t[n],r=encodeURIComponent(String(i));i=this.la(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),e.push(s)}}return this.h=e.join("&")},He.prototype.toString=function(){return this.a.toString()};var Ge,We={Pa:"ui_auid",lc:"apiKey",Qa:"ui_sd",ub:"mode",$a:"oobCode",PROVIDER_ID:"ui_pid",Sa:"ui_sid",vb:"tenantId"};e:{var ze=h.navigator;if(ze){var qe=ze.userAgent;if(qe){Ge=qe;break e}}Ge=""}function Ke(e){return-1!=Ge.indexOf(e)}function $e(){return(Ke("Chrome")||Ke("CriOS"))&&!Ke("Edge")}function Ye(e){return Ye[" "](e),e}Ye[" "]=g;var Xe,Qe=Ke("Opera"),Je=Ke("Trident")||Ke("MSIE"),Ze=Ke("Edge"),et=Ze||Je,tt=Ke("Gecko")&&!(-1!=Ge.toLowerCase().indexOf("webkit")&&!Ke("Edge"))&&!(Ke("Trident")||Ke("MSIE"))&&!Ke("Edge"),nt=-1!=Ge.toLowerCase().indexOf("webkit")&&!Ke("Edge"),it=nt&&Ke("Mobile"),rt=Ke("Macintosh");function ot(){var e=h.document;return e?e.documentMode:void 0}e:{var st="",at=function(){var e=Ge;return tt?/rv:([^\);]+)(\)|;)/.exec(e):Ze?/Edge\/([\d\.]+)/.exec(e):Je?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):nt?/WebKit\/(\S+)/.exec(e):Qe?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(at&&(st=at?at[1]:""),Je){var lt=ot();if(null!=lt&&lt>parseFloat(st)){Xe=String(lt);break e}}Xe=st}var ut,ct={};function ht(e){return function(e,t){var n=ct;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(){for(var t=0,n=Y(String(Xe)).split("."),i=Y(String(e)).split("."),r=Math.max(n.length,i.length),o=0;0==t&&o<r;o++){var s=n[o]||"",a=i[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;t=ie(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ie(0==s[2].length,0==a[2].length)||ie(s[2],a[2]),s=s[3],a=a[3]}while(0==t)}return 0<=t}))}var dt=h.document;function ft(e,t){this.a=e===mt&&t||"",this.g=pt}ut=dt&&Je?ot()||("CSS1Compat"==dt.compatMode?parseInt(Xe,10):5):void 0,ft.prototype.ma=!0,ft.prototype.ka=function(){return this.a},ft.prototype.toString=function(){return"Const{"+this.a+"}"};var pt={},mt={};function gt(){this.a="",this.h=yt}function vt(e){return e instanceof gt&&e.constructor===gt&&e.h===yt?e.a:(O("expected object of type TrustedResourceUrl, got '"+e+"' of type "+y(e)),"type_error:TrustedResourceUrl")}gt.prototype.ma=!0,gt.prototype.ka=function(){return this.a.toString()},gt.prototype.g=function(){return 1},gt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var yt={};function bt(){this.a="",this.h=It}function wt(e){return e instanceof bt&&e.constructor===bt&&e.h===It?e.a:(O("expected object of type SafeUrl, got '"+e+"' of type "+y(e)),"type_error:SafeUrl")}bt.prototype.ma=!0,bt.prototype.ka=function(){return this.a.toString()},bt.prototype.g=function(){return 1},bt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var _t=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function St(e){return e instanceof bt?e:(e="object"==typeof e&&e.ma?e.ka():String(e),_t.test(e)||(e="about:invalid#zClosurez"),Et(e))}function Tt(e){return e instanceof bt?e:(e="object"==typeof e&&e.ma?e.ka():String(e),_t.test(e)||(e="about:invalid#zClosurez"),Et(e))}var It={};function Et(e){var t=new bt;return t.a=e,t}function At(){this.a="",this.g=kt}Et("about:blank"),At.prototype.ma=!0;var kt={};function Ct(){this.a="",this.j=Rt,this.h=null}function xt(e){return e instanceof Ct&&e.constructor===Ct&&e.j===Rt?e.a:(O("expected object of type SafeHtml, got '"+e+"' of type "+y(e)),"type_error:SafeHtml")}At.prototype.ka=function(){return this.a},At.prototype.toString=function(){return"SafeStyle{"+this.a+"}"},Ct.prototype.g=function(){return this.h},Ct.prototype.ma=!0,Ct.prototype.ka=function(){return this.a.toString()},Ct.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Rt={};function Lt(e,t){var n=new Ct;return n.a=e,n.h=t,n}Lt("<!DOCTYPE html>",0);var Mt=Lt("",0);Lt("<br>",0);var Pt,Dt,Nt=(Dt=!1,function(){return Dt||(Pt=function(){if("undefined"==typeof document)return!1;var e=document.createElement("div"),t=document.createElement("div");return t.appendChild(document.createElement("div")),e.appendChild(t),!!e.firstChild&&(t=e.firstChild.firstChild,e.innerHTML=xt(Mt),!t.parentElement)}(),Dt=!0),Pt});function Ot(e,t){t=t instanceof bt?t:Tt(t),e.assign(wt(t))}function Ft(e,t){this.a=d(e)?e:0,this.g=d(t)?t:0}function Ut(e,t){this.width=e,this.height=t}function Vt(e){return e?new Yt(qt(e)):R||(R=new Yt)}function Ht(e,t){var n=t||document;return n.querySelectorAll&&n.querySelector?n.querySelectorAll("."+e):jt(document,e,t)}function Bt(e,t){var n=t||document;if(n.getElementsByClassName)e=n.getElementsByClassName(e)[0];else{n=document;var i=t||n;e=i.querySelectorAll&&i.querySelector&&e?i.querySelector(e?"."+e:""):jt(n,e,t)[0]||null}return e||null}function jt(e,t,n){var i;if((e=n||e).querySelectorAll&&e.querySelector&&t)return e.querySelectorAll(t?"."+t:"");if(t&&e.getElementsByClassName){var r=e.getElementsByClassName(t);return r}if(r=e.getElementsByTagName("*"),t){var o={};for(n=i=0;e=r[n];n++){var s=e.className;"function"==typeof s.split&&j(s.split(/\s+/),t)&&(o[i++]=e)}return o.length=i,o}return r}Ft.prototype.toString=function(){return"("+this.a+", "+this.g+")"},Ft.prototype.ceil=function(){return this.a=Math.ceil(this.a),this.g=Math.ceil(this.g),this},Ft.prototype.floor=function(){return this.a=Math.floor(this.a),this.g=Math.floor(this.g),this},Ft.prototype.round=function(){return this.a=Math.round(this.a),this.g=Math.round(this.g),this},(e=Ut.prototype).toString=function(){return"("+this.width+" x "+this.height+")"},e.aspectRatio=function(){return this.width/this.height},e.ceil=function(){return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},e.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},e.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this};var Gt={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Wt(e){return e.scrollingElement?e.scrollingElement:(nt||"CSS1Compat"!=e.compatMode)&&e.body||e.documentElement}function zt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function qt(e){return 9==e.nodeType?e:e.ownerDocument||e.document}function Kt(e,t){if("textContent"in e)e.textContent=t;else if(3==e.nodeType)e.data=String(t);else if(e.firstChild&&3==e.firstChild.nodeType){for(;e.lastChild!=e.firstChild;)e.removeChild(e.lastChild);e.firstChild.data=String(t)}else{for(var n;n=e.firstChild;)e.removeChild(n);e.appendChild(qt(e).createTextNode(String(t)))}}function $t(e,t){return t?function(e,t){for(;e;){if(t(e))return e;e=e.parentNode}return null}(e,(function(e){return!t||f(e.className)&&j(e.className.split(/\s+/),t)})):null}function Yt(e){this.a=e||h.document||document}Yt.prototype.N=function(){return f(void 0)?this.a.getElementById(void 0):void 0};var Xt={Fc:!0},Qt={Hc:!0},Jt={Ec:!0},Zt={Gc:!0};function en(){throw Error("Do not instantiate directly")}function tn(e,t,n,i){if(e=e(t||rn,void 0,n),i=(i||Vt()).a.createElement("DIV"),(e=function(e){if(!S(e))return re(String(e));if(e instanceof en){if(e.fa===Xt)return e.content;if(e.fa===Zt)return re(e.content)}return O("Soy template output is unsafe for use as HTML: "+e),"zSoyz"}(e)).match(nn),e=Lt(e,null),Nt())for(;i.lastChild;)i.removeChild(i.lastChild);return i.innerHTML=xt(e),1==i.childNodes.length&&(1==(e=i.firstChild).nodeType&&(i=e)),i}en.prototype.va=null,en.prototype.toString=function(){return this.content};var nn=/^<(body|caption|col|colgroup|head|html|tr|td|th|tbody|thead|tfoot)>/i,rn={};function on(){en.call(this)}function sn(e){return null!=e&&e.fa===Xt?e:e instanceof Ct?cn(xt(e).toString(),e.g()):cn(re(String(String(e))),function(e){if(null!=e)switch(e.va){case 1:return 1;case-1:return-1;case 0:return 0}return null}(e))}function an(){en.call(this)}function ln(e,t){this.content=String(e),this.va=null!=t?t:null}function un(e){return new ln(e,void 0)}P(on,en),on.prototype.fa=Xt,P(an,en),an.prototype.fa=Qt,an.prototype.va=1,P(ln,en),ln.prototype.fa=Zt;var cn=function(e){function t(e){this.content=e}return t.prototype=e.prototype,function(e,n){return e=new t(String(e)),void 0!==n&&(e.va=n),e}}(on),hn=function(e){function t(e){this.content=e}return t.prototype=e.prototype,function(e){return new t(String(e))}}(an);function dn(e){return(e=String(e))?new ln(e,void 0):""}var fn=function(e){function t(e){this.content=e}return t.prototype=e.prototype,function(e,n){return(e=String(e))?(e=new t(e),void 0!==n&&(e.va=n),e):""}}(on);function pn(e){return null!=e&&e.fa===Xt?String(String(e.content).replace(En,"").replace(An,"&lt;")).replace(_n,yn):re(String(e))}function mn(e){return null!=e&&e.fa===Qt?e=String(e).replace(Sn,wn):e instanceof bt?e=String(wt(e).toString()).replace(Sn,wn):(e=String(e),In.test(e)?e=e.replace(Sn,wn):(O("Bad value `%s` for |filterNormalizeUri",[e]),e="#zSoyz")),e}function gn(e){return null!=e&&e.fa===Jt?e=e.content:null==e?e="":e instanceof At?e instanceof At&&e.constructor===At&&e.g===kt?e=e.a:(O("expected object of type SafeStyle, got '"+e+"' of type "+y(e)),e="type_error:SafeStyle"):(e=String(e),Tn.test(e)||(O("Bad value `%s` for |filterCssValue",[e]),e="zSoyz")),e}var vn={"\0":"&#0;","\t":"&#9;","\n":"&#10;","\v":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;",'"':"&quot;","&":"&amp;","'":"&#39;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","`":"&#96;","":"&#133;"," ":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};function yn(e){return vn[e]}var bn={"\0":"%00","":"%01","":"%02","":"%03","":"%04","":"%05","":"%06","":"%07","\b":"%08","\t":"%09","\n":"%0A","\v":"%0B","\f":"%0C","\r":"%0D","":"%0E","":"%0F","":"%10","":"%11","":"%12","":"%13","":"%14","":"%15","":"%16","":"%17","":"%18","":"%19","":"%1A","":"%1B","":"%1C","":"%1D","":"%1E","":"%1F"," ":"%20",'"':"%22","'":"%27","(":"%28",")":"%29","<":"%3C",">":"%3E","\\":"%5C","{":"%7B","}":"%7D","":"%7F","":"%C2%85"," ":"%C2%A0","\u2028":"%E2%80%A8","\u2029":"%E2%80%A9","！":"%EF%BC%81","＃":"%EF%BC%83","＄":"%EF%BC%84","＆":"%EF%BC%86","＇":"%EF%BC%87","（":"%EF%BC%88","）":"%EF%BC%89","＊":"%EF%BC%8A","＋":"%EF%BC%8B","，":"%EF%BC%8C","／":"%EF%BC%8F","：":"%EF%BC%9A","；":"%EF%BC%9B","＝":"%EF%BC%9D","？":"%EF%BC%9F","＠":"%EF%BC%A0","［":"%EF%BC%BB","］":"%EF%BC%BD"};function wn(e){return bn[e]}var _n=/[\x00\x22\x27\x3c\x3e]/g,Sn=/[\x00- \x22\x27-\x29\x3c\x3e\\\x7b\x7d\x7f\x85\xa0\u2028\u2029\uff01\uff03\uff04\uff06-\uff0c\uff0f\uff1a\uff1b\uff1d\uff1f\uff20\uff3b\uff3d]/g,Tn=/^(?!-*(?:expression|(?:moz-)?binding))(?:[.#]?-?(?:[_a-z0-9-]+)(?:-[_a-z0-9-]+)*-?|-?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[a-z]{1,2}|%)?|!important|)$/i,In=/^(?![^#?]*\/(?:\.|%2E){2}(?:[\/?#]|$))(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i,En=/<(?:!|\/?([a-zA-Z][a-zA-Z0-9:\-]*))(?:[^>'"]|"[^"]*"|'[^']*')*>/g,An=/</g;function kn(){return un("Enter a valid phone number")}function Cn(){return un("Unable to send password reset code to specified email")}function xn(){return un("Something went wrong. Please try again.")}function Rn(){return un("This email already exists without any means of sign-in. Please reset the password to recover.")}function Ln(e){var t="";switch((e=e||{}).code){case"invalid-argument":t+="Client specified an invalid argument.";break;case"invalid-configuration":t+="Client specified an invalid project configuration.";break;case"failed-precondition":t+="Request can not be executed in the current system state.";break;case"out-of-range":t+="Client specified an invalid range.";break;case"unauthenticated":t+="Request not authenticated due to missing, invalid, or expired OAuth token.";break;case"permission-denied":t+="Client does not have sufficient permission.";break;case"not-found":t+="Specified resource is not found.";break;case"aborted":t+="Concurrency conflict, such as read-modify-write conflict.";break;case"already-exists":t+="The resource that a client tried to create already exists.";break;case"resource-exhausted":t+="Either out of resource quota or reaching rate limiting.";break;case"cancelled":t+="Request cancelled by the client.";break;case"data-loss":t+="Unrecoverable data loss or data corruption.";break;case"unknown":t+="Unknown server error.";break;case"internal":t+="Internal server error.";break;case"not-implemented":t+="API method not implemented by the server.";break;case"unavailable":t+="Service unavailable.";break;case"deadline-exceeded":t+="Request deadline exceeded.";break;case"auth/user-disabled":t+="The user account has been disabled by an administrator.";break;case"auth/timeout":t+="The operation has timed out.";break;case"auth/too-many-requests":t+="We have blocked all requests from this device due to unusual activity. Try again later.";break;case"auth/quota-exceeded":t+="The quota for this operation has been exceeded. Try again later.";break;case"auth/network-request-failed":t+="A network error has occurred. Try again later.";break;case"restart-process":t+="An issue was encountered when authenticating your request. Please visit the URL that redirected you to this page again to restart the authentication process.";break;case"no-matching-tenant-for-email":t+="No sign-in provider is available for the given email, please try with a different email."}return un(t)}function Mn(){return un("Please login again to perform this operation")}function Pn(e,t,n){var i=Error.call(this);if(this.message=i.message,"stack"in i&&(this.stack=i.stack),this.code=Dn+e,!(e=t)){if(e="","firebaseui/merge-conflict"===this.code)e+="The current anonymous user failed to upgrade. The non-anonymous credential is already associated with a different user account.";else e+=xn();e=un(e).toString()}this.message=e||"",this.credential=n||null}a(Pn,Error),Pn.prototype.toJSON=function(){return{code:this.code,message:this.message}};var Dn="firebaseui/";function Nn(){0!=On&&(Fn[this[T]||(this[T]=++I)]=this),this.T=this.T,this.C=this.C}var On=0,Fn={};function Un(e,t){e.T?d(void 0)?t.call(void 0):t():(e.C||(e.C=[]),e.C.push(d(void 0)?k(t,void 0):t))}function Vn(e){e&&"function"==typeof e.m&&e.m()}Nn.prototype.T=!1,Nn.prototype.m=function(){if(!this.T&&(this.T=!0,this.o(),0!=On)){var e=this[T]||(this[T]=++I);if(0!=On&&this.C&&0<this.C.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Fn[e]}},Nn.prototype.o=function(){if(this.C)for(;this.C.length;)this.C.shift()()};var Hn=Object.freeze||function(e){return e},Bn=!Je||9<=Number(ut),jn=Je&&!ht("9"),Gn=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{h.addEventListener("test",g,t),h.removeEventListener("test",g,t)}catch(e){}return e}();function Wn(e,t){this.type=e,this.g=this.target=t,this.h=!1,this.qb=!0}function zn(e,t){if(Wn.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.j=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(tt){e:{try{Ye(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.keyCode=e.keyCode||0,this.key=e.key||"",this.j=e.charCode||("keypress"==n?e.keyCode:0),this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=f(e.pointerType)?e.pointerType:qn[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}Wn.prototype.stopPropagation=function(){this.h=!0},Wn.prototype.preventDefault=function(){this.qb=!1},P(zn,Wn);var qn=Hn({2:"touch",3:"pen",4:"mouse"});zn.prototype.stopPropagation=function(){zn.K.stopPropagation.call(this),this.a.stopPropagation?this.a.stopPropagation():this.a.cancelBubble=!0},zn.prototype.preventDefault=function(){zn.K.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,jn)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}};var Kn="closure_listenable_"+(1e6*Math.random()|0),$n=0;function Yn(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.La=r,this.key=++$n,this.sa=this.Ia=!1}function Xn(e){e.sa=!0,e.listener=null,e.proxy=null,e.src=null,e.La=null}function Qn(e){this.src=e,this.a={},this.g=0}function Jn(e,t){var n=t.type;n in e.a&&G(e.a[n],t)&&(Xn(t),0==e.a[n].length&&(delete e.a[n],e.g--))}function Zn(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r];if(!o.sa&&o.listener==t&&o.capture==!!n&&o.La==i)return r}return-1}Qn.prototype.add=function(e,t,n,i,r){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.g++);var s=Zn(e,t,i,r);return-1<s?(t=e[s],n||(t.Ia=!1)):((t=new Yn(t,this.src,o,!!i,r)).Ia=n,e.push(t)),t};var ei="closure_lm_"+(1e6*Math.random()|0),ti={};function ni(e,t,n,i,r){if(i&&i.once)return ri(e,t,n,i,r);if(b(t)){for(var o=0;o<t.length;o++)ni(e,t[o],n,i,r);return null}return n=fi(n),e&&e[Kn]?e.J.add(String(t),n,!1,S(i)?!!i.capture:!!i,r):ii(e,t,n,!1,i,r)}function ii(e,t,n,i,r,o){if(!t)throw Error("Invalid event type");var s=S(r)?!!r.capture:!!r,a=hi(e);if(a||(e[ei]=a=new Qn(e)),(n=a.add(t,n,i,s,o)).proxy)return n;if(i=function(){var e=ci,t=Bn?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)Gn||(r=s),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(ai(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function ri(e,t,n,i,r){if(b(t)){for(var o=0;o<t.length;o++)ri(e,t[o],n,i,r);return null}return n=fi(n),e&&e[Kn]?e.J.add(String(t),n,!0,S(i)?!!i.capture:!!i,r):ii(e,t,n,!0,i,r)}function oi(e,t,n,i,r){if(b(t))for(var o=0;o<t.length;o++)oi(e,t[o],n,i,r);else i=S(i)?!!i.capture:!!i,n=fi(n),e&&e[Kn]?(e=e.J,(t=String(t).toString())in e.a&&(-1<(n=Zn(o=e.a[t],n,i,r))&&(Xn(o[n]),W(o,n),0==o.length&&(delete e.a[t],e.g--)))):e&&(e=hi(e))&&(t=e.a[t.toString()],e=-1,t&&(e=Zn(t,n,i,r)),(n=-1<e?t[e]:null)&&si(n))}function si(e){if("number"!=typeof e&&e&&!e.sa){var t=e.src;if(t&&t[Kn])Jn(t.J,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(ai(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=hi(t))?(Jn(n,e),0==n.g&&(n.src=null,t[ei]=null)):Xn(e)}}}function ai(e){return e in ti?ti[e]:ti[e]="on"+e}function li(e,t,n,i){var r=!0;if((e=hi(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.sa&&(o=ui(o,i),r=r&&!1!==o)}return r}function ui(e,t){var n=e.listener,i=e.La||e.src;return e.Ia&&si(e),n.call(i,t)}function ci(e,t){if(e.sa)return!0;if(!Bn){if(!t)e:{t=["window","event"];for(var n=h,i=0;i<t.length;i++)if(null==(n=n[t[i]])){t=null;break e}t=n}if(t=new zn(i=t,this),n=!0,!(0>i.keyCode||null!=i.returnValue)){e:{var r=!1;if(0==i.keyCode)try{i.keyCode=-1;break e}catch(e){r=!0}(r||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],r=t.g;r;r=r.parentNode)i.push(r);for(e=e.type,r=i.length-1;!t.h&&0<=r;r--){t.g=i[r];var o=li(i[r],e,!0,t);n=n&&o}for(r=0;!t.h&&r<i.length;r++)t.g=i[r],o=li(i[r],e,!1,t),n=n&&o}return n}return ui(e,new zn(t,this))}function hi(e){return(e=e[ei])instanceof Qn?e:null}var di="__closure_events_fn_"+(1e9*Math.random()>>>0);function fi(e){return _(e)?e:(e[di]||(e[di]=function(t){return e.handleEvent(t)}),e[di])}function pi(){Nn.call(this),this.J=new Qn(this),this.wb=this,this.Ha=null}function mi(e,t){var n,i=e.Ha;if(i)for(n=[];i;i=i.Ha)n.push(i);if(e=e.wb,i=t.type||t,f(t))t=new Wn(t,e);else if(t instanceof Wn)t.target=t.target||e;else{var r=t;le(t=new Wn(i,e),r)}if(r=!0,n)for(var o=n.length-1;!t.h&&0<=o;o--){var s=t.g=n[o];r=gi(s,i,!0,t)&&r}if(t.h||(r=gi(s=t.g=e,i,!0,t)&&r,t.h||(r=gi(s,i,!1,t)&&r)),n)for(o=0;!t.h&&o<n.length;o++)r=gi(s=t.g=n[o],i,!1,t)&&r;return r}function gi(e,t,n,i){if(!(t=e.J.a[String(t)]))return!0;t=t.concat();for(var r=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.sa&&s.capture==n){var a=s.listener,l=s.La||s.src;s.Ia&&Jn(e.J,s),r=!1!==a.call(l,i)&&r}}return r&&0!=i.qb}P(pi,Nn),pi.prototype[Kn]=!0,pi.prototype.Za=function(e){this.Ha=e},pi.prototype.removeEventListener=function(e,t,n,i){oi(this,e,t,n,i)},pi.prototype.o=function(){if(pi.K.o.call(this),this.J){var e,t=this.J;for(e in t.a){for(var n=t.a[e],i=0;i<n.length;i++)Xn(n[i]);delete t.a[e],t.g--}}this.Ha=null};var vi={},yi=0;function bi(e,t){if(!e)throw Error("Event target element must be provided!");if(e=_i(e),vi[e]&&vi[e].length)for(var n=0;n<vi[e].length;n++)mi(vi[e][n],t)}function wi(e){var t=_i(e.N());vi[t]&&vi[t].length&&(function(e,t){e:{for(var n=e.length,i=f(e)?e.split(""):e,r=0;r<n;r++)if(r in i&&t.call(void 0,i[r],r,e)){t=r;break e}t=-1}0<=t&&W(e,t)}(vi[t],(function(t){return t==e})),vi[t].length||delete vi[t])}function _i(e){return void 0===e.a&&(e.a=yi,yi++),e.a}function Si(e){if(!e)throw Error("Event target element must be provided!");pi.call(this),this.a=e}function Ti(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(e){return!1}}function Ii(e,t){this.h=e,this.j=t,this.g=0,this.a=null}function Ei(e,t){e.j(t),100>e.g&&(e.g++,t.next=e.a,e.a=t)}function Ai(){this.g=this.a=null}a(Si,pi),Si.prototype.N=function(){return this.a},Si.prototype.register=function(){var e=_i(this.N());vi[e]?j(vi[e],this)||vi[e].push(this):vi[e]=[this]},Ii.prototype.get=function(){if(0<this.g){this.g--;var e=this.a;this.a=e.next,e.next=null}else e=this.h();return e};var ki,Ci,xi=new Ii((function(){return new Li}),(function(e){e.reset()}));function Ri(){var e=Ni,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.g=null),t.next=null),t}function Li(){this.next=this.g=this.a=null}function Mi(e){h.setTimeout((function(){throw e}),0)}function Pi(e,t){Ci||function(){if(h.Promise&&h.Promise.resolve){var e=h.Promise.resolve(void 0);Ci=function(){e.then(Oi)}}else Ci=function(){var e=Oi;!_(h.setImmediate)||h.Window&&h.Window.prototype&&!Ke("Edge")&&h.Window.prototype.setImmediate==h.setImmediate?(ki||(ki=function(){var e=h.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!Ke("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(""),e.close();var n="callImmediate"+Math.random(),i="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=k((function(e){"*"!=i&&e.origin!=i||e.data!=n||this.port1.onmessage()}),this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,i)}}}),void 0!==e&&!Ke("Trident")&&!Ke("MSIE")){var t=new e,n={},i=n;return t.port1.onmessage=function(){if(d(n.next)){var e=(n=n.next).gb;n.gb=null,e()}},function(e){i.next={gb:e},i=i.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){h.setTimeout(e,0)}}()),ki(e)):h.setImmediate(e)}}(),Di||(Ci(),Di=!0),Ni.add(e,t)}Ai.prototype.add=function(e,t){var n=xi.get();n.set(e,t),this.g?this.g.next=n:this.a=n,this.g=n},Li.prototype.set=function(e,t){this.a=e,this.g=t,this.next=null},Li.prototype.reset=function(){this.next=this.g=this.a=null};var Di=!1,Ni=new Ai;function Oi(){for(var e;e=Ri();){try{e.a.call(e.g)}catch(e){Mi(e)}Ei(xi,e)}Di=!1}function Fi(e){if(this.a=Ui,this.A=void 0,this.j=this.g=this.h=null,this.s=this.i=!1,e!=g)try{var t=this;e.call(void 0,(function(e){Yi(t,Vi,e)}),(function(e){if(!(e instanceof tr))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}Yi(t,Hi,e)}))}catch(e){Yi(this,Hi,e)}}var Ui=0,Vi=2,Hi=3;function Bi(){this.next=this.j=this.g=this.s=this.a=null,this.h=!1}Bi.prototype.reset=function(){this.j=this.g=this.s=this.a=null,this.h=!1};var ji=new Ii((function(){return new Bi}),(function(e){e.reset()}));function Gi(e,t,n){var i=ji.get();return i.s=e,i.g=t,i.j=n,i}function Wi(e){if(e instanceof Fi)return e;var t=new Fi(g);return Yi(t,Vi,e),t}function zi(e){return new Fi((function(t,n){n(e)}))}function qi(e,t){if(e.a==Ui)if(e.h){var n=e.h;if(n.g){for(var i=0,r=null,o=null,s=n.g;s&&(s.h||(i++,s.a==e&&(r=s),!(r&&1<i)));s=s.next)r||(o=s);r&&(n.a==Ui&&1==i?qi(n,t):(o?((i=o).next==n.j&&(n.j=i),i.next=i.next.next):Qi(n),Ji(n,r,Hi,t)))}e.h=null}else Yi(e,Hi,t)}function Ki(e,t){e.g||e.a!=Vi&&e.a!=Hi||Xi(e),e.j?e.j.next=t:e.g=t,e.j=t}function $i(e,t,n,i){var r=Gi(null,null,null);return r.a=new Fi((function(e,o){r.s=t?function(n){try{var r=t.call(i,n);e(r)}catch(e){o(e)}}:e,r.g=n?function(t){try{var r=n.call(i,t);!d(r)&&t instanceof tr?o(t):e(r)}catch(e){o(e)}}:o})),r.a.h=e,Ki(e,r),r.a}function Yi(e,t,n){if(e.a==Ui){e===n&&(t=Hi,n=new TypeError("Promise cannot resolve to itself")),e.a=1;e:{var i=n,r=e.hc,o=e.ic;if(i instanceof Fi){Ki(i,Gi(r||g,o||null,e));var s=!0}else if(Ti(i))i.then(r,o,e),s=!0;else{if(S(i))try{var a=i.then;if(_(a)){!function(e,t,n,i,r){function o(e){a||(a=!0,i.call(r,e))}function s(e){a||(a=!0,n.call(r,e))}var a=!1;try{t.call(e,s,o)}catch(e){o(e)}}(i,a,r,o,e),s=!0;break e}}catch(t){o.call(e,t),s=!0;break e}s=!1}}s||(e.A=n,e.a=t,e.h=null,Xi(e),t!=Hi||n instanceof tr||function(e,t){e.s=!0,Pi((function(){e.s&&er.call(null,t)}))}(e,n))}}function Xi(e){e.i||(e.i=!0,Pi(e.Hb,e))}function Qi(e){var t=null;return e.g&&(t=e.g,e.g=t.next,t.next=null),e.g||(e.j=null),t}function Ji(e,t,n,i){if(n==Hi&&t.g&&!t.h)for(;e&&e.s;e=e.h)e.s=!1;if(t.a)t.a.h=null,Zi(t,n,i);else try{t.h?t.s.call(t.j):Zi(t,n,i)}catch(e){er.call(null,e)}Ei(ji,t)}function Zi(e,t,n){t==Vi?e.s.call(e.j,n):e.g&&e.g.call(e.j,n)}Fi.prototype.then=function(e,t,n){return $i(this,_(e)?e:null,_(t)?t:null,n)},Fi.prototype.$goog_Thenable=!0,(e=Fi.prototype).fc=function(e,t){return(e=Gi(e,e,t)).h=!0,Ki(this,e),this},e.Ca=function(e,t){return $i(this,null,e,t)},e.cancel=function(e){this.a==Ui&&Pi((function(){qi(this,new tr(e))}),this)},e.hc=function(e){this.a=Ui,Yi(this,Vi,e)},e.ic=function(e){this.a=Ui,Yi(this,Hi,e)},e.Hb=function(){for(var e;e=Qi(this);)Ji(this,e,this.a,this.A);this.i=!1};var er=Mi;function tr(e){D.call(this,e)}function nr(e,t,n){t||(t={}),n=n||window;var i=e instanceof bt?e:St(void 0!==e.href?e.href:String(e));e=t.target||e.target;var r=[];for(o in t)switch(o){case"width":case"height":case"top":case"left":r.push(o+"="+t[o]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(o+"="+(t[o]?1:0))}var o=r.join(",");return(Ke("iPhone")&&!Ke("iPod")&&!Ke("iPad")||Ke("iPad")||Ke("iPod"))&&n.navigator&&n.navigator.standalone&&e&&"_self"!=e?(o=n.document.createElement("A"),i=i instanceof bt?i:Tt(i),o.href=wt(i),o.setAttribute("target",e),t.noreferrer&&o.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,n,1),o.dispatchEvent(t),n={}):t.noreferrer?(n=n.open("",e,o),t=wt(i).toString(),n&&(et&&-1!=t.indexOf(";")&&(t="'"+t.replace(/'/g,"%27")+"'"),n.opener=null,t=Lt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+re(t)+'">',null),n.document.write(xt(t)),n.document.close())):(n=n.open(wt(i).toString(),e,o))&&t.noopener&&(n.opener=null),n}function ir(){try{return!(!window.opener||!window.opener.location||window.opener.location.hostname!==window.location.hostname||window.opener.location.protocol!==window.location.protocol)}catch(e){}return!1}function rr(e){nr(e,{target:window.cordova&&window.cordova.InAppBrowser?"_system":"_blank"},void 0)}function or(e,t){if(null==(e=S(e)&&1==e.nodeType?e:document.querySelector(String(e))))throw Error(t||"Cannot find element.");return e}function sr(){return window.location.href}function ar(e){var t=yr;this.s=[],this.T=t,this.O=e||null,this.j=this.a=!1,this.h=void 0,this.J=this.l=this.A=!1,this.i=0,this.g=null,this.C=0}function lr(e,t,n){e.a=!0,e.h=n,e.j=!t,dr(e)}function ur(e){if(e.a){if(!e.J)throw new fr(e);e.J=!1}}function cr(e,t,n){e.s.push([t,n,void 0]),e.a&&dr(e)}function hr(e){return B(e.s,(function(e){return _(e[1])}))}function dr(e){if(e.i&&e.a&&hr(e)){var t=e.i,n=gr[t];n&&(h.clearTimeout(n.a),delete gr[t]),e.i=0}e.g&&(e.g.C--,delete e.g),t=e.h;for(var i=n=!1;e.s.length&&!e.A;){var r=e.s.shift(),o=r[0],s=r[1];if(r=r[2],o=e.j?s:o)try{var a=o.call(r||e.O,t);d(a)&&(e.j=e.j&&(a==t||a instanceof Error),e.h=t=a),(Ti(t)||"function"==typeof h.Promise&&t instanceof h.Promise)&&(i=!0,e.A=!0)}catch(i){t=i,e.j=!0,hr(e)||(n=!0)}}e.h=t,i&&(a=k(e.L,e,!0),i=k(e.L,e,!1),t instanceof ar?(cr(t,a,i),t.l=!0):t.then(a,i)),n&&(t=new mr(t),gr[t.a]=t,e.i=t.a)}function fr(){D.call(this)}function pr(){D.call(this)}function mr(e){this.a=h.setTimeout(k(this.h,this),0),this.g=e}P(tr,D),tr.prototype.name="cancel",ar.prototype.cancel=function(e){if(this.a)this.h instanceof ar&&this.h.cancel();else{if(this.g){var t=this.g;delete this.g,e?t.cancel(e):(t.C--,0>=t.C&&t.cancel())}this.T?this.T.call(this.O,this):this.J=!0,this.a||(e=new pr(this),ur(this),lr(this,!1,e))}},ar.prototype.L=function(e,t){this.A=!1,lr(this,e,t)},ar.prototype.callback=function(e){ur(this),lr(this,!0,e)},ar.prototype.then=function(e,t,n){var i,r,o=new Fi((function(e,t){i=e,r=t}));return cr(this,i,(function(e){e instanceof pr?o.cancel():r(e)})),o.then(e,t,n)},ar.prototype.$goog_Thenable=!0,P(fr,D),fr.prototype.message="Deferred has already fired",fr.prototype.name="AlreadyCalledError",P(pr,D),pr.prototype.message="Deferred was canceled",pr.prototype.name="CanceledError",mr.prototype.h=function(){throw delete gr[this.a],this.g};var gr={};function vr(e){var t={},n=t.document||document,i=vt(e).toString(),r=document.createElement("SCRIPT"),o={rb:r,sb:void 0},s=new ar(o),a=null,l=null!=t.timeout?t.timeout:5e3;return 0<l&&(a=window.setTimeout((function(){br(r,!0);var e=new Sr(_r,"Timeout reached for loading script "+i);ur(s),lr(s,!1,e)}),l),o.sb=a),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(br(r,t.xc||!1,a),s.callback(null))},r.onerror=function(){br(r,!0,a);var e=new Sr(wr,"Error while loading script "+i);ur(s),lr(s,!1,e)},le(o=t.attributes||{},{type:"text/javascript",charset:"UTF-8"}),function(e,t){oe(t,(function(t,n){t&&"object"==typeof t&&t.ma&&(t=t.ka()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:Gt.hasOwnProperty(n)?e.setAttribute(Gt[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t}))}(r,o),function(e,t){e.src=vt(t),null===m&&(m=(t=(t=h.document).querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&p.test(t)?t:""),(t=m)&&e.setAttribute("nonce",t)}(r,e),function(e){var t=(e||document).getElementsByTagName("HEAD");return t&&0!=t.length?t[0]:e.documentElement}(n).appendChild(r),s}function yr(){if(this&&this.rb){var e=this.rb;e&&"SCRIPT"==e.tagName&&br(e,!0,this.sb)}}function br(e,t,n){null!=n&&h.clearTimeout(n),e.onload=g,e.onerror=g,e.onreadystatechange=g,t&&window.setTimeout((function(){zt(e)}),0)}var wr=0,_r=1;function Sr(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),D.call(this,n),this.code=e}function Tr(){return h.google&&h.google.accounts&&h.google.accounts.id||null}function Ir(e){this.a=e||Tr(),this.h=!1,this.g=null}function Er(e,t,n){return e.a&&t?(e.h=!0,new Fi((function(i){e.g=i,e.a.initialize({client_id:t,callback:i,auto_select:!n}),e.a.prompt()}))):Wi(t?kr.Xa().load().then((function(){return e.a=Tr(),Er(e,t,n)})).Ca((function(){return null})):null)}P(Sr,D),Ir.prototype.cancel=function(){this.a&&this.h&&(this.g&&this.g(null),this.a.cancel())},v(Ir);var Ar=new ft(mt,"https://accounts.google.com/gsi/client");function kr(){this.a=null}function Cr(e,t){this.a=e,this.g=t||function(e){throw e}}function xr(e,t,n){this.reset(e,t,n,void 0,void 0)}kr.prototype.load=function(){var e=this;if(this.a)return this.a;var t=function(){var e=Ar;e instanceof ft&&e.constructor===ft&&e.g===pt?e=e.a:(O("expected object of type Const, got '"+e+"'"),e="type_error:Const");var t=new gt;return t.a=e,t}();return Tr()?Wi():this.a=function(){var e=null;return new Fi((function(t){"complete"==h.document.readyState?t():(e=function(){t()},ri(window,"load",e))})).Ca((function(t){throw oi(window,"load",e),t}))}().then((function(){if(!Tr())return new Fi((function(n,i){var r=setTimeout((function(){e.a=null,i(Error("Network error!"))}),1e4);h.onGoogleLibraryLoad=function(){clearTimeout(r),n()},Wi(vr(t)).then((function(){Tr()&&n()})).Ca((function(t){clearTimeout(r),e.a=null,i(t)}))}))}))},v(kr),Cr.prototype.confirm=function(e){return Wi(this.a.confirm(e)).Ca(this.g)},xr.prototype.a=null;function Rr(e){this.s=e,this.a=this.h=this.j=this.g=null}function Lr(e,t){this.name=e,this.value=t}xr.prototype.reset=function(e,t,n,i,r){"number"==typeof r||0,this.h=i||L(),this.j=e,this.s=t,this.g=n,delete this.a},Lr.prototype.toString=function(){return this.name};var Mr=new Lr("SEVERE",1e3),Pr=new Lr("WARNING",900),Dr=new Lr("CONFIG",700);function Nr(e){return e.j?e.j:e.g?Nr(e.g):(O("Root logger has no level set."),null)}Rr.prototype.log=function(e,t,n){if(e.value>=Nr(this).value)for(_(t)&&(t=t()),e=new xr(e,String(t),this.s),n&&(e.a=n),n=this;n;){var i=n,r=e;if(i.a)for(var o=0;t=i.a[o];o++)t(r);n=n.g}};var Or={},Fr=null;function Ur(){Fr||(Fr=new Rr(""),Or[""]=Fr,Fr.j=Dr)}function Vr(){this.a=L()}var Hr=null;function Br(e){this.j=e||"",Hr||(Hr=new Vr),this.s=Hr}function jr(e){return 10>e?"0"+e:String(e)}function Gr(e){Br.call(this,e)}function Wr(){this.s=k(this.h,this),this.a=new Gr,this.a.g=!1,this.a.h=!1,this.g=this.a.a=!1,this.j={}}Vr.prototype.set=function(e){this.a=e},Vr.prototype.reset=function(){this.set(L())},Vr.prototype.get=function(){return this.a},Br.prototype.a=!0,Br.prototype.g=!0,Br.prototype.h=!1,P(Gr,Br),Wr.prototype.h=function(e){if(!this.j[e.g]){var t=function(e,t){var n=[];if(n.push(e.j," "),e.g){var i=new Date(t.h);n.push("[",jr(i.getFullYear()-2e3)+jr(i.getMonth()+1)+jr(i.getDate())+" "+jr(i.getHours())+":"+jr(i.getMinutes())+":"+jr(i.getSeconds())+"."+jr(Math.floor(i.getMilliseconds()/10)),"] ")}return n.push("[",function(e,t){t=(e=(e.h-t)/1e3).toFixed(3);var n=0;if(1>e)n=2;else for(;100>e;)n++,e*=10;for(;0<n--;)t=" "+t;return t}(t,e.s.get()),"s] "),n.push("[",t.g,"] "),n.push(t.s),e.h&&(t=t.a)&&n.push("\n",t instanceof Error?t.message:t.toString()),e.a&&n.push("\n"),n.join("")}(this.a,e);if(qr)!function(e,t,n,i){e[t]?e[t](n,i||""):e.log(n,i||"")}(qr,function(e){if(e){if(e.value>=Mr.value)return"error";if(e.value>=Pr.value)return"warn";if(e.value>=Dr.value)return"log"}return"debug"}(e.j),t,e.a)}};var zr,qr=h.console;function Kr(e,t){zr&&zr.log(Mr,e,t)}zr=function e(t){var n;if(Ur(),!(n=Or[t])){n=new Rr(t);var i=t.lastIndexOf("."),r=t.substr(i+1);(i=e(t.substr(0,i))).h||(i.h={}),i.h[r]=n,n.g=i,Or[t]=n}return n}("firebaseui");var $r=new Wr;if(1!=$r.g){var Yr;Ur(),Yr=Fr;var Xr=$r.s;Yr.a||(Yr.a=[]),Yr.a.push(Xr),$r.g=!0}function Qr(e){zr&&zr.log(Pr,e,void 0)}function Jr(){this.a=("undefined"==typeof document?null:document)||{cookie:""}}function Zr(e){e=(e.a.cookie||"").split(";");for(var t,n,i=[],r=[],o=0;o<e.length;o++)-1==(t=(n=Y(e[o])).indexOf("="))?(i.push(""),r.push(n)):(i.push(n.substring(0,t)),r.push(n.substring(t+1)));return{keys:i,values:r}}(e=Jr.prototype).set=function(e,t,n,i,r,o){if(/[;=\s]/.test(e))throw Error('Invalid cookie name "'+e+'"');if(/[;\r\n]/.test(t))throw Error('Invalid cookie value "'+t+'"');d(n)||(n=-1),r=r?";domain="+r:"",i=i?";path="+i:"",o=o?";secure":"",n=0>n?"":0==n?";expires="+new Date(1970,1,1).toUTCString():";expires="+new Date(L()+1e3*n).toUTCString(),this.a.cookie=e+"="+t+r+i+n+o},e.get=function(e,t){for(var n,i=e+"=",r=(this.a.cookie||"").split(";"),o=0;o<r.length;o++){if(0==(n=Y(r[o])).lastIndexOf(i,0))return n.substr(i.length);if(n==e)return""}return t},e.ja=function(){return Zr(this).keys},e.la=function(){return Zr(this).values},e.clear=function(){for(var e=Zr(this).keys,t=e.length-1;0<=t;t--){var n=e[t];this.get(n),this.set(n,"",0,void 0,void 0)}};var eo=new Jr;function to(){}function no(e,t,n,i){this.h=null!=e?e:-1,this.g=t||null,this.a=n||null,this.j=!!i}function io(e,t){this.g=e,this.a=t||null}function ro(e){return{email:e.g,credential:e.a&&e.a.toJSON()}}function oo(e){if(e&&e.email){var t=e.credential&&D_.auth.AuthCredential.fromJSON(e.credential);return new io(e.email,t)}return null}function so(e){this.a=e||null}function ao(e){for(var t=[],n=0,i=0;i<e.length;i++){var r=e.charCodeAt(i);255<r&&(t[n++]=255&r,r>>=8),t[n++]=r}return t}function lo(e){return H(e,(function(e){return 1<(e=e.toString(16)).length?e:"0"+e})).join("")}function uo(e){for(this.i=e,this.g=this.i.length/4,this.j=this.g+6,this.h=[[],[],[],[]],this.s=[[],[],[],[]],this.a=Array(co*(this.j+1)),e=0;e<this.g;e++)this.a[e]=[this.i[4*e],this.i[4*e+1],this.i[4*e+2],this.i[4*e+3]];var t=Array(4);for(e=this.g;e<co*(this.j+1);e++){if(t[0]=this.a[e-1][0],t[1]=this.a[e-1][1],t[2]=this.a[e-1][2],t[3]=this.a[e-1][3],0==e%this.g){var n=t,i=n[0];n[0]=n[1],n[1]=n[2],n[2]=n[3],n[3]=i,yo(t),t[0]^=_o[e/this.g][0],t[1]^=_o[e/this.g][1],t[2]^=_o[e/this.g][2],t[3]^=_o[e/this.g][3]}else 6<this.g&&4==e%this.g&&yo(t);this.a[e]=Array(4),this.a[e][0]=this.a[e-this.g][0]^t[0],this.a[e][1]=this.a[e-this.g][1]^t[1],this.a[e][2]=this.a[e-this.g][2]^t[2],this.a[e][3]=this.a[e-this.g][3]^t[3]}}a(no,to),no.prototype.set=function(e,t){eo.set(e,t,this.h,this.g,this.a,this.j)},no.prototype.get=function(e){return eo.get(e)||null},no.prototype.ra=function(e){var t=this.g,n=this.a;eo.get(e),eo.set(e,"",0,t,n)},uo.prototype.A=16;var co=uo.prototype.A/4;function ho(e,t){for(var n,i=0;i<co;i++)for(var r=0;4>r;r++)n=t[n=4*r+i],e.h[i][r]=n}function fo(e){for(var t=[],n=0;n<co;n++)for(var i=0;4>i;i++)t[4*i+n]=e.h[n][i];return t}function po(e,t){for(var n=0;4>n;n++)for(var i=0;4>i;i++)e.h[n][i]^=e.a[4*t+i][n]}function mo(e,t){for(var n=0;4>n;n++)for(var i=0;4>i;i++)e.h[n][i]=t[e.h[n][i]]}function go(e){for(var t=1;4>t;t++)for(var n=0;4>n;n++)e.s[t][n]=e.h[t][n];for(t=1;4>t;t++)for(n=0;4>n;n++)e.h[t][n]=e.s[t][(n+t)%co]}function vo(e){for(var t=1;4>t;t++)for(var n=0;4>n;n++)e.s[t][(n+t)%co]=e.h[t][n];for(t=1;4>t;t++)for(n=0;4>n;n++)e.h[t][n]=e.s[t][n]}function yo(e){e[0]=bo[e[0]],e[1]=bo[e[1]],e[2]=bo[e[2]],e[3]=bo[e[3]]}var bo=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],wo=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],_o=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],So=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,27,25,31,29,19,17,23,21,11,9,15,13,3,1,7,5,59,57,63,61,51,49,55,53,43,41,47,45,35,33,39,37,91,89,95,93,83,81,87,85,75,73,79,77,67,65,71,69,123,121,127,125,115,113,119,117,107,105,111,109,99,97,103,101,155,153,159,157,147,145,151,149,139,137,143,141,131,129,135,133,187,185,191,189,179,177,183,181,171,169,175,173,163,161,167,165,219,217,223,221,211,209,215,213,203,201,207,205,195,193,199,197,251,249,255,253,243,241,247,245,235,233,239,237,227,225,231,229],To=[0,3,6,5,12,15,10,9,24,27,30,29,20,23,18,17,48,51,54,53,60,63,58,57,40,43,46,45,36,39,34,33,96,99,102,101,108,111,106,105,120,123,126,125,116,119,114,113,80,83,86,85,92,95,90,89,72,75,78,77,68,71,66,65,192,195,198,197,204,207,202,201,216,219,222,221,212,215,210,209,240,243,246,245,252,255,250,249,232,235,238,237,228,231,226,225,160,163,166,165,172,175,170,169,184,187,190,189,180,183,178,177,144,147,150,149,156,159,154,153,136,139,142,141,132,135,130,129,155,152,157,158,151,148,145,146,131,128,133,134,143,140,137,138,171,168,173,174,167,164,161,162,179,176,181,182,191,188,185,186,251,248,253,254,247,244,241,242,227,224,229,230,239,236,233,234,203,200,205,206,199,196,193,194,211,208,213,214,223,220,217,218,91,88,93,94,87,84,81,82,67,64,69,70,79,76,73,74,107,104,109,110,103,100,97,98,115,112,117,118,127,124,121,122,59,56,61,62,55,52,49,50,35,32,37,38,47,44,41,42,11,8,13,14,7,4,1,2,19,16,21,22,31,28,25,26],Io=[0,9,18,27,36,45,54,63,72,65,90,83,108,101,126,119,144,153,130,139,180,189,166,175,216,209,202,195,252,245,238,231,59,50,41,32,31,22,13,4,115,122,97,104,87,94,69,76,171,162,185,176,143,134,157,148,227,234,241,248,199,206,213,220,118,127,100,109,82,91,64,73,62,55,44,37,26,19,8,1,230,239,244,253,194,203,208,217,174,167,188,181,138,131,152,145,77,68,95,86,105,96,123,114,5,12,23,30,33,40,51,58,221,212,207,198,249,240,235,226,149,156,135,142,177,184,163,170,236,229,254,247,200,193,218,211,164,173,182,191,128,137,146,155,124,117,110,103,88,81,74,67,52,61,38,47,16,25,2,11,215,222,197,204,243,250,225,232,159,150,141,132,187,178,169,160,71,78,85,92,99,106,113,120,15,6,29,20,43,34,57,48,154,147,136,129,190,183,172,165,210,219,192,201,246,255,228,237,10,3,24,17,46,39,60,53,66,75,80,89,102,111,116,125,161,168,179,186,133,140,151,158,233,224,251,242,205,196,223,214,49,56,35,42,21,28,7,14,121,112,107,98,93,84,79,70],Eo=[0,11,22,29,44,39,58,49,88,83,78,69,116,127,98,105,176,187,166,173,156,151,138,129,232,227,254,245,196,207,210,217,123,112,109,102,87,92,65,74,35,40,53,62,15,4,25,18,203,192,221,214,231,236,241,250,147,152,133,142,191,180,169,162,246,253,224,235,218,209,204,199,174,165,184,179,130,137,148,159,70,77,80,91,106,97,124,119,30,21,8,3,50,57,36,47,141,134,155,144,161,170,183,188,213,222,195,200,249,242,239,228,61,54,43,32,17,26,7,12,101,110,115,120,73,66,95,84,247,252,225,234,219,208,205,198,175,164,185,178,131,136,149,158,71,76,81,90,107,96,125,118,31,20,9,2,51,56,37,46,140,135,154,145,160,171,182,189,212,223,194,201,248,243,238,229,60,55,42,33,16,27,6,13,100,111,114,121,72,67,94,85,1,10,23,28,45,38,59,48,89,82,79,68,117,126,99,104,177,186,167,172,157,150,139,128,233,226,255,244,197,206,211,216,122,113,108,103,86,93,64,75,34,41,52,63,14,5,24,19,202,193,220,215,230,237,240,251,146,153,132,143,190,181,168,163],Ao=[0,13,26,23,52,57,46,35,104,101,114,127,92,81,70,75,208,221,202,199,228,233,254,243,184,181,162,175,140,129,150,155,187,182,161,172,143,130,149,152,211,222,201,196,231,234,253,240,107,102,113,124,95,82,69,72,3,14,25,20,55,58,45,32,109,96,119,122,89,84,67,78,5,8,31,18,49,60,43,38,189,176,167,170,137,132,147,158,213,216,207,194,225,236,251,246,214,219,204,193,226,239,248,245,190,179,164,169,138,135,144,157,6,11,28,17,50,63,40,37,110,99,116,121,90,87,64,77,218,215,192,205,238,227,244,249,178,191,168,165,134,139,156,145,10,7,16,29,62,51,36,41,98,111,120,117,86,91,76,65,97,108,123,118,85,88,79,66,9,4,19,30,61,48,39,42,177,188,171,166,133,136,159,146,217,212,195,206,237,224,247,250,183,186,173,160,131,142,153,148,223,210,197,200,235,230,241,252,103,106,125,112,83,94,73,68,15,2,21,24,59,54,33,44,12,1,22,27,56,53,34,47,100,105,126,115,80,93,74,71,220,209,198,203,232,229,242,255,180,185,174,163,128,141,154,151],ko=[0,14,28,18,56,54,36,42,112,126,108,98,72,70,84,90,224,238,252,242,216,214,196,202,144,158,140,130,168,166,180,186,219,213,199,201,227,237,255,241,171,165,183,185,147,157,143,129,59,53,39,41,3,13,31,17,75,69,87,89,115,125,111,97,173,163,177,191,149,155,137,135,221,211,193,207,229,235,249,247,77,67,81,95,117,123,105,103,61,51,33,47,5,11,25,23,118,120,106,100,78,64,82,92,6,8,26,20,62,48,34,44,150,152,138,132,174,160,178,188,230,232,250,244,222,208,194,204,65,79,93,83,121,119,101,107,49,63,45,35,9,7,21,27,161,175,189,179,153,151,133,139,209,223,205,195,233,231,245,251,154,148,134,136,162,172,190,176,234,228,246,248,210,220,206,192,122,116,102,104,66,76,94,80,10,4,22,24,50,60,46,32,236,226,240,254,212,218,200,198,156,146,128,142,164,170,184,182,12,2,16,30,52,58,40,38,124,114,96,110,68,74,88,86,55,57,43,37,15,1,19,29,71,73,91,85,127,113,99,109,215,217,203,197,239,225,243,253,167,169,187,181,159,145,131,141];function Co(e,t){e=new uo(Ro(e));for(var n,i=(t=ao(t)).splice(0,16),r="";i.length;){n=16-i.length;for(var o=0;o<n;o++)i.push(0);for(ho(n=e,i),po(n,0),i=1;i<n.j;++i){mo(n,bo),go(n),o=n.h;for(var s=n.s[0],a=0;4>a;a++)s[0]=o[0][a],s[1]=o[1][a],s[2]=o[2][a],s[3]=o[3][a],o[0][a]=So[s[0]]^To[s[1]]^s[2]^s[3],o[1][a]=s[0]^So[s[1]]^To[s[2]]^s[3],o[2][a]=s[0]^s[1]^So[s[2]]^To[s[3]],o[3][a]=To[s[0]]^s[1]^s[2]^So[s[3]];po(n,i)}mo(n,bo),go(n),po(n,n.j),r+=lo(fo(n)),i=t.splice(0,16)}return r}function xo(e,t){e=new uo(Ro(e));for(var n=[],i=0;i<t.length;i+=2)n.push(parseInt(t.substring(i,i+2),16));var r=n.splice(0,16);for(t="";r.length;){for(ho(i=e,r),po(i,i.j),r=1;r<i.j;++r){vo(i),mo(i,wo),po(i,i.j-r);for(var o=i.h,s=i.s[0],a=0;4>a;a++)s[0]=o[0][a],s[1]=o[1][a],s[2]=o[2][a],s[3]=o[3][a],o[0][a]=ko[s[0]]^Eo[s[1]]^Ao[s[2]]^Io[s[3]],o[1][a]=Io[s[0]]^ko[s[1]]^Eo[s[2]]^Ao[s[3]],o[2][a]=Ao[s[0]]^Io[s[1]]^ko[s[2]]^Eo[s[3]],o[3][a]=Eo[s[0]]^Ao[s[1]]^Io[s[2]]^ko[s[3]]}if(vo(i),mo(i,wo),po(i,0),8192>=(i=fo(i)).length)i=String.fromCharCode.apply(null,i);else{for(r="",o=0;o<i.length;o+=8192)r+=String.fromCharCode.apply(null,$(i,o,o+8192));i=r}t+=i,r=n.splice(0,16)}return t.replace(/(\x00)+$/,"")}function Ro(e){for(var t=32-(e=ao(e.substring(0,32))).length,n=0;n<t;n++)e.push(0);return e}function Lo(e){var t=[];return Po(new Mo,e,t),t.join("")}function Mo(){}function Po(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(b(t)){var i=t;t=i.length,n.push("[");for(var r="",o=0;o<t;o++)n.push(r),Po(e,i[o],n),r=",";return void n.push("]")}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){for(i in n.push("{"),r="",t)Object.prototype.hasOwnProperty.call(t,i)&&("function"!=typeof(o=t[i])&&(n.push(r),Oo(i,n),n.push(":"),Po(e,o,n),r=","));return void n.push("}")}t=t.valueOf()}switch(typeof t){case"string":Oo(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}}var Do={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},No=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Oo(e,t){t.push('"',e.replace(No,(function(e){var t=Do[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Do[e]=t),t})),'"')}function Fo(e){this.a=e}function Uo(){}function Vo(e){this.a=e}function Ho(e){if(!e.a)return!1;try{return e.a.setItem("__sak","1"),e.a.removeItem("__sak"),!0}catch(e){return!1}}function Bo(){var e=null;try{e=window.localStorage||null}catch(e){}this.a=e}function jo(){var e=null;try{e=window.sessionStorage||null}catch(e){}this.a=e}function Go(e,t){this.g=e,this.a=t+"::"}Fo.prototype.set=function(e,t){d(t)?this.a.set(e,Lo(t)):this.a.ra(e)},Fo.prototype.get=function(e){try{var t=this.a.get(e)}catch(e){return}if(null!==t)try{return JSON.parse(t)}catch(e){throw"Storage: Invalid value was encountered"}},P(Uo,to),Uo.prototype.clear=function(){var e=de(this.ha(!0)),t=this;U(e,(function(e){t.ra(e)}))},P(Vo,Uo),(e=Vo.prototype).set=function(e,t){try{this.a.setItem(e,t)}catch(e){if(0==this.a.length)throw"Storage mechanism: Storage disabled";throw"Storage mechanism: Quota exceeded"}},e.get=function(e){if(!f(e=this.a.getItem(e))&&null!==e)throw"Storage mechanism: Invalid value was encountered";return e},e.ra=function(e){this.a.removeItem(e)},e.ha=function(e){var t=0,n=this.a,i=new ce;return i.next=function(){if(t>=n.length)throw ue;var i=n.key(t++);if(e)return i;if(!f(i=n.getItem(i)))throw"Storage mechanism: Invalid value was encountered";return i},i},e.clear=function(){this.a.clear()},e.key=function(e){return this.a.key(e)},P(Bo,Vo),P(jo,Vo),P(Go,Uo),Go.prototype.set=function(e,t){this.g.set(this.a+e,t)},Go.prototype.get=function(e){return this.g.get(this.a+e)},Go.prototype.ra=function(e){this.g.ra(this.a+e)},Go.prototype.ha=function(e){var t=this.g.ha(!0),n=this,i=new ce;return i.next=function(){for(var i=t.next();i.substr(0,n.a.length)!=n.a;)i=t.next();return e?i.substr(n.a.length):n.g.get(i)},i},Ho(new Bo);var Wo=new jo,zo=new Fo(Ho(Wo)?new Go(Wo,"firebaseui"):null),qo={name:"pendingEmailCredential",storage:zo},Ko={name:"redirectStatus",storage:zo},$o={name:"redirectUrl",storage:zo},Yo={name:"emailForSignIn",storage:new Fo(new no(3600,"/"))},Xo={name:"pendingEncryptedCredential",storage:new Fo(new no(3600,"/"))};function Qo(e,t){return e.storage.get(t?e.name+":"+t:e.name)}function Jo(e,t){e.storage.a.ra(t?e.name+":"+t:e.name)}function Zo(e,t,n){e.storage.set(n?e.name+":"+n:e.name,t)}function es(e){return Qo($o,e)||null}function ts(e){return oo(e=Qo(qo,e)||null)}function ns(e){Jo(qo,e)}function is(e,t){Zo(qo,ro(e),t)}function rs(e){return(e=Qo(Ko,e)||null)&&void 0!==e.tenantId?new so(e.tenantId):null}function os(){this.W={}}function ss(e,t,n){if(t.toLowerCase()in e.W)throw Error("Configuration "+t+" has already been defined.");e.W[t.toLowerCase()]=n}function as(e,t,n){if(!(t.toLowerCase()in e.W))throw Error("Configuration "+t+" is not defined.");e.W[t.toLowerCase()]=n}function ls(e,t){if(!(e=e.get(t)))throw Error("Configuration "+t+" is required.");return e}function us(){this.g=void 0,this.a={}}function cs(e,t,n,i){for(var r=0;r<t.length;r++){var o=t.charAt(r);e.a[o]||(e.a[o]=new us),e=e.a[o]}if(i&&void 0!==e.g)throw Error('The collection already contains the key "'+t+'"');e.g=n}function hs(e,t){for(var n in void 0!==e.g&&t.push(e.g),e.a)hs(e.a[n],t)}function ds(e,t,n){for(var i in void 0!==e.g&&n.push(t),e.a)ds(e.a[i],t+i,n)}function fs(e){for(this.a=e,this.g=new us,e=0;e<this.a.length;e++){var t=this.g.get("+"+this.a[e].b);t?t.push(this.a[e]):this.g.add("+"+this.a[e].b,[this.a[e]])}}function ps(e,t){var n={},i=0;for(void 0!==(e=e.g).g&&(n[i]=e.g);i<t.length;i++){var r=t.charAt(i);if(!(r in e.a))break;void 0!==(e=e.a[r]).g&&(n[i]=e.g)}for(var o in n)if(n.hasOwnProperty(o))return n[o];return[]}function ms(e){for(var t=0;t<bs.length;t++)if(bs[t].c===e)return bs[t];return null}function gs(e){e=e.toUpperCase();for(var t=[],n=0;n<bs.length;n++)bs[n].f===e&&t.push(bs[n]);return t}function vs(e){if(0<e.length&&"+"==e.charAt(0)){e=e.substring(1);for(var t=[],n=0;n<bs.length;n++)bs[n].b==e&&t.push(bs[n]);e=t}else e=gs(e);return e}function ys(e){e.sort((function(e,t){return e.name.localeCompare(t.name,"en")}))}os.prototype.get=function(e){if(!(e.toLowerCase()in this.W))throw Error("Configuration "+e+" is not defined.");return this.W[e.toLowerCase()]},(e=us.prototype).set=function(e,t){cs(this,e,t,!1)},e.add=function(e,t){cs(this,e,t,!0)},e.get=function(e){e:{for(var t=this,n=0;n<e.length;n++)if(!(t=t.a[e.charAt(n)])){e=void 0;break e}e=t}return e?e.g:void 0},e.la=function(){var e=[];return hs(this,e),e},e.ja=function(){var e=[];return ds(this,"",e),e},e.clear=function(){this.a={},this.g=void 0};var bs=[{name:"Afghanistan",c:"93-AF-0",b:"93",f:"AF"},{name:"Åland Islands",c:"358-AX-0",b:"358",f:"AX"},{name:"Albania",c:"355-AL-0",b:"355",f:"AL"},{name:"Algeria",c:"213-DZ-0",b:"213",f:"DZ"},{name:"American Samoa",c:"1-AS-0",b:"1",f:"AS"},{name:"Andorra",c:"376-AD-0",b:"376",f:"AD"},{name:"Angola",c:"244-AO-0",b:"244",f:"AO"},{name:"Anguilla",c:"1-AI-0",b:"1",f:"AI"},{name:"Antigua and Barbuda",c:"1-AG-0",b:"1",f:"AG"},{name:"Argentina",c:"54-AR-0",b:"54",f:"AR"},{name:"Armenia",c:"374-AM-0",b:"374",f:"AM"},{name:"Aruba",c:"297-AW-0",b:"297",f:"AW"},{name:"Ascension Island",c:"247-AC-0",b:"247",f:"AC"},{name:"Australia",c:"61-AU-0",b:"61",f:"AU"},{name:"Austria",c:"43-AT-0",b:"43",f:"AT"},{name:"Azerbaijan",c:"994-AZ-0",b:"994",f:"AZ"},{name:"Bahamas",c:"1-BS-0",b:"1",f:"BS"},{name:"Bahrain",c:"973-BH-0",b:"973",f:"BH"},{name:"Bangladesh",c:"880-BD-0",b:"880",f:"BD"},{name:"Barbados",c:"1-BB-0",b:"1",f:"BB"},{name:"Belarus",c:"375-BY-0",b:"375",f:"BY"},{name:"Belgium",c:"32-BE-0",b:"32",f:"BE"},{name:"Belize",c:"501-BZ-0",b:"501",f:"BZ"},{name:"Benin",c:"229-BJ-0",b:"229",f:"BJ"},{name:"Bermuda",c:"1-BM-0",b:"1",f:"BM"},{name:"Bhutan",c:"975-BT-0",b:"975",f:"BT"},{name:"Bolivia",c:"591-BO-0",b:"591",f:"BO"},{name:"Bosnia and Herzegovina",c:"387-BA-0",b:"387",f:"BA"},{name:"Botswana",c:"267-BW-0",b:"267",f:"BW"},{name:"Brazil",c:"55-BR-0",b:"55",f:"BR"},{name:"British Indian Ocean Territory",c:"246-IO-0",b:"246",f:"IO"},{name:"British Virgin Islands",c:"1-VG-0",b:"1",f:"VG"},{name:"Brunei",c:"673-BN-0",b:"673",f:"BN"},{name:"Bulgaria",c:"359-BG-0",b:"359",f:"BG"},{name:"Burkina Faso",c:"226-BF-0",b:"226",f:"BF"},{name:"Burundi",c:"257-BI-0",b:"257",f:"BI"},{name:"Cambodia",c:"855-KH-0",b:"855",f:"KH"},{name:"Cameroon",c:"237-CM-0",b:"237",f:"CM"},{name:"Canada",c:"1-CA-0",b:"1",f:"CA"},{name:"Cape Verde",c:"238-CV-0",b:"238",f:"CV"},{name:"Caribbean Netherlands",c:"599-BQ-0",b:"599",f:"BQ"},{name:"Cayman Islands",c:"1-KY-0",b:"1",f:"KY"},{name:"Central African Republic",c:"236-CF-0",b:"236",f:"CF"},{name:"Chad",c:"235-TD-0",b:"235",f:"TD"},{name:"Chile",c:"56-CL-0",b:"56",f:"CL"},{name:"China",c:"86-CN-0",b:"86",f:"CN"},{name:"Christmas Island",c:"61-CX-0",b:"61",f:"CX"},{name:"Cocos [Keeling] Islands",c:"61-CC-0",b:"61",f:"CC"},{name:"Colombia",c:"57-CO-0",b:"57",f:"CO"},{name:"Comoros",c:"269-KM-0",b:"269",f:"KM"},{name:"Democratic Republic Congo",c:"243-CD-0",b:"243",f:"CD"},{name:"Republic of Congo",c:"242-CG-0",b:"242",f:"CG"},{name:"Cook Islands",c:"682-CK-0",b:"682",f:"CK"},{name:"Costa Rica",c:"506-CR-0",b:"506",f:"CR"},{name:"Côte d'Ivoire",c:"225-CI-0",b:"225",f:"CI"},{name:"Croatia",c:"385-HR-0",b:"385",f:"HR"},{name:"Cuba",c:"53-CU-0",b:"53",f:"CU"},{name:"Curaçao",c:"599-CW-0",b:"599",f:"CW"},{name:"Cyprus",c:"357-CY-0",b:"357",f:"CY"},{name:"Czech Republic",c:"420-CZ-0",b:"420",f:"CZ"},{name:"Denmark",c:"45-DK-0",b:"45",f:"DK"},{name:"Djibouti",c:"253-DJ-0",b:"253",f:"DJ"},{name:"Dominica",c:"1-DM-0",b:"1",f:"DM"},{name:"Dominican Republic",c:"1-DO-0",b:"1",f:"DO"},{name:"East Timor",c:"670-TL-0",b:"670",f:"TL"},{name:"Ecuador",c:"593-EC-0",b:"593",f:"EC"},{name:"Egypt",c:"20-EG-0",b:"20",f:"EG"},{name:"El Salvador",c:"503-SV-0",b:"503",f:"SV"},{name:"Equatorial Guinea",c:"240-GQ-0",b:"240",f:"GQ"},{name:"Eritrea",c:"291-ER-0",b:"291",f:"ER"},{name:"Estonia",c:"372-EE-0",b:"372",f:"EE"},{name:"Ethiopia",c:"251-ET-0",b:"251",f:"ET"},{name:"Falkland Islands [Islas Malvinas]",c:"500-FK-0",b:"500",f:"FK"},{name:"Faroe Islands",c:"298-FO-0",b:"298",f:"FO"},{name:"Fiji",c:"679-FJ-0",b:"679",f:"FJ"},{name:"Finland",c:"358-FI-0",b:"358",f:"FI"},{name:"France",c:"33-FR-0",b:"33",f:"FR"},{name:"French Guiana",c:"594-GF-0",b:"594",f:"GF"},{name:"French Polynesia",c:"689-PF-0",b:"689",f:"PF"},{name:"Gabon",c:"241-GA-0",b:"241",f:"GA"},{name:"Gambia",c:"220-GM-0",b:"220",f:"GM"},{name:"Georgia",c:"995-GE-0",b:"995",f:"GE"},{name:"Germany",c:"49-DE-0",b:"49",f:"DE"},{name:"Ghana",c:"233-GH-0",b:"233",f:"GH"},{name:"Gibraltar",c:"350-GI-0",b:"350",f:"GI"},{name:"Greece",c:"30-GR-0",b:"30",f:"GR"},{name:"Greenland",c:"299-GL-0",b:"299",f:"GL"},{name:"Grenada",c:"1-GD-0",b:"1",f:"GD"},{name:"Guadeloupe",c:"590-GP-0",b:"590",f:"GP"},{name:"Guam",c:"1-GU-0",b:"1",f:"GU"},{name:"Guatemala",c:"502-GT-0",b:"502",f:"GT"},{name:"Guernsey",c:"44-GG-0",b:"44",f:"GG"},{name:"Guinea Conakry",c:"224-GN-0",b:"224",f:"GN"},{name:"Guinea-Bissau",c:"245-GW-0",b:"245",f:"GW"},{name:"Guyana",c:"592-GY-0",b:"592",f:"GY"},{name:"Haiti",c:"509-HT-0",b:"509",f:"HT"},{name:"Heard Island and McDonald Islands",c:"672-HM-0",b:"672",f:"HM"},{name:"Honduras",c:"504-HN-0",b:"504",f:"HN"},{name:"Hong Kong",c:"852-HK-0",b:"852",f:"HK"},{name:"Hungary",c:"36-HU-0",b:"36",f:"HU"},{name:"Iceland",c:"354-IS-0",b:"354",f:"IS"},{name:"India",c:"91-IN-0",b:"91",f:"IN"},{name:"Indonesia",c:"62-ID-0",b:"62",f:"ID"},{name:"Iran",c:"98-IR-0",b:"98",f:"IR"},{name:"Iraq",c:"964-IQ-0",b:"964",f:"IQ"},{name:"Ireland",c:"353-IE-0",b:"353",f:"IE"},{name:"Isle of Man",c:"44-IM-0",b:"44",f:"IM"},{name:"Israel",c:"972-IL-0",b:"972",f:"IL"},{name:"Italy",c:"39-IT-0",b:"39",f:"IT"},{name:"Jamaica",c:"1-JM-0",b:"1",f:"JM"},{name:"Japan",c:"81-JP-0",b:"81",f:"JP"},{name:"Jersey",c:"44-JE-0",b:"44",f:"JE"},{name:"Jordan",c:"962-JO-0",b:"962",f:"JO"},{name:"Kazakhstan",c:"7-KZ-0",b:"7",f:"KZ"},{name:"Kenya",c:"254-KE-0",b:"254",f:"KE"},{name:"Kiribati",c:"686-KI-0",b:"686",f:"KI"},{name:"Kosovo",c:"377-XK-0",b:"377",f:"XK"},{name:"Kosovo",c:"381-XK-0",b:"381",f:"XK"},{name:"Kosovo",c:"386-XK-0",b:"386",f:"XK"},{name:"Kuwait",c:"965-KW-0",b:"965",f:"KW"},{name:"Kyrgyzstan",c:"996-KG-0",b:"996",f:"KG"},{name:"Laos",c:"856-LA-0",b:"856",f:"LA"},{name:"Latvia",c:"371-LV-0",b:"371",f:"LV"},{name:"Lebanon",c:"961-LB-0",b:"961",f:"LB"},{name:"Lesotho",c:"266-LS-0",b:"266",f:"LS"},{name:"Liberia",c:"231-LR-0",b:"231",f:"LR"},{name:"Libya",c:"218-LY-0",b:"218",f:"LY"},{name:"Liechtenstein",c:"423-LI-0",b:"423",f:"LI"},{name:"Lithuania",c:"370-LT-0",b:"370",f:"LT"},{name:"Luxembourg",c:"352-LU-0",b:"352",f:"LU"},{name:"Macau",c:"853-MO-0",b:"853",f:"MO"},{name:"Macedonia",c:"389-MK-0",b:"389",f:"MK"},{name:"Madagascar",c:"261-MG-0",b:"261",f:"MG"},{name:"Malawi",c:"265-MW-0",b:"265",f:"MW"},{name:"Malaysia",c:"60-MY-0",b:"60",f:"MY"},{name:"Maldives",c:"960-MV-0",b:"960",f:"MV"},{name:"Mali",c:"223-ML-0",b:"223",f:"ML"},{name:"Malta",c:"356-MT-0",b:"356",f:"MT"},{name:"Marshall Islands",c:"692-MH-0",b:"692",f:"MH"},{name:"Martinique",c:"596-MQ-0",b:"596",f:"MQ"},{name:"Mauritania",c:"222-MR-0",b:"222",f:"MR"},{name:"Mauritius",c:"230-MU-0",b:"230",f:"MU"},{name:"Mayotte",c:"262-YT-0",b:"262",f:"YT"},{name:"Mexico",c:"52-MX-0",b:"52",f:"MX"},{name:"Micronesia",c:"691-FM-0",b:"691",f:"FM"},{name:"Moldova",c:"373-MD-0",b:"373",f:"MD"},{name:"Monaco",c:"377-MC-0",b:"377",f:"MC"},{name:"Mongolia",c:"976-MN-0",b:"976",f:"MN"},{name:"Montenegro",c:"382-ME-0",b:"382",f:"ME"},{name:"Montserrat",c:"1-MS-0",b:"1",f:"MS"},{name:"Morocco",c:"212-MA-0",b:"212",f:"MA"},{name:"Mozambique",c:"258-MZ-0",b:"258",f:"MZ"},{name:"Myanmar [Burma]",c:"95-MM-0",b:"95",f:"MM"},{name:"Namibia",c:"264-NA-0",b:"264",f:"NA"},{name:"Nauru",c:"674-NR-0",b:"674",f:"NR"},{name:"Nepal",c:"977-NP-0",b:"977",f:"NP"},{name:"Netherlands",c:"31-NL-0",b:"31",f:"NL"},{name:"New Caledonia",c:"687-NC-0",b:"687",f:"NC"},{name:"New Zealand",c:"64-NZ-0",b:"64",f:"NZ"},{name:"Nicaragua",c:"505-NI-0",b:"505",f:"NI"},{name:"Niger",c:"227-NE-0",b:"227",f:"NE"},{name:"Nigeria",c:"234-NG-0",b:"234",f:"NG"},{name:"Niue",c:"683-NU-0",b:"683",f:"NU"},{name:"Norfolk Island",c:"672-NF-0",b:"672",f:"NF"},{name:"North Korea",c:"850-KP-0",b:"850",f:"KP"},{name:"Northern Mariana Islands",c:"1-MP-0",b:"1",f:"MP"},{name:"Norway",c:"47-NO-0",b:"47",f:"NO"},{name:"Oman",c:"968-OM-0",b:"968",f:"OM"},{name:"Pakistan",c:"92-PK-0",b:"92",f:"PK"},{name:"Palau",c:"680-PW-0",b:"680",f:"PW"},{name:"Palestinian Territories",c:"970-PS-0",b:"970",f:"PS"},{name:"Panama",c:"507-PA-0",b:"507",f:"PA"},{name:"Papua New Guinea",c:"675-PG-0",b:"675",f:"PG"},{name:"Paraguay",c:"595-PY-0",b:"595",f:"PY"},{name:"Peru",c:"51-PE-0",b:"51",f:"PE"},{name:"Philippines",c:"63-PH-0",b:"63",f:"PH"},{name:"Poland",c:"48-PL-0",b:"48",f:"PL"},{name:"Portugal",c:"351-PT-0",b:"351",f:"PT"},{name:"Puerto Rico",c:"1-PR-0",b:"1",f:"PR"},{name:"Qatar",c:"974-QA-0",b:"974",f:"QA"},{name:"Réunion",c:"262-RE-0",b:"262",f:"RE"},{name:"Romania",c:"40-RO-0",b:"40",f:"RO"},{name:"Russia",c:"7-RU-0",b:"7",f:"RU"},{name:"Rwanda",c:"250-RW-0",b:"250",f:"RW"},{name:"Saint Barthélemy",c:"590-BL-0",b:"590",f:"BL"},{name:"Saint Helena",c:"290-SH-0",b:"290",f:"SH"},{name:"St. Kitts",c:"1-KN-0",b:"1",f:"KN"},{name:"St. Lucia",c:"1-LC-0",b:"1",f:"LC"},{name:"Saint Martin",c:"590-MF-0",b:"590",f:"MF"},{name:"Saint Pierre and Miquelon",c:"508-PM-0",b:"508",f:"PM"},{name:"St. Vincent",c:"1-VC-0",b:"1",f:"VC"},{name:"Samoa",c:"685-WS-0",b:"685",f:"WS"},{name:"San Marino",c:"378-SM-0",b:"378",f:"SM"},{name:"São Tomé and Príncipe",c:"239-ST-0",b:"239",f:"ST"},{name:"Saudi Arabia",c:"966-SA-0",b:"966",f:"SA"},{name:"Senegal",c:"221-SN-0",b:"221",f:"SN"},{name:"Serbia",c:"381-RS-0",b:"381",f:"RS"},{name:"Seychelles",c:"248-SC-0",b:"248",f:"SC"},{name:"Sierra Leone",c:"232-SL-0",b:"232",f:"SL"},{name:"Singapore",c:"65-SG-0",b:"65",f:"SG"},{name:"Sint Maarten",c:"1-SX-0",b:"1",f:"SX"},{name:"Slovakia",c:"421-SK-0",b:"421",f:"SK"},{name:"Slovenia",c:"386-SI-0",b:"386",f:"SI"},{name:"Solomon Islands",c:"677-SB-0",b:"677",f:"SB"},{name:"Somalia",c:"252-SO-0",b:"252",f:"SO"},{name:"South Africa",c:"27-ZA-0",b:"27",f:"ZA"},{name:"South Georgia and the South Sandwich Islands",c:"500-GS-0",b:"500",f:"GS"},{name:"South Korea",c:"82-KR-0",b:"82",f:"KR"},{name:"South Sudan",c:"211-SS-0",b:"211",f:"SS"},{name:"Spain",c:"34-ES-0",b:"34",f:"ES"},{name:"Sri Lanka",c:"94-LK-0",b:"94",f:"LK"},{name:"Sudan",c:"249-SD-0",b:"249",f:"SD"},{name:"Suriname",c:"597-SR-0",b:"597",f:"SR"},{name:"Svalbard and Jan Mayen",c:"47-SJ-0",b:"47",f:"SJ"},{name:"Swaziland",c:"268-SZ-0",b:"268",f:"SZ"},{name:"Sweden",c:"46-SE-0",b:"46",f:"SE"},{name:"Switzerland",c:"41-CH-0",b:"41",f:"CH"},{name:"Syria",c:"963-SY-0",b:"963",f:"SY"},{name:"Taiwan",c:"886-TW-0",b:"886",f:"TW"},{name:"Tajikistan",c:"992-TJ-0",b:"992",f:"TJ"},{name:"Tanzania",c:"255-TZ-0",b:"255",f:"TZ"},{name:"Thailand",c:"66-TH-0",b:"66",f:"TH"},{name:"Togo",c:"228-TG-0",b:"228",f:"TG"},{name:"Tokelau",c:"690-TK-0",b:"690",f:"TK"},{name:"Tonga",c:"676-TO-0",b:"676",f:"TO"},{name:"Trinidad/Tobago",c:"1-TT-0",b:"1",f:"TT"},{name:"Tunisia",c:"216-TN-0",b:"216",f:"TN"},{name:"Turkey",c:"90-TR-0",b:"90",f:"TR"},{name:"Turkmenistan",c:"993-TM-0",b:"993",f:"TM"},{name:"Turks and Caicos Islands",c:"1-TC-0",b:"1",f:"TC"},{name:"Tuvalu",c:"688-TV-0",b:"688",f:"TV"},{name:"U.S. Virgin Islands",c:"1-VI-0",b:"1",f:"VI"},{name:"Uganda",c:"256-UG-0",b:"256",f:"UG"},{name:"Ukraine",c:"380-UA-0",b:"380",f:"UA"},{name:"United Arab Emirates",c:"971-AE-0",b:"971",f:"AE"},{name:"United Kingdom",c:"44-GB-0",b:"44",f:"GB"},{name:"United States",c:"1-US-0",b:"1",f:"US"},{name:"Uruguay",c:"598-UY-0",b:"598",f:"UY"},{name:"Uzbekistan",c:"998-UZ-0",b:"998",f:"UZ"},{name:"Vanuatu",c:"678-VU-0",b:"678",f:"VU"},{name:"Vatican City",c:"379-VA-0",b:"379",f:"VA"},{name:"Venezuela",c:"58-VE-0",b:"58",f:"VE"},{name:"Vietnam",c:"84-VN-0",b:"84",f:"VN"},{name:"Wallis and Futuna",c:"681-WF-0",b:"681",f:"WF"},{name:"Western Sahara",c:"212-EH-0",b:"212",f:"EH"},{name:"Yemen",c:"967-YE-0",b:"967",f:"YE"},{name:"Zambia",c:"260-ZM-0",b:"260",f:"ZM"},{name:"Zimbabwe",c:"263-ZW-0",b:"263",f:"ZW"}];ys(bs);var ws=new fs(bs);function _s(e,t){this.a=e,this.Aa=t}function Ss(e){e=Y(e);var t=ps(ws,e);return 0<t.length?new _s("1"==t[0].b?"1-US-0":t[0].c,Y(e.substr(t[0].b.length+1))):null}function Ts(e){var t=ms(e.a);if(!t)throw Error("Country ID "+e.a+" not found.");return"+"+t.b+e.Aa}function Is(e,t){for(var n=0;n<e.length;n++)if(!j(Es,e[n])&&(null!==As&&e[n]in As||j(t,e[n])))return e[n];return null}var Es=["emailLink","password","phone"],As={"facebook.com":"FacebookAuthProvider","github.com":"GithubAuthProvider","google.com":"GoogleAuthProvider",password:"EmailAuthProvider","twitter.com":"TwitterAuthProvider",phone:"PhoneAuthProvider"};function ks(){this.a=new os,ss(this.a,"autoUpgradeAnonymousUsers"),ss(this.a,"callbacks"),ss(this.a,"credentialHelper",na),ss(this.a,"immediateFederatedRedirect",!1),ss(this.a,"popupMode",!1),ss(this.a,"privacyPolicyUrl"),ss(this.a,"queryParameterForSignInSuccessUrl","signInSuccessUrl"),ss(this.a,"queryParameterForWidgetMode","mode"),ss(this.a,"signInFlow"),ss(this.a,"signInOptions"),ss(this.a,"signInSuccessUrl"),ss(this.a,"siteName"),ss(this.a,"tosUrl"),ss(this.a,"widgetUrl"),ss(this.a,"adminRestrictedOperation")}function Cs(e){var t=!!e.a.get("autoUpgradeAnonymousUsers");return t&&!Ys(e)&&Kr('Missing "signInFailure" callback: "signInFailure" callback needs to be provided when "autoUpgradeAnonymousUsers" is set to true.',void 0),t}function xs(e){e=e.a.get("signInOptions")||[];for(var t=[],n=0;n<e.length;n++){var i=e[n];(i=S(i)?i:{provider:i}).provider&&t.push(i)}return t}function Rs(e,t){e=xs(e);for(var n=0;n<e.length;n++)if(e[n].provider===t)return e[n];return null}function Ls(e){return xs(e).map((function(e){return e.provider}))}function Ms(e,t){e=Ps(e);for(var n=0;n<e.length;n++)if(e[n].providerId===t)return e[n];return null}function Ps(e){return xs(e).map((function(e){if(As[e.provider]||j(aa,e.provider)){for(var t in e={providerId:e.provider,S:e.providerName||null,V:e.fullLabel||null,ta:e.buttonColor||null,za:e.iconUrl?wt(St(e.iconUrl)).toString():null})null===e[t]&&delete e[t];return e}return{providerId:e.provider,S:e.providerName||null,V:e.fullLabel||null,ta:e.buttonColor||null,za:e.iconUrl?wt(St(e.iconUrl)).toString():null,Ob:e.loginHintKey||null}}))}function Ds(e){var t,n=Rs(e,D_.auth.GoogleAuthProvider.PROVIDER_ID);if(t=n&&n.clientId){e:{if("http:"===(window.location&&window.location.protocol)||"https:"===(window.location&&window.location.protocol))for(i in e=e.a.get("credentialHelper"),ia)if(ia[i]===e){var i=ia[i];break e}i=na}t=i===ta}return t&&n.clientId||null}function Ns(e){return!!((e=Rs(e,D_.auth.EmailAuthProvider.PROVIDER_ID))&&e.disableSignUp&&e.disableSignUp.status)}function Os(e){return!(!(e=e.a.get("adminRestrictedOperation")||null)||!e.status)}function Fs(e,t){return e=(e=Rs(e,t))&&e.scopes,Array.isArray(e)?e:[]}function Us(e,t){return S(e=(e=Rs(e,t))&&e.customParameters)?(e=se(e),t===D_.auth.GoogleAuthProvider.PROVIDER_ID&&delete e.login_hint,t===D_.auth.GithubAuthProvider.PROVIDER_ID&&delete e.login,e):null}function Vs(e){if(!(e=Rs(e,D_.auth.PhoneAuthProvider.PROVIDER_ID)))return null;var t=e.whitelistedCountries,n=e.blacklistedCountries;if(void 0!==t&&(!Array.isArray(t)||0==t.length))throw Error("WhitelistedCountries must be a non-empty array.");if(void 0!==n&&!Array.isArray(n))throw Error("BlacklistedCountries must be an array.");if(t&&n)throw Error("Both whitelistedCountries and blacklistedCountries are provided.");if(!t&&!n)return bs;if(e=[],t){n={};for(var i=0;i<t.length;i++)for(var r=vs(t[i]),o=0;o<r.length;o++)n[r[o].c]=r[o];for(var s in n)n.hasOwnProperty(s)&&e.push(n[s])}else{for(s={},t=0;t<n.length;t++)for(r=vs(n[t]),i=0;i<r.length;i++)s[r[i].c]=r[i];for(r=0;r<bs.length;r++)null!==s&&bs[r].c in s||e.push(bs[r])}return e}function Hs(e){return ls(e.a,"queryParameterForWidgetMode")}function Bs(e){var t=e.a.get("tosUrl")||null;if(e=e.a.get("privacyPolicyUrl")||null,t&&!e&&Qr("Privacy Policy URL is missing, the link will not be displayed."),t&&e){if("function"==typeof t)return t;if("string"==typeof t)return function(){rr(t)}}return null}function js(e){var t=e.a.get("tosUrl")||null,n=e.a.get("privacyPolicyUrl")||null;if(n&&!t&&Qr("Term of Service URL is missing, the link will not be displayed."),t&&n){if("function"==typeof n)return n;if("string"==typeof n)return function(){rr(n)}}return null}function Gs(e){return!(e=Rs(e,D_.auth.EmailAuthProvider.PROVIDER_ID))||void 0===e.requireDisplayName||!!e.requireDisplayName}function Ws(e){return!(!(e=Rs(e,D_.auth.EmailAuthProvider.PROVIDER_ID))||e.signInMethod!==D_.auth.EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD)}function zs(e){var t=!!e.a.get("immediateFederatedRedirect"),n=Ls(e);return e=qs(e),t&&1==n.length&&!j(Es,n[0])&&e==ra}function qs(e){for(var t in e=e.a.get("signInFlow"),oa)if(oa[t]==e)return oa[t];return ra}function Ks(e){return Xs(e).signInSuccess||null}function $s(e){return Xs(e).signInSuccessWithAuthResult||null}function Ys(e){return Xs(e).signInFailure||null}function Xs(e){return e.a.get("callbacks")||{}}var Qs,Js,Zs,ea,ta="googleyolo",na="none",ia={nc:ta,NONE:na},ra="redirect",oa={qc:"popup",rc:ra},sa={mc:"callback",RECOVER_EMAIL:"recoverEmail",sc:"resetPassword",REVERT_SECOND_FACTOR_ADDITION:"revertSecondFactorAddition",tc:"select",uc:"signIn",VERIFY_AND_CHANGE_EMAIL:"verifyAndChangeEmail",VERIFY_EMAIL:"verifyEmail"},aa=["anonymous"],la=["sitekey","tabindex","callback","expired-callback"],ua={};function ca(e,t,n,i){ua[e].apply(null,Array.prototype.slice.call(arguments,1))}function ha(e){return e.classList?e.classList:f(e=e.className)&&e.match(/\S+/g)||[]}function da(e,t){return e.classList?e.classList.contains(t):j(ha(e),t)}function fa(e,t){e.classList?e.classList.add(t):da(e,t)||(e.className+=0<e.className.length?" "+t:t)}function pa(e,t){e.classList?e.classList.remove(t):da(e,t)&&(e.className=V(ha(e),(function(e){return e!=t})).join(" "))}function ma(e){var t=e.type;switch(f(t)&&t.toLowerCase()){case"checkbox":case"radio":return e.checked?e.value:null;case"select-one":return 0<=(t=e.selectedIndex)?e.options[t].value:null;case"select-multiple":t=[];for(var n,i=0;n=e.options[i];i++)n.selected&&t.push(n.value);return t.length?t:null;default:return null!=e.value?e.value:null}}function ga(e,t){var n=e.type;switch(f(n)&&n.toLowerCase()){case"checkbox":case"radio":e.checked=t;break;case"select-one":if(e.selectedIndex=-1,f(t))for(var i=0;n=e.options[i];i++)if(n.value==t){n.selected=!0;break}break;case"select-multiple":for(f(t)&&(t=[t]),i=0;n=e.options[i];i++)if(n.selected=!1,t)for(var r,o=0;r=t[o];o++)n.value==r&&(n.selected=!0);break;default:e.value=null!=t?t:""}}function va(e,t,n,i,r,o){if(nt&&!ht("525"))return!0;if(rt&&r)return ya(e);if(r&&!i)return!1;if(!tt&&("number"==typeof t&&(t=ba(t)),(!n||rt)&&(17==t||18==t||rt&&91==t)||rt&&16==t&&(i||o)))return!1;if((nt||Ze)&&i&&n)switch(e){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(Je&&i&&t==e)return!1;switch(e){case 13:return!tt||!o&&!r&&!(n&&i);case 27:return!(nt||Ze||tt)}return(!tt||!(i||r||o))&&ya(e)}function ya(e){if(48<=e&&57>=e||96<=e&&106>=e||65<=e&&90>=e||(nt||Ze)&&0==e)return!0;switch(e){case 32:case 43:case 63:case 64:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:case 163:return!0;case 173:return tt;default:return!1}}function ba(e){if(tt)e=function(e){switch(e){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return e}}(e);else if(rt&&nt&&93===e)e=91;return e}function wa(e){pi.call(this),this.a=e,ni(e,"keydown",this.g,!1,this),ni(e,"click",this.h,!1,this)}function _a(e,t){var n=new Ta(t);if(mi(e,n)){n=new Sa(t);try{mi(e,n)}finally{t.stopPropagation()}}}function Sa(e){zn.call(this,e.a),this.type="action"}function Ta(e){zn.call(this,e.a),this.type="beforeaction"}function Ia(e){pi.call(this),this.a=e,e=Je?"focusout":"blur",this.g=ni(this.a,Je?"focusin":"focus",this,!Je),this.h=ni(this.a,e,this,!Je)}function Ea(e,t){pi.call(this),this.g=e||1,this.a=t||h,this.h=k(this.gc,this),this.j=L()}function Aa(e){e.Ka=!1,e.aa&&(e.a.clearTimeout(e.aa),e.aa=null)}function ka(e){Nn.call(this),this.g=e,this.a={}}P(wa,pi),wa.prototype.g=function(e){(13==e.keyCode||nt&&3==e.keyCode)&&_a(this,e)},wa.prototype.h=function(e){_a(this,e)},wa.prototype.o=function(){wa.K.o.call(this),oi(this.a,"keydown",this.g,!1,this),oi(this.a,"click",this.h,!1,this),delete this.a},P(Sa,zn),P(Ta,zn),P(Ia,pi),Ia.prototype.handleEvent=function(e){var t=new zn(e.a);t.type="focusin"==e.type||"focus"==e.type?"focusin":"focusout",mi(this,t)},Ia.prototype.o=function(){Ia.K.o.call(this),si(this.g),si(this.h),delete this.a},P(Ea,pi),(e=Ea.prototype).Ka=!1,e.aa=null,e.gc=function(){if(this.Ka){var e=L()-this.j;0<e&&e<.8*this.g?this.aa=this.a.setTimeout(this.h,this.g-e):(this.aa&&(this.a.clearTimeout(this.aa),this.aa=null),mi(this,"tick"),this.Ka&&(Aa(this),this.start()))}},e.start=function(){this.Ka=!0,this.aa||(this.aa=this.a.setTimeout(this.h,this.g),this.j=L())},e.o=function(){Ea.K.o.call(this),Aa(this),delete this.a},P(ka,Nn);var Ca=[];function xa(e,t,n,i){b(n)||(n&&(Ca[0]=n.toString()),n=Ca);for(var r=0;r<n.length;r++){var o=ni(t,n[r],i||e.handleEvent,!1,e.g||e);if(!o)break;e.a[o.key]=o}}function Ra(e){oe(e.a,(function(e,t){this.a.hasOwnProperty(t)&&si(e)}),e),e.a={}}function La(e){pi.call(this),this.a=null,this.g=e,e=Je||Ze||nt&&!ht("531")&&"TEXTAREA"==e.tagName,this.h=new ka(this),xa(this.h,this.g,e?["keydown","paste","cut","drop","input"]:"input",this)}function Ma(e){null!=e.a&&(h.clearTimeout(e.a),e.a=null)}function Pa(e){return(e=new zn(e.a)).type="input",e}function Da(e,t){pi.call(this),e&&(this.Oa&&Va(this),this.qa=e,this.Na=ni(this.qa,"keypress",this,t),this.Ya=ni(this.qa,"keydown",this.Jb,t,this),this.Oa=ni(this.qa,"keyup",this.Kb,t,this))}ka.prototype.o=function(){ka.K.o.call(this),Ra(this)},ka.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},P(La,pi),La.prototype.handleEvent=function(e){if("input"==e.type)Je&&ht(10)&&0==e.keyCode&&0==e.j||(Ma(this),mi(this,Pa(e)));else if("keydown"!=e.type||function(e){if(e.altKey&&!e.ctrlKey||e.metaKey||112<=e.keyCode&&123>=e.keyCode)return!1;if(ya(e.keyCode))return!0;switch(e.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 252:case 224:case 92:return!1;case 0:return!tt;default:return 166>e.keyCode||183<e.keyCode}}(e)){var t="keydown"==e.type?this.g.value:null;Je&&229==e.keyCode&&(t=null);var n=Pa(e);Ma(this),this.a=function(e,t){if(_(e))t&&(e=k(e,t));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=k(e.handleEvent,e)}return 2147483647<Number(0)?-1:h.setTimeout(e,0)}((function(){this.a=null,this.g.value!=t&&mi(this,n)}),this)}},La.prototype.o=function(){La.K.o.call(this),this.h.m(),Ma(this),delete this.g},P(Da,pi),(e=Da.prototype).qa=null,e.Na=null,e.Ya=null,e.Oa=null,e.R=-1,e.X=-1,e.Ua=!1;var Na={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},Oa={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Fa=!nt||ht("525"),Ua=rt&&tt;function Va(e){e.Na&&(si(e.Na),si(e.Ya),si(e.Oa),e.Na=null,e.Ya=null,e.Oa=null),e.qa=null,e.R=-1,e.X=-1}function Ha(e,t,n,i){zn.call(this,i),this.type="key",this.keyCode=e,this.j=t,this.repeat=n}function Ba(e,t,n,i){this.top=e,this.right=t,this.bottom=n,this.left=i}function ja(e,t){var n=qt(e);return n.defaultView&&n.defaultView.getComputedStyle&&(e=n.defaultView.getComputedStyle(e,null))&&(e[t]||e.getPropertyValue(t))||""}function Ga(e){try{var t=e.getBoundingClientRect()}catch(e){return{left:0,top:0,right:0,bottom:0}}return Je&&e.ownerDocument.body&&(e=e.ownerDocument,t.left-=e.documentElement.clientLeft+e.body.clientLeft,t.top-=e.documentElement.clientTop+e.body.clientTop),t}function Wa(e){var t=qt(e),n=new Ft(0,0),i=t?qt(t):document;return e==(i=!Je||9<=Number(ut)||"CSS1Compat"==Vt(i).a.compatMode?i.documentElement:i.body)||(e=Ga(e),t=Wt(i=Vt(t).a),i=i.parentWindow||i.defaultView,t=Je&&ht("10")&&i.pageYOffset!=t.scrollTop?new Ft(t.scrollLeft,t.scrollTop):new Ft(i.pageXOffset||t.scrollLeft,i.pageYOffset||t.scrollTop),n.a=e.left+t.a,n.g=e.top+t.g),n}(e=Da.prototype).Jb=function(e){(nt||Ze)&&(17==this.R&&!e.ctrlKey||18==this.R&&!e.altKey||rt&&91==this.R&&!e.metaKey)&&(this.X=this.R=-1),-1==this.R&&(e.ctrlKey&&17!=e.keyCode?this.R=17:e.altKey&&18!=e.keyCode?this.R=18:e.metaKey&&91!=e.keyCode&&(this.R=91)),Fa&&!va(e.keyCode,this.R,e.shiftKey,e.ctrlKey,e.altKey,e.metaKey)?this.handleEvent(e):(this.X=ba(e.keyCode),Ua&&(this.Ua=e.altKey))},e.Kb=function(e){this.X=this.R=-1,this.Ua=e.altKey},e.handleEvent=function(e){var t=e.a,n=t.altKey;if(Je&&"keypress"==e.type)var i=this.X,r=13!=i&&27!=i?t.keyCode:0;else(nt||Ze)&&"keypress"==e.type?(i=this.X,r=0<=t.charCode&&63232>t.charCode&&ya(i)?t.charCode:0):Qe&&!nt?r=ya(i=this.X)?t.keyCode:0:("keypress"==e.type?(Ua&&(n=this.Ua),t.keyCode==t.charCode?32>t.keyCode?(i=t.keyCode,r=0):(i=this.X,r=t.charCode):(i=t.keyCode||this.X,r=t.charCode||0)):(i=t.keyCode||this.X,r=t.charCode||0),rt&&63==r&&224==i&&(i=191));var o=i=ba(i);i?63232<=i&&i in Na?o=Na[i]:25==i&&e.shiftKey&&(o=9):t.keyIdentifier&&t.keyIdentifier in Oa&&(o=Oa[t.keyIdentifier]),tt&&Fa&&"keypress"==e.type&&!va(o,this.R,e.shiftKey,e.ctrlKey,n,e.metaKey)||(e=o==this.R,this.R=o,(t=new Ha(o,r,e,t)).altKey=n,mi(this,t))},e.N=function(){return this.qa},e.o=function(){Da.K.o.call(this),Va(this)},P(Ha,zn),Ba.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"},Ba.prototype.ceil=function(){return this.top=Math.ceil(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this.left=Math.ceil(this.left),this},Ba.prototype.floor=function(){return this.top=Math.floor(this.top),this.right=Math.floor(this.right),this.bottom=Math.floor(this.bottom),this.left=Math.floor(this.left),this},Ba.prototype.round=function(){return this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this.left=Math.round(this.left),this};var za={thin:2,medium:4,thick:6};function qa(e,t){if("none"==(e.currentStyle?e.currentStyle[t+"Style"]:null))return 0;var n=e.currentStyle?e.currentStyle[t+"Width"]:null;if(n in za)e=za[n];else if(/^\d+px?$/.test(n))e=parseInt(n,10);else{t=e.style.left;var i=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,e.style.left=n,n=e.style.pixelLeft,e.style.left=t,e.runtimeStyle.left=i,e=+n}return e}function Ka(){}function $a(e){pi.call(this),this.s=e||Vt(),this.cb=null,this.na=!1,this.g=null,this.L=void 0,this.oa=this.Ea=this.Y=null}function Ya(e,t){return e.g?Bt(t,e.g||e.s.a):null}function Xa(e){return e.L||(e.L=new ka(e)),e.L}function Qa(e,t){e.Ea&&U(e.Ea,t,void 0)}function Ja(e,t){var n=$t(e,"firebaseui-textfield");t?(pa(e,"firebaseui-input-invalid"),fa(e,"firebaseui-input"),n&&pa(n,"firebaseui-textfield-invalid")):(pa(e,"firebaseui-input"),fa(e,"firebaseui-input-invalid"),n&&fa(n,"firebaseui-textfield-invalid"))}function Za(e,t,n){Un(e,C(Vn,t=new La(t))),xa(Xa(e),t,"input",n)}function el(e,t,n){Un(e,C(Vn,t=new Da(t))),xa(Xa(e),t,"key",(function(e){13==e.keyCode&&(e.stopPropagation(),e.preventDefault(),n(e))}))}function tl(e,t,n){Un(e,C(Vn,t=new wa(t))),xa(Xa(e),t,"action",(function(e){e.stopPropagation(),e.preventDefault(),n(e)}))}function nl(e){fa(e,"firebaseui-hidden")}function il(e,t){t&&Kt(e,t),pa(e,"firebaseui-hidden")}function rl(e){return!da(e,"firebaseui-hidden")&&"none"!=e.style.display}function ol(e){var t=(e=e||{}).email,n=e.disabled,i='<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-email-input">';return i=e.wc?i+"Enter new email address":i+"Email",i+='</label><input type="email" name="email" id="ui-sign-in-email-input" autocomplete="username" class="mdl-textfield__input firebaseui-input firebaseui-id-email" value="'+pn(null!=t?t:"")+'"'+(n?"disabled":"")+'></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-email-error"></p></div>',cn(i)}function sl(e){var t='<button type="submit" class="firebaseui-id-submit firebaseui-button mdl-button mdl-js-button mdl-button--raised mdl-button--colored">';return t=(e=(e=e||{}).label)?t+sn(e):t+"Next",cn(t+"</button>")}function al(){var e=""+sl({label:dn("Sign In")});return cn(e)}function ll(){var e=""+sl({label:dn("Save")});return cn(e)}function ul(){var e=""+sl({label:dn("Continue")});return cn(e)}function cl(e){var t='<div class="firebaseui-new-password-component"><div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-new-password-input">';return t=(e=(e=e||{}).label)?t+sn(e):t+"Choose password",cn(t+'</label><input type="password" name="newPassword" id="ui-sign-in-new-password-input" autocomplete="new-password" class="mdl-textfield__input firebaseui-input firebaseui-id-new-password"></div><a href="javascript:void(0)" class="firebaseui-input-floating-button firebaseui-id-password-toggle firebaseui-input-toggle-on firebaseui-input-toggle-blur"></a><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-new-password-error"></p></div></div>')}function hl(){var e='<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-password-input">';return cn((e={}.current?e+"Current password":e+"Password")+'</label><input type="password" name="password" id="ui-sign-in-password-input" autocomplete="current-password" class="mdl-textfield__input firebaseui-input firebaseui-id-password"></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-password-error"></p></div>')}function dl(){return cn('<a class="firebaseui-link firebaseui-id-secondary-link" href="javascript:void(0)">Trouble signing in?</a>')}function fl(e){var t='<button class="firebaseui-id-secondary-link firebaseui-button mdl-button mdl-js-button mdl-button--primary">';return t=(e=(e=e||{}).label)?t+sn(e):t+"Cancel",cn(t+"</button>")}function pl(e){var t="";return e.F&&e.D&&(t+='<ul class="firebaseui-tos-list firebaseui-tos"><li class="firebaseui-inline-list-item"><a href="javascript:void(0)" class="firebaseui-link firebaseui-tos-link" target="_blank">Terms of Service</a></li><li class="firebaseui-inline-list-item"><a href="javascript:void(0)" class="firebaseui-link firebaseui-pp-link" target="_blank">Privacy Policy</a></li></ul>'),cn(t)}function ml(e){var t="";return e.F&&e.D&&(t+='<p class="firebaseui-tos firebaseui-tospp-full-message">By continuing, you are indicating that you accept our <a href="javascript:void(0)" class="firebaseui-link firebaseui-tos-link" target="_blank">Terms of Service</a> and <a href="javascript:void(0)" class="firebaseui-link firebaseui-pp-link" target="_blank">Privacy Policy</a>.</p>'),cn(t)}function gl(e){return e='<div class="firebaseui-info-bar firebaseui-id-info-bar"><p class="firebaseui-info-bar-message">'+sn(e.message)+'&nbsp;&nbsp;<a href="javascript:void(0)" class="firebaseui-link firebaseui-id-dismiss-info-bar">Dismiss</a></p></div>',cn(e)}function vl(e){var t=e.content;return e=e.Ab,cn('<dialog class="mdl-dialog firebaseui-dialog firebaseui-id-dialog'+(e?" "+pn(e):"")+'">'+sn(t)+"</dialog>")}function yl(e){var t=e.message;return cn(vl({content:fn('<div class="firebaseui-dialog-icon-wrapper"><div class="'+pn(e.Ma)+' firebaseui-dialog-icon"></div></div><div class="firebaseui-progress-dialog-message">'+sn(t)+"</div>")}))}function bl(e){for(var t='<div class="firebaseui-list-box-actions">',n=(e=e.items).length,i=0;i<n;i++){var r=e[i];t+='<button type="button" data-listboxid="'+pn(r.id)+'" class="mdl-button firebaseui-id-list-box-dialog-button firebaseui-list-box-dialog-button">'+(r.Ma?'<div class="firebaseui-list-box-icon-wrapper"><div class="firebaseui-list-box-icon '+pn(r.Ma)+'"></div></div>':"")+'<div class="firebaseui-list-box-label-wrapper">'+sn(r.label)+"</div></button>"}return t=""+vl({Ab:dn("firebaseui-list-box-dialog"),content:fn(t+"</div>")}),cn(t)}function wl(e){return cn((e=e||{}).tb?'<div class="mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-busy-indicator firebaseui-id-busy-indicator"></div>':'<div class="mdl-progress mdl-js-progress mdl-progress__indeterminate firebaseui-busy-indicator firebaseui-id-busy-indicator"></div>')}function _l(e,t){return un((e=(e=e||{}).ga).S?e.S:t.hb[e.providerId]?""+t.hb[e.providerId]:e.providerId&&0==e.providerId.indexOf("saml.")||e.providerId&&0==e.providerId.indexOf("oidc.")?e.providerId.substring(5):""+e.providerId)}function Sl(e){El(e,"upgradeElement")}function Tl(e){El(e,"downgradeElements")}v(Ka),Ka.prototype.a=0,P($a,pi),(e=$a.prototype).Lb=Ka.Xa(),e.N=function(){return this.g},e.Za=function(e){if(this.Y&&this.Y!=e)throw Error("Method not supported");$a.K.Za.call(this,e)},e.kb=function(){this.g=this.s.a.createElement("DIV")},e.render=function(e){if(this.na)throw Error("Component already rendered");this.g||this.kb(),e?e.insertBefore(this.g,null):this.s.a.body.appendChild(this.g),this.Y&&!this.Y.na||this.v()},e.v=function(){this.na=!0,Qa(this,(function(e){!e.na&&e.N()&&e.v()}))},e.ya=function(){Qa(this,(function(e){e.na&&e.ya()})),this.L&&Ra(this.L),this.na=!1},e.o=function(){this.na&&this.ya(),this.L&&(this.L.m(),delete this.L),Qa(this,(function(e){e.m()})),this.g&&zt(this.g),this.Y=this.g=this.oa=this.Ea=null,$a.K.o.call(this)},e.removeChild=function(e,t){if(e){var n=f(e)?e:e.cb||(e.cb=":"+(e.Lb.a++).toString(36));if(this.oa&&n?e=(null!==(e=this.oa)&&n in e?e[n]:void 0)||null:e=null,n&&e){var i=this.oa;if(n in i&&delete i[n],G(this.Ea,e),t&&(e.ya(),e.g&&zt(e.g)),null==(t=e))throw Error("Unable to set parent component");t.Y=null,$a.K.Za.call(t,null)}}if(!e)throw Error("Child is not in parent component");return e},gl.a="firebaseui.auth.soy2.element.infoBar",yl.a="firebaseui.auth.soy2.element.progressDialog",bl.a="firebaseui.auth.soy2.element.listBoxDialog",wl.a="firebaseui.auth.soy2.element.busyIndicator";var Il=["mdl-js-textfield","mdl-js-progress","mdl-js-spinner","mdl-js-button"];function El(e,t){e&&window.componentHandler&&window.componentHandler[t]&&Il.forEach((function(n){da(e,n)&&window.componentHandler[t](e),U(Ht(n,e),(function(e){window.componentHandler[t](e)}))}))}function Al(e,t,n){if(kl.call(this),document.body.appendChild(e),e.showModal||window.dialogPolyfill.registerDialog(e),e.showModal(),Sl(e),t&&tl(this,e,(function(t){var n=e.getBoundingClientRect();(t.clientX<n.left||n.left+n.width<t.clientX||t.clientY<n.top||n.top+n.height<t.clientY)&&kl.call(this)})),!n){var i=this.N().parentElement||this.N().parentNode;if(i){var r=this;this.da=function(){if(e.open){var t=e.getBoundingClientRect().height,n=i.getBoundingClientRect().height,o=i.getBoundingClientRect().top-document.body.getBoundingClientRect().top,s=i.getBoundingClientRect().left-document.body.getBoundingClientRect().left,a=e.getBoundingClientRect().width,l=i.getBoundingClientRect().width;e.style.top=(o+(n-t)/2).toString()+"px",t=s+(l-a)/2,e.style.left=t.toString()+"px",e.style.right=(document.body.getBoundingClientRect().width-t-a).toString()+"px"}else window.removeEventListener("resize",r.da)},this.da(),window.addEventListener("resize",this.da,!1)}}}function kl(){var e=Cl.call(this);e&&(Tl(e),e.open&&e.close(),zt(e),this.da&&window.removeEventListener("resize",this.da))}function Cl(){return Bt("firebaseui-id-dialog")}function xl(){zt(Rl.call(this))}function Rl(){return Ya(this,"firebaseui-id-info-bar")}function Ll(){return Ya(this,"firebaseui-id-dismiss-info-bar")}var Ml={xa:{"google.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg","github.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/github.svg","facebook.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/facebook.svg","twitter.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/twitter.svg",password:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/mail.svg",phone:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/phone.svg",anonymous:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/anonymous.png","microsoft.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/microsoft.svg","yahoo.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/yahoo.svg","apple.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/apple.png",saml:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/saml.svg",oidc:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/oidc.svg"},wa:{"google.com":"#ffffff","github.com":"#333333","facebook.com":"#3b5998","twitter.com":"#55acee",password:"#db4437",phone:"#02bd7e",anonymous:"#f4b400","microsoft.com":"#2F2F2F","yahoo.com":"#720E9E","apple.com":"#000000",saml:"#007bff",oidc:"#007bff"},hb:{"google.com":"Google","github.com":"GitHub","facebook.com":"Facebook","twitter.com":"Twitter",password:"Password",phone:"Phone",anonymous:"Guest","microsoft.com":"Microsoft","yahoo.com":"Yahoo","apple.com":"Apple"}};function Pl(e,t,n){for(var i in Wn.call(this,e,t),n)this[i]=n[i]}function Dl(e,t,n,i,r){$a.call(this,n),this.fb=e,this.eb=t,this.Fa=!1,this.Ga=i||null,this.A=this.ca=null,this.Z=se(Ml),le(this.Z,r||{})}function Nl(e){return e.N().parentElement||e.N().parentNode}function Ol(e,t,n){el(e,t,(function(){n.focus()}))}function Fl(e,t,n){el(e,t,(function(){n()}))}function Ul(e,t,n){t=(e=e||{}).Va;var i=e.ia;return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-sign-in"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in with email</h1></div><div class="firebaseui-card-content"><div class="firebaseui-relative-wrapper">'+ol(e)+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(t?fl(null):"")+sl(null)+'</div></div><div class="firebaseui-card-footer">'+(i?ml(n):pl(n))+"</div></form></div>",cn(e)}function Vl(e,t,n){return t=(e=e||{}).ia,e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-sign-in"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content">'+ol(e)+hl()+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+dl()+'</div><div class="firebaseui-form-actions">'+al()+'</div></div><div class="firebaseui-card-footer">'+(t?ml(n):pl(n))+"</div></form></div>",cn(e)}function Hl(e,t,n){var i=(e=e||{}).Tb;t=e.Ta;var r=e.ia,o='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-sign-up"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Create account</h1></div><div class="firebaseui-card-content">'+ol(e);return i?(e='<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-name-input">First &amp; last name</label><input type="text" name="name" id="ui-sign-in-name-input" autocomplete="name" class="mdl-textfield__input firebaseui-input firebaseui-id-name" value="'+pn(null!=(e=(e=e||{}).name)?e:"")+'"></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-name-error"></p></div>',e=cn(e)):e="",n=o+e+cl(null)+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(t?fl(null):"")+ll()+'</div></div><div class="firebaseui-card-footer">'+(r?ml(n):pl(n))+"</div></form></div>",cn(n)}function Bl(e,t,n){return t=(e=e||{}).Ta,e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-recovery"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Recover password</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Get instructions sent to this email that explain how to reset your password</p>'+ol(e)+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(t?fl(null):"")+sl({label:dn("Send")})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(e)}function jl(e,t,n){t=e.G;var i="";return i+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-recovery-email-sent"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Check your email</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(e="Follow the instructions sent to <strong>"+sn(e.email)+"</strong> to recover your password")+'</p></div><div class="firebaseui-card-actions">',t&&(i+='<div class="firebaseui-form-actions">'+sl({label:dn("Done")})+"</div>"),i+='</div><div class="firebaseui-card-footer">'+pl(n)+"</div></div>",cn(i)}function Gl(e,t,n){return cn('<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-callback"><div class="firebaseui-callback-indicator-container">'+wl(null)+"</div></div>")}function Wl(e,t,n){return cn('<div class="firebaseui-container firebaseui-id-page-spinner">'+wl({tb:!0})+"</div>")}function zl(){return cn('<div class="firebaseui-container firebaseui-id-page-blank firebaseui-use-spinner"></div>')}function ql(e,t,n){return t="",t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-sent"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign-in email sent</h1></div><div class="firebaseui-card-content"><div class="firebaseui-email-sent"></div><p class="firebaseui-text">'+(e="A sign-in email with additional instructions was sent to <strong>"+sn(e.email)+"</strong>. Check your email to complete sign-in.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+cn('<a class="firebaseui-link firebaseui-id-trouble-getting-email-link" href="javascript:void(0)">Trouble getting email?</a>')+'</div><div class="firebaseui-form-actions">'+fl({label:dn("Back")})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(t)}function Kl(e,t,n){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-not-received"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Trouble getting email?</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Try these common fixes:<ul><li>Check if the email was marked as spam or filtered.</li><li>Check your internet connection.</li><li>Check that you did not misspell your email.</li><li>Check that your inbox space is not running out or other inbox settings related issues.</li></ul></p><p class="firebaseui-text">If the steps above didn\'t work, you can resend the email. Note that this will deactivate the link in the older email.</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+cn('<a class="firebaseui-link firebaseui-id-resend-email-link" href="javascript:void(0)">Resend</a>')+'</div><div class="firebaseui-form-actions">'+fl({label:dn("Back")})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(e)}function $l(e,t,n){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-confirmation"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Confirm email</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Confirm your email to complete sign in</p><div class="firebaseui-relative-wrapper">'+ol(e)+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+fl(null)+sl(null)+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(e)}function Yl(){var e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-different-device-error"><div class="firebaseui-card-header"><h1 class="firebaseui-title">New device or browser detected</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Try opening the link using the same device or browser where you started the sign-in process.</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+fl({label:dn("Dismiss")})+"</div></div></div>";return cn(e)}function Xl(){var e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-anonymous-user-mismatch"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Session ended</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">The session associated with this sign-in request has either expired or was cleared.</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+fl({label:dn("Dismiss")})+"</div></div></div>";return cn(e)}function Ql(e,t,n){return t="",t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-linking"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">You already have an account</h2><p class="firebaseui-text">'+(e="You’ve already used <strong>"+sn(e.email)+"</strong> to sign in. Enter your password for that account.")+"</p>"+hl()+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+dl()+'</div><div class="firebaseui-form-actions">'+al()+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(t)}function Jl(e,t,n){var i=e.email;return t="",e=dn(e=""+_l(e,n)),t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-linking"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">You already have an account</h2><p class="firebaseui-text firebaseui-text-justify">'+(i="You’ve already used <strong>"+sn(i)+"</strong>. You can connect your <strong>"+sn(e)+"</strong> account with <strong>"+sn(i)+"</strong> by signing in with email link below.")+'<p class="firebaseui-text firebaseui-text-justify">'+(e="For this flow to successfully connect your "+sn(e)+" account with this email, you have to open the link on the same device or browser.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+al()+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(t)}function Zl(e,t,n){t="";var i=""+_l(e,n);return t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-linking-different-device"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text firebaseui-text-justify">'+(e="You originally intended to connect <strong>"+sn(i=dn(i))+"</strong> to your email account but have opened the link on a different device where you are not signed in.")+'</p><p class="firebaseui-text firebaseui-text-justify">'+(i="If you still want to connect your <strong>"+sn(i)+"</strong> account, open the link on the same device where you started sign-in. Otherwise, tap Continue to sign-in on this device.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+ul()+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(t)}function eu(e,t,n){var i=e.email;return t="",e=dn(e=""+_l(e,n)),t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-federated-linking"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">You already have an account</h2><p class="firebaseui-text">'+(i="You’ve already used <strong>"+sn(i)+"</strong>. Sign in with "+sn(e)+" to continue.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+sl({label:dn("Sign in with "+e)})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(t)}function tu(e,t,n){var i=(e=e||{}).kc;t=e.yb,e=e.Eb;var r='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-unauthorized-user"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Not Authorized</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">';return i?r+=i="<strong>"+sn(i)+"</strong> is not authorized to view the requested page.":r+="User is not authorized to view the requested page.",r+="</p>",t&&(r+='<p class="firebaseui-text firebaseui-id-unauthorized-user-admin-email">'+(t="Please contact <strong>"+sn(t)+"</strong> for authorization.")+"</p>"),r+='</div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">',e&&(r+='<a class="firebaseui-link firebaseui-id-unauthorized-user-help-link" href="javascript:void(0)" target="_blank">Learn More</a>'),r+='</div><div class="firebaseui-form-actions">'+fl({label:dn("Back")})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(r)}function nu(e,t,n){return t="",t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-unsupported-provider"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(e="To continue sign in with <strong>"+sn(e.email)+"</strong> on this device, you have to recover the password.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+fl(null)+sl({label:dn("Recover password")})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(t)}function iu(e){var t="";return t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-reset"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Reset your password</h1></div><div class="firebaseui-card-content">'+('<p class="firebaseui-text">for <strong>'+sn(e.email)+"</strong></p>")+cl(function(e){function t(){}var n={label:dn("New password")};for(var i in t.prototype=e,e=new t,n)e[i]=n[i];return e}(e))+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+ll()+"</div></div></form></div>",cn(t)}function ru(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-reset-success"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Password changed</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">You can now sign in with your new password</p></div><div class="firebaseui-card-actions">'+((e=e||{}).G?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(e)}function ou(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-reset-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Try resetting your password again</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Your request to reset your password has expired or the link has already been used</p></div><div class="firebaseui-card-actions">'+((e=e||{}).G?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(e)}function su(e){var t=e.G,n="";return n+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-change-revoke-success"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Updated email address</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(e="Your sign-in email address has been changed back to <strong>"+sn(e.email)+"</strong>.")+'</p><p class="firebaseui-text">If you didn’t ask to change your sign-in email, it’s possible someone is trying to access your account and you should <a class="firebaseui-link firebaseui-id-reset-password-link" href="javascript:void(0)">change your password right away</a>.</p></div><div class="firebaseui-card-actions">'+(t?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></form></div>",cn(n)}function au(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-change-revoke-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Unable to update your email address</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">There was a problem changing your sign-in email back.</p><p class="firebaseui-text">If you try again and still can’t reset your email, try asking your administrator for help.</p></div><div class="firebaseui-card-actions">'+((e=e||{}).G?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(e)}function lu(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-verification-success"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Your email has been verified</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">You can now sign in with your new account</p></div><div class="firebaseui-card-actions">'+((e=e||{}).G?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(e)}function uu(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-verification-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Try verifying your email again</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Your request to verify your email has expired or the link has already been used</p></div><div class="firebaseui-card-actions">'+((e=e||{}).G?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(e)}function cu(e){var t=e.G,n="";return n+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-verify-and-change-email-success"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Your email has been verified and changed</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(e="You can now sign in with your new email <strong>"+sn(e.email)+"</strong>.")+'</p></div><div class="firebaseui-card-actions">'+(t?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(n)}function hu(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-verify-and-change-email-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Try updating your email again</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Your request to verify and update your email has expired or the link has already been used.</p></div><div class="firebaseui-card-actions">'+((e=e||{}).G?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(e)}function du(e){var t=e.factorId,n=e.phoneNumber;e=e.G;var i='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-revert-second-factor-addition-success"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Removed second factor</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">';if("phone"===t)i+=t="The <strong>"+sn(t)+" "+sn(n)+"</strong> was removed as a second authentication step.";else i+="The device or app was removed as a second authentication step.";return i+='</p><p class="firebaseui-text">If you don\'t recognize this device, someone might be trying to access your account. Consider <a class="firebaseui-link firebaseui-id-reset-password-link" href="javascript:void(0)">changing your password right away</a>.</p></div><div class="firebaseui-card-actions">'+(e?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></form></div>",cn(i)}function fu(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-revert-second-factor-addition-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Couldn\'t remove your second factor</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Something went wrong removing your second factor.</p><p class="firebaseui-text">Try removing it again. If that doesn\'t work, contact support for assistance.</p></div><div class="firebaseui-card-actions">'+((e=e||{}).G?'<div class="firebaseui-form-actions">'+ul()+"</div>":"")+"</div></div>",cn(e)}function pu(e){var t=e.zb;return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-recoverable-error"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Error encountered</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+sn(e.errorMessage)+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">',t&&(e+=sl({label:dn("Retry")})),cn(e+"</div></div></div>")}function mu(e){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-unrecoverable-error"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Error encountered</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+sn(e.errorMessage)+"</p></div></div>",cn(e)}function gu(e,t,n){var i=e.Qb;return t="",t+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-mismatch"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">'+(e="Continue with "+sn(e.jc)+"?")+'</h2><p class="firebaseui-text">'+(i="You originally wanted to sign in with "+sn(i))+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+fl(null)+sl({label:dn("Continue")})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form></div>",cn(t)}function vu(e,t,n){var i='<div class="firebaseui-container firebaseui-page-provider-sign-in firebaseui-id-page-provider-sign-in firebaseui-use-spinner"><div class="firebaseui-card-content"><form onsubmit="return false;"><ul class="firebaseui-idp-list">';t=(e=e.Sb).length;for(var r=0;r<t;r++){var o={ga:e[r]},s=n,a=(o=o||{}).ga,l=o,u="";switch((l=l||{}).ga.providerId){case"google.com":u+="firebaseui-idp-google";break;case"github.com":u+="firebaseui-idp-github";break;case"facebook.com":u+="firebaseui-idp-facebook";break;case"twitter.com":u+="firebaseui-idp-twitter";break;case"phone":u+="firebaseui-idp-phone";break;case"anonymous":u+="firebaseui-idp-anonymous";break;case"password":u+="firebaseui-idp-password";break;default:u+="firebaseui-idp-generic"}l=(l='<button class="firebaseui-idp-button mdl-button mdl-js-button mdl-button--raised '+pn(un(u))+' firebaseui-id-idp-button" data-provider-id="'+pn(a.providerId)+'" style="background-color:')+pn(gn(un((u=(u=(u=o)||{}).ga).ta?u.ta:s.wa[u.providerId]?""+s.wa[u.providerId]:0==u.providerId.indexOf("saml.")?""+s.wa.saml:0==u.providerId.indexOf("oidc.")?""+s.wa.oidc:""+s.wa.password)))+'"><span class="firebaseui-idp-icon-wrapper"><img class="firebaseui-idp-icon" alt="" src="';var c=o;u=s,c=(c=c||{}).ga,u=hn(c.za?mn(c.za):u.xa[c.providerId]?mn(u.xa[c.providerId]):0==c.providerId.indexOf("saml.")?mn(u.xa.saml):0==c.providerId.indexOf("oidc.")?mn(u.xa.oidc):mn(u.xa.password)),l=l+pn(mn(u))+'"></span>',"password"==a.providerId?(l+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',a.V?l+=sn(a.V):a.S?l+=o="Sign in with "+sn(_l(o,s)):l+="Sign in with email",l+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">',l=a.S?l+sn(a.S):l+"Email",l+="</span>"):"phone"==a.providerId?(l+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',a.V?l+=sn(a.V):a.S?l+=o="Sign in with "+sn(_l(o,s)):l+="Sign in with phone",l+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">',l=a.S?l+sn(a.S):l+"Phone",l+="</span>"):"anonymous"==a.providerId?(l+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',a.V?l+=sn(a.V):a.S?l+=o="Sign in with "+sn(_l(o,s)):l+="Continue as guest",l+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">',l=a.S?l+sn(a.S):l+"Guest",l+="</span>"):(l+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',a.V?l+=sn(a.V):l+=u="Sign in with "+sn(_l(o,s)),l+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">'+(a.S?sn(a.S):sn(_l(o,s)))+"</span>"),i+='<li class="firebaseui-list-item">'+(a=cn(l+"</button>"))+"</li>"}return i+='</ul></form></div><div class="firebaseui-card-footer firebaseui-provider-sign-in-footer">'+ml(n)+"</div></div>",cn(i)}function yu(e,t,n){var i,r=(e=e||{}).Gb,o=e.Va;return t=e.ia,e='<div class="firebaseui-phone-number"><button class="firebaseui-id-country-selector firebaseui-country-selector mdl-button mdl-js-button"><span class="firebaseui-flag firebaseui-country-selector-flag firebaseui-id-country-selector-flag"></span><span class="firebaseui-id-country-selector-code"></span></button><div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label firebaseui-textfield firebaseui-phone-input-wrapper"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-phone-number-input">Phone number</label><input type="tel" name="phoneNumber" id="ui-sign-in-phone-number-input" class="mdl-textfield__input firebaseui-input firebaseui-id-phone-number" value="'+pn(null!=(e=(e=e||{}).Aa)?e:"")+'"></div></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-phone-number-error firebaseui-id-phone-number-error"></p></div>',i=(e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-phone-sign-in-start"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Enter your phone number</h1></div><div class="firebaseui-card-content"><div class="firebaseui-relative-wrapper">'+cn(e))+(i=r?cn('<div class="firebaseui-recaptcha-wrapper"><div class="firebaseui-recaptcha-container"></div><div class="firebaseui-error-wrapper firebaseui-recaptcha-error-wrapper"><p class="firebaseui-error firebaseui-hidden firebaseui-id-recaptcha-error"></p></div></div>'):"")+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(o?fl(null):"")+sl({label:dn("Verify")})+'</div></div><div class="firebaseui-card-footer">',t?(t='<p class="firebaseui-tos firebaseui-phone-tos">',t=n.F&&n.D?t+'By tapping Verify, you are indicating that you accept our <a href="javascript:void(0)" class="firebaseui-link firebaseui-tos-link" target="_blank">Terms of Service</a> and <a href="javascript:void(0)" class="firebaseui-link firebaseui-pp-link" target="_blank">Privacy Policy</a>. An SMS may be sent. Message &amp; data rates may apply.':t+"By tapping Verify, an SMS may be sent. Message &amp; data rates may apply.",n=cn(t+"</p>")):n=cn('<p class="firebaseui-tos firebaseui-phone-sms-notice">By tapping Verify, an SMS may be sent. Message &amp; data rates may apply.</p>')+pl(n),cn(i+n+"</div></form></div>")}function bu(e,t,n){var i="";return e='Enter the 6-digit code we sent to <a class="firebaseui-link firebaseui-change-phone-number-link firebaseui-id-change-phone-number-link" href="javascript:void(0)">&lrm;'+sn(t=(e=e||{}).phoneNumber)+"</a>",sn(t),t=i,n='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-phone-sign-in-finish"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Verify your phone number</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+e+"</p>"+(i=cn('<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-phone-confirmation-code-input">6-digit code</label><input type="number" name="phoneConfirmationCode" id="ui-sign-in-phone-confirmation-code-input" class="mdl-textfield__input firebaseui-input firebaseui-id-phone-confirmation-code"></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-phone-confirmation-code-error"></p></div>'))+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+fl(null)+sl({label:dn("Continue")})+'</div></div><div class="firebaseui-card-footer">'+pl(n)+"</div></form>",e=cn('<div class="firebaseui-resend-container"><span class="firebaseui-id-resend-countdown"></span><a href="javascript:void(0)" class="firebaseui-id-resend-link firebaseui-hidden firebaseui-link">Resend</a></div>'),cn(t+(n+e+"</div>"))}function wu(){return cn('<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-sign-out"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign Out</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">You are now successfully signed out.</p></div></div>')}function _u(e,t,n){var i='<div class="firebaseui-container firebaseui-page-select-tenant firebaseui-id-page-select-tenant"><div class="firebaseui-card-content"><form onsubmit="return false;"><ul class="firebaseui-tenant-list">';t=(e=e.ec).length;for(var r=0;r<t;r++){var o=e[r],s="",a=sn(o.displayName),l=o.tenantId?o.tenantId:"top-level-project";s+='<button class="firebaseui-tenant-button mdl-button mdl-js-button mdl-button--raised firebaseui-tenant-selection-'+pn(l=dn(l))+' firebaseui-id-tenant-selection-button"'+(o.tenantId?'data-tenant-id="'+pn(o.tenantId)+'"':"")+'style="background-color:'+pn(gn(o.ta))+'"><span class="firebaseui-idp-icon-wrapper"><img class="firebaseui-idp-icon" alt="" src="'+pn(mn(o.za))+'"></span><span class="firebaseui-idp-text firebaseui-idp-text-long">',o.V?s+=sn(o.V):s+=o="Sign in to "+sn(o.displayName),i+='<li class="firebaseui-list-item">'+(s=cn(s+'</span><span class="firebaseui-idp-text firebaseui-idp-text-short">'+a+"</span></button>"))+"</li>"}return i+='</ul></form></div><div class="firebaseui-card-footer firebaseui-provider-sign-in-footer">'+ml(n)+"</div></div>",cn(i)}function Su(e,t,n){return e='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-provider-match-by-email"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><div class="firebaseui-relative-wrapper">'+ol(null)+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+sl(null)+'</div></div><div class="firebaseui-card-footer">'+ml(n)+"</div></form></div>",cn(e)}function Tu(){return Ya(this,"firebaseui-id-submit")}function Iu(){return Ya(this,"firebaseui-id-secondary-link")}function Eu(e,t){tl(this,Tu.call(this),(function(t){e(t)}));var n=Iu.call(this);n&&t&&tl(this,n,(function(e){t(e)}))}function Au(){return Ya(this,"firebaseui-id-password")}function ku(){return Ya(this,"firebaseui-id-password-error")}function Cu(){var e=Au.call(this),t=ku.call(this);Za(this,e,(function(){rl(t)&&(Ja(e,!0),nl(t))}))}function xu(){var e=Au.call(this),t=ku.call(this);return ma(e)?(Ja(e,!0),nl(t),t=!0):(Ja(e,!1),il(t,un("Enter your password").toString()),t=!1),t?ma(e):null}function Ru(e,t,n,i,r,o){Dl.call(this,Ql,{email:e},o,"passwordLinking",{F:i,D:r}),this.w=t,this.H=n}P(Pl,Wn),P(Dl,$a),(e=Dl.prototype).kb=function(){var e=tn(this.fb,this.eb,this.Z,this.s);Sl(e),this.g=e},e.v=function(){if(Dl.K.v.call(this),bi(Nl(this),new Pl("pageEnter",Nl(this),{pageId:this.Ga})),this.bb()&&this.Z.F){var e=this.Z.F;tl(this,this.bb(),(function(){e()}))}if(this.ab()&&this.Z.D){var t=this.Z.D;tl(this,this.ab(),(function(){t()}))}},e.ya=function(){bi(Nl(this),new Pl("pageExit",Nl(this),{pageId:this.Ga})),Dl.K.ya.call(this)},e.o=function(){window.clearTimeout(this.ca),this.eb=this.fb=this.ca=null,this.Fa=!1,this.A=null,Tl(this.N()),Dl.K.o.call(this)},e.I=function(e,t,n,i){function r(){if(o.T)return null;o.Fa=!1,window.clearTimeout(o.ca),o.ca=null,o.A&&(Tl(o.A),zt(o.A),o.A=null)}var o=this;return o.Fa?null:(function(e){e.Fa=!0;var t=da(e.N(),"firebaseui-use-spinner");e.ca=window.setTimeout((function(){e.N()&&null===e.A&&(e.A=tn(wl,{tb:t},null,e.s),e.N().appendChild(e.A),Sl(e.A))}),500)}(o),e.apply(null,t).then(n,i).then(r,r))},x(Dl.prototype,{a:function(e){xl.call(this);var t=tn(gl,{message:e},null,this.s);this.N().appendChild(t),tl(this,Ll.call(this),(function(){zt(t)}))},yc:xl,Ac:Rl,zc:Ll,$:function(e,t){e=tn(yl,{Ma:e,message:t},null,this.s),Al.call(this,e)},h:kl,Cb:Cl,Cc:function(){return Ya(this,"firebaseui-tos")},bb:function(){return Ya(this,"firebaseui-tos-link")},ab:function(){return Ya(this,"firebaseui-pp-link")},Dc:function(){return Ya(this,"firebaseui-tos-list")}}),Ul.a="firebaseui.auth.soy2.page.signIn",Vl.a="firebaseui.auth.soy2.page.passwordSignIn",Hl.a="firebaseui.auth.soy2.page.passwordSignUp",Bl.a="firebaseui.auth.soy2.page.passwordRecovery",jl.a="firebaseui.auth.soy2.page.passwordRecoveryEmailSent",Gl.a="firebaseui.auth.soy2.page.callback",Wl.a="firebaseui.auth.soy2.page.spinner",zl.a="firebaseui.auth.soy2.page.blank",ql.a="firebaseui.auth.soy2.page.emailLinkSignInSent",Kl.a="firebaseui.auth.soy2.page.emailNotReceived",$l.a="firebaseui.auth.soy2.page.emailLinkSignInConfirmation",Yl.a="firebaseui.auth.soy2.page.differentDeviceError",Xl.a="firebaseui.auth.soy2.page.anonymousUserMismatch",Ql.a="firebaseui.auth.soy2.page.passwordLinking",Jl.a="firebaseui.auth.soy2.page.emailLinkSignInLinking",Zl.a="firebaseui.auth.soy2.page.emailLinkSignInLinkingDifferentDevice",eu.a="firebaseui.auth.soy2.page.federatedLinking",tu.a="firebaseui.auth.soy2.page.unauthorizedUser",nu.a="firebaseui.auth.soy2.page.unsupportedProvider",iu.a="firebaseui.auth.soy2.page.passwordReset",ru.a="firebaseui.auth.soy2.page.passwordResetSuccess",ou.a="firebaseui.auth.soy2.page.passwordResetFailure",su.a="firebaseui.auth.soy2.page.emailChangeRevokeSuccess",au.a="firebaseui.auth.soy2.page.emailChangeRevokeFailure",lu.a="firebaseui.auth.soy2.page.emailVerificationSuccess",uu.a="firebaseui.auth.soy2.page.emailVerificationFailure",cu.a="firebaseui.auth.soy2.page.verifyAndChangeEmailSuccess",hu.a="firebaseui.auth.soy2.page.verifyAndChangeEmailFailure",du.a="firebaseui.auth.soy2.page.revertSecondFactorAdditionSuccess",fu.a="firebaseui.auth.soy2.page.revertSecondFactorAdditionFailure",pu.a="firebaseui.auth.soy2.page.recoverableError",mu.a="firebaseui.auth.soy2.page.unrecoverableError",gu.a="firebaseui.auth.soy2.page.emailMismatch",vu.a="firebaseui.auth.soy2.page.providerSignIn",yu.a="firebaseui.auth.soy2.page.phoneSignInStart",bu.a="firebaseui.auth.soy2.page.phoneSignInFinish",wu.a="firebaseui.auth.soy2.page.signOut",_u.a="firebaseui.auth.soy2.page.selectTenant",Su.a="firebaseui.auth.soy2.page.providerMatchByEmail",a(Ru,Dl),Ru.prototype.v=function(){this.P(),this.M(this.w,this.H),Fl(this,this.i(),this.w),this.i().focus(),Dl.prototype.v.call(this)},Ru.prototype.o=function(){this.w=null,Dl.prototype.o.call(this)},Ru.prototype.j=function(){return ma(Ya(this,"firebaseui-id-email"))},x(Ru.prototype,{i:Au,B:ku,P:Cu,u:xu,ea:Tu,ba:Iu,M:Eu});var Lu=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;function Mu(){return Ya(this,"firebaseui-id-email")}function Pu(){return Ya(this,"firebaseui-id-email-error")}function Du(e){var t=Mu.call(this),n=Pu.call(this);Za(this,t,(function(){rl(n)&&(Ja(t,!0),nl(n))})),e&&el(this,t,(function(){e()}))}function Nu(){return Y(ma(Mu.call(this))||"")}function Ou(){var e=Mu.call(this),t=Pu.call(this),n=ma(e)||"";return n?Lu.test(n)?(Ja(e,!0),nl(t),t=!0):(Ja(e,!1),il(t,un("That email address isn't correct").toString()),t=!1):(Ja(e,!1),il(t,un("Enter your email address to continue").toString()),t=!1),t?Y(ma(e)):null}function Fu(e,t,n,i,r,o,s){Dl.call(this,Vl,{email:n,ia:!!o},s,"passwordSignIn",{F:i,D:r}),this.w=e,this.H=t}function Uu(e,t,n,i,r,o){Dl.call(this,e,t,i,r||"notice",o),this.i=n||null}function Vu(e,t,n,i,r){Uu.call(this,jl,{email:e,G:!!t},t,r,"passwordRecoveryEmailSent",{F:n,D:i})}function Hu(e,t){Uu.call(this,lu,{G:!!e},e,t,"emailVerificationSuccess")}function Bu(e,t){Uu.call(this,uu,{G:!!e},e,t,"emailVerificationFailure")}function ju(e,t,n){Uu.call(this,cu,{email:e,G:!!t},t,n,"verifyAndChangeEmailSuccess")}function Gu(e,t){Uu.call(this,hu,{G:!!e},e,t,"verifyAndChangeEmailFailure")}function Wu(e,t){Uu.call(this,fu,{G:!!e},e,t,"revertSecondFactorAdditionFailure")}function zu(e){Uu.call(this,wu,void 0,void 0,e,"signOut")}function qu(e,t){Uu.call(this,ru,{G:!!e},e,t,"passwordResetSuccess")}function Ku(e,t){Uu.call(this,ou,{G:!!e},e,t,"passwordResetFailure")}function $u(e,t){Uu.call(this,au,{G:!!e},e,t,"emailChangeRevokeFailure")}function Yu(e,t,n){Uu.call(this,pu,{errorMessage:e,zb:!!t},t,n,"recoverableError")}function Xu(e,t){Uu.call(this,mu,{errorMessage:e},void 0,t,"unrecoverableError")}function Qu(e){if("auth/invalid-credential"===e.code&&e.message&&-1!==e.message.indexOf("error=consent_required"))return{code:"auth/user-cancelled"};if(e.message&&-1!==e.message.indexOf("HTTP Cloud Function returned an error:")){var t=JSON.parse(e.message.substring(e.message.indexOf("{"),e.message.lastIndexOf("}")+1));return{code:e.code,message:t&&t.error&&t.error.message||e.message}}return e}function Ju(e,t,n,i){function r(n){if(!n.name||"cancel"!=n.name){e:{var i=n.message;try{var r=((JSON.parse(i).error||{}).message||"").toLowerCase().match(/invalid.+(access|id)_token/);if(r&&r.length){var o=!0;break e}}catch(e){}o=!1}if(o)n=Nl(t),t.m(),oc(e,n,void 0,un("Your sign-in session has expired. Please try again.").toString());else{if(o=n&&n.message||"",n.code){if("auth/email-already-in-use"==n.code||"auth/credential-already-in-use"==n.code)return;o=tc(n)}t.a(o)}}}if(Rh(e),i)return Zu(e,n),Wi();if(!n.credential)throw Error("No credential found!");if(!wh(e).currentUser&&!n.user)throw Error("User not logged in.");try{var o=function(e,t){return Ph(e),kh(e,(function(n){if(e.j&&!e.j.isAnonymous&&Cs(Mh(e))&&!wh(e).currentUser)return Nh(e).then((function(){return"password"==t.credential.providerId&&(t.credential=null),t}));if(n)return Nh(e).then((function(){return n.linkWithCredential(t.credential)})).then((function(e){return t.user=e.user,t.credential=e.credential,t.operationType=e.operationType,t.additionalUserInfo=e.additionalUserInfo,t}),(function(n){if(n&&"auth/email-already-in-use"==n.code&&n.email&&n.credential)throw n;return Oh(e,n,t.credential)}));if(!t.user)throw Error('Internal error: An incompatible or outdated version of "firebase.js" may be used.');return Nh(e).then((function(){return _h(e).updateCurrentUser(t.user)})).then((function(){return t.user=_h(e).currentUser,t.operationType="signIn",t.credential&&t.credential.providerId&&"password"==t.credential.providerId&&(t.credential=null),t}))}))}(e,n)}catch(e){return Kr(e.code||e.message,e),t.a(e.code||e.message),Wi()}return n=o.then((function(t){Zu(e,t)}),r).then(void 0,r),xh(e,o),Wi(n)}function Zu(e,t){if(!t.user)throw Error("No user found");var n=$s(Mh(e));if(Ks(Mh(e))&&n&&Qr("Both signInSuccess and signInSuccessWithAuthResult callbacks are provided. Only signInSuccessWithAuthResult callback will be invoked."),n){n=$s(Mh(e));var i=es(Sh(e))||void 0;Jo($o,Sh(e));var r=!1;ir()?(n&&!n(t,i)||(r=!0,Ot(window.opener.location,ec(e,i))),n||window.close()):n&&!n(t,i)||(r=!0,Ot(window.location,ec(e,i))),r||e.reset()}else{n=t.user,t=t.credential,i=Ks(Mh(e)),r=es(Sh(e))||void 0,Jo($o,Sh(e));var o=!1;ir()?(i&&!i(n,t,r)||(o=!0,Ot(window.opener.location,ec(e,r))),i||window.close()):i&&!i(n,t,r)||(o=!0,Ot(window.location,ec(e,r))),o||e.reset()}}function ec(e,t){if(!(e=t||Mh(e).a.get("signInSuccessUrl")))throw Error("No redirect URL has been found. You must either specify a signInSuccessUrl in the configuration, pass in a redirect URL to the widget URL, or return false from the callback.");return e}function tc(e){var t={code:e.code},n="";switch((t=t||{}).code){case"auth/email-already-in-use":n+="The email address is already used by another account";break;case"auth/requires-recent-login":case"auth/user-token-expired":n+=Mn();break;case"auth/too-many-requests":n+="You have entered an incorrect password too many times. Please try again in a few minutes.";break;case"auth/user-cancelled":n+="Please authorize the required permissions to sign in to the application";break;case"auth/user-not-found":n+="That email address doesn't match an existing account";break;case"auth/weak-password":n+="Strong passwords have at least 6 characters and a mix of letters and numbers";break;case"auth/wrong-password":n+="The email and password you entered don't match";break;case"auth/network-request-failed":n+="A network error has occurred";break;case"auth/invalid-phone-number":n+=kn();break;case"auth/invalid-verification-code":n+=un("Wrong code. Try again.");break;case"auth/code-expired":n+="This code is no longer valid";break;case"auth/expired-action-code":n+="This code has expired.";break;case"auth/invalid-action-code":n+="The action code is invalid. This can happen if the code is malformed, expired, or has already been used."}if(t=un(n).toString())return t;try{return JSON.parse(e.message),Kr("Internal error: "+e.message,void 0),xn().toString()}catch(t){return e.message}}function nc(e,t,n,i){function r(){!function(e,t){Zo(Ko,{tenantId:e.a},t)}(new so(e.h.tenantId||null),Sh(e)),xh(e,t.I(k(e.dc,e),[l],(function(){if("file:"===(window.location&&window.location.protocol))return xh(e,vh(e).then((function(n){t.m(),Jo(Ko,Sh(e)),ca("callback",e,a,Wi(n))}),o))}),s))}function o(i){if(Jo(Ko,Sh(e)),!i.name||"cancel"!=i.name)switch(i=Qu(i),i.code){case"auth/popup-blocked":r();break;case"auth/popup-closed-by-user":case"auth/cancelled-popup-request":case"auth/credential-already-in-use":break;case"auth/network-request-failed":case"auth/too-many-requests":case"auth/user-cancelled":t.a(tc(i));break;case"auth/admin-restricted-operation":t.m(),Os(Mh(e))?ca("handleUnauthorizedUser",e,a,null,n):ca("callback",e,a,zi(i));break;default:t.m(),ca("callback",e,a,zi(i))}}function s(n){Jo(Ko,Sh(e)),n.name&&"cancel"==n.name||(Kr("signInWithRedirect: "+n.code,void 0),n=tc(n),"blank"==t.Ga&&zs(Mh(e))?(t.m(),ca("providerSignIn",e,a,n)):t.a(n))}var a=Nl(t),l=function(e,t,n){var i=As[t]&&D_.auth[As[t]]?new D_.auth[As[t]]:0==t.indexOf("saml.")?new D_.auth.SAMLAuthProvider(t):new D_.auth.OAuthProvider(t);if(!i)throw Error("Invalid Firebase Auth provider!");var r=Fs(Mh(e),t);if(i.addScope)for(var o=0;o<r.length;o++)i.addScope(r[o]);return r=Us(Mh(e),t)||{},n&&(e=t==D_.auth.GoogleAuthProvider.PROVIDER_ID?"login_hint":t==D_.auth.GithubAuthProvider.PROVIDER_ID?"login":(e=Ms(Mh(e),t))&&e.Ob)&&(r[e]=n),i.setCustomParameters&&i.setCustomParameters(r),i}(e,n,i);qs(Mh(e))==ra?r():xh(e,function(e,t){return Ph(e),kh(e,(function(n){return n&&!ts(Sh(e))?n.linkWithPopup(t).then((function(e){return e}),(function(t){if(t&&"auth/email-already-in-use"==t.code&&t.email&&t.credential)throw t;return Oh(e,t)})):wh(e).signInWithPopup(t)}))}(e,l).then((function(n){t.m(),ca("callback",e,a,Wi(n))}),o))}function ic(e){return 1==(e=Ls(Mh(e))).length&&e[0]==D_.auth.EmailAuthProvider.PROVIDER_ID}function rc(e){return 1==(e=Ls(Mh(e))).length&&e[0]==D_.auth.PhoneAuthProvider.PROVIDER_ID}function oc(e,t,n,i){ic(e)?i?ca("signIn",e,t,n,i):uc(e,t,n):e&&rc(e)&&!i?ca("phoneSignInStart",e,t):e&&zs(Mh(e))&&!i?ca("federatedRedirect",e,t,n):ca("providerSignIn",e,t,i,n)}function sc(e,t,n,i){var r=Nl(t);xh(e,t.I(k(wh(e).fetchSignInMethodsForEmail,wh(e)),[n],(function(o){t.m(),ac(e,r,o,n,i)}),(function(e){e=tc(e),t.a(e)})))}function ac(e,t,n,i,r,o){n.length||Ws(Mh(e))&&!Ws(Mh(e))?j(n,D_.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD)?ca("passwordSignIn",e,t,i,o):1==n.length&&n[0]===D_.auth.EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD?Ws(Mh(e))?ca("sendEmailLinkForSignIn",e,t,i,(function(){ca("signIn",e,t)})):ca("unsupportedProvider",e,t,i):(n=Is(n,Ls(Mh(e))))?(is(new io(i),Sh(e)),ca("federatedSignIn",e,t,i,n,r)):ca("unsupportedProvider",e,t,i):Ns(Mh(e))?ca("handleUnauthorizedUser",e,t,i,D_.auth.EmailAuthProvider.PROVIDER_ID):Ws(Mh(e))?ca("sendEmailLinkForSignIn",e,t,i,(function(){ca("signIn",e,t)})):ca("passwordSignUp",e,t,i,void 0,void 0,o)}function lc(e,t,n,i,r,o){var s=Nl(t);xh(e,t.I(k(e.Ib,e),[n,o],(function(){t.m(),ca("emailLinkSignInSent",e,s,n,i,o)}),r))}function uc(e,t,n){n?ca("prefilledEmailSignIn",e,t,n):ca("signIn",e,t)}function cc(){return be(sr(),"oobCode")}function hc(){var e=be(sr(),"continueUrl");return e?function(){Ot(window.location,e)}:null}function dc(e,t){Dl.call(this,Xl,void 0,t,"anonymousUserMismatch"),this.i=e}function fc(e){Dl.call(this,Gl,void 0,e,"callback")}function pc(e,t,n){if(n.user){var i={user:n.user,credential:n.credential,operationType:n.operationType,additionalUserInfo:n.additionalUserInfo},r=ts(Sh(e)),o=r&&r.g;if(o&&!function(e,t){if(t==e.email)return!0;if(e.providerData)for(var n=0;n<e.providerData.length;n++)if(t==e.providerData[n].email)return!0;return!1}(n.user,o))!function(e,t,n){var i=Nl(t);xh(e,Nh(e).then((function(){t.m(),ca("emailMismatch",e,i,n)}),(function(e){e.name&&"cancel"==e.name||(e=tc(e.code),t.a(e))})))}(e,t,i);else{var s=r&&r.a;s?xh(e,n.user.linkWithCredential(s).then((function(n){i={user:n.user,credential:s,operationType:n.operationType,additionalUserInfo:n.additionalUserInfo},mc(e,t,i)}),(function(n){gc(e,t,n)}))):mc(e,t,i)}}else n=Nl(t),t.m(),ns(Sh(e)),oc(e,n)}function mc(e,t,n){ns(Sh(e)),Ju(e,t,n)}function gc(e,t,n){var i=Nl(t);ns(Sh(e)),n=tc(n),t.m(),oc(e,i,void 0,n)}function vc(e,t,n,i){var r=Nl(t);xh(e,wh(e).fetchSignInMethodsForEmail(n).then((function(o){t.m(),o.length?j(o,D_.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD)?ca("passwordLinking",e,r,n):1==o.length&&o[0]===D_.auth.EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD?ca("emailLinkSignInLinking",e,r,n):(o=Is(o,Ls(Mh(e))))?ca("federatedLinking",e,r,n,o,i):(ns(Sh(e)),ca("unsupportedProvider",e,r,n)):(ns(Sh(e)),ca("passwordRecovery",e,r,n,!1,Rn().toString()))}),(function(n){gc(e,t,n)})))}function yc(e,t){Dl.call(this,Yl,void 0,t,"differentDeviceError"),this.i=e}function bc(e,t,n,i){Dl.call(this,su,{email:e,G:!!n},i,"emailChangeRevoke"),this.l=t,this.i=n||null}function wc(){return Ya(this,"firebaseui-id-new-password")}function _c(){return Ya(this,"firebaseui-id-password-toggle")}function Sc(){this.Ra=!this.Ra;var e=_c.call(this),t=wc.call(this);this.Ra?(t.type="text",fa(e,"firebaseui-input-toggle-off"),pa(e,"firebaseui-input-toggle-on")):(t.type="password",fa(e,"firebaseui-input-toggle-on"),pa(e,"firebaseui-input-toggle-off")),t.focus()}function Tc(){return Ya(this,"firebaseui-id-new-password-error")}function Ic(){this.Ra=!1;var e=wc.call(this);e.type="password";var t=Tc.call(this);Za(this,e,(function(){rl(t)&&(Ja(e,!0),nl(t))}));var n=_c.call(this);fa(n,"firebaseui-input-toggle-on"),pa(n,"firebaseui-input-toggle-off"),function(e,t,n){Un(e,C(Vn,t=new Ia(t))),xa(Xa(e),t,"focusin",n)}(this,e,(function(){fa(n,"firebaseui-input-toggle-focus"),pa(n,"firebaseui-input-toggle-blur")})),function(e,t,n){Un(e,C(Vn,t=new Ia(t))),xa(Xa(e),t,"focusout",n)}(this,e,(function(){fa(n,"firebaseui-input-toggle-blur"),pa(n,"firebaseui-input-toggle-focus")})),tl(this,n,k(Sc,this))}function Ec(){var e=wc.call(this),t=Tc.call(this);return ma(e)?(Ja(e,!0),nl(t),t=!0):(Ja(e,!1),il(t,un("Enter your password").toString()),t=!1),t?ma(e):null}function Ac(e,t,n){Dl.call(this,iu,{email:e},n,"passwordReset"),this.l=t}function kc(e,t,n,i,r){Dl.call(this,du,{factorId:e,phoneNumber:n||null,G:!!i},r,"revertSecondFactorAdditionSuccess"),this.l=t,this.i=i||null}function Cc(e,t,n,i){"auth/weak-password"==(i&&i.code)?(e=tc(i),Ja(n.i(),!1),il(n.w(),e),n.i().focus()):(n&&n.m(),(n=new Ku).render(t),yh(e,n))}function xc(e,t){try{var n="number"==typeof e.selectionStart}catch(e){n=!1}n?(e.selectionStart=t,e.selectionEnd=t):Je&&!ht("9")&&("textarea"==e.type&&(t=e.value.substring(0,t).replace(/(\r\n|\r|\n)/g,"\n").length),(e=e.createTextRange()).collapse(!0),e.move("character",t),e.select())}function Rc(e,t,n,i,r,o){Dl.call(this,$l,{email:n},o,"emailLinkSignInConfirmation",{F:i,D:r}),this.l=e,this.u=t}function Lc(e,t,n,i,r){Dl.call(this,Zl,{ga:e},r,"emailLinkSignInLinkingDifferentDevice",{F:n,D:i}),this.i=t}function Mc(e){Dl.call(this,zl,void 0,e,"blank")}function Pc(e,t,n,i,r){var o=new Mc,s=new He(n),a=s.a.a.get(We.$a)||"",l=s.a.a.get(We.Sa)||"",u="1"===s.a.a.get(We.Qa),c=Be(s),h=s.a.a.get(We.PROVIDER_ID)||null;s=s.a.a.get(We.vb)||null,Lh(e,s);var d=!Qo(Yo,Sh(e)),f=i||function(e,t){var n=null;if(t=Qo(Yo,t))try{var i=xo(e,t),r=JSON.parse(i);n=r&&r.email||null}catch(e){}return n}(l,Sh(e)),p=(i=function(e,t){var n=null;if(t=Qo(Xo,t))try{var i=xo(e,t);n=JSON.parse(i)}catch(e){}return oo(n||null)}(l,Sh(e)))&&i.a;h&&p&&p.providerId!==h&&(p=null),o.render(t),yh(e,o),xh(e,o.I((function(){var t=Wi(null);t=c&&d||d&&u?zi(Error("anonymous-user-not-found")):function(e,t){var n=Be(new He(t));return n?(t=new Fi((function(t,i){var r=_h(e).onAuthStateChanged((function(e){r(),e&&e.isAnonymous&&e.uid===n?t(e):e&&e.isAnonymous&&e.uid!==n?i(Error("anonymous-user-mismatch")):i(Error("anonymous-user-not-found"))}));xh(e,r)})),xh(e,t),t):Wi(null)}(e,n).then((function(e){if(h&&!p)throw Error("pending-credential-not-found");return e}));var i=null;return t.then((function(t){return i=t,r?null:wh(e).checkActionCode(a)})).then((function(){return i}))}),[],(function(i){f?function(e,t,n,i,r,o){var s=Nl(t);t.$("mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-progress-dialog-loading-icon",un("Signing in...").toString());var a=null;r=(o?function(e,t,n,i,r){Ph(e);var o=r||null,s=D_.auth.EmailAuthProvider.credentialWithLink(n,i);return n=o?wh(e).signInWithEmailLink(n,i).then((function(e){return e.user.linkWithCredential(o)})).then((function(){return Nh(e)})).then((function(){return Oh(e,{code:"auth/email-already-in-use"},o)})):wh(e).fetchSignInMethodsForEmail(n).then((function(n){return n.length?Oh(e,{code:"auth/email-already-in-use"},s):t.linkWithCredential(s)})),xh(e,n),n}(e,o,n,i,r):function(e,t,n,i){Ph(e);var r,o=i||null;return t=wh(e).signInWithEmailLink(t,n).then((function(e){if(r={user:e.user,credential:null,operationType:e.operationType,additionalUserInfo:e.additionalUserInfo},o)return e.user.linkWithCredential(o).then((function(e){r={user:e.user,credential:o,operationType:r.operationType,additionalUserInfo:e.additionalUserInfo}}))})).then((function(){Nh(e)})).then((function(){return _h(e).updateCurrentUser(r.user)})).then((function(){return r.user=_h(e).currentUser,r})),xh(e,t),t}(e,n,i,r)).then((function(n){Jo(Xo,Sh(e)),Jo(Yo,Sh(e)),t.h(),t.$("firebaseui-icon-done",un("Signed in!").toString()),a=setTimeout((function(){t.h(),Ju(e,t,n,!0)}),1e3),xh(e,(function(){t&&(t.h(),t.m()),clearTimeout(a)}))}),(function(r){if(t.h(),t.m(),!r.name||"cancel"!=r.name){var o=tc(r=Qu(r));"auth/email-already-in-use"==r.code||"auth/credential-already-in-use"==r.code?(Jo(Xo,Sh(e)),Jo(Yo,Sh(e))):"auth/invalid-email"==r.code?(o=un("The email provided does not match the current sign-in session.").toString(),ca("emailLinkConfirmation",e,s,i,Dc,null,o)):oc(e,s,n,o)}})),xh(e,r)}(e,o,f,n,p,i):u?(o.m(),ca("differentDeviceError",e,t)):(o.m(),ca("emailLinkConfirmation",e,t,n,Dc))}),(function(i){var r=void 0;if(!i||!i.name||"cancel"!=i.name)switch(o.m(),i&&i.message){case"anonymous-user-not-found":ca("differentDeviceError",e,t);break;case"anonymous-user-mismatch":ca("anonymousUserMismatch",e,t);break;case"pending-credential-not-found":ca("emailLinkNewDeviceLinking",e,t,n,Nc);break;default:i&&(r=tc(i)),oc(e,t,void 0,r)}})))}function Dc(e,t,n,i){Pc(e,t,i,n,!0)}function Nc(e,t,n){Pc(e,t,n)}function Oc(e,t,n,i,r,o){Dl.call(this,Jl,{email:e,ga:t},o,"emailLinkSignInLinking",{F:i,D:r}),this.i=n}function Fc(e,t,n,i,r,o){Dl.call(this,ql,{email:e},o,"emailLinkSignInSent",{F:i,D:r}),this.u=t,this.i=n}function Uc(e,t,n,i,r,o,s){Dl.call(this,gu,{jc:e,Qb:t},s,"emailMismatch",{F:r,D:o}),this.l=n,this.i=i}function Vc(e,t,n,i,r){Dl.call(this,Kl,void 0,r,"emailNotReceived",{F:n,D:i}),this.l=e,this.i=t}function Hc(e,t,n,i,r,o){Dl.call(this,eu,{email:e,ga:t},o,"federatedLinking",{F:i,D:r}),this.i=n}function Bc(e,t,n,i,r,o){Dl.call(this,Bl,{email:n,Ta:!!t},o,"passwordRecovery",{F:i,D:r}),this.l=e,this.u=t}function jc(){return Ya(this,"firebaseui-id-name")}function Gc(){return Ya(this,"firebaseui-id-name-error")}function Wc(e,t,n,i,r,o,s,a,l){Dl.call(this,Hl,{email:i,Tb:e,name:r,Ta:!!n,ia:!!a},l,"passwordSignUp",{F:o,D:s}),this.w=t,this.H=n,this.B=e}function zc(e,t){var n=Gs(Mh(e)),i=t.j(),r=null;n&&(r=t.M());var o=t.P();if(i){if(n){if(!r)return void t.u().focus();r=re(r)}if(o){var s=D_.auth.EmailAuthProvider.credential(i,o);xh(e,t.I(k(e.Yb,e),[i,o],(function(i){var o={user:i.user,credential:s,operationType:i.operationType,additionalUserInfo:i.additionalUserInfo};return n?(i=i.user.updateProfile({displayName:r}).then((function(){return Ju(e,t,o)})),xh(e,i),i):Ju(e,t,o)}),(function(n){if(!n.name||"cancel"!=n.name){var r=Qu(n);switch(n=tc(r),r.code){case"auth/email-already-in-use":return function(e,t,n,i){function r(){var e=tc(i);Ja(t.i(),!1),il(t.U(),e),t.i().focus()}var o=wh(e).fetchSignInMethodsForEmail(n).then((function(i){i.length?r():(i=Nl(t),t.m(),ca("passwordRecovery",e,i,n,!1,Rn().toString()))}),(function(){r()}));return xh(e,o),o}(e,t,i,r);case"auth/too-many-requests":n=un("Too many account requests are coming from your IP address. Try again in a few minutes.").toString();case"auth/operation-not-allowed":case"auth/weak-password":Ja(t.l(),!1),il(t.ba(),n);break;case"auth/admin-restricted-operation":Os(Mh(e))?(n=Nl(t),t.m(),ca("handleUnauthorizedUser",e,n,i,D_.auth.EmailAuthProvider.PROVIDER_ID)):t.a(n);break;default:Kr(r="setAccountInfo: "+Lo(r),void 0),t.a(n)}}})))}else t.l().focus()}else t.i().focus()}function qc(){return Ya(this,"firebaseui-id-phone-confirmation-code")}function Kc(){return Ya(this,"firebaseui-id-phone-confirmation-code-error")}function $c(){return Ya(this,"firebaseui-id-resend-countdown")}function Yc(e,t,n,i,r,o,s,a,l){Dl.call(this,bu,{phoneNumber:r},l,"phoneSignInFinish",{F:s,D:a}),this.jb=o,this.i=new Ea(1e3),this.B=o,this.P=e,this.l=t,this.H=n,this.M=i}a(Fu,Dl),Fu.prototype.v=function(){this.P(),this.ea(),this.ba(this.w,this.H),Ol(this,this.l(),this.i()),Fl(this,this.i(),this.w),ma(this.l())?this.i().focus():this.l().focus(),Dl.prototype.v.call(this)},Fu.prototype.o=function(){this.H=this.w=null,Dl.prototype.o.call(this)},x(Fu.prototype,{l:Mu,U:Pu,P:Du,M:Nu,j:Ou,i:Au,B:ku,ea:Cu,u:xu,ua:Tu,pa:Iu,ba:Eu}),P(Uu,Dl),Uu.prototype.v=function(){this.i&&(this.u(this.i),this.l().focus()),Uu.K.v.call(this)},Uu.prototype.o=function(){this.i=null,Uu.K.o.call(this)},x(Uu.prototype,{l:Tu,w:Iu,u:Eu}),P(Vu,Uu),P(Hu,Uu),P(Bu,Uu),P(ju,Uu),P(Gu,Uu),P(Wu,Uu),P(zu,Uu),P(qu,Uu),P(Ku,Uu),P($u,Uu),P(Yu,Uu),P(Xu,Uu),a(dc,Dl),dc.prototype.v=function(){var e=this;tl(this,this.l(),(function(){e.i()})),this.l().focus(),Dl.prototype.v.call(this)},dc.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(dc.prototype,{l:Iu}),ua.anonymousUserMismatch=function(e,t){var n=new dc((function(){n.m(),oc(e,t)}));n.render(t),yh(e,n)},a(fc,Dl),fc.prototype.I=function(e,t,n,i){return e.apply(null,t).then(n,i)},ua.callback=function(e,t,n){var i=new fc;i.render(t),yh(e,i),n=n||vh(e),xh(e,n.then((function(t){pc(e,i,t)}),(function(n){if((n=Qu(n))&&("auth/account-exists-with-different-credential"==n.code||"auth/email-already-in-use"==n.code)&&n.email&&n.credential)is(new io(n.email,n.credential),Sh(e)),vc(e,i,n.email);else if(n&&"auth/user-cancelled"==n.code){var r=ts(Sh(e)),o=tc(n);r&&r.a?vc(e,i,r.g,o):r?sc(e,i,r.g,o):gc(e,i,n)}else n&&"auth/credential-already-in-use"==n.code||(n&&"auth/operation-not-supported-in-this-environment"==n.code&&ic(e)?pc(e,i,{user:null,credential:null}):n&&"auth/admin-restricted-operation"==n.code&&Os(Mh(e))?(i.m(),ns(Sh(e)),ca("handleUnauthorizedUser",e,t,null,null)):gc(e,i,n))})))},a(yc,Dl),yc.prototype.v=function(){var e=this;tl(this,this.l(),(function(){e.i()})),this.l().focus(),Dl.prototype.v.call(this)},yc.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(yc.prototype,{l:Iu}),ua.differentDeviceError=function(e,t){var n=new yc((function(){n.m(),oc(e,t)}));n.render(t),yh(e,n)},a(bc,Dl),bc.prototype.v=function(){var e=this;tl(this,Ya(this,"firebaseui-id-reset-password-link"),(function(){e.l()})),this.i&&(this.w(this.i),this.u().focus()),Dl.prototype.v.call(this)},bc.prototype.o=function(){this.l=this.i=null,Dl.prototype.o.call(this)},x(bc.prototype,{u:Tu,B:Iu,w:Eu}),a(Ac,Dl),Ac.prototype.v=function(){this.H(),this.B(this.l),Fl(this,this.i(),this.l),this.i().focus(),Dl.prototype.v.call(this)},Ac.prototype.o=function(){this.l=null,Dl.prototype.o.call(this)},x(Ac.prototype,{i:wc,w:Tc,M:_c,H:Ic,u:Ec,U:Tu,P:Iu,B:Eu}),a(kc,Dl),kc.prototype.v=function(){var e=this;tl(this,Ya(this,"firebaseui-id-reset-password-link"),(function(){e.l()})),this.i&&(this.w(this.i),this.u().focus()),Dl.prototype.v.call(this)},kc.prototype.o=function(){this.l=this.i=null,Dl.prototype.o.call(this)},x(kc.prototype,{u:Tu,B:Iu,w:Eu}),ua.passwordReset=function(e,t,n,i){xh(e,wh(e).verifyPasswordResetCode(n).then((function(r){var o=new Ac(r,(function(){!function(e,t,n,i,r){var o=n.u();o&&xh(e,n.I(k(wh(e).confirmPasswordReset,wh(e)),[i,o],(function(){n.m();var i=new qu(r);i.render(t),yh(e,i)}),(function(i){Cc(e,t,n,i)})))}(e,t,o,n,i)}));o.render(t),yh(e,o)}),(function(){Cc(e,t)})))},ua.emailChangeRevocation=function(e,t,n){var i=null;xh(e,wh(e).checkActionCode(n).then((function(t){return i=t.data.email,wh(e).applyActionCode(n)})).then((function(){!function(e,t,n){var i=new bc(n,(function(){xh(e,i.I(k(wh(e).sendPasswordResetEmail,wh(e)),[n],(function(){i.m(),(i=new Vu(n,void 0,Bs(Mh(e)),js(Mh(e)))).render(t),yh(e,i)}),(function(){i.a(Cn().toString())})))}));i.render(t),yh(e,i)}(e,t,i)}),(function(){var n=new $u;n.render(t),yh(e,n)})))},ua.emailVerification=function(e,t,n,i){xh(e,wh(e).applyActionCode(n).then((function(){var n=new Hu(i);n.render(t),yh(e,n)}),(function(){var n=new Bu;n.render(t),yh(e,n)})))},ua.revertSecondFactorAddition=function(e,t,n){var i=null,r=null;xh(e,wh(e).checkActionCode(n).then((function(t){return i=t.data.email,r=t.data.multiFactorInfo,wh(e).applyActionCode(n)})).then((function(){!function(e,t,n,i){var r=new kc(i.factorId,(function(){r.I(k(wh(e).sendPasswordResetEmail,wh(e)),[n],(function(){r.m(),(r=new Vu(n,void 0,Bs(Mh(e)),js(Mh(e)))).render(t),yh(e,r)}),(function(){r.a(Cn().toString())}))}),i.phoneNumber);r.render(t),yh(e,r)}(e,t,i,r)}),(function(){var n=new Wu;n.render(t),yh(e,n)})))},ua.verifyAndChangeEmail=function(e,t,n,i){var r=null;xh(e,wh(e).checkActionCode(n).then((function(t){return r=t.data.email,wh(e).applyActionCode(n)})).then((function(){var n=new ju(r,i);n.render(t),yh(e,n)}),(function(){var n=new Gu;n.render(t),yh(e,n)})))},a(Rc,Dl),Rc.prototype.v=function(){this.w(this.l),this.B(this.l,this.u),this.i().focus(),xc(this.i(),(this.i().value||"").length),Dl.prototype.v.call(this)},Rc.prototype.o=function(){this.u=this.l=null,Dl.prototype.o.call(this)},x(Rc.prototype,{i:Mu,M:Pu,w:Du,H:Nu,j:Ou,U:Tu,P:Iu,B:Eu}),ua.emailLinkConfirmation=function(e,t,n,i,r,o){var s=new Rc((function(){var r=s.j();r?(s.m(),i(e,t,r,n)):s.i().focus()}),(function(){s.m(),oc(e,t,r||void 0)}),r||void 0,Bs(Mh(e)),js(Mh(e)));s.render(t),yh(e,s),o&&s.a(o)},a(Lc,Dl),Lc.prototype.v=function(){this.u(this.i),this.l().focus(),Dl.prototype.v.call(this)},Lc.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(Lc.prototype,{l:Tu,u:Eu}),ua.emailLinkNewDeviceLinking=function(e,t,n,i){var r=new He(n);if(n=r.a.a.get(We.PROVIDER_ID)||null,je(r,null),n){var o=new Lc(Ms(Mh(e),n),(function(){o.m(),i(e,t,r.toString())}),Bs(Mh(e)),js(Mh(e)));o.render(t),yh(e,o)}else oc(e,t)},a(Mc,Dl),ua.emailLinkSignInCallback=Pc,a(Oc,Dl),Oc.prototype.v=function(){this.u(this.i),this.l().focus(),Dl.prototype.v.call(this)},Oc.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(Oc.prototype,{l:Tu,u:Eu}),ua.emailLinkSignInLinking=function(e,t,n){var i=ts(Sh(e));if(ns(Sh(e)),i){var r=i.a.providerId,o=new Oc(n,Ms(Mh(e),r),(function(){!function(e,t,n,i){var r=Nl(t);lc(e,t,n,(function(){oc(e,r,n)}),(function(i){if(!i.name||"cancel"!=i.name){var o=tc(i);i&&"auth/network-request-failed"==i.code?t.a(o):(t.m(),oc(e,r,n,o))}}),i)}(e,o,n,i)}),Bs(Mh(e)),js(Mh(e)));o.render(t),yh(e,o)}else oc(e,t)},a(Fc,Dl),Fc.prototype.v=function(){var e=this;tl(this,this.l(),(function(){e.i()})),tl(this,Ya(this,"firebaseui-id-trouble-getting-email-link"),(function(){e.u()})),this.l().focus(),Dl.prototype.v.call(this)},Fc.prototype.o=function(){this.i=this.u=null,Dl.prototype.o.call(this)},x(Fc.prototype,{l:Iu}),ua.emailLinkSignInSent=function(e,t,n,i,r){var o=new Fc(n,(function(){o.m(),ca("emailNotReceived",e,t,n,i,r)}),(function(){o.m(),i()}),Bs(Mh(e)),js(Mh(e)));o.render(t),yh(e,o)},a(Uc,Dl),Uc.prototype.v=function(){this.w(this.l,this.i),this.u().focus(),Dl.prototype.v.call(this)},Uc.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(Uc.prototype,{u:Tu,B:Iu,w:Eu}),ua.emailMismatch=function(e,t,n){var i=ts(Sh(e));if(i){var r=new Uc(n.user.email,i.g,(function(){var t=r;ns(Sh(e)),Ju(e,t,n)}),(function(){var t=n.credential.providerId,o=Nl(r);r.m(),i.a?ca("federatedLinking",e,o,i.g,t):ca("federatedSignIn",e,o,i.g,t)}),Bs(Mh(e)),js(Mh(e)));r.render(t),yh(e,r)}else oc(e,t)},a(Vc,Dl),Vc.prototype.v=function(){var e=this;tl(this,this.u(),(function(){e.i()})),tl(this,this.Da(),(function(){e.l()})),this.u().focus(),Dl.prototype.v.call(this)},Vc.prototype.Da=function(){return Ya(this,"firebaseui-id-resend-email-link")},Vc.prototype.o=function(){this.i=this.l=null,Dl.prototype.o.call(this)},x(Vc.prototype,{u:Iu}),ua.emailNotReceived=function(e,t,n,i,r){var o=new Vc((function(){lc(e,o,n,i,(function(e){e=tc(e),o.a(e)}),r)}),(function(){o.m(),oc(e,t,n)}),Bs(Mh(e)),js(Mh(e)));o.render(t),yh(e,o)},a(Hc,Dl),Hc.prototype.v=function(){this.u(this.i),this.l().focus(),Dl.prototype.v.call(this)},Hc.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(Hc.prototype,{l:Tu,u:Eu}),ua.federatedLinking=function(e,t,n,i,r){var o=ts(Sh(e));if(o&&o.a){var s=new Hc(n,Ms(Mh(e),i),(function(){nc(e,s,i,n)}),Bs(Mh(e)),js(Mh(e)));s.render(t),yh(e,s),r&&s.a(r)}else oc(e,t)},ua.federatedRedirect=function(e,t,n){var i=new Mc;i.render(t),yh(e,i),nc(e,i,t=Ls(Mh(e))[0],n)},ua.federatedSignIn=function(e,t,n,i,r){var o=new Hc(n,Ms(Mh(e),i),(function(){nc(e,o,i,n)}),Bs(Mh(e)),js(Mh(e)));o.render(t),yh(e,o),r&&o.a(r)},ua.passwordLinking=function(e,t,n){var i=ts(Sh(e));ns(Sh(e));var r=i&&i.a;if(r){var o=new Ru(n,(function(){!function(e,t,n,i){var r=t.u();r?xh(e,t.I(k(e.Xb,e),[n,r],(function(n){return n=n.user.linkWithCredential(i).then((function(n){return Ju(e,t,{user:n.user,credential:i,operationType:n.operationType,additionalUserInfo:n.additionalUserInfo})})),xh(e,n),n}),(function(e){if(!e.name||"cancel"!=e.name)switch(e.code){case"auth/wrong-password":Ja(t.i(),!1),il(t.B(),tc(e));break;case"auth/too-many-requests":t.a(tc(e));break;default:Kr("signInWithEmailAndPassword: "+e.message,void 0),t.a(tc(e))}}))):t.i().focus()}(e,o,n,r)}),(function(){o.m(),ca("passwordRecovery",e,t,n)}),Bs(Mh(e)),js(Mh(e)));o.render(t),yh(e,o)}else oc(e,t)},a(Bc,Dl),Bc.prototype.v=function(){this.B(),this.H(this.l,this.u),ma(this.i())||this.i().focus(),Fl(this,this.i(),this.l),Dl.prototype.v.call(this)},Bc.prototype.o=function(){this.u=this.l=null,Dl.prototype.o.call(this)},x(Bc.prototype,{i:Mu,w:Pu,B:Du,M:Nu,j:Ou,U:Tu,P:Iu,H:Eu}),ua.passwordRecovery=function(e,t,n,i,r){var o=new Bc((function(){!function(e,t){var n=t.j();if(n){var i=Nl(t);xh(e,t.I(k(wh(e).sendPasswordResetEmail,wh(e)),[n],(function(){t.m();var r=new Vu(n,(function(){r.m(),oc(e,i)}),Bs(Mh(e)),js(Mh(e)));r.render(i),yh(e,r)}),(function(e){Ja(t.i(),!1),il(t.w(),tc(e))})))}else t.i().focus()}(e,o)}),i?void 0:function(){o.m(),oc(e,t)},n,Bs(Mh(e)),js(Mh(e)));o.render(t),yh(e,o),r&&o.a(r)},ua.passwordSignIn=function(e,t,n,i){var r=new Fu((function(){!function(e,t){var n=t.j(),i=t.u();if(n)if(i){var r=D_.auth.EmailAuthProvider.credential(n,i);xh(e,t.I(k(e.bc,e),[n,i],(function(n){return Ju(e,t,{user:n.user,credential:r,operationType:n.operationType,additionalUserInfo:n.additionalUserInfo})}),(function(e){if(!e.name||"cancel"!=e.name)switch(e.code){case"auth/email-already-in-use":break;case"auth/email-exists":Ja(t.l(),!1),il(t.U(),tc(e));break;case"auth/too-many-requests":case"auth/wrong-password":Ja(t.i(),!1),il(t.B(),tc(e));break;default:Kr("verifyPassword: "+e.message,void 0),t.a(tc(e))}})))}else t.i().focus();else t.l().focus()}(e,r)}),(function(){var n=r.M();r.m(),ca("passwordRecovery",e,t,n)}),n,Bs(Mh(e)),js(Mh(e)),i);r.render(t),yh(e,r)},a(Wc,Dl),Wc.prototype.v=function(){this.ea(),this.B&&this.Ja(),this.ua(),this.pa(this.w,this.H),this.B?(Ol(this,this.i(),this.u()),Ol(this,this.u(),this.l())):Ol(this,this.i(),this.l()),this.w&&Fl(this,this.l(),this.w),ma(this.i())?this.B&&!ma(this.u())?this.u().focus():this.l().focus():this.i().focus(),Dl.prototype.v.call(this)},Wc.prototype.o=function(){this.H=this.w=null,Dl.prototype.o.call(this)},x(Wc.prototype,{i:Mu,U:Pu,ea:Du,jb:Nu,j:Ou,u:jc,Bc:Gc,Ja:function(){var e=jc.call(this),t=Gc.call(this);Za(this,e,(function(){rl(t)&&(Ja(e,!0),nl(t))}))},M:function(){var e=jc.call(this),t=Gc.call(this),n=ma(e);return Ja(e,n=!/^[\s\xa0]*$/.test(null==n?"":String(n))),n?(nl(t),t=!0):(il(t,un("Enter your account name").toString()),t=!1),t?Y(ma(e)):null},l:wc,ba:Tc,lb:_c,ua:Ic,P:Ec,Nb:Tu,Mb:Iu,pa:Eu}),ua.passwordSignUp=function(e,t,n,i,r,o){var s=new Wc(Gs(Mh(e)),(function(){zc(e,s)}),r?void 0:function(){s.m(),oc(e,t)},n,i,Bs(Mh(e)),js(Mh(e)),o);s.render(t),yh(e,s)},a(Yc,Dl),Yc.prototype.v=function(){var e=this;this.U(this.jb),ni(this.i,"tick",this.w,!1,this),this.i.start(),tl(this,Ya(this,"firebaseui-id-change-phone-number-link"),(function(){e.P()})),tl(this,this.Da(),(function(){e.M()})),this.Ja(this.l),this.ea(this.l,this.H),this.u().focus(),Dl.prototype.v.call(this)},Yc.prototype.o=function(){this.M=this.H=this.l=this.P=null,Aa(this.i),oi(this.i,"tick",this.w),this.i=null,Dl.prototype.o.call(this)},Yc.prototype.w=function(){--this.B,0<this.B?this.U(this.B):(Aa(this.i),oi(this.i,"tick",this.w),this.ua(),this.lb())},x(Yc.prototype,{u:qc,pa:Kc,Ja:function(e){var t=qc.call(this),n=Kc.call(this);Za(this,t,(function(){rl(n)&&(Ja(t,!0),nl(n))})),e&&el(this,t,(function(){e()}))},ba:function(){var e=Y(ma(qc.call(this))||"");return/^\d{6}$/.test(e)?e:null},Fb:$c,U:function(e){Kt($c.call(this),un("Resend code in "+(9<e?"0:":"0:0")+e).toString())},ua:function(){nl(this.Fb())},Da:function(){return Ya(this,"firebaseui-id-resend-link")},lb:function(){il(this.Da())},Nb:Tu,Mb:Iu,ea:Eu}),ua.phoneSignInFinish=function(e,t,n,i,r,o){var s=new Yc((function(){s.m(),ca("phoneSignInStart",e,t,n)}),(function(){!function(e,t,n,i){function r(e){t.u().focus(),Ja(t.u(),!1),il(t.pa(),e)}var o=t.ba();o?(t.$("mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-progress-dialog-loading-icon",un("Verifying...").toString()),xh(e,t.I(k(i.confirm,i),[o],(function(n){t.h(),t.$("firebaseui-icon-done",un("Verified!").toString());var i=setTimeout((function(){t.h(),t.m();var i={user:_h(e).currentUser,credential:null,operationType:n.operationType,additionalUserInfo:n.additionalUserInfo};Ju(e,t,i,!0)}),1e3);xh(e,(function(){t&&t.h(),clearTimeout(i)}))}),(function(i){if(i.name&&"cancel"==i.name)t.h();else{var o=Qu(i);switch(i=tc(o),o.code){case"auth/credential-already-in-use":t.h();break;case"auth/code-expired":o=Nl(t),t.h(),t.m(),ca("phoneSignInStart",e,o,n,i);break;case"auth/missing-verification-code":case"auth/invalid-verification-code":t.h(),r(i);break;default:t.h(),t.a(i)}}})))):r(un("Wrong code. Try again.").toString())}(e,s,n,r)}),(function(){s.m(),oc(e,t)}),(function(){s.m(),ca("phoneSignInStart",e,t,n)}),Ts(n),i,Bs(Mh(e)),js(Mh(e)));s.render(t),yh(e,s),o&&s.a(o)};var Xc=!(Je||Ke("Safari")&&!($e()||Ke("Coast")||Ke("Opera")||Ke("Edge")||Ke("Firefox")||Ke("FxiOS")||Ke("Silk")||Ke("Android")));function Qc(e,t){return/-[a-z]/.test(t)?null:Xc&&e.dataset?!Ke("Android")||$e()||Ke("Firefox")||Ke("FxiOS")||Ke("Opera")||Ke("Silk")||t in e.dataset?void 0===(e=e.dataset[t])?null:e:null:e.getAttribute("data-"+String(t).replace(/([A-Z])/g,"-$1").toLowerCase())}function Jc(e,t,n){var i=this;e=tn(bl,{items:e},null,this.s),Al.call(this,e,!0,!0),n&&(n=function(e,t){e=(e||document).getElementsByTagName("BUTTON");for(var n=0;n<e.length;n++)if(Qc(e[n],"listboxid")===t)return e[n];return null}(e,n))&&(n.focus(),function(e,t){var n=(t=t||Wt(document))||Wt(document),i=Wa(e),r=Wa(n);if(!Je||9<=Number(ut)){s=ja(n,"borderLeftWidth");var o=ja(n,"borderRightWidth");a=ja(n,"borderTopWidth"),l=ja(n,"borderBottomWidth"),o=new Ba(parseFloat(a),parseFloat(o),parseFloat(l),parseFloat(s))}else{var s=qa(n,"borderLeft");o=qa(n,"borderRight");var a=qa(n,"borderTop"),l=qa(n,"borderBottom");o=new Ba(a,o,l,s)}n==Wt(document)?(s=i.a-n.scrollLeft,i=i.g-n.scrollTop,!Je||10<=Number(ut)||(s+=o.left,i+=o.top)):(s=i.a-r.a-o.left,i=i.g-r.g-o.top),r=e.offsetWidth,o=e.offsetHeight,a=nt&&!r&&!o,e=d(r)&&!a||!e.getBoundingClientRect?new Ut(r,o):new Ut((e=Ga(e)).right-e.left,e.bottom-e.top),r=n.clientHeight-e.height,o=n.scrollLeft,a=n.scrollTop,n=new Ft(o+=Math.min(s,Math.max(s-(n.clientWidth-e.width),0)),a+=Math.min(i,Math.max(i-r,0))),t.scrollLeft=n.a,t.scrollTop=n.g}(n,e)),tl(this,e,(function(e){(e=(e=$t(e.target,"firebaseui-id-list-box-dialog-button"))&&Qc(e,"listboxid"))&&(kl.call(i),t(e))}))}function Zc(){return Ya(this,"firebaseui-id-phone-number")}function eh(){return Ya(this,"firebaseui-id-country-selector")}function th(){return Ya(this,"firebaseui-id-phone-number-error")}function nh(e,t){var n=e.a,i=ih("1-US-0",n),r=null;if(!(r=t&&ih(t,n)?t:i?"1-US-0":0<n.length?n[0].c:null))throw Error("No available default country");sh.call(this,r,e)}function ih(e,t){return!(!(e=ms(e))||!j(t,e))}function rh(e){return"firebaseui-flag-"+e.f}function oh(e){var t=this;Jc.call(this,function(e){return e.map((function(e){return{id:e.c,Ma:"firebaseui-flag "+rh(e),label:e.name+" ‎+"+e.b}}))}(e.a),(function(n){sh.call(t,n,e,!0),t.O().focus()}),this.Ba)}function sh(e,t,n){var i=ms(e);i&&(n&&((t=ps(t,n=Y(ma(Zc.call(this))||""))).length&&t[0].b!=i.b&&(n="+"+i.b+n.substr(t[0].b.length+1),ga(Zc.call(this),n))),t=ms(this.Ba),this.Ba=e,e=Ya(this,"firebaseui-id-country-selector-flag"),t&&pa(e,rh(t)),fa(e,rh(i)),Kt(Ya(this,"firebaseui-id-country-selector-code"),"‎+"+i.b))}function ah(e,t,n,i,r,o,s,a,l,u){Dl.call(this,yu,{Gb:t,Aa:l||null,Va:!!n,ia:!!o},u,"phoneSignInStart",{F:i,D:r}),this.H=a||null,this.M=t,this.l=e,this.w=n||null,this.pa=s||null}function lh(e,t,n,i){try{var r=t.U(Zs)}catch(e){return}r?Qs?(t.$("mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-progress-dialog-loading-icon",un("Verifying...").toString()),xh(e,t.I(k(e.cc,e),[Ts(r),n],(function(n){var i=Nl(t);t.$("firebaseui-icon-done",un("Code sent!").toString());var o=setTimeout((function(){t.h(),t.m(),ca("phoneSignInFinish",e,i,r,15,n)}),1e3);xh(e,(function(){t&&t.h(),clearTimeout(o)}))}),(function(n){if(t.h(),!n.name||"cancel"!=n.name){grecaptcha.reset(ea),Qs=null;var i=n&&n.message||"";if(n.code)switch(n.code){case"auth/too-many-requests":i=un("This phone number has been used too many times").toString();break;case"auth/invalid-phone-number":case"auth/missing-phone-number":return t.O().focus(),void il(t.B(),kn().toString());case"auth/admin-restricted-operation":if(Os(Mh(e)))return n=Nl(t),t.m(),void ca("handleUnauthorizedUser",e,n,Ts(r),D_.auth.PhoneAuthProvider.PROVIDER_ID);i=tc(n);break;default:i=tc(n)}t.a(i)}})))):Js?il(t.u(),un("Solve the reCAPTCHA").toString()):!Js&&i&&t.i().click():(t.O().focus(),il(t.B(),kn().toString()))}function uh(e,t,n,i,r){Dl.call(this,vu,{Sb:t},r,"providerSignIn",{F:n,D:i}),this.i=e}function ch(e,t,n,i,r,o,s){Dl.call(this,Ul,{email:n,Va:!!t,ia:!!o},s,"signIn",{F:i,D:r}),this.i=e,this.u=t}function hh(e,t,n,i,r,o,s){Dl.call(this,tu,{kc:e,yb:n,Eb:!!i},s,"unauthorizedUser",{F:r,D:o}),this.l=t,this.i=i}function dh(e,t,n,i,r,o){Dl.call(this,nu,{email:e},o,"unsupportedProvider",{F:i,D:r}),this.l=t,this.i=n}function fh(e,t){this.$=!1;var n=gh(t);if(mh[n])throw Error('An AuthUI instance already exists for the key "'+n+'"');mh[n]=this,this.a=e,this.u=null,this.Y=!1,ph(this.a),this.h=D_.initializeApp({apiKey:e.app.options.apiKey,authDomain:e.app.options.authDomain},e.app.name+"-firebaseui-temp").auth(),(e=e.emulatorConfig)&&(n=e.port,this.h.useEmulator(e.protocol+"://"+e.host+(null===n?"":":"+n),e.options)),ph(this.h),this.h.setPersistence&&this.h.setPersistence(D_.auth.Auth.Persistence.SESSION),this.oa=t,this.ca=new ks,this.g=this.T=this.i=this.J=this.O=null,this.s=[],this.Z=!1,this.l=Ir.Xa(),this.j=this.C=null,this.da=this.A=!1}function ph(e){e&&e.INTERNAL&&e.INTERNAL.logFramework&&e.INTERNAL.logFramework("FirebaseUI-web")}a(ah,Dl),ah.prototype.v=function(){this.ea(this.pa,this.H),this.P(this.l,this.w||void 0),this.M||Ol(this,this.O(),this.i()),Fl(this,this.i(),this.l),this.O().focus(),xc(this.O(),(this.O().value||"").length),Dl.prototype.v.call(this)},ah.prototype.o=function(){this.w=this.l=null,Dl.prototype.o.call(this)},x(ah.prototype,{Cb:Cl,O:Zc,B:th,ea:function(e,t,n){var i=this,r=Zc.call(this),o=eh.call(this),s=th.call(this),a=e||ws,l=a.a;if(0==l.length)throw Error("No available countries provided.");nh.call(i,a,t),tl(this,o,(function(){oh.call(i,a)})),Za(this,r,(function(){rl(s)&&(Ja(r,!0),nl(s));var e=Y(ma(r)||""),t=ms(this.Ba),n=ps(a,e);e=ih("1-US-0",l),n.length&&n[0].b!=t.b&&(t=n[0],sh.call(i,"1"==t.b&&e?"1-US-0":t.c,a))})),n&&el(this,r,(function(){n()}))},U:function(e){var t=Y(ma(Zc.call(this))||""),n=(e=e||ws).a,i=ps(ws,t);if(i.length&&!j(n,i[0]))throw ga(Zc.call(this)),Zc.call(this).focus(),il(th.call(this),un("The country code provided is not supported.").toString()),Error("The country code provided is not supported.");return n=ms(this.Ba),i.length&&i[0].b!=n.b&&sh.call(this,i[0].c,e),i.length&&(t=t.substr(i[0].b.length+1)),t?new _s(this.Ba,t):null},Ja:eh,ba:function(){return Ya(this,"firebaseui-recaptcha-container")},u:function(){return Ya(this,"firebaseui-id-recaptcha-error")},i:Tu,ua:Iu,P:Eu}),ua.phoneSignInStart=function(e,t,n,i){var r=function(e){var t=null;if(xs(e).forEach((function(e){e.provider==D_.auth.PhoneAuthProvider.PROVIDER_ID&&S(e.recaptchaParameters)&&!Array.isArray(e.recaptchaParameters)&&(t=se(e.recaptchaParameters))})),t){var n=[];la.forEach((function(e){void 0!==t[e]&&(n.push(e),delete t[e])})),n.length&&Qr('The following provided "recaptchaParameters" keys are not allowed: '+n.join(", "))}return t}(Mh(e))||{};Qs=null,Js=!(r&&"invisible"===r.size);var o=rc(e),s=function(e){var t=(e=Rs(e,D_.auth.PhoneAuthProvider.PROVIDER_ID))&&e.defaultCountry||null;t=t&&gs(t);var n=null;return e&&"string"==typeof e.loginHint&&(n=Ss(e.loginHint)),t&&t[0]||n&&ms(n.a)||null}(Mh(e)),a=o?function(e){var t=null;return(e=Rs(e,D_.auth.PhoneAuthProvider.PROVIDER_ID))&&"string"==typeof e.loginHint&&(t=Ss(e.loginHint)),e&&e.defaultNationalNumber||t&&t.Aa||null}(Mh(e)):null;s=n&&n.a||s&&s.c||null,n=n&&n.Aa||a,(a=Vs(Mh(e)))&&ys(a),Zs=a?new fs(Vs(Mh(e))):ws;var l=new ah((function(t){lh(e,l,u,!(!t||!t.keyCode))}),Js,o?null:function(){u.clear(),l.m(),oc(e,t)},Bs(Mh(e)),js(Mh(e)),o,Zs,s,n);l.render(t),yh(e,l),i&&l.a(i),r.callback=function(t){l.u()&&nl(l.u()),Qs=t,Js||lh(e,l,u)},r["expired-callback"]=function(){Qs=null};var u=new D_.auth.RecaptchaVerifier(Js?l.ba():l.i(),r,_h(e).app);xh(e,l.I(k(u.render,u),[],(function(e){ea=e}),(function(n){n.name&&"cancel"==n.name||(n=tc(n),l.m(),oc(e,t,void 0,n))})))},ua.prefilledEmailSignIn=function(e,t,n){var i=new Mc;i.render(t),yh(e,i),xh(e,i.I(k(wh(e).fetchSignInMethodsForEmail,wh(e)),[n],(function(r){i.m();var o=!(!ic(e)||!Th(e));ac(e,t,r,n,void 0,o)}),(function(r){r=tc(r),i.m(),ca("signIn",e,t,n,r)})))},a(uh,Dl),uh.prototype.v=function(){this.l(this.i),Dl.prototype.v.call(this)},uh.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(uh.prototype,{l:function(e){function t(t){e(t)}for(var n=this.g?Ht("firebaseui-id-idp-button",this.g||this.s.a):[],i=0;i<n.length;i++){var r=n[i];tl(this,r,C(t,Qc(r,"providerId")))}}}),ua.providerSignIn=function(e,t,n,i){var r=new uh((function(n){n==D_.auth.EmailAuthProvider.PROVIDER_ID?(r.m(),uc(e,t,i)):n==D_.auth.PhoneAuthProvider.PROVIDER_ID?(r.m(),ca("phoneSignInStart",e,t)):"anonymous"==n?function(e,t){xh(e,t.I(k(e.$b,e),[],(function(n){return t.m(),Ju(e,t,n,!0)}),(function(e){e.name&&"cancel"==e.name||(Kr("ContinueAsGuest: "+e.code,void 0),e=tc(e),t.a(e))})))}(e,r):nc(e,r,n,i),Ph(e),e.l.cancel()}),Ps(Mh(e)),Bs(Mh(e)),js(Mh(e)));r.render(t),yh(e,r),n&&r.a(n),function(e){Ph(e);try{Er(e.l,Ds(Mh(e)),function(e){var t;return Ph(e),(t=e.Z)||(e=Mh(e),e=Us(e,D_.auth.GoogleAuthProvider.PROVIDER_ID),t=!(!e||"select_account"!==e.prompt)),t}(e)).then((function(t){return!!e.g&&function(e,t,n){if(n&&n.credential&&n.clientId===Ds(Mh(e))){if(Fs(Mh(e),D_.auth.GoogleAuthProvider.PROVIDER_ID).length){try{var i=JSON.parse(atob(n.credential.split(".")[1])).email}catch(r){}return nc(e,t,D_.auth.GoogleAuthProvider.PROVIDER_ID,i),Wi(!0)}return r=D_.auth.GoogleAuthProvider.credential(n.credential),o=!1,r=t.I(k(e.ac,e),[r],(function(n){var i=Nl(t);t.m(),ca("callback",e,i,Wi(n)),o=!0}),(function(n){if(!(n.name&&"cancel"==n.name||n&&"auth/credential-already-in-use"==n.code))if(n&&"auth/email-already-in-use"==n.code&&n.email&&n.credential){var i=Nl(t);t.m(),ca("callback",e,i,zi(n))}else n&&"auth/admin-restricted-operation"==n.code&&Os(Mh(e))?(n=Nl(t),t.m(),ca("handleUnauthorizedUser",e,n,null,D_.auth.GoogleAuthProvider.PROVIDER_ID)):(n=tc(n),t.a(n))})),xh(e,r),r.then((function(){return o}),(function(){return!1}))}var r,o;return n&&t.a(un("The selected credential for the authentication provider is not supported!").toString()),Wi(!1)}(e,e.g,t)}))}catch(e){}}(e)},ua.sendEmailLinkForSignIn=function(e,t,n,i){var r=new fc;r.render(t),yh(e,r),lc(e,r,n,i,(function(i){r.m(),i&&"auth/admin-restricted-operation"==i.code&&Os(Mh(e))?ca("handleUnauthorizedUser",e,t,n,D_.auth.EmailAuthProvider.PROVIDER_ID):(i=tc(i),ca("signIn",e,t,n,i))}))},a(ch,Dl),ch.prototype.v=function(){this.w(this.i),this.B(this.i,this.u||void 0),this.l().focus(),xc(this.l(),(this.l().value||"").length),Dl.prototype.v.call(this)},ch.prototype.o=function(){this.u=this.i=null,Dl.prototype.o.call(this)},x(ch.prototype,{l:Mu,M:Pu,w:Du,H:Nu,j:Ou,U:Tu,P:Iu,B:Eu}),ua.signIn=function(e,t,n,i){var r=ic(e),o=new ch((function(){var t=o,n=t.j()||"";n&&sc(e,t,n)}),r?null:function(){o.m(),oc(e,t,n)},n,Bs(Mh(e)),js(Mh(e)),r);o.render(t),yh(e,o),i&&o.a(i)},a(hh,Dl),hh.prototype.v=function(){var e=this,t=Ya(this,"firebaseui-id-unauthorized-user-help-link");this.i&&t&&tl(this,t,(function(){e.i()})),tl(this,this.u(),(function(){e.l()})),this.u().focus(),Dl.prototype.v.call(this)},hh.prototype.o=function(){this.i=this.l=null,Dl.prototype.o.call(this)},x(hh.prototype,{u:Iu}),ua.handleUnauthorizedUser=function(e,t,n,i){function r(){oc(e,t)}i===D_.auth.EmailAuthProvider.PROVIDER_ID?r=function(){uc(e,t)}:i===D_.auth.PhoneAuthProvider.PROVIDER_ID&&(r=function(){ca("phoneSignInStart",e,t)});var o=null,s=null;i===D_.auth.EmailAuthProvider.PROVIDER_ID&&Ns(Mh(e))?(o=function(e){return(e=Rs(e,D_.auth.EmailAuthProvider.PROVIDER_ID))&&e.disableSignUp&&e.disableSignUp.adminEmail||null}(Mh(e)),s=function(e){if((e=Rs(e,D_.auth.EmailAuthProvider.PROVIDER_ID))&&e.disableSignUp){var t=e.disableSignUp.helpLink||null;if(t&&"string"==typeof t)return function(){rr(t)}}return null}(Mh(e))):Os(Mh(e))&&(o=function(e){return(e=e.a.get("adminRestrictedOperation"))&&e.adminEmail?e.adminEmail:null}(Mh(e)),s=function(e){if(e=e.a.get("adminRestrictedOperation")||null){var t=e.helpLink||null;if(t&&"string"==typeof t)return function(){rr(t)}}return null}(Mh(e)));var a=new hh(n,(function(){a.m(),r()}),o,s,Bs(Mh(e)),js(Mh(e)));a.render(t),yh(e,a)},a(dh,Dl),dh.prototype.v=function(){this.w(this.l,this.i),this.u().focus(),Dl.prototype.v.call(this)},dh.prototype.o=function(){this.i=this.l=null,Dl.prototype.o.call(this)},x(dh.prototype,{u:Tu,B:Iu,w:Eu}),ua.unsupportedProvider=function(e,t,n){var i=new dh(n,(function(){i.m(),ca("passwordRecovery",e,t,n)}),(function(){i.m(),oc(e,t,n)}),Bs(Mh(e)),js(Mh(e)));i.render(t),yh(e,i)};var mh={};function gh(e){return e||"[DEFAULT]"}function vh(e){return Ph(e),e.i||(e.i=kh(e,(function(t){return t&&!ts(Sh(e))?Wi(_h(e).getRedirectResult().then((function(e){return e}),(function(t){if(t&&"auth/email-already-in-use"==t.code&&t.email&&t.credential)throw t;return Oh(e,t)}))):Wi(wh(e).getRedirectResult().then((function(t){return Cs(Mh(e))&&!t.user&&e.j&&!e.j.isAnonymous?_h(e).getRedirectResult():t})))}))),e.i}function yh(e,t){Ph(e),e.g=t}var bh=null;function wh(e){return Ph(e),e.h}function _h(e){return Ph(e),e.a}function Sh(e){return Ph(e),e.oa}function Th(e){return Ph(e),e.O?e.O.emailHint:void 0}function Ih(e){return"signIn"===((e=new He(e)).a.a.get(We.ub)||null)&&!!e.a.a.get(We.$a)}function Eh(e,t,n,i){Ph(e),void 0!==e.a.languageCode&&(e.u=e.a.languageCode);var r="en".replace(/_/g,"-");e.a.languageCode=r,e.h.languageCode=r,e.Y=!0,void 0!==e.a.tenantId&&(e.h.tenantId=e.a.tenantId),e.ib(n),e.O=i||null;var o=h.document;e.C?e.C.then((function(){"complete"==o.readyState?Ah(e,t):ri(window,"load",(function(){Ah(e,t)}))})):"complete"==o.readyState?Ah(e,t):ri(window,"load",(function(){Ah(e,t)}))}function Ah(e,t){var n=or(t,"Could not find the FirebaseUI widget element on the page.");if(n.setAttribute("lang","en".replace(/_/g,"-")),bh){var i=bh;Ph(i),ts(Sh(i))&&Qr("UI Widget is already rendered on the page and is pending some user interaction. Only one widget instance can be rendered per page. The previous instance has been automatically reset."),bh.reset()}if(bh=e,e.T=n,function(e,t){e.L=null,e.J=new Si(t),e.J.register(),ni(e.J,"pageEnter",(function(t){if(t=t&&t.pageId,e.L!=t){var n=Mh(e);(n=Xs(n).uiChanged||null)&&n(e.L,t),e.L=t}}))}(e,n),Ho(new Bo)&&Ho(new jo)){t=or(t,"Could not find the FirebaseUI widget element on the page."),n=(n=be(n=sr(),i=ls(Mh(e).a,"queryParameterForSignInSuccessUrl")))?wt(St(n)).toString():null;e:{i=sr();var r=Hs(Mh(e));for(o in i=be(i,r)||"",sa)if(sa[o].toLowerCase()==i.toLowerCase()){var o=sa[o];break e}o="callback"}switch(o){case"callback":n&&(o=Sh(e),Zo($o,n,o)),e.nb()?ca("callback",e,t):oc(e,t,Th(e));break;case"resetPassword":ca("passwordReset",e,t,cc(),hc());break;case"recoverEmail":ca("emailChangeRevocation",e,t,cc());break;case"revertSecondFactorAddition":ca("revertSecondFactorAddition",e,t,cc());break;case"verifyEmail":ca("emailVerification",e,t,cc(),hc());break;case"verifyAndChangeEmail":ca("verifyAndChangeEmail",e,t,cc(),hc());break;case"signIn":ca("emailLinkSignInCallback",e,t,sr()),Dh();break;case"select":n&&(o=Sh(e),Zo($o,n,o)),oc(e,t);break;default:throw Error("Unhandled widget operation.")}(t=Xs(t=Mh(e)).uiShown||null)&&t()}else t=or(t,"Could not find the FirebaseUI widget element on the page."),(o=new Xu(un("The browser you are using does not support Web Storage. Please try again in a different browser.").toString())).render(t),yh(e,o);t=e.g&&"blank"==e.g.Ga&&zs(Mh(e)),rs(Sh(e))&&!t&&(Lh(e,(t=rs(Sh(e))).a),Jo(Ko,Sh(e)))}function kh(e,t){if(e.A)return t(Ch(e));if(xh(e,(function(){e.A=!1})),Cs(Mh(e))){var n=new Fi((function(n){xh(e,e.a.onAuthStateChanged((function(i){e.j=i,e.A||(e.A=!0,n(t(Ch(e))))})))}));return xh(e,n),n}return e.A=!0,t(null)}function Ch(e){return Ph(e),Cs(Mh(e))&&e.j&&e.j.isAnonymous?e.j:null}function xh(e,t){if(Ph(e),t){e.s.push(t);var n=function(){z(e.s,(function(e){return e==t}))};"function"!=typeof t&&t.then(n,n)}}function Rh(e){void 0!==e.a.languageCode&&e.Y&&(e.Y=!1,e.a.languageCode=e.u)}function Lh(e,t){e.a.tenantId=t,e.h.tenantId=t}function Mh(e){return Ph(e),e.ca}function Ph(e){if(e.$)throw Error("AuthUI instance is deleted!")}function Dh(){var e=sr();if(Ih(e)){for(var t in e=new He(e),We)We.hasOwnProperty(t)&&Oe(e.a.a,We[t]);t={state:"signIn",mode:"emailLink",operation:"clear"};var n=h.document.title;h.history&&h.history.replaceState&&h.history.replaceState(t,n,e.toString())}}function Nh(e){return Ph(e),wh(e).signOut()}function Oh(e,t,n){if(Ph(e),t&&t.code&&("auth/email-already-in-use"==t.code||"auth/credential-already-in-use"==t.code)){var i=Ys(Mh(e));return Wi().then((function(){return i(new Pn("anonymous-upgrade-merge-conflict",null,n||t.credential))})).then((function(){throw e.g&&(e.g.m(),e.g=null),t}))}return zi(t)}function Fh(e,t,n,i){Dl.call(this,Su,void 0,i,"providerMatchByEmail",{F:t,D:n}),this.i=e}function Uh(e,t,n,i,r){Dl.call(this,_u,{ec:t},r,"selectTenant",{F:n,D:i}),this.i=e}function Vh(e){Dl.call(this,Wl,void 0,e,"spinner")}function Hh(e){for(var t in this.a=new os,ss(this.a,"authDomain"),ss(this.a,"displayMode",$h),ss(this.a,"tenants"),ss(this.a,"callbacks"),ss(this.a,"tosUrl"),ss(this.a,"privacyPolicyUrl"),e)if(e.hasOwnProperty(t))try{as(this.a,t,e[t])}catch(e){Kr('Invalid config: "'+t+'"',void 0)}}function Bh(e){return e.a.get("callbacks")||{}}function jh(e){var t=e.a.get("tosUrl")||null;if(e=e.a.get("privacyPolicyUrl")||null,t&&!e&&Qr("Privacy Policy URL is missing, the link will not be displayed."),t&&e){if("function"==typeof t)return t;if("string"==typeof t)return function(){rr(t)}}return null}function Gh(e){var t=e.a.get("tosUrl")||null,n=e.a.get("privacyPolicyUrl")||null;if(n&&!t&&Qr("Terms of Service URL is missing, the link will not be displayed."),t&&n){if("function"==typeof n)return n;if("string"==typeof n)return function(){rr(n)}}return null}function Wh(e,t){if(!(e=e.a.get("tenants"))||!e.hasOwnProperty(t)&&!e.hasOwnProperty(Xh))throw Error("Invalid tenant configuration!")}function zh(e,t,n){if(!(e=e.a.get("tenants")))throw Error("Invalid tenant configuration!");var i=[];if(!(e=e[t]||e[Xh]))return Kr("Invalid tenant configuration: "+t+" is not configured!",void 0),i;if(!(t=e.signInOptions))throw Error("Invalid tenant configuration: signInOptions are invalid!");return t.forEach((function(e){if("string"==typeof e)i.push(e);else if("string"==typeof e.provider){var t=e.hd;t&&n?(t instanceof RegExp?t:new RegExp("@"+t.replace(".","\\.")+"$")).test(n)&&i.push(e.provider):i.push(e.provider)}else Kr(e="Invalid tenant configuration: signInOption "+JSON.stringify(e)+" is invalid!",void 0)})),i}function qh(e,t,n){return e=function(e,t){var n=Kh,i=void 0===i?{}:i;return Wh(e,t),e=e.a.get("tenants"),function(e,t,n){return n=void 0===n?{}:n,Object.keys(e).filter((function(e){return t.includes(e)})).reduce((function(t,n){return t[n]=e[n],t}),n)}(e[t]||e[Xh],n,i)}(e,t),(t=e.signInOptions)&&n&&(t=t.filter((function(e){return"string"==typeof e?n.includes(e):n.includes(e.provider)})),e.signInOptions=t),e}(e=fh.prototype).nb=function(){return Ph(this),!!rs(Sh(this))||Ih(sr())},e.start=function(e,t){Eh(this,e,t)},e.Db=function(){Ph(this),this.Z=!0},e.reset=function(){Ph(this);var e=this;this.T&&this.T.removeAttribute("lang"),this.J&&wi(this.J),Rh(this),this.O=null,Dh(),Jo(Ko,Sh(this)),Ph(this),this.l.cancel(),this.i=Wi({user:null,credential:null}),bh==this&&(bh=null),this.T=null;for(var t=0;t<this.s.length;t++)"function"==typeof this.s[t]?this.s[t]():this.s[t].cancel&&this.s[t].cancel();this.s=[],ns(Sh(this)),this.g&&(this.g.m(),this.g=null),this.L=null,this.h&&(this.C=Nh(this).then((function(){e.C=null}),(function(){e.C=null})))},e.ib=function(e){Ph(this);var t,n=this.ca;for(t in e)try{as(n.a,t,e[t])}catch(e){Kr('Invalid config: "'+t+'"',void 0)}it&&as(n.a,"popupMode",!1),Vs(n),!this.da&&Ks(Mh(this))&&(Qr("signInSuccess callback is deprecated. Please use signInSuccessWithAuthResult callback instead."),this.da=!0)},e.Wb=function(){Ph(this);var e=Mh(this),t=ls(e.a,"widgetUrl");e=Hs(e);for(var n,i=t.search(ye),r=0,o=[];0<=(n=ve(t,r,e,i));)o.push(t.substring(r,n)),r=Math.min(t.indexOf("&",n)+1||i,i);o.push(t.substr(r)),t=o.join("").replace(we,"$1"),(e+=i="="+encodeURIComponent("select"))?(0>(i=t.indexOf("#"))&&(i=t.length),0>(r=t.indexOf("?"))||r>i?(r=i,n=""):n=t.substring(r+1,i),i=(t=[t.substr(0,r),n,t.substr(i)])[1],t[1]=e?i?i+"&"+e:e:i,i=t[0]+(t[1]?"?"+t[1]:"")+t[2]):i=t,Mh(this).a.get("popupMode")?(i=i||"about:blank",(e={width:500,height:600,top:0<(e=(window.screen.availHeight-600)/2)?e:0,left:0<(t=(window.screen.availWidth-500)/2)?t:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1}).target=e.target||i.target||"google_popup",e.width=e.width||690,e.height=e.height||500,(e=nr(i,e))&&e.focus()):Ot(window.location,i)},e.Wa=function(){var e=this;return Ph(this),this.h.app.delete().then((function(){var t=gh(Sh(e));delete mh[t],e.reset(),e.$=!0}))},e.Ib=function(e,t){Ph(this);var n=this,i=function(){for(var e=32,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();if(!Ws(Mh(this)))return zi(Error("Email link sign-in should be enabled to trigger email sending."));var r=function(e){if(Ws(e)){var t={url:sr(),handleCodeInApp:!0};(e=Rs(e,D_.auth.EmailAuthProvider.PROVIDER_ID))&&"function"==typeof e.emailLinkSignIn&&le(t,e.emailLinkSignIn()),e=t.url;var n=sr();n instanceof _e||(n=Ee(n)),e instanceof _e||(e=Ee(e));var i=n;n=new _e(i);var r=!!e.j;r?Se(n,e.j):r=!!e.A,r?n.A=e.A:r=!!e.h,r?n.h=e.h:r=null!=e.C;var o=e.g;if(r)Te(n,e.C);else if(r=!!e.g)if("/"!=o.charAt(0)&&(i.h&&!i.g?o="/"+o:-1!=(i=n.g.lastIndexOf("/"))&&(o=n.g.substr(0,i+1)+o)),".."==o||"."==o)o="";else if(-1!=o.indexOf("./")||-1!=o.indexOf("/.")){i=0==o.lastIndexOf("/",0),o=o.split("/");for(var s=[],a=0;a<o.length;){var l=o[a++];"."==l?i&&a==o.length&&s.push(""):".."==l?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),i&&a==o.length&&s.push("")):(s.push(l),i=!0)}o=s.join("/")}return r?n.g=o:r=""!==e.a.toString(),r?Ie(n,Ue(e.a)):r=!!e.s,r&&(n.s=e.s),t.url=n.toString(),t}return null}(Mh(this)),o=new He(r.url);return function(e,t){t?e.a.a.set(We.Sa,t):Oe(e.a.a,We.Sa)}(o,i),t&&t.a&&(function(e,t,n){Zo(Xo,Co(e,JSON.stringify(ro(t))),n)}(i,t,Sh(this)),je(o,t.a.providerId)),function(e,t){null!==t?e.a.a.set(We.Qa,t?"1":"0"):Oe(e.a.a,We.Qa)}(o,function(e){return!(!(e=Rs(e,D_.auth.EmailAuthProvider.PROVIDER_ID))||!e.forceSameDevice)}(Mh(this))),kh(this,(function(t){return t&&((t=t.uid)?o.a.a.set(We.Pa,t):Oe(o.a.a,We.Pa)),r.url=o.toString(),wh(n).sendSignInLinkToEmail(e,r)})).then((function(){var t=Sh(n),r={};r.email=e,Zo(Yo,Co(i,JSON.stringify(r)),t)}),(function(e){throw Jo(Xo,Sh(n)),Jo(Yo,Sh(n)),e}))},e.bc=function(e,t){Ph(this);var n=this;return wh(this).signInWithEmailAndPassword(e,t).then((function(i){return kh(n,(function(r){return r?Nh(n).then((function(){return Oh(n,{code:"auth/email-already-in-use"},D_.auth.EmailAuthProvider.credential(e,t))})):i}))}))},e.Yb=function(e,t){Ph(this);var n=this;return kh(this,(function(i){if(i){var r=D_.auth.EmailAuthProvider.credential(e,t);return i.linkWithCredential(r)}return wh(n).createUserWithEmailAndPassword(e,t)}))},e.ac=function(e){Ph(this);var t=this;return kh(this,(function(n){return n?n.linkWithCredential(e).then((function(e){return e}),(function(n){if(n&&"auth/email-already-in-use"==n.code&&n.email&&n.credential)throw n;return Oh(t,n,e)})):wh(t).signInWithCredential(e)}))},e.dc=function(e){Ph(this);var t=this,n=this.i;return this.i=null,kh(this,(function(n){return n&&!ts(Sh(t))?n.linkWithRedirect(e):wh(t).signInWithRedirect(e)})).then((function(){}),(function(e){throw t.i=n,e}))},e.cc=function(e,t){Ph(this);var n=this;return kh(this,(function(i){return i?i.linkWithPhoneNumber(e,t).then((function(e){return new Cr(e,(function(e){if("auth/credential-already-in-use"==e.code)return Oh(n,e);throw e}))})):_h(n).signInWithPhoneNumber(e,t).then((function(e){return new Cr(e)}))}))},e.$b=function(){return Ph(this),_h(this).signInAnonymously()},e.Xb=function(e,t){return Ph(this),wh(this).signInWithEmailAndPassword(e,t)},a(Fh,Dl),Fh.prototype.v=function(){this.u(this.i),this.w(this.i),this.l().focus(),xc(this.l(),(this.l().value||"").length),Dl.prototype.v.call(this)},Fh.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},x(Fh.prototype,{l:Mu,H:Pu,u:Du,B:Nu,j:Ou,M:Tu,w:Eu}),a(Uh,Dl),Uh.prototype.v=function(){!function(e,t){function n(e){t(e)}for(var i=e.g?Ht("firebaseui-id-tenant-selection-button",e.g||e.s.a):[],r=0;r<i.length;r++){var o=i[r];tl(e,o,C(n,Qc(o,"tenantId")))}}(this,this.i),Dl.prototype.v.call(this)},Uh.prototype.o=function(){this.i=null,Dl.prototype.o.call(this)},a(Vh,Dl);var Kh=["immediateFederatedRedirect","privacyPolicyUrl","signInFlow","signInOptions","tosUrl"],$h="optionFirst",Yh={pc:$h,oc:"identifierFirst"},Xh="*";function Qh(e,t){var n=this;this.s=or(e),this.a={},Object.keys(t).forEach((function(e){n.a[e]=new Hh(t[e])})),this.ob=this.g=this.A=this.h=this.i=this.j=null,Object.defineProperty(this,"languageCode",{get:function(){return this.ob},set:function(e){this.ob=e||null},enumerable:!1})}function Jh(e){e.j&&e.j.reset(),e.mb(),e.g&&e.g.m()}(e=Qh.prototype).Ub=function(e,t){var n=this;Jh(this);var i=e.apiKey;return new Fi((function(e,r){if(n.a.hasOwnProperty(i)){var o=Bh(n.a[i]).selectTenantUiHidden||null;if(function(e){for(var t in e=e.a.get("displayMode"),Yh)if(Yh[t]===e)return Yh[t];return $h}(n.a[i])===$h){var s=[];t.forEach((function(e){e=e||"_";var t=n.a[i].a.get("tenants");if(!t)throw Error("Invalid tenant configuration!");(t=t[e]||t[Xh])?e={tenantId:"_"!==e?e:null,V:t.fullLabel||null,displayName:t.displayName,za:t.iconUrl,ta:t.buttonColor}:(Kr("Invalid tenant configuration: "+e+" is not configured!",void 0),e=null),e&&s.push(e)}));var a=function(t){t={tenantId:t,providerIds:zh(n.a[i],t||"_")},e(t)};if(1===s.length)return void a(s[0].tenantId);n.g=new Uh((function(e){Jh(n),o&&o(),a(e)}),s,jh(n.a[i]),Gh(n.a[i]))}else n.g=new Fh((function(){var r=n.g.j();if(r){for(var s=0;s<t.length;s++){var a=zh(n.a[i],t[s]||"_",r);if(0!==a.length)return r={tenantId:t[s],providerIds:a,email:r},Jh(n),o&&o(),void e(r)}n.g.a(Ln({code:"no-matching-tenant-for-email"}).toString())}}),jh(n.a[i]),Gh(n.a[i]));n.g.render(n.s),(r=Bh(n.a[i]).selectTenantUiShown||null)&&r()}else{var l=Error("Invalid project configuration: API key is invalid!");l.code="invalid-configuration",n.pb(l),r(l)}}))},e.Pb=function(e,t){if(!this.a.hasOwnProperty(e))throw Error("Invalid project configuration: API key is invalid!");var n=t||void 0;Wh(this.a[e],t||"_");try{this.i=D_.app(n).auth()}catch(r){var i=this.a[e].a.get("authDomain");if(!i)throw Error("Invalid project configuration: authDomain is required!");(e=D_.initializeApp({apiKey:e,authDomain:i},n)).auth().tenantId=t,this.i=e.auth()}return this.i},e.Zb=function(e,t){var n=this;return new Fi((function(i,r){function o(t,i){n.j=new fh(e),Eh(n.j,n.s,t,i)}var s=e.app.options.apiKey;n.a.hasOwnProperty(s)||r(Error("Invalid project configuration: API key is invalid!"));var a=qh(n.a[s],e.tenantId||"_",t&&t.providerIds);Jh(n),r={signInSuccessWithAuthResult:function(e){return i(e),!1}};var l,u=Bh(n.a[s]).signInUiShown||null,c=!1;r.uiChanged=function(t,i){null===t&&"callback"===i?((t=Bt("firebaseui-id-page-callback",n.s))&&nl(t),n.h=new Vh,n.h.render(n.s)):c||null===t&&"spinner"===i||"blank"===i||(n.h&&(n.h.m(),n.h=null),c=!0,u&&u(e.tenantId))},a.callbacks=r,a.credentialHelper="none",t&&t.email&&(l={emailHint:t.email}),n.j?n.j.Wa().then((function(){o(a,l)})):o(a,l)}))},e.reset=function(){var e=this;return Wi().then((function(){e.j&&e.j.Wa()})).then((function(){e.j=null,Jh(e)}))},e.Vb=function(){var e=this;this.h||this.A||(this.A=window.setTimeout((function(){Jh(e),e.h=new Vh,e.g=e.h,e.h.render(e.s),e.A=null}),500))},e.mb=function(){window.clearTimeout(this.A),this.A=null,this.h&&(this.h.m(),this.h=null)},e.Bb=function(){return Jh(this),this.g=new zu,this.g.render(this.s),Wi()},e.pb=function(e){var t,n=this,i=Ln({code:e.code}).toString()||e.message;Jh(this),e.retry&&"function"==typeof e.retry&&(t=function(){n.reset(),e.retry()}),this.g=new Yu(i,t),this.g.render(this.s)},e.Rb=function(e){var t=this;return Wi().then((function(){var n=t.i&&t.i.app.options.apiKey;if(!t.a.hasOwnProperty(n))throw Error("Invalid project configuration: API key is invalid!");if(Wh(t.a[n],e.tenantId||"_"),!t.i.currentUser||t.i.currentUser.uid!==e.uid)throw Error("The user being processed does not match the signed in user!");return(n=Bh(t.a[n]).beforeSignInSuccess||null)?n(e):e})).then((function(t){if(t.uid!==e.uid)throw Error("User with mismatching UID returned.");return t}))},M("firebaseui.auth.FirebaseUiHandler",Qh),M("firebaseui.auth.FirebaseUiHandler.prototype.selectTenant",Qh.prototype.Ub),M("firebaseui.auth.FirebaseUiHandler.prototype.getAuth",Qh.prototype.Pb),M("firebaseui.auth.FirebaseUiHandler.prototype.startSignIn",Qh.prototype.Zb),M("firebaseui.auth.FirebaseUiHandler.prototype.reset",Qh.prototype.reset),M("firebaseui.auth.FirebaseUiHandler.prototype.showProgressBar",Qh.prototype.Vb),M("firebaseui.auth.FirebaseUiHandler.prototype.hideProgressBar",Qh.prototype.mb),M("firebaseui.auth.FirebaseUiHandler.prototype.completeSignOut",Qh.prototype.Bb),M("firebaseui.auth.FirebaseUiHandler.prototype.handleError",Qh.prototype.pb),M("firebaseui.auth.FirebaseUiHandler.prototype.processUser",Qh.prototype.Rb),M("firebaseui.auth.AuthUI",fh),M("firebaseui.auth.AuthUI.getInstance",(function(e){return e=gh(e),mh[e]?mh[e]:null})),M("firebaseui.auth.AuthUI.prototype.disableAutoSignIn",fh.prototype.Db),M("firebaseui.auth.AuthUI.prototype.start",fh.prototype.start),M("firebaseui.auth.AuthUI.prototype.setConfig",fh.prototype.ib),M("firebaseui.auth.AuthUI.prototype.signIn",fh.prototype.Wb),M("firebaseui.auth.AuthUI.prototype.reset",fh.prototype.reset),M("firebaseui.auth.AuthUI.prototype.delete",fh.prototype.Wa),M("firebaseui.auth.AuthUI.prototype.isPendingRedirect",fh.prototype.nb),M("firebaseui.auth.AuthUIError",Pn),M("firebaseui.auth.AuthUIError.prototype.toJSON",Pn.prototype.toJSON),M("firebaseui.auth.CredentialHelper.GOOGLE_YOLO",ta),M("firebaseui.auth.CredentialHelper.NONE",na),M("firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID","anonymous"),Fi.prototype.catch=Fi.prototype.Ca,Fi.prototype.finally=Fi.prototype.fc}).apply(void 0!==t?t:"undefined"!=typeof self?self:window)}.apply(void 0!==t?t:"undefined"!=typeof self?self:window),"undefined"!=typeof window&&(window.dialogPolyfill=n(CS));var DS=firebaseui.auth;class NS{firebaseConfig={apiKey:"AIzaSyBaILJolbhEas7fzIBxAqqVwlptlpYbvq8",authDomain:"lurk-leap-loot.firebaseapp.com",projectId:"lurk-leap-loot",storageBucket:"lurk-leap-loot.appspot.com",messagingSenderId:"116296425992",appId:"1:116296425992:web:57e4ff993152df7981a7bd",measurementId:"G-T14R1XCP4B"};user=null;scoreData=null;scoreDate=null;userScoreRanking=NaN;constructor(){this.app=yr(this.firebaseConfig),this.db=Lw(this.app);ua(tu(this.app),(e=>{e?this.user=e:(console.log("Auth state changed: no user logged in"),this.user=null)}))}openSignInPopup(e){const t=tu(this.app);let n=document.getElementById("server-login");return null!==n&&(n.style.display="flex",new DS.AuthUI(t).start("#firebaseui-auth-container",{signInOptions:[ws.PROVIDER_ID,Es.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:()=>this.closeSigninPopup(e)}}),!0)}closeSigninPopup(e){let t=document.getElementById("server-login");return null!==t&&(t.style.display="none"),e(),!1}async submitConfig(e){const t=tu(this.app).currentUser,n=document.getElementById("servermessage");if(null!==n)if(null!==t)try{const i=t.uid;await ea(t,{displayName:e.value.slice(0,20)}),await E_(Cw(this.db,"display_names",i),{display_name:e.value.slice(0,20)});n.innerHTML="Display name updated"}catch(e){"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message&&(n.innerHTML=e.message)}else n&&(n.innerHTML="Not logged in as a user. Close this dialog and login.")}openConfigPopup(e){const t=tu(this.app);if(!t.currentUser)return!1;const n=document.getElementById("servermessage");if(null===n)return!1;n.innerHTML="";const i=document.getElementById("displayname");if(null===i)return!1;i.value=t.currentUser.displayName??"";document.getElementById("serversubmit").onclick=()=>this.submitConfig(i);document.getElementById("serverclose").onclick=()=>this.closeConfigPopup(e);const r=document.getElementById("server-config");return null!==r&&(r.style.display="flex",!0)}closeConfigPopup(e){let t=document.getElementById("server-config");if(null!==t){t.style.display="none";t.offsetHeight;e()}}async signOut(){return ca(tu(this.app))}async getUserScore(e){}async addScore(e,t,n){const i=new Date,r=this.user?.uid;if(!r)return void console.log("No user active -- store cannot be uploaded to server");const o={score:e,turns:t,level:n,date:Xf.fromDate(i)};console.log(tu(this.app));const s=new Date(i),a=r+"_"+s.getUTCFullYear()+"_"+(s.getUTCMonth()+1)+"_"+s.getUTCDate();E_(Cw(this.db,"daily_challenge_scores",a),o).then((e=>{console.log("Added score to firebase")})).catch((e=>{console.log(e)}))}async getScoresForDate(e){this.scoreDate=null,this.scoreData=null,this.userScoreRanking=NaN;var t=new Date(e);const n=Xf.fromDate(t);t.setDate(t.getDate()-1);const i=Xf.fromDate(t),r=await kw(this.db,"daily_challenge_scores"),o=await a_(r,u_("date",">=",i),u_("date","<",n)),s=await I_(o),a=[];for(let e of s.docs){const t=e.id.split("_",1)[0],n=Cw(this.db,"display_names",t),i=await S_(n),r=i.exists()?String(i.data().display_name.slice(0,20).replace("]",")").replace("[","(")):"",o=e.data(),s={uid:t,dname:r,score:o.score,level:o.level,turns:o.turns};a.push(s)}if(this.scoreData=a.sort(((e,t)=>1e7*-(e.level-t.level)-1e5*(e.score-t.score)+(e.turns-t.turns))),this.scoreDate=e,this.user?.uid){const e=this.user.uid;this.userScoreRanking=a.findIndex((t=>t.uid==e))+1}0===this.userScoreRanking&&(this.userScoreRanking=NaN)}getFormattedScoreData(e,t,n){if(null===this.scoreData)return["",null,0,0];let i="    #   "+"Name".padEnd(21)+"Lvl".padEnd(5)+"Score".padEnd(6)+"Turns".padEnd(7)+"\n\n";const r=this.user?.uid,o=Math.max(Math.min(e,this.scoreData.length-t),0),s=this.scoreData.length-o;for(let e=o;e<s;++e){const t=this.scoreData[e],n=""!=t.dname?t.dname:t.uid;i+=(t.uid===r?" #80# ":"    ")+String(e+1).padEnd(3)+" "+n.slice(0,20).padEnd(21)+String(t.level).padEnd(5)+String(t.score).padEnd(6)+String(t.turns).padEnd(7)+"\n"}0==this.scoreData.length&&(i+="    No scores submitted.");for(let e=s-o;e<t;++e)i+="\n";return[i,this.scoreDate,o,s-o]}}const OS={numGameMaps:10,totalGameLoot:100};let FS;var US;(US=FS||(FS={}))[US.Creak=0]="Creak",US[US.Splash=1]="Splash";const VS=ht(),HS=dt();window.onload=function(){Promise.all([hT(HS.imageSrc,HS.image),hT(VS.imageSrc,VS.image)]).then(KS)};const BS=65,jS=8,GS=16,WS=16,zS=16,qS="Esc or / for help";function KS(e){const t=document.querySelector("#canvas");document.body.addEventListener("keydown",(function(e){0==Object.keys(i.sounds).length&&(rn(i.sounds,i.subtitledSounds,i.activeSoundPool),e.preventDefault())})),t.addEventListener("mousedown",(function(e){0==Object.keys(i.sounds).length&&(rn(i.sounds,i.subtitledSounds,i.activeSoundPool),e.preventDefault())})),t.addEventListener("touchstart",(function(e){0==Object.keys(i.sounds).length&&(rn(i.sounds,i.subtitledSounds,i.activeSoundPool),e.preventDefault())}));const n=new Ye(t,VS,HS),i=function(e,t,n,i){const r=new v,o=0,s=ye(OS.numGameMaps,OS.totalGameLoot,r),a=we(o,s[o],r),l=yT(),u="Gamepad"===(window.localStorage.getItem("touchMode")??"Gamepad");return{scoreServer:new NS,gameStats:{lootStolen:0,lootSpent:0,ghostBonuses:0,timeBonuses:0,maxGhostBonuses:0,maxTimeBonuses:0,maxLootStolen:0},lightStates:[],particles:[],stats:l,tLast:void 0,dt:0,idleTimer:0,initialSeen:0,rng:r,dailyRun:null,leapToggleActive:!1,gameMode:mn.HomeScreen,helpScreen:new kn,textWindows:{[mn.HomeScreen]:new yn,[mn.OptionsScreen]:new bn,[mn.StatsScreen]:new _n,[mn.DailyHub]:new wn,[mn.BetweenMansions]:new Sn,[mn.Dead]:new Tn,[mn.Win]:new In},helpActive:!1,player:new ie(a.playerStartPos),topStatusMessage:qS,topStatusMessageSticky:!0,finishedLevel:!1,healCost:1,zoomLevel:2,seeAll:!0,seeGuardSight:!1,seeGuardPatrols:!1,camera:mT(a.playerStartPos),level:o,turns:0,totalTurns:0,lootStolen:0,lootSpent:0,lootAvailable:s[o].totalLoot,ghostBonus:5,maxTimeBonus:5,gameMapRoughPlans:s,gameMap:a,sounds:e,subtitledSounds:t,activeSoundPool:n,guardMute:!1,volumeMute:!1,touchAsGamepad:u,touchController:i,gamepadManager:new fn,keyboardController:new hn,popups:new S}}({},{},new Zt,new pn(t,!0));function r(){requestAnimationFrame((e=>TT(e,n,i)))}window.addEventListener("resize",(function(){r()})),r()}function $S(e){if(e.gamepadManager.updateGamepadStates(),null!==an){e.helpActive?e.helpScreen.onControls(e,t):e.gameMode==mn.Mansion?function(n){e.camera.panning&&(e.camera.velocity[0]=0,e.camera.velocity[1]=0);n.controlStates.panLeft&&(e.camera.panning=!0,e.camera.velocity[0]=-1e3*e.dt);n.controlStates.panRight&&(e.camera.panning=!0,e.camera.velocity[0]=1e3*e.dt);n.controlStates.panUp&&(e.camera.panning=!0,e.camera.velocity[1]=1e3*e.dt);n.controlStates.panDown&&(e.camera.panning=!0,e.camera.velocity[1]=-1e3*e.dt);n.controlStates.snapToPlayer&&(e.camera.panning=!1,e.camera.snapped=!1);if(t("left")||t("heal"))e.leapToggleActive||n.controlStates.jump?oT(e,-1,0):rT(e,-1,0);else if(t("right"))e.leapToggleActive||n.controlStates.jump?oT(e,1,0):rT(e,1,0);else if(t("down"))e.leapToggleActive||n.controlStates.jump?oT(e,0,-1):rT(e,0,-1);else if(t("up"))e.leapToggleActive||n.controlStates.jump?oT(e,0,1):rT(e,0,1);else if(t("jumpLeft"))oT(e,-1,0);else if(t("jumpRight"))oT(e,1,0);else if(t("jumpDown"))oT(e,0,-1);else if(t("jumpUp"))oT(e,0,1);else if(t("wait"))!function(e){const t=e.player;if(t.health<=0)return;e.idleTimer=5,e.camera.panning=!1,e.touchController.clearMotion(),lT(e),e.gameMap.identifyAdjacentCells(t.pos),t.pickTarget=null,uT(e)}(e);else if(t("exitLevel"))e.level>=OS.numGameMaps-1?QS(e):XS(e);else if(t("menu"))e.helpActive=!0;else if(t("jumpToggle"))e.leapToggleActive=!e.leapToggleActive;else if(t("seeAll"))e.seeAll=!e.seeAll;else if(t("collectLoot")){const t=e.gameMap.collectAllLoot();e.player.loot+=t,e.lootStolen+=t,cT(e)}else if(t("forceRestart"))e.rng=new v,e.dailyRun=null,_T(e);else if(t("nextLevel"))e.level<e.gameMapRoughPlans.length-1&&(++e.level,ST(e));else if(t("resetState"))ST(e);else if(t("prevLevel"))e.level>0&&(--e.level,ST(e));else if(t("guardSight"))e.seeGuardSight=!e.seeGuardSight;else if(t("guardPatrols"))e.seeGuardPatrols=!e.seeGuardPatrols;else if(t("markSeen"))e.gameMap.markAllSeen(),cT(e);else if(t("zoomIn"))e.zoomLevel=Math.max(1,e.zoomLevel-1),e.camera.snapped=!1;else if(t("zoomOut"))e.zoomLevel=Math.min(10,e.zoomLevel+1),e.camera.snapped=!1;else if(t("seeAll"))e.seeAll=!e.seeAll;else if(t("guardMute")){e.guardMute=!e.guardMute;for(const t in e.subtitledSounds)e.subtitledSounds[t].mute=e.guardMute}else if(t("volumeMute"))e.volumeMute=!e.volumeMute,gt.mute(e.volumeMute);else if(t("volumeDown")){const e=gt.volume();gt.volume(Math.max(e-.1,.1))}else if(t("volumeUp")){const e=gt.volume();gt.volume(Math.max(e+.1,1))}}(an):e.textWindows[e.gameMode]?.onControls(e,(function(t){let n=!1;if(null===an)return!1;const i=an.controlStates;if(!(t in i))return!1;if(an===e.touchController){const i=e.touchController;if(t in i.touchTargets&&"release"==i.touchTargets[t].trigger)return n=an.currentFrameReleases.has(t),n&&(an.controlTimes[t],Date.now()),n}n=an.currentFramePresses.has(t),n&&(an.controlTimes[t],Date.now());return n})),e.touchController.endFrame(),e.keyboardController.endFrame();for(const t in e.gamepadManager.gamepads)e.gamepadManager.gamepads[t].endFrame()}function t(t){let n=!1;if(null===an)return!1;const i=an.controlStates;if(!(t in i))return!1;if(an===e.touchController){const i=e.touchController;if(t in i.touchTargets&&"release"==i.touchTargets[t].trigger)return n=an.currentFrameReleases.has(t),n&&(an.controlTimes[t]=Date.now()),n}return n=an.currentFramePresses.has(t)||i[t]&&Date.now()-an.controlTimes[t]>250,n&&(an.controlTimes[t]=Date.now()),n}}function YS(e){const t=e.gameMap.cells,n=Math.ceil(t.sizeX*t.sizeY*(1-e.initialSeen)/4),i=e.turns;return Math.max(5-Math.max(Math.floor(i/n)-1,0),0)}function XS(e){const t=YS(e);e.player.loot+=t+e.ghostBonus,e.activeSoundPool.empty(),e.sounds.levelCompleteJingle.play(.35),e.gameMode=mn.BetweenMansions,e.lootStolen===e.lootAvailable&&(e.stats.totalLootSweeps++,vT("totalLootSweeps",e.stats.totalLootSweeps)),e.ghostBonus>0&&(e.stats.totalGhosts++,vT("totalGhosts",e.stats.totalGhosts)),e.topStatusMessage="",e.topStatusMessageSticky=!1}function QS(e){e.activeSoundPool.empty(),e.player.loot>95&&Math.random()>.9?e.sounds.easterEgg.play(.5):e.sounds.victorySong.play(.5),e.stats.totalWins++,vT("totalWins",e.stats.totalWins),e.stats.bestScore=Math.max(e.stats.bestScore,e.player.loot),vT("bestScore",e.stats.bestScore),e.stats.totalGold+=e.player.loot,vT("totalGold",e.stats.totalGold);const t={score:e.player.loot,date:xT(),turns:e.totalTurns,level:e.level+1};if(e.stats.highScores.push(t),e.dailyRun){e.stats.bestDailyScore=Math.max(e.stats.bestDailyScore,e.player.loot),vT("bestDailyScore",e.stats.bestDailyScore),e.stats.dailyWins++,vT("dailyWins",e.stats.dailyWins),e.stats.dailyWinStreak++,vT("dailyWinStreak",e.stats.dailyWinStreak),200==e.player.loot&&(e.stats.dailyPerfect++,vT("dailyPerfect",e.stats.dailyPerfect));const t={score:e.player.loot,date:e.dailyRun,turns:e.totalTurns,level:e.level+1};e.stats.lastDaily=t,e.stats.dailyScores.push(e.stats.lastDaily),vT("lastDaily",e.stats.lastDaily),e.dailyRun===xT()&&e.scoreServer.addScore(e.player.loot,e.totalTurns,e.level+1)}e.gameMode=mn.Win,e.topStatusMessage="",e.topStatusMessageSticky=!1}function JS(e,t,n){const i=e.gameMap.collectLootAt(t);i.length>0&&e.sounds.coin.play(1);for(const t of i){++e.player.loot,++e.lootStolen;const i=s.create(),r=s.fromValues(n[0]-t.pos[0],n[1]-t.pos[1]),o=r.scale(.3333).add(s.fromValues(0,.5)),a=new k([{pt0:i,pt1:o,duration:.1,fn:T.easeOutQuad},{pt0:o,pt1:r,duration:.1,fn:T.easeInQuad}],[VS.itemTiles[Z.Coin],VS.itemTiles[Z.Coin]]);a.removeOnFinish=!0,t.animation=a,e.particles.push(t)}}function ZS(e,t){if((t[0]<0||t[0]>=e.gameMap.cells.sizeX||t[1]<0||t[1]>=e.gameMap.cells.sizeY)&&!e.finishedLevel)return!1;const n=e.gameMap.cells.atVec(t);return!n.blocksPlayerMove&&(!sT(n.type)&&(n.type!==$.PortcullisNS&&n.type!==$.PortcullisEW&&((n.type!==$.DoorNS&&n.type!==$.DoorEW||!e.gameMap.items.find((e=>e.pos.equals(t)&&ue(e.type))))&&(!e.gameMap.items.find((e=>e.pos.equals(t)&&function(e){switch(e){case Z.TorchUnlit:case Z.TorchLit:return!0;default:return!1}}(e.type)))&&!e.gameMap.guards.find((n=>n.pos.equals(t)&&!n.movingWithPlayerPosition(e.player.pos)))))))}function eT(e,t,n){if(n.hidesPlayer)return void e.sounds.hide.play(.2);const i=.5+Math.random()/2,r=t.type!==n.type;switch(n.type){case $.GroundWoodCreaky:e.sounds.footstepCreaky.play(.15*i);break;case $.GroundWood:(r||Math.random()>.9)&&e.sounds.footstepWood.play(.15*i);break;case $.GroundNormal:(r||Math.random()>.5)&&e.sounds.footstepGravel.play(.03*i);break;case $.GroundGrass:(r||Math.random()>.75)&&e.sounds.footstepGrass.play(.05*i);break;case $.GroundWater:(r||Math.random()>.6)&&e.sounds.footstepWater.play(.02*i);break;case $.GroundMarble:case $.GroundVault:(r||Math.random()>.8)&&e.sounds.footstepTile.play(.05*i);break;default:(r||Math.random()>.8)&&e.sounds.footstepTile.play(.02*i)}}function tT(e,t,n){const i=s.create(),r=s.fromValues(t/4,n/4);e.player.animation=new k([{pt0:i,pt1:r,duration:.05,fn:T.linear},{pt0:r,pt1:i,duration:.05,fn:T.linear}],[VS.playerTiles.normal])}function nT(e,t,n){e.sounds.footstepTile.play(.1),tT(e,t,n)}function iT(e,t,n,i){let r=null;if(t.pickTarget=null,n.hasPurse&&(n.hasPurse=!1,t.loot+=1,e.lootStolen+=1,r={pos:s.clone(n.pos),type:Z.Coin}),n.hasVaultKey&&(n.hasVaultKey=!1,t.hasVaultKey=!0,r={pos:s.clone(n.pos),type:Z.Key}),r){const t=s.create(),n=i.subtract(r.pos),o=n.scale(.3333).add(s.fromValues(0,.5)),a=new k([{pt0:t,pt1:o,duration:.1,fn:T.easeOutQuad},{pt0:o,pt1:n,duration:.1,fn:T.easeInQuad}],[VS.itemTiles[r.type],VS.itemTiles[r.type]]);a.removeOnFinish=!0,r.animation=a,e.particles.push(r),e.sounds.coin.play(1)}}function rT(e,t,n){const i=e.player;if(i.health<=0)return;e.idleTimer=5,e.camera.panning=!1,e.touchController.clearMotion();const r=s.clone(i.pos),o=s.fromValues(i.pos[0]+t,i.pos[1]+n);if(o[0]<0||o[0]>=e.gameMap.cells.sizeX||o[1]<0||o[1]>=e.gameMap.cells.sizeY)return void(e.finishedLevel?e.level>=OS.numGameMaps-1?(lT(e),QS(e)):(lT(e),XS(e)):nT(e,t,n));const a=e.gameMap.cells.atVec(o);if(a.blocksPlayerMove)return void nT(e,t,n);if(a.type==$.OneWayWindowE&&o[0]<=r[0]||a.type==$.OneWayWindowW&&o[0]>=r[0]||a.type==$.OneWayWindowN&&o[1]<=r[1]||a.type==$.OneWayWindowS&&o[1]>=r[1])return e.topStatusMessage="Window cannot be accessed from outside",e.topStatusMessageSticky=!1,0===e.level&&setTimeout((()=>e.sounds.tooHigh.play(.3)),250),void nT(e,t,n);if(sT(a.type))return e.topStatusMessage="Shift+move to leap",e.topStatusMessageSticky=!1,0===e.level&&setTimeout((()=>e.sounds.jump.play(.3)),250),void nT(e,t,n);for(const r of e.gameMap.items.filter((e=>e.pos.equals(o))))switch(r.type){case Z.TorchUnlit:return lT(e),e.sounds.ignite.play(.08),r.type=Z.TorchLit,i.pickTarget=null,tT(e,t,n),void uT(e);case Z.TorchLit:return lT(e),e.sounds.douse.play(.05),r.type=Z.TorchUnlit,i.pickTarget=null,tT(e,t,n),void uT(e);case Z.PortcullisEW:case Z.PortcullisNS:return e.topStatusMessage="Shift+move to leap",e.topStatusMessageSticky=!1,e.sounds.gate.play(.3),0===e.level&&setTimeout((()=>e.sounds.jump.play(.3)),1e3),void tT(e,t,n);case Z.LockedDoorEW:case Z.LockedDoorNS:if(!i.hasVaultKey)return e.topStatusMessage="Locked!",e.topStatusMessageSticky=!1,void nT(e,t,n)}const l=e.gameMap.guards.find((e=>e.pos.equals(o)));let u=!1;if(void 0===l)i.pickTarget=null;else if(l.mode===P.Unconscious)i.pickTarget=null,function(e,t){const n=s.clone(t.pos),i=s.clone(e.player.pos),r=s.create();s.subtract(r,n,i),s.add(r,r,n);let o=!1;(r[0]<0||r[1]<0||r[0]>=e.gameMap.cells.sizeX||r[1]>=e.gameMap.cells.sizeY||e.gameMap.cells.atVec(r).moveCost===1/0||e.gameMap.guards.find((e=>e.pos.equals(r))))&&(s.copy(r,i),o=!0),s.copy(t.pos,r),e.gameMap.cells.atVec(t.pos).type===$.GroundWater&&(t.modeTimeout=0);const a=s.clone(n).subtract(t.pos),l=s.create();let u;if(o)u=[{pt0:a,pt1:l,duration:.2,fn:T.easeOutQuad}];else{const e=s.fromValues(.5*(n[0]-t.pos[0]),.5*(n[1]-t.pos[1]));u=[{pt0:a,pt1:e,duration:.2,fn:T.easeInQuad},{pt0:e,pt1:l,duration:.1,fn:T.easeOutQuad}]}t.animation=new k(u,[])}(e,l);else{if(l.mode===P.ChaseVisibleTarget)return void nT(e,t,n);if(O(l.mode)?(l.hasPurse||l.hasVaultKey)&&(i.pickTarget===l?u=!0:i.pickTarget=l):i.pickTarget=null,!l.movingWithPlayerPosition(i.pos))return u&&iT(e,i,l,r),lT(e),void uT(e);u&&iT(e,i,l,o)}lT(e),s.copy(i.pos,o),e.gameMap.identifyAdjacentCells(i.pos);const c=s.clone(r).subtract(o),h=s.create();let d=c.add(h).scale(.5).add(s.fromValues(0,.125));const f=i.hidden(e.gameMap),p=t<0?VS.playerTiles.left:t>0?VS.playerTiles.right:n>0?VS.playerTiles.up:VS.playerTiles.down;let m;if(void 0!==l&&l.mode===P.Unconscious){const e=s.fromValues(.5*(r[0]-o[0]),.5*(r[1]-o[1]));m=[{pt0:c,pt1:e,duration:.2,fn:T.easeInQuad},{pt0:e,pt1:h,duration:.1,fn:T.easeOutQuad}]}else m=[{pt0:c,pt1:d,duration:.1,fn:T.easeInQuad},{pt0:d,pt1:h,duration:.1,fn:T.easeOutQuad},{pt0:h,pt1:h,duration:.1,fn:T.easeOutQuad}],n>0&&!f&&m.push({pt0:h,pt1:h,duration:.1,fn:T.easeOutQuad});const g=f?VS.playerTiles.hidden:p;i.animation=new k(m,[p,g,g,VS.playerTiles.left]),JS(e,i.pos,o),a.type===$.GroundWoodCreaky&&aT(e.gameMap,i,FS.Creak,17,e.sounds),uT(e),eT(e,e.gameMap.cells.atVec(r),a)}function oT(e,t,n){const i=e.player;if(i.health<=0)return;e.idleTimer=5,e.camera.panning=!1,e.touchController.clearMotion();const r=s.clone(i.pos),o=s.fromValues(i.pos[0]+t,i.pos[1]+n),a=s.fromValues(i.pos[0]+2*t,i.pos[1]+2*n),l=e.gameMap.guards.find((e=>e.pos.equals(o)&&e.mode!==P.Unconscious&&e.mode!==P.ChaseVisibleTarget));if(l)return lT(e),l.mode=P.Unconscious,l.modeTimeout=Math.max(1,40-2*e.level)+y(20),(l.hasPurse||l.hasVaultKey)&&iT(e,i,l,r),i.pickTarget=null,e.sounds.hitGuard.play(.25),uT(e),void tT(e,t,n);if(e.gameMap.cells.atVec(r).type===$.GroundWater)return void rT(e,t,n);if(o[0]<0||o[1]<0||o[0]>=e.gameMap.cells.sizeX||o[1]>=e.gameMap.cells.sizeY)return void rT(e,t,n);const u=e.gameMap.cells.atVec(o);if(u.blocksPlayerMove)return void rT(e,t,n);if((u.type===$.DoorNS||u.type===$.DoorEW)&&e.gameMap.items.find((e=>e.pos.equals(o)&&ue(e.type))))return void rT(e,t,n);if(u.type==$.OneWayWindowE&&a[0]<=r[0]||u.type==$.OneWayWindowW&&a[0]>=r[0]||u.type==$.OneWayWindowN&&a[1]<=r[1]||u.type==$.OneWayWindowS&&a[1]>=r[1])return void rT(e,t,n);if(!ZS(e,a))return void(!function(e,t){if((t[0]<0||t[0]>=e.gameMap.cells.sizeX||t[1]<0||t[1]>=e.gameMap.cells.sizeY)&&!e.finishedLevel)return!1;const n=e.gameMap.cells.atVec(t);if(n.blocksPlayerMove)return!1;if(sT(n.type))return!1;for(const n of e.gameMap.items.filter((e=>e.pos.equals(t))))switch(n.type){case Z.TorchUnlit:case Z.TorchLit:case Z.PortcullisEW:case Z.PortcullisNS:return!1}return!e.gameMap.guards.find((e=>e.pos.equals(t)))}(e,o)?nT(e,t,n):rT(e,t,n));const c=e.gameMap.guards.find((e=>e.pos.equals(a)));if(void 0===c||!c.hasPurse&&!c.hasVaultKey?i.pickTarget=null:i.pickTarget=c,lT(e),JS(e,o,a),a[0]<0||a[1]<0||a[0]>=e.gameMap.cells.sizeX||a[1]>=e.gameMap.cells.sizeY)return void(e.level>=OS.numGameMaps-1?QS(e):XS(e));s.copy(i.pos,a);const h=e.gameMap.cells.atVec(a);h.identified=!0;const d=s.clone(r).subtract(a),f=s.create();let p=d.add(f).scale(.5).add(s.fromValues(0,.5));const m=t<0?VS.playerTiles.left:t>0?VS.playerTiles.right:n>0?VS.playerTiles.up:VS.playerTiles.down,g=[{pt0:d,pt1:p,duration:.1,fn:T.easeInQuad},{pt0:p,pt1:f,duration:.1,fn:T.easeOutQuad},{pt0:f,pt1:f,duration:.1,fn:T.easeOutQuad}],v=i.hidden(e.gameMap);n>0&&!v&&g.push({pt0:f,pt1:f,duration:.1,fn:T.easeOutQuad});const b=v?VS.playerTiles.hidden:m;i.animation=new k(g,[m,b,b,VS.playerTiles.left]),JS(e,a,a),h.type===$.GroundWoodCreaky?aT(e.gameMap,i,FS.Creak,17,e.sounds):h.type===$.GroundWater&&aT(e.gameMap,i,FS.Splash,17,e.sounds),uT(e),eT(e,e.gameMap.cells.atVec(r),h),u.type!==$.PortcullisNS&&u.type!==$.PortcullisEW||e.sounds.gate.play(.3)}function sT(e){switch(e){case $.OneWayWindowE:case $.OneWayWindowW:case $.OneWayWindowN:case $.OneWayWindowS:return!0;default:return!1}}function aT(e,t,n,i,r){switch(t.noisy=!0,n){case FS.Creak:r.footstepCreaky.play(.6);case FS.Splash:}let o=1/0,s=null;for(const n of e.guardsInEarshot(t.pos,i)){n.heardThief=!0;const e=t.pos.squaredDistance(n.pos);e<o&&O(n.mode)&&(o=e,s=n)}null!==s&&(s.heardThiefClosest=!0)}function lT(e){e.topStatusMessageSticky||(e.topStatusMessage=""),e.popups.clear(),e.player.noisy=!1,e.player.damagedLastTurn=!1}function uT(e){let t=e.player.health;e.turns++,e.totalTurns++,e.gameMap.cells.atVec(e.player.pos).type==$.GroundWater?e.player.turnsRemainingUnderwater>0&&--e.player.turnsRemainingUnderwater:e.player.turnsRemainingUnderwater=7,e.gameMap.computeLighting(e.gameMap.cells.atVec(e.player.pos)),U(e,e.gameMap,e.popups,e.player),void 0!==e.gameMap.guards.find((e=>e.mode===P.ChaseVisibleTarget||e.mode===P.Unconscious))&&(e.ghostBonus=0),e.gameMap.recomputeVisibility(e.player.pos),cT(e),t>e.player.health&&(e.sounds.hitPlayer.play(.5),e.player.health<=0&&(setTimeout((()=>e.sounds.gameOverJingle.play(.5)),1e3),e.dailyRun&&(e.stats.dailyWinStreak=0,vT("dailyWinStreak",e.stats.dailyWinStreak),e.stats.lastDaily={score:e.player.loot,date:e.dailyRun,turns:e.totalTurns,level:e.level+1},vT("lastDaily",e.stats.lastDaily),e.dailyRun===xT()&&e.scoreServer.addScore(e.player.loot,e.totalTurns,e.level)),e.gameMode=mn.Dead))}function cT(e){e.gameMap.allSeen()&&(e.finishedLevel||e.sounds.levelRequirementJingle.play(.5),e.finishedLevel=!0);const t=e.popups.endOfUpdate(e.subtitledSounds);""!==t?(e.topStatusMessage=t,e.topStatusMessageSticky=!0):e.finishedLevel&&(e.lootAvailable>e.lootStolen?e.topStatusMessage="Mansion fully mapped! You may exit any side but loot remains.":e.topStatusMessage="Mansion fully mapped and looted! Exit any side.",e.topStatusMessageSticky=!0)}function hT(e,t){return new Promise(((n,i)=>{t.onload=()=>n(t),t.onerror=i,t.src=e}))}function dT(e,t,n,i){return 0==n.size?e:i?e**(1+[...n].reduce(((e,n)=>e+t[n]),0)/n.size):0}function fT(e,t,n,i,r){const o=n.at(e-1,t-1),s=n.at(e,t-1),a=n.at(e+1,t-1),l=n.at(e-1,t),u=n.at(e,t),c=n.at(e+1,t),h=n.at(e-1,t+1),d=n.at(e,t+1),f=n.at(e+1,t+1),p=dT(o.lit,i,o.litSrc,r||o.seen),m=dT(s.lit,i,s.litSrc,r||s.seen),g=dT(a.lit,i,a.litSrc,r||a.seen),v=dT(l.lit,i,l.litSrc,r||l.seen),y=dT(u.lit,i,u.litSrc,r||u.seen),b=dT(c.lit,i,c.litSrc,r||c.seen),w=dT(h.lit,i,h.litSrc,r||h.seen),_=dT(d.lit,i,d.litSrc,r||d.seen);return[(p+m+v+y)/4,(g+m+b+y)/4,(w+_+v+y)/4,(dT(f.lit,i,f.litSrc,r||f.seen)+_+b+y)/4]}function pT(e){return e[1]>0?1:e[1]<0?3:e[0]>0?0:e[0]<0?2:3}function mT(e){const t={position:s.create(),velocity:s.create(),anchor:s.create(),snapped:!1,panning:!1};return s.copy(t.position,e),s.zero(t.velocity),t}function gT(e){return JSON.parse(String(window.localStorage.getItem("stat."+e)))}function vT(e,t){window.localStorage.setItem("stat."+e,JSON.stringify(t))}function yT(){return{highScores:gT("highScores")??[],dailyScores:gT("dailyScores")??[],bestScore:gT("bestScore")??0,bestDailyScore:gT("bestDailyScores")??0,lastDaily:gT("lastDaily")??{score:0,date:""},dailyWinStreak:gT("dailyWinStreak")??0,dailyPlays:gT("dailyPlays")??0,dailyWins:gT("dailyWins")??0,dailyPerfect:gT("dailyPerfect")??0,totalGold:gT("totalGold")??0,totalPlays:gT("totalPlays")??0,totalWins:gT("totalWins")??0,totalPerfect:gT("totalPerfect")??0,totalGhosts:gT("totalGhosts")??0,totalLootSweeps:gT("totalLootSweeps")??0,achievements:gT("achievements")??new Set}}function bT(e,t){for(let t of e.cells.values)t.type===$.GroundWater&&(t.animation=new A(VS.waterAnimation,.5))}function wT(e,t){let n=0;if(VS.candleAnimation.length>=3){const i=VS.candleAnimation.slice(0,3).map((e=>[e,.5])),r=VS.candleAnimation.at(-2),o=VS.candleAnimation.at(-1);for(let s of e.items)s.type===Z.TorchLit?(s.animation=new R(C.idle,n,t.lightStates,s,i,r,o),n++):s.type===Z.TorchUnlit&&(s.animation=new R(C.off,n,t.lightStates,s,i,r,o),n++)}if(VS.torchAnimation.length>=3){const i=VS.torchAnimation.slice(0,3).map((e=>[e,.5])),r=VS.torchAnimation.at(-2),o=VS.torchAnimation.at(-1);for(let s of e.guards)s.hasTorch&&(s.torchAnimation=new R(C.idle,n,t.lightStates,null,i,r,o),n++)}}function _T(e){e.gameMapRoughPlans=ye(OS.numGameMaps,OS.totalGameLoot,e.rng),e.level=7,e.stats.totalPlays++,vT("totalPlays",e.stats.totalPlays),e.dailyRun&&(e.stats.dailyPlays++,vT("dailyPlays",e.stats.dailyPlays)),e.gameStats={lootStolen:0,lootSpent:0,ghostBonuses:0,timeBonuses:0,maxGhostBonuses:0,maxTimeBonuses:0,maxLootStolen:0};const t=we(e.level,e.gameMapRoughPlans[e.level],e.rng);e.lightStates=Array(t.lightCount).fill(0),wT(t,e),bT(t),e.gameMode=mn.Mansion,e.topStatusMessage=qS,e.topStatusMessageSticky=!0,e.finishedLevel=!1,e.healCost=1,e.turns=0,e.totalTurns=0,e.lootStolen=0,e.lootSpent=0,e.lootAvailable=e.gameMapRoughPlans[e.level].totalLoot,e.ghostBonus=5,e.maxTimeBonus=5,e.initialSeen=t.percentSeen()/100,e.player=new ie(t.playerStartPos),e.camera=mT(t.playerStartPos),e.gameMap=t,e.activeSoundPool.empty(),e.popups.clear()}function ST(e){const t=we(e.level,e.gameMapRoughPlans[e.level],e.rng);e.lightStates=Array(t.lightCount).fill(0),wT(t,e),bT(t),e.turns=0,e.totalTurns=0,e.lootStolen=0,e.lootSpent=0,e.lootAvailable=e.gameMapRoughPlans[e.level].totalLoot,e.ghostBonus=5,e.maxTimeBonus=5,e.initialSeen=t.percentSeen()/100,e.topStatusMessage=qS,e.topStatusMessageSticky=!0,e.finishedLevel=!1,e.player=new ie(t.playerStartPos),e.camera=mT(t.playerStartPos),e.gameMap=t,e.popups.clear(),e.activeSoundPool.empty()}function TT(e,t,n){const i=e/1e3,r=void 0===n.tLast?0:Math.min(1/30,i-n.tLast);n.dt=r,n.tLast=i,function(e,t){if(e.idleTimer-=t,e.idleTimer<=0&&e.player.health>0&&null===e.player.animation){e.idleTimer=5;const t=e.player,n=s.create(),i=s.fromValues(-.125,0),r=s.fromValues(.125,0),o=s.fromValues(0,.125),a=t.hidden(e.gameMap),l=VS.playerTiles;let u,c;a||Math.random()>.5?(u=[{pt0:n,pt1:o,duration:.1,fn:T.easeInQuad},{pt0:o,pt1:n,duration:.05,fn:T.easeOutQuad},{pt0:n,pt1:n,duration:.1,fn:T.easeOutQuad},{pt0:n,pt1:o,duration:.1,fn:T.easeInQuad},{pt0:o,pt1:n,duration:.05,fn:T.easeOutQuad}],c=a?[l.hidden]:[l.normal]):(u=[{pt0:n,pt1:i,duration:.1,fn:T.easeOutQuad},{pt0:i,pt1:i,duration:.5,fn:T.easeOutQuad},{pt0:i,pt1:n,duration:.1,fn:T.easeInQuad},{pt0:n,pt1:r,duration:.1,fn:T.easeOutQuad},{pt0:r,pt1:r,duration:.5,fn:T.easeOutQuad},{pt0:r,pt1:n,duration:.1,fn:T.easeInQuad}],c=[l.left,l.left,l.normal,l.right,l.right,l.normal]),t.animation=new k(u,c)}}(n,r);const o=s.create();t.getScreenSize(o),n.camera.snapped||(n.camera.panning=!1,n.camera.snapped=!0,function(e,t){IT(e.camera.position,s.fromValues(e.gameMap.cells.sizeX,e.gameMap.cells.sizeY),e.zoomLevel,t,e.player.pos),s.zero(e.camera.velocity)}(n,o)),$S(n),r>0&&function(e,t,n){!function(e,t,n){const i=s.create();if(!e.camera.panning){const r=s.create();IT(r,s.fromValues(e.gameMap.cells.sizeX,e.gameMap.cells.sizeY),e.zoomLevel,t,e.player.pos);const o=s.create();s.subtract(o,r,e.camera.position);const a=s.create();s.negate(a,e.camera.velocity);const l=8,u=s.create();s.scale(u,o,l**2),s.scaleAndAdd(u,u,a,2*l),s.scaleAndAdd(i,e.camera.velocity,u,n)}s.scaleAndAdd(e.camera.position,e.camera.position,e.camera.velocity,.5*n),s.scaleAndAdd(e.camera.position,e.camera.position,i,.5*n),s.copy(e.camera.velocity,i)}(e,t,n)}(n,o,r),n.player.animation&&n.player.animation.update(r)&&(n.player.animation=null);for(let e of n.gameMap.cells.values)e.animation?.update(r);for(let e of n.gameMap.guards)e.animation?.update(r)&&(e.animation=null),e.torchAnimation?.update(r)&&(e.torchAnimation=null);if(n.gameMap.items=n.gameMap.items.filter((e=>{const t=e.animation?.update(r);return!(e.animation instanceof k)||!(e.animation.removeOnFinish&&t)})),n.particles=n.particles.filter((e=>{const t=e.animation?.update(r);return!(e.animation instanceof k)||!(e.animation.removeOnFinish&&t)})),n.helpActive){const e=n.helpScreen;e.update(n),e.parseUI(),e.updateScreenSize(o)}else{const e=n.textWindows[n.gameMode];void 0!==e&&(e.update(n),e.parseUI(),e.updateScreenSize(o))}!function(e,t,n,i){if(an!==e)return;const r=i.helpActive?i.helpScreen:i.textWindows[i.gameMode],o=s.fromValues(i.gameMap.cells.sizeX,i.gameMap.cells.sizeY),a=(AT(n[0]),n[0]),l=n[1]-2*GS,u=function(e,t,n,i){const r=t[0],o=t[1],a=GS*AT(e[0]),l=s.fromValues(e[0],e[1]-2*a),u=l[0],c=l[1],h=ET(l,r,o,i),d=h[0],f=h[1],p=n[0],m=n[1];return{screenToWorld:e=>s.fromValues((e[0]-u/2)*d/u+p,(e[1]-c/2-2*GS)*f/c+m),worldToScreen:e=>s.fromValues((e[0]-p)*u/d+u/2,(e[1]-m)*c/f+c/2+2*GS)}}(n,o,i.camera.position,i.zoomLevel);if(-1!==e.lastMotion.id&&void 0===r&&null===e.targetOnTouchDown&&e.lastMotion.active){const t=u.screenToWorld(s.fromValues(e.lastMotion.x0,e.lastMotion.y0)),n=u.screenToWorld(s.fromValues(e.lastMotion.x,e.lastMotion.y));i.camera.panning=!0;let r=n.subtract(t);i.camera.position[0]-=r[0]-i.camera.anchor[0],i.camera.position[1]-=r[1]-i.camera.anchor[1],i.camera.anchor[0]=r[0],i.camera.anchor[1]=r[1]}else i.camera.anchor[0]=0,i.camera.anchor[1]=0;const c=Math.floor(Math.min(l,a)/6),h=u.screenToWorld(s.fromValues(0,0)),d=u.screenToWorld(s.fromValues(c,c)),f=u.screenToWorld(s.fromValues(a,l)),p=h[0],m=h[1],g=f[0]-p,v=f[1]-m,y=d[0]-p,b=d[1]-m,w=i.helpActive||i.gameMode!=mn.Mansion?100:0,_=(i.helpActive||(i.gameMode,mn.BetweenMansions),!i.helpActive&&[mn.Dead,mn.Win].includes(i.gameMode)?0:100),S=i.helpActive?0:100;let T=t.tileSet.touchButtons;void 0===T&&(T={});const I=i.touchAsGamepad&&!(an===i.touchController&&i.touchController.mouseActive);if(i.touchController.setTouchConfig(I),I)var E={menu:{game:new un(p,m+v-b,y,b),view:new un,tileInfo:T.menu},zoomIn:{game:new un(p+g-y+w,m+v-2*b,y,b),view:new un,tileInfo:T.zoomIn},zoomOut:{game:new un(p+g-y+w,m+v-b,y,b),view:new un,tileInfo:T.zoomOut},fullscreen:{game:new un(p+g-y+S,m+v-b,y,b),view:new un,tileInfo:T.fullscreen},restart:{game:new un(p+g-y+_,m+v-b,y,b),view:new un,tileInfo:T.restart},forceRestart:{game:new un(p+g-y+S,m+v-2*b,y,b),view:new un,tileInfo:T.restart},left:{game:new un(p,m+b,y,b),view:new un,tileInfo:T.left},right:{game:new un(p+2*y,m+b,y,b),view:new un,tileInfo:T.right},up:{game:new un(p+y,m+2*b,y,b),view:new un,tileInfo:T.up},down:{game:new un(p+y,m,y,b),view:new un,tileInfo:T.down},wait:{game:new un(p+y,m+b,y,b),view:new un,tileInfo:T.wait},jump:{game:new un(p+g-y,m+y,y,b),view:new un,tileInfo:T.jump}};else{const e=4/i.zoomLevel;E={menu:{game:new un(p,m+v-1.5*e,e,e),view:new un,tileInfo:T.menu},zoomIn:{game:new un(p,m+v-2.5*e,e,e),view:new un,tileInfo:T.zoomIn},zoomOut:{game:new un(p,m+v-3.5*e,e,e),view:new un,tileInfo:T.zoomOut},fullscreen:{game:new un(p+S,m+v-4.5*e,e,e),view:new un,tileInfo:T.fullscreen},restart:{game:new un(p+_,m+v-5.5*e,e,e),view:new un,tileInfo:T.restart},forceRestart:{game:new un(p+S,m+v-6.5*e,e,e),view:new un,tileInfo:T.restart}};const t=i.player.pos;E.wait=i.gameMode!=mn.Mansion||i.helpActive?{game:new un(-2,1,1),view:new un,tileInfo:T.wait}:{game:new un(...t,1,1),view:new un,tileInfo:T.wait},!i.finishedLevel||i.gameMode!=mn.Mansion||i.helpActive||0!=t[0]&&0!=t[1]&&t[0]!=o[0]-1&&t[1]!=o[1]-1?E.exitLevel={game:new un(-1,-1,0,0),view:new un,tileInfo:T.exitLevel}:E.exitLevel={game:new un(p,m+v-4.5*e,e,e),view:new un,tileInfo:T.exitLevel};for(const e of[["left",[-1,0]],["right",[1,0]],["up",[0,1]],["down",[0,-1]]]){const n=e[0],r=e[1],a=s.fromValues(t[0]+r[0],t[1]+r[1]);a[0]<0||a[1]<0||a[0]>=o[0]||a[1]>=o[1]||(i.gameMode!=mn.Mansion||i.helpActive||i.gameMap.cells.atVec(a).blocksPlayerMove||i.gameMap.cells.atVec(a).type==$.OneWayWindowE||i.gameMap.cells.atVec(a).type==$.OneWayWindowW||i.gameMap.cells.atVec(a).type==$.OneWayWindowN||i.gameMap.cells.atVec(a).type==$.OneWayWindowS||i.gameMap.items.find((e=>e.pos.equals(a)&&[Z.PortcullisEW,Z.PortcullisNS].includes(e.type)))||i.gameMap.guards.find((e=>e.pos.equals(a)))?E[n]={game:new un(-1,-1,0,0),view:new un,tileInfo:T.picker}:E[n]={game:new un(...a,1,1),view:new un,tileInfo:T.picker})}for(const e of[["jumpLeft",[-1,0]],["jumpRight",[1,0]],["jumpUp",[0,1]],["jumpDown",[0,-1]]]){const n=e[0],r=s.fromValues(...e[1]),a=t.add(r),l=t.scaleAndAdd(r,2);i.gameMode!=mn.Mansion||i.helpActive||a[0]<0||a[1]<0||a[0]>=o[0]||a[1]>=o[1]||l[0]<0||l[1]<0||l[0]>=o[0]||l[1]>=o[1]||i.gameMap.cells.atVec(a).blocksPlayerMove||i.gameMap.cells.atVec(l).blocksPlayerMove||i.gameMap.cells.atVec(a).type==$.OneWayWindowE&&"jumpLeft"==n||i.gameMap.cells.atVec(a).type==$.OneWayWindowW&&"jumpRight"==n||i.gameMap.cells.atVec(a).type==$.OneWayWindowN&&"jumpDown"==n||i.gameMap.cells.atVec(a).type==$.OneWayWindowS&&"jumpUp"==n||i.gameMap.items.find((e=>e.pos.equals(l)&&[Z.PortcullisEW,Z.PortcullisNS].includes(e.type)))||i.gameMap.guards.find((e=>e.pos.equals(l)))?E[n]={game:new un(-1,-1,0,0),view:new un,tileInfo:T.picker}:E[n]={game:new un(...l,1,1),view:new un,tileInfo:T.picker}}}for(const t in E){const n=E[t],i=n.game,r=u.worldToScreen(s.fromValues(i[0],i[1])),o=u.worldToScreen(s.fromValues(i[0]+i[2],i[1]+i[3]));e.updateCoreTouchTarget(t,i,new un(r[0],r[1],o[0]-r[0],o[1]-r[1]),n.tileInfo)}r&&e.activateTouchTargets(r.getTouchData())}(n.touchController,t,o,n),function(e,t,n){e.beginFrame(t);const i=a.create();(function(e,t,n){const i=e.gameMap.cells.sizeX,r=e.gameMap.cells.sizeY,o=GS*AT(t[0]),l=s.fromValues(t[0],t[1]-2*o),[u,c]=ET(l,i,r,e.zoomLevel),h=e.camera.position[0],d=e.camera.position[1],f=e.zoomLevel,p=o/(zS*f),m=Math.floor(WS*(h-u/2))/WS,g=Math.floor(zS*(d-c/2))/zS;a.ortho(n,m,m+u,g-p,g+c+p,1,-1)})(n,t,i),e.start(i,1),function(e,t){const n={};for(let t of e.gameMap.items){const i=e.gameMap.cells.indexVec(t.pos);i in n?n[i].push(t):n[i]=[t]}for(let i=0;i<e.gameMap.cells.sizeX;++i)for(let r=e.gameMap.cells.sizeY-1;r>=0;--r){const o=e.gameMap.cells.at(i,r);if(!o.seen&&!e.seeAll)continue;let s=o.type;s!=$.GroundWoodCreaky||o.lit||o.identified||(s=$.GroundWood);const a=fT(i,r,e.gameMap.cells,e.lightStates,e.seeAll);if([$.PortcullisEW].includes(s)&&e.gameMap.guards.find((e=>e.pos[0]==i&&e.pos[1]==r)))t.addGlyph(i,r,i+1,r+1,t.tileSet.terrainTiles[$.PortcullisNS],a);else{const e=o.animation?o.animation.currentTile():t.tileSet.terrainTiles[s];t.addGlyph(i,r,i+1,r+1,e,a)}if(s===$.GroundWater){const n=t.tileSet.ledgeTiles;let o=0;for(let s of[[0,1],[0,-1],[-1,0],[1,0]])e.gameMap.cells.at(i+s[0],r+s[1]).type!==$.GroundWater&&t.addGlyph(i,r,i+1,r+1,n[o],a),o++}const l=e.gameMap.cells.index(i,r);if(l in n)for(let o of n[l]){const n=fT(i,r,e.gameMap.cells,e.lightStates,e.seeAll);if([$.PortcullisEW].includes(s)&&e.gameMap.guards.find((e=>e.pos[0]==i&&e.pos[1]==r)))t.addGlyph(i,r,i+1,r+1,t.tileSet.itemTiles[Z.PortcullisNS],n);else{const e=o.animation?o.animation.currentTile():t.tileSet.itemTiles[o.type];if(o.animation instanceof k){const s=o.animation.offset;t.addGlyph(i+s[0],r+s[1],i+s[0]+1,r+s[1]+1,e,n)}else t.addGlyph(i,r,i+1,r+1,e,n)}}}}(n,e),n.gameMode===mn.Mansion&&(function(e,t){if(!e.seeGuardSight)return;const n=e.gameMap.cells.sizeX,i=e.gameMap.cells.sizeY,r=new z(n,i,!1),o=s.create(),a=s.create();for(const t of e.gameMap.guards){const l=3,u=Math.max(0,Math.floor(t.pos[0]-l)),c=Math.min(n,Math.floor(t.pos[0]+l)+1),h=Math.max(0,Math.floor(t.pos[1]-l)),d=Math.min(i,Math.floor(t.pos[1]+l)+1);for(let n=h;n<d;++n)for(let i=u;i<c;++i){s.set(o,i,n),s.subtract(a,o,t.pos);const l=e.gameMap.cells.at(i,n);r.get(i,n)||l.blocksPlayerMove||(e.seeAll||l.seen)&&(s.dot(t.dir,a)<0||s.squaredLen(a)>=t.sightCutoff(l.lit>0)||B(e.gameMap,t.pos,o)&&r.set(i,n,!0))}}for(let n=0;n<e.gameMap.cells.sizeY;++n)for(let i=0;i<e.gameMap.cells.sizeX;++i)r.get(i,n)&&t.addGlyph(i,n,i+1,n+1,VS.namedTiles.crossHatch,1)}(n,e),function(e,t){if(e.seeGuardPatrols)for(const n of e.gameMap.guards)for(const e of n.patrolPath)t.addGlyph(e[0],e[1],e[0]+1,e[1]+1,VS.namedTiles.patrolRoute,1)}(n,e));(function(e,t){for(const n of e.gameMap.guards){let i=0+pT(n.dir);const r=e.gameMap.cells.atVec(n.pos);let o=dT(r.lit,e.lightStates,r.litSrc,e.seeAll||r.seen);const a=e.seeAll||r.seen||n.speaking;if(!a&&s.squaredDistance(e.player.pos,n.pos)>36)continue;a||n.mode===P.Unconscious?n.mode!==P.Patrol||n.speaking||0!=r.lit?n.mode===P.Unconscious?i+=12:i+=8:o=0:i+=4;const l=t.tileSet.npcTiles[i],u=e.gameMap.items.find((e=>[Z.PortcullisEW,Z.PortcullisNS].includes(e.type))),c=void 0!==u&&u.pos.equals(n.pos)?.25:0;let h=n.animation?.offset??s.create();const d=n.pos[0]+h[0]+c,f=n.pos[1]+h[1];if(n.hasTorch||n.hasPurse||n.hasVaultKey){let e=d+.375*n.dir[0]+.375*n.dir[1],i=f-.125;const r=n.torchAnimation?.currentTile()??t.tileSet.itemTiles[Z.TorchCarry];let s=d-.25*n.dir[0]+(n.dir[1]<0?.375:0),a=f-.125;const u=n.hasVaultKey?VS.itemTiles[Z.KeyCarry]:t.tileSet.itemTiles[Z.PurseCarry];n.dir[1]>0?(n.hasTorch&&t.addGlyph(e,i,e+1,i+1,r,o),t.addGlyph(d,f,d+1,f+1,l,o),(n.hasPurse||n.hasVaultKey)&&t.addGlyph(s,a,s+1,a+1,u,o)):n.dir[1]<0?((n.hasPurse||n.hasVaultKey)&&t.addGlyph(s,a,s+1,a+1,u,o),t.addGlyph(d,f,d+1,f+1,l,o),n.hasTorch&&t.addGlyph(e,i,e+1,i+1,r,o)):(t.addGlyph(d,f,d+1,f+1,l,o),n.hasTorch&&t.addGlyph(e,i,e+1,i+1,r,o),(n.hasPurse||n.hasVaultKey)&&t.addGlyph(s,a,s+1,a+1,u,o))}else t.addGlyph(d,f,d+1,f+1,l,o)}})(n,e),(n.gameMode===mn.Mansion||n.gameMode===mn.Dead)&&(function(e,t){const n=e.player,i=e.player.animation,r=i&&i instanceof k?i.offset:s.create(),o=n.pos[0]+r[0],a=n.pos[1]+r[1],l=n.pos[0],u=n.pos[1],c=e.gameMap.cells.at(l,u),h=dT(c.lit,e.lightStates,c.litSrc,e.seeAll||c.seen),d=n.hidden(e.gameMap),f=t.tileSet.playerTiles;let p;p=e.player.animation?e.player.animation.currentTile():n.damagedLastTurn?f.wounded:n.noisy?f.noisy:d?f.hidden:h?f.normal:f.unlit,t.addGlyph(o,a,o+1,a+1,p,h)}(n,e),function(e,t){for(let n of e.particles)if(n.animation){const e=n.animation,i=e instanceof k?e.offset:s.create(),r=n.pos[0]+i[0],o=n.pos[1]+i[1],a=e.currentTile();t.addGlyph(r,o,r+1,o+1,a)}}(n,e));n.gameMode===mn.Mansion&&function(e,t){const n=e.player;for(const i of e.gameMap.guards){const r=e.gameMap.cells.atVec(i.pos);if(!(e.seeAll||r.seen||i.speaking)&&s.squaredDistance(e.player.pos,i.pos)>36)continue;const o=i.overheadIcon();let a;if(o!==Q.Relaxed)a=t.tileSet.guardStateTiles[o];else{if(i!==n.pickTarget)continue;a=VS.namedTiles.pickTarget}let l=i.animation?.offset??s.create();const u=i.pos[0]+l[0],c=i.pos[1]+l[1]+.625;t.addGlyph(u,c,u+1,c+1,a,1)}if(n.noisy){const e=n.pos[0],i=n.pos[1]-.5;t.addGlyph(e,i,e+1,i+1,VS.namedTiles.noise,1)}}(n,e);e.flush();const r=n.textWindows[n.gameMode];void 0!==r&&r.render(e);n.gameMode!==mn.Mansion&&n.gameMode!==mn.BetweenMansions||(n.helpActive?(n.helpScreen.render(e),CT(e,t,n)):(!function(e,t,n,i){const r=AT(t[0]),o=r*GS,s=t[0]/(r*jS),l=t[1]/o,u=1-l,c=a.create();a.ortho(c,0,s,u,l+u,1,-1),e.start(c,0);const h=Math.ceil(s);e.addGlyph(0,0,h,1,HS.background),i.dailyRun&&kT(e,0,"Daily run",st);const d=Math.floor((h-n.length)/2+.5);kT(e,d,n,tt),e.flush()}(e,t,n.topStatusMessage,n),CT(e,t,n)));an===n.touchController&&(e.start(i,1),function(e,t,n){for(const t in n.coreTouchTargets){if(!(t in n.controlStates))continue;const i=n.coreTouchTargets[t],r=n.controlStates[t]&&n.targetOnTouchDown===t?1:0;null!==i.tileInfo&&("always"==i.show||"press"==i.show&&-1!=i.id)&&e.addGlyph(i.game[0],i.game[1],i.game[0]+i.game[2],i.game[1]+i.game[3],i.tileInfo,r)}e.flush()}(e,0,n.touchController),e.flush())}(t,o,n),requestAnimationFrame((e=>TT(e,t,n)))}function IT(e,t,n,i,r){const o=s.create(),a=s.create();!function(e,t,n,i,r){const o=e[0],a=e[1],l=GS*AT(t[0]),u=s.fromValues(t[0],t[1]-2*l),[c,h]=ET(u,o,a,n);let d=c/2,f=e[0]-c/2;d>f&&(d=f=e[0]/2);let p=h/2,m=e[1]-h/2;p>m&&(p=m=e[1]/2);i[0]=d,i[1]=p,r[0]=f,r[1]=m}(t,i,n,o,a),e[0]=Math.max(o[0],Math.min(a[0],r[0]+.5)),e[1]=Math.max(o[1],Math.min(a[1],r[1]+.5))}function ET(e,t,n,i){const r=WS*i,o=zS*i;return[e[0]/r,e[1]/o]}function AT(e){return Math.min(2,Math.max(1,Math.floor(e/(BS*jS))))}function kT(e,t,n,i){for(let r=0;r<n.length;++r){const o=n.charCodeAt(r);e.addGlyph(t+r,0,t+r+1,1,{textureIndex:o,color:i})}}function CT(e,t,n){const i=AT(t[0]),r=t[0]/(i*jS),o=t[1]/(i*GS),s=a.create();a.ortho(s,0,r,0,o,1,-1),e.start(s,0);const l=Math.ceil(r);e.addGlyph(0,0,l,1,HS.background);kT(e,1,"Health",Ze);const u=HS.heart.textureIndex;for(let t=0;t<ne;++t){const i=t<n.player.health?Ze:Je;e.addGlyph(t+1+7,0,t+1+8,1,{textureIndex:u,color:i})}if(n.gameMap.cells.at(n.player.pos[0],n.player.pos[1]).type==$.GroundWater&&n.player.turnsRemainingUnderwater>0){const t=1+ne+10;kT(e,t,"Air",ot);const i=HS.air.textureIndex;for(let r=0;r<n.player.turnsRemainingUnderwater;++r)e.addGlyph(t+4+r,0,t+5+r,1,{textureIndex:i,color:ot})}const c=n.gameMap.percentSeen(),h=YS(n),d=n.gameMap.cells,f=Math.ceil(d.sizeX*d.sizeY*(1-n.initialSeen)/4);let p=(6-h)*f+f-1-n.turns;const m=h>0?"Timer "+p+" (+"+h+")":"Turns "+n.turns+" (--)",g="Mansion "+(n.level+1)+" - "+c+"% Mapped - "+m;kT(e,Math.floor((l-g.length)/2+.5),g,tt);let v="Loot "+n.player.loot;const y=l-(v.length+1);if(kT(e,y,v,st),n.player.hasVaultKey){kT(e,y-4,"Key",ot)}if(n.leapToggleActive){const t="Leap";kT(e,y-(t.length+2),t,rt)}e.flush()}function xT(e=null,t=!0){const n=e??new Date,i=t?n.getUTCFullYear():n.getFullYear(),r=1+(t?n.getUTCMonth():n.getMonth()),o=t?n.getUTCDate():n.getDate();return`${String(i)}/${String(r).padStart(2,"0")}/${String(o).padStart(2,"0")}`}
//# sourceMappingURL=index.ba0dc971.js.map
